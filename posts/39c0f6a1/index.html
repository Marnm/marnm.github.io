<!DOCTYPE html>
<html lang="en">

<head><meta name="generator" content="Hexo 3.8.0">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport">
	
	<!-- title -->
	
	<title>
	
		Prometheus学习笔记 | 
	 
	Deops&#39;s blog
	</title>
	
	<!-- keywords,description -->
	
		<meta name="keywords" content="Echo">
	 
		<meta name="description" content="Echo">
	

	<!-- favicon -->
	
	<link rel="shortcut icon" href="/favicon.ico">
	


	<!-- search -->
	<script>
		var searchEngine = "https://www.google.com/search?q=";
		if(typeof searchEngine == "undefined" || searchEngine == null || searchEngine == ""){
			searchEngine = "https://www.google.com/search?q=";
		}
		var homeHost = "https://marnm.github.io/";
		if(typeof homeHost == "undefined" || homeHost == null || homeHost == ""){
			homeHost = window.location.host;
		}
	</script>


	<link rel="stylesheet" href="/css/main.css">
	<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="/lib/highlight/styles/base16/solarized-dark.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
    
    <!-- 引入代码高亮的 js -->
    <script src="/lib/highlight/highlight.min.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>

	<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
	<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

	<script src="https://cdn.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script>
	<script src="/js/main.js"></script>
	
		<script src="https://cdn.jsdelivr.net/npm/leancloud-storage/dist/av-min.js"></script>
		<script src="https://cdn.jsdelivr.net/npm/valine@v1.4.14/dist/Valine.min.js"></script>
	
	
</head>

<body>
	<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?3efe99c287df5a1d6f0d02d187e403c1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<header id="header">
    <a id="title" href="/" class="logo">Deops's blog</a>

	<ul id="menu">
		<li class="menu-item">
			<a href="/about" class="menu-item-link">ABOUT</a>
		</li>
	
		<li class="menu-item">
			<a href="/tags" class="menu-item-link">标签</a>
		</li>
	

	
		<li class="menu-item">
			<a href="/categories" class="menu-item-link">分类</a>
		</li>
	

		<li class="menu-item">
			<a href="https://github.com/Marnm" class="menu-item-link" target="_blank">
				<i class="fa fa-github fa-2x"></i>
			</a>
		</li>
	</ul>
</header>

	
<div id="sidebar">
	<button id="sidebar-toggle" class="toggle"><i class="fa fa-arrow-right " aria-hidden="true"></i></button>
	
	<div id="site-toc">
		<input id="search-input" class="search-input" type="search" placeholder="按回车全站搜索">
		<div id="tree">
			

			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Ansible自动化运维
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/b45e213f/">
                     
										    Ansible自动化管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/28c30eb2/">
                     
										    CTF线下赛AWD套路小结
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Ceph对象存储
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/38843421/">
                     
										    Ceph分布式存储部署笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e9abc941/">
                     
										    Ceph分布式存储
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/9964b559/">
                     
										    DHCP Server的配置与管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4782a8c2/">
                     
										    DNS Server的配置与管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/5e357037/">
                     
										    Django教程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Docker
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/4a3d459a/">
                     
										    Docker学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										ELK Stack
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/2d95f1c1/">
                     
										    ElasticSearch环境搭建
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/573fc171/">
                     
										    Logstash二进制安装与启动
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b11339a9/">
                     
										    Logstash去除不需要的字段
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d05b44e0/">
                     
										    Logstash读取日志发送到ES
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/9d56e705/">
                     
										    FTP/TFTP的配置与管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/ca9298d7/">
                     
										    Git版本控制
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/51acad32/">
                     
										    诺尔·巴尔扎克（Honoréde Balzac）的名言
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4def9c28/">
                     
										    In Your 20's These Things Matter More Than You Think
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/295162d9/">
                     
										    Java8 环境变量配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										KVM虚拟化
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/dba5727f/">
                     
										    KVM图形化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/204af86b/">
                     
										    KVM虚拟机克隆和快照
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d69c6e72/">
                     
										    KVM虚拟机添加磁盘
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/16305c66/">
                     
										    KVM虚拟机迁移
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/7733d98/">
                     
										    LDAP的配置与管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/5922577d/">
                     
										    LNMP手动部署
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/195423a2/">
                     
										    LNMP高可用架构配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/38cc96c8/">
                     
										    LVM磁盘管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/be48d001/">
                     
										    LVS-DR集群
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/df68056c/">
                     
										    LVS-IPTUN集群
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/dcf8e277/">
                     
										    LVS-NAT集群
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/640aafef/">
                     
										    LVS和KeepAlived实现高可用集群
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/82734d8/">
                     
										    Linux命令
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/67ee4dec/">
                     
										    Linux学习笔记 - 关于开源
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d53cba09/">
                     
										    Linux常用性能分析工具
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/15c0e66c/">
                     
										    Linux常见日志文件
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/480c215d/">
                     
										    Linux性能管理工具
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/a9bb0c1a/">
                     
										    Linux文件的特殊权限
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/cc999d74/">
                     
										    Linux文件的隐藏属性
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b7f1c6/">
                     
										    Linux文本四剑客
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/aabbd398/">
                     
										    Linux无法挂载sysroot并自动进入紧急模式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b3f64b7d/">
                     
										    Linux生成随机密码方法
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e025952a/">
                     
										    Linux登录退出提示信息欢迎信息
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/ee2f9f35/">
                     
										    Linux的PAM模块
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1e844aa4/">
                     
										    Linux的归档与解压缩
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/c4bbfe69/">
                     
										    Linux的日志切割
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/be846aea/">
                     
										    Linux禁止和开启ping的方法
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f20e14fd/">
                     
										    Linux网卡聚合及bond模式的原理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2fe5fc07/">
                     
										    Linux计划任务实现
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/365d0867/">
                     
										    Linux路由配置——route
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/fbf617b4/">
                     
										    MariaDB
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/bff83912/">
                     
										    Markdown 简明语法手册
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/5125c787/">
                     
										    Markdown语法说明（快速入门）
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										MongoDB
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/8b1c1f4b/">
                     
										    MongoDB介绍
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/a36562d7/">
                     
										    MongoDB学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/55c06d78/">
                     
										    MongoDB安装部署
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										MySQL学习笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/16fc5dc4/">
                     
										    MySQL5.6
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/61fb6d52/">
                     
										    MySQL5.7
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/bce68613/">
                     
										    MySQL基础
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f6e2d114/">
                     
										    使用RPM包安装MySQL5.7数据库
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/269a56e8/">
                     
										    MySQL备份与恢复（删库不跑路）
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/607e4760/">
                     
										    MySQL传统主从同步
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d77fafec/">
                     
										    MySQL的GTID主从同步
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/db0340bd/">
                     
										    MySQL高可用集群架构-MHA架构
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/62ec7971/">
                     
										    Atlas实现MySQL读写分离
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/490925f2/">
                     
										    MySQL数据库高级应用之读写分离
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/176dc5f3/">
                     
										    MyCat垂直分表操作
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/8f74b0e7/">
                     
										    MyCat教程全国省份分片枚举操作
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/208cd020/">
                     
										    MySQL调优
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1876d05d/">
                     
										    NetworkManager管理工具
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/60444925/">
                     
										    NexT主题优化+美化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Nginx学习笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/f4d30967/">
                     
										    Nginx动静分离部署
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1db2b3f1/">
                     
										    Nginx平滑升级
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2793eb31/">
                     
										    Nginx日志管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2793eb31/">
                     
										    Nginx日志管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e0989926/">
                     
										    Nginx添加第三方模块
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/da411b72/">
                     
										    Nginx虚拟主机
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d4e5e907/">
                     
										    Nginx访问控制
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d2802762/">
                     
										    Nginx高可用架构配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/36ba38f9/">
                     
										    NoSQL知识
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e8c4eb08/">
                     
										    OpenSSL使用教程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/97717e94/">
                     
										    PXE自动化部署
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Prometheus学习笔记
									</a>
									
							<ul>
								<li class="file active">
									<a href="/posts/39c0f6a1/">
                     
										    Prometheus学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1f351894/">
                     
										    Python-VirtualEnv
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/297a89d9/">
                     
										    Python学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/fa8e89f7/">
                     
										    RAID磁盘阵列技术介绍
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/afdfa673/">
                     
										    RHEL 7配置Yum软件仓库
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/32546aed/">
                     
										    RedHat Linux重置root管理员密码
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/eb7dbe25/">
                     
										    RedHat_7 配置网卡信息
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										Redis学习笔记
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/5188e636/">
                     
										    Redis与其他应用的集成
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/49fbbc1/">
                     
										    Redis基本操作
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e8376589/">
                     
										    Redis安装部署——Cluster集群
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e78aaf59/">
                     
										    Redis安装部署——Sentinel模式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2acd829b/">
                     
										    Redis安装部署——主从复制
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/119ed1dc/">
                     
										    Redis持久化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/18d7d749/">
                     
										    Redis概述
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e3fb0a3e/">
                     
										    Redis的数据备份与恢复
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3e3d973e/">
                     
										    Redis配合MySQL使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f03da4e7/">
                     
										    Redis配置文件详解
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/41f893fd/">
                     
										    Redis编译安装
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/dbd9d26a/">
                     
										    SHELL编程类面试题
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f42b90f9/">
                     
										    SHELL脚本工具
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/8a8ba1e/">
                     
										    SHELL脚本练习
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/c45f2736/">
                     
										    SQL Server 2008安装配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/aa142b64/">
                     
										    SQLite安装
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e228b71f/">
                     
										    SSH原理与应用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1fdc29d2/">
                     
										    Shell的基本运算符
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6309c3f8/">
                     
										    Shell编程
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e76ba468/">
                     
										    Ubuntu Desktop优化与配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/129acd64/">
                     
										    Ubuntu修改配置及美化
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b382711f/">
                     
										    VIM的使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e9c6771b/">
                     
										    Win10环境下Python2、3和pip2、3版本共存
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6ed6984b/">
                     
										    Windows进程管理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/59089347/">
                     
										    Zabbix3.4邮件报警配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/7034657d/">
                     
										    Zabbix4.0
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/c7b4ec91/">
                     
										    firewalld学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1ebd4a76/">
                     
										    iproute2工具包
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/57bbf635/">
                     
										    iptables学习笔记
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3e189d0c/">
                     
										    mysqlclient无法安装的问题
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/1939d3e2/">
                     
										    net-tools工具
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/bae5d4f0/">
                     
										    rhel修改网卡命名规则
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/3c7a2415/">
                     
										    rsync数据同步
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/37ca92de/">
                     
										    swap交换分区
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/6efb91e0/">
                     
										    tcpdump与Wireshark的使用
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/d185f6ae/">
                     
										    web性能压测学习
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/bb750036/">
                     
										    你要懂得及时止损，别太在乎沉没成本
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/da58b03e/">
                     
										    使用HAProxy实现七层负载均衡
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/b161a250/">
                     
										    使用服务搭建Hexo个人博客
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="directory">
									<a href="#" class="directory">
										<i class="fa fa-plus-square-o"></i>
										其它
									</a>
									
							<ul>
								<li class="file">
									<a href="/posts/9bf5b5/">
                     
										    我学练英语所使用的方法、工具与资料
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
								</li>
								
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4c41c7ef/">
                     
										    十二句经典的爱情名言
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/e364486e/">
                     
										    基于Docker搭建Prometheus
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/69c239dd/">
                     
										    基于LNMP架构搭建企业级开源监控系统Zabbix
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f801d3c5/">
                     
										    增加一台Filebeat收集httpd日志
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f5d6f6a9/">
                     
										    实战-GitLab更新代码后自动触发Jenkins进行部署
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/fa35a60d/">
                     
										    性能测试指标详解
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/8a3c5d26/">
                     
										    搭建Jenkins实现持续集成-配置Jenkins自动拉取GitLab中的代码
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/4f96852/">
                     
										    搭建JumpServer管理王者荣耀数万台游戏服务器
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/f0a65eeb/">
                     
										    根分区扩容
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2f57a694/">
                     
										    正则表达式
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/9e3f6743/">
                     
										    自由的灵魂必将远航
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/217dc297/">
                     
										    计算机概述
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/8d4b7ae1/">
                     
										    计算机组成原理
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/dded0e80/">
                     
										    运维发展史
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/undefined/">
                     
										    邮件报警配置
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/5095a46f/">
                     
										    配置Docker静态IP
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/2b923a54/">
                     
										    配置GitLab邮件服务
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
							<ul>
								<li class="file">
									<a href="/posts/76011417/">
                     
										    配置Zabbix3.4监控Apache服务
                     
									</a>
								</li>
								<div class="article-toc" style="display: none;"></div>
							</ul>
			
		</div>
	</div>
</div>

	<!-- 引入正文 -->
	<div id="content">
		<h1 id="article-title">
	Prometheus学习笔记
</h1>
<div class="article-meta">
	
	<span>Echo</span>
	<span>2022-06-28 17:19:36</span>
		<div id="article-categories">
    
		<span>Categories：</span>
            
    

    
		<span>Tags：</span>
            
    
		</div>

</div>

<div id="article-content">
	<h2 id="&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x88C5;"><a href="#&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x88C5;" class="headerlink" title="&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x88C5;"></a>&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x88C5;</h2><p><strong>Download Prometheus Binary Pakcage</strong></p>
<pre><code class="bash">curl -O --progress http://192.168.210.200/0221-note/prometheus-2.36.2.linux-amd64.tar.gz
tar zxvf prometheus-2.36.2.linux-amd64.tar.gz -C /opt/
mv prometheus-2.36.2.linux-amd64/ prometheus-2.36.2
cd /opt/prometheus-2.36.2/
vim /etc/systemd/system/prometheus.service
</code></pre>
<a id="more"></a>
<p><strong>Create Systemctl start file</strong></p>
<pre><code class="ini">[Unit]
Description=Prometheus
Wants=network-online.target
After=network-online.target

[Service]
User=prometheus
Group=prometheus
Type=simple
ExecStart=/opt/prometheus-2.36.2/prometheus \
    --config.file /opt/prometheus-2.36.2/prometheus.yml \
    --storage.tsdb.path /var/lib/prometheus/ \
    --web.console.templates=/opt/prometheus-2.36.2/consoles \
    --web.console.libraries=/opt/prometheus-2.36.2/console_libraries

[Install]
WantedBy=multi-user.target
</code></pre>
<p><strong>Configure Prometheus</strong></p>
<pre><code class="bash">useradd --no-create-home --bash /bin/false prometheus
useradd --no-create-home --bash /bin/false node_exporter
mkdir mkdir /var/lib/prometheus
chown prometheus:prometheus /opt/prometheus-2.36.2/
chown prometheus:prometheus /var/lib/prometheus/
systemctl daemon-reload
systemctl start prometheus
systemctl status prometheus
systemctl enable prometheus
</code></pre>
<pre><code class="bash">[root@server12 opt]# netstat -pantul | grep prometheus
tcp6       0      0 :::9090                 :::*                    LISTEN      4556/prometheus
tcp6       0      0 ::1:9090                ::1:49814               ESTABLISHED 4556/prometheus
tcp6       0      0 ::1:49814               ::1:9090                ESTABLISHED 4556/prometheus
[root@server12 opt]#
</code></pre>
<h3 id="&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x88C5;node-exporter"><a href="#&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x88C5;node-exporter" class="headerlink" title="&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x88C5;node_exporter"></a>&#x4E8C;&#x8FDB;&#x5236;&#x5B89;&#x88C5;node_exporter</h3><p><strong>Download node-exporter</strong></p>
<pre><code class="bash"> curl -O --progress http://192.168.210.200/0221-note/node_exporter-1.3.1.linux-amd64.tar.gz
 tar zxvf node_exporter-1.3.1.linux-amd64.tar.gz -C /opt/
 mv node_exporter-1.3.1.linux-amd64/ node_exporter-1.3.1
 cd node_exporter-1.3.1/
 systemctl stop prometheus
 systemctl status prometheus
</code></pre>
<p> <strong>Create systemctl start file mangement node-exporter</strong></p>
<pre><code class="bash"> vim /etc/systemd/system/node_exporter.service
</code></pre>
<pre><code class="ini"> [Unit]
Description=Prometheus Node Exporter
After=network.target

[Service]
ExecStart=/opt/node_exporter-1.3.1/node_exporter

[Install]
WantedBy=multi-user.target
</code></pre>
<pre><code class="bash">systemctl daemon-reload
systemctl start node_exporter
systemctl status node_exporter
systemctl enable node_exporter
</code></pre>
<h2 id="rpm&#x5B89;&#x88C5;grafana"><a href="#rpm&#x5B89;&#x88C5;grafana" class="headerlink" title="rpm&#x5B89;&#x88C5;grafana"></a>rpm&#x5B89;&#x88C5;grafana</h2><pre><code class="bash">curl -O --progress http://192.168.210.200/0221-note/grafana-enterprise-8.5.6-1.x86_64.rpm
yum install -y fontconfig urw-base35 urw-fonts
rpm -ivh grafana-enterprise-8.5.6-1.x86_64.rpm
</code></pre>
<p><strong>&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</strong></p>
<pre><code class="vim">vim /etc/grafana/grafana.ini
</code></pre>
<p>&#x53BB;&#x6389;&#x76F8;&#x5173;&#x6CE8;&#x91CA;</p>
<pre><code class="ini">#################################### Server ####################################
[server]
# Protocol (http, https, h2, socket)
protocol = http

# The ip address to bind to, empty will bind to all interfaces
http_addr = 0.0.0.0

# The http port  to use
http_port = 3000
....&#x7701;&#x7565;...
...
...
</code></pre>
<pre><code class="bash">systemctl start grafana-server
</code></pre>
<h2 id="Prometheus&#x57FA;&#x4E8E;Consul&#x7684;&#x670D;&#x52A1;&#x53D1;&#x73B0;"><a href="#Prometheus&#x57FA;&#x4E8E;Consul&#x7684;&#x670D;&#x52A1;&#x53D1;&#x73B0;" class="headerlink" title="Prometheus&#x57FA;&#x4E8E;Consul&#x7684;&#x670D;&#x52A1;&#x53D1;&#x73B0;"></a>Prometheus&#x57FA;&#x4E8E;Consul&#x7684;&#x670D;&#x52A1;&#x53D1;&#x73B0;</h2><p><strong>&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;consul</strong>  </p>
<pre><code class="bash">curl -O --progress http://192.168.210.200/0221-note/consul_1.12.2_linux_amd64.zip
unzip consul_1.12.2_linux_amd64.zip -d /usr/local/bin/
</code></pre>
<p><strong>&#x4E0E;Prometheus&#x96C6;&#x6210;</strong>  </p>
<pre><code class="bash">mkdir /etc/consul
mkdir /var/lib/consul
#&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;
vim /etc/consul/nodes1.json
</code></pre>
<pre><code class="json">{
  &quot;services&quot;: [
    {
      &quot;id&quot;: &quot;node_exporter-node01&quot;,
      &quot;name&quot;: &quot;node01&quot;,
      &quot;address&quot;: &quot;192.168.73.11&quot;,
      &quot;port&quot;: 9100,
      &quot;tags&quot;: [&quot;nodes&quot;],
      &quot;checks&quot;: [{
        &quot;http&quot;: &quot;http://192.168.73.11:9100/metrics&quot;,
        &quot;interval&quot;: &quot;5s&quot;
      }]
    },
    {
      &quot;id&quot;: &quot;node_exporter-node02&quot;,
      &quot;name&quot;: &quot;node02&quot;,
      &quot;address&quot;: &quot;192.168.73.12&quot;,
      &quot;port&quot;: 9100,
      &quot;tags&quot;: [&quot;prometheus&quot;],
      &quot;checks&quot;: [{
        &quot;http&quot;: &quot;http://192.168.73.12:9100/metrics&quot;,
        &quot;interval&quot;: &quot;5s&quot;
      }]
    }
  ]
}
</code></pre>
<p><strong>&#x4FEE;&#x6539;Prometheus&#x914D;&#x7F6E;</strong></p>
<pre><code class="yaml"># my global config
global:
  scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.

alerting:
  alertmanagers:
    - static_configs:
        - targets:
          # - alertmanager:9093
rule_files:

scrape_configs:
  - job_name: &quot;prometheus&quot;  # /etc/consul/nodes1.json&#x91CC;&#x7684;tags&#x91CC;&#x7684;&#x53C2;&#x6570;&#x6709;&#x624D;&#x884C;
    consul_sd_configs:
    - server: &quot;192.168.73.12:8500&quot;  # &#x6539;&#x6210;&#x81EA;&#x5DF1;&#x7684;IP
      tags:
      - &quot;prometheus&quot;
      refresh_interval: 10s

  - job_name: &apos;nodes&apos;
    consul_sd_configs:
    - server: &quot;192.168.73.12:8500&quot;  # &#x6539;&#x6210;&#x81EA;&#x5DF1;&#x7684;IP
      tags:
      - &quot;nodes&quot;
      refresh_interval: 5s
</code></pre>
<p><strong>&#x68C0;&#x67E5;Prometheus&#x914D;&#x7F6E;&#x662F;&#x5426;&#x6B63;&#x786E;</strong></p>
<pre><code class="bash">./promtool check config ./prometheus.yml
Checking ./prometheus.yml
 SUCCESS: ./prometheus.yml is valid prometheus config file syntax

[root@server12 prometheus-2.36.2]#
</code></pre>
<p><strong>&#x540E;&#x53F0;&#x8FD0;&#x884C;Consul</strong></p>
<pre><code class="bash"> nohup consul agent -server -bootstrap -bind=192.168.73.12 -client=192.168.73.12 -data-dir=/var/lib/consul -config-dir=/etc/consul -ui -node=192.168.73.12 &amp; # &#x56DE;&#x8F66;
</code></pre>
<p><strong>&#x91CD;&#x542F;Prometheus</strong></p>
<pre><code class="bash">systemctl restart prometheus
</code></pre>
<p><strong>consul&#x65E5;&#x5FD7;</strong></p>
<pre><code>consul agent -dev -data-dir=/data/consul -config-dir=/etc/consul -ui
</code></pre><p><strong>&#x5199;&#x5165;&#x6D4B;&#x8BD5;&#x6570;&#x636E;</strong></p>
<pre><code class="bash">curl -X PUT -d &apos;{&quot;id&quot;:&quot;node-exporter11&quot;,&quot;name&quot;:&quot;node-exporter11&quot;,&quot;address&quot;:&quot;192.168.73.11&quot;,&quot;port&quot;:9100,&quot;tags&quot;:[&quot;node-exporter&quot;],&quot;checks&quot;:[{&quot;http&quot;:&quot;http://192.168.73.11:9100/&quot;,&quot;interval&quot;: &quot;5s&quot;}]}&apos; http://192.168.73.11:8500/v1/agent/service/register

curl -X PUT -d &apos;{&quot;id&quot;:&quot;node-exporter12&quot;,&quot;name&quot;:&quot;node-exporter12&quot;,&quot;address&quot;:&quot;192.168.73.12&quot;,&quot;port&quot;:9100,&quot;tags&quot;:[&quot;node-exporter&quot;],&quot;checks&quot;:[{&quot;http&quot;:&quot;http://192.168.73.12:9100/&quot;,&quot;interval&quot;: &quot;5s&quot;}]}&apos; http://192.168.73.12:8500/v1/agent/service/register
# &#x4E0A;&#x9762;&#x7684;IP&#x5730;&#x5740;&#x6539;&#x6210;&#x81EA;&#x5DF1;&#x7684;

# curl&#x5E38;&#x7528;&#x53C2;&#x6570;
# -X/--request  &#x6307;&#x5B9A;&#x4EC0;&#x4E48;&#x6307;&#x4EE4;&#xFF08;&#x8BF7;&#x6C42;&#xFF09;[GET|POST|PUT|DELETE|...] &#x6307;&#x5B9A;HTTP method&#x53D1;&#x51FA;&#x6307;&#x5B9A;&#x7684;request
# -d/--data &quot;XX=XXXX...&quot; &#x8BBE;&#x5B9A;HTTP&#x53C2;&#x6570;
# -H/--header &quot;XX:XXX&quot; &#x8BBE;&#x5B9A;request&#x7684;header
# -i/--include &#x663E;&#x793A;response&#x7684;header
# -v/--verbose &#x663E;&#x793A;&#x7EA4;&#x8BE6;&#x7EC6;&#x4FE1;&#x606F;
# -u/--user  &quot;XX:XXX&quot; &#x4F7F;&#x7528;&#x8005;&#x8D26;&#x53F7;&#x5BC6;&#x7801;
# -b/--cookie cookie&#x6587;&#x4EF6;&#x8DEF;&#x5F84;&#x4F7F;&#x7528;cookie
</code></pre>
<hr>
<h2 id="&#x4F7F;&#x7528;Consul&#x76D1;&#x63A7;MySQL"><a href="#&#x4F7F;&#x7528;Consul&#x76D1;&#x63A7;MySQL" class="headerlink" title="&#x4F7F;&#x7528;Consul&#x76D1;&#x63A7;MySQL"></a>&#x4F7F;&#x7528;Consul&#x76D1;&#x63A7;MySQL</h2><blockquote>
<p>MySQL Exporter &#x662F;&#x7528;&#x6765;&#x91C7;&#x96C6; MySQL/MariaDB &#x6570;&#x636E;&#x5E93;&#x76D1;&#x63A7;&#x6307;&#x6807;&#x800C;&#x8BBE;&#x8BA1;&#x5F00;&#x53D1;&#x7684;&#xFF0C;&#x901A;&#x8FC7; Exporter &#x4E0A;&#x62A5;&#x6838;&#x5FC3;&#x7684;&#x6570;&#x636E;&#x5E93;&#x6307;&#x6807;&#xFF0C;&#x7528;&#x4E8E;&#x5F02;&#x5E38;&#x62A5;&#x8B66;&#x548C;&#x76D1;&#x63A7;&#x5927;&#x76D8;&#x5C55;&#x793A;&#xFF0C;&#x4E91;&#x76D1;&#x63A7; Prometheus &#x63D0;&#x4F9B;&#x4E86;&#x4E0E; MySQL Exporter &#x96C6;&#x6210;&#x53CA;&#x5F00;&#x7BB1;&#x5373;&#x7528;&#x7684; Grafana &#x76D1;&#x63A7;&#x5927;&#x76D8;&#x3002;</p>
</blockquote>
<p><strong>&#x5B89;&#x88C5;&#x6570;&#x636E;&#x5E93;</strong><br>MySQL/MariaDB&#x90FD;&#x53EF;&#x4EE5;</p>
<pre><code class="bash"># &#x5B89;&#x88C5;
yum install -y mariadb-server
# &#x542F;&#x52A8;
systemctl start mariadb
# &#x521D;&#x59CB;&#x5316;
mysql_secure_installation
</code></pre>
<p><strong>&#x6388;&#x6743;&#x76D1;&#x63A7;&#x8D26;&#x6237;&#x6743;&#x9650;</strong></p>
<pre><code class="sql">CREATE USER &apos;mysql_exporter&apos;@&apos;localhost&apos; IDENTIFIED BY &apos;imnot007*&apos;;

GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO &apos;mysql_exporter&apos;@&apos;localhost&apos;;

flush privileges;
</code></pre>
<p><strong>&#x5C1D;&#x8BD5;&#x767B;&#x5F55;&#x521B;&#x5EFA;&#x7684;&#x8D26;&#x6237;</strong></p>
<pre><code class="bash">mysql -umysql_exporter -pimnot007* -hlocalhost
</code></pre>
<p><strong>&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;mysql_exporter</strong>  </p>
<pre><code class="bash">curl -O --progress http://192.168.210.200/0221-note/mysqld_exporter-0.14.0.linux-amd64.tar.gz
tar xf mysqld_exporter-0.14.0.linux-amd64.tar.gz -C /opt/
cd /opt/mysqld_exporter-0.14.0.linux-amd64/
cp mysqld_exporter /usr/local/bin/ 
</code></pre>
<p><strong>&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#x914D;&#x7F6E;&#xFF1A;</strong></p>
<pre><code class="bash">vim /etc/my.cnf
</code></pre>
<p>&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#x914D;&#x7F6E;&#xFF1A;</p>
<pre><code class="ini">[client]
user=mysql_exporter
password=imnot007*
</code></pre>
<p><strong>&#x521B;&#x5EFA;systemd&#x7BA1;&#x7406;mysql expoter</strong></p>
<pre><code class="bash">vim /etc/systemd/system/mysqld_exporter.service
</code></pre>
<pre><code class="ini">[Unit]
Description=Prometheus Node Exporter
After=network.target
[Service]
# &#x4E0B;&#x9762;&#x7684;my.cnf&#x6539;&#x6210;&#x81EA;&#x5DF1;&#x7684;&#x76EE;&#x5F55;
ExecStart=/usr/local/bin/mysqld_exporter --config.my-cnf=/etc/my.cnf
[Install]
WantedBy=multi-user.target
</code></pre>
<pre><code class="bash">systemctl daemon-reload
systemctl start mysqld_exporter
systemctl enable mysqld_exporter
</code></pre>
<p><strong>&#x68C0;&#x67E5;mysqld expoter&#x662F;&#x5426;&#x542F;&#x52A8;</strong></p>
<pre><code class="xml">[root@server11 mysqld_exporter-0.14.0.linux-amd64]# netstat -pantul | grep 9104
tcp6       0      0 :::9104                 :::*                    LISTEN      12982/mysqld_export
[root@server11 mysqld_exporter-0.14.0.linux-amd64]#
</code></pre>
<p><strong>&#x4FEE;&#x6539;Consul&#x914D;&#x7F6E;</strong></p>
<pre><code>vim /etc/consul/nodes1.json
</code></pre><pre><code class="json">{
  &quot;services&quot;: [
    {
      &quot;id&quot;: &quot;node_exporter-node01&quot;,
      &quot;name&quot;: &quot;node01&quot;,
      &quot;address&quot;: &quot;192.168.73.11&quot;,
      &quot;port&quot;: 9100,
      &quot;tags&quot;: [&quot;nodes&quot;],
      &quot;checks&quot;: [{
        &quot;http&quot;: &quot;http://192.168.73.11:9100/metrics&quot;,
        &quot;interval&quot;: &quot;5s&quot;
      }]
    },
    {
      &quot;id&quot;: &quot;node_exporter-node02&quot;,
      &quot;name&quot;: &quot;node02&quot;,
      &quot;address&quot;: &quot;192.168.73.12&quot;,
      &quot;port&quot;: 9100,
      &quot;tags&quot;: [&quot;prometheus&quot;],
      &quot;checks&quot;: [{
        &quot;http&quot;: &quot;http://192.168.73.12:9100/metrics&quot;,
        &quot;interval&quot;: &quot;5s&quot;
      }]
    },
    {
      &quot;id&quot;: &quot;mysql-monitor-172.31.2.182&quot;,
      &quot;name&quot;: &quot;mysql&quot;,
      &quot;address&quot;: &quot;192.168.73.11&quot;,
      &quot;port&quot;: 9104,
      &quot;tags&quot;: [&quot;mysql&quot;],
      &quot;checks&quot;: [{
        &quot;http&quot;: &quot;http://192.168.73.12:9100/metrics&quot;,
        &quot;interval&quot;: &quot;5s&quot;
      }]
    }
  ]
}
</code></pre>
<p>&#x91CD;&#x542F;Consul</p>
<pre><code>nohup consul agent -server -bootstrap -bind=192.168.73.12 -client=192.168.73.12 -data-dir=/var/lib/consul -config-dir=/etc/consul -ui -node=192.168.73.12 &amp;
</code></pre><p><strong>&#x4FEE;&#x6539;Prometheus&#x914D;&#x7F6E;</strong></p>
<pre><code class="yaml">global:
  scrape_interval: 15s # Set the scrape interval to every 15 seconds. Default is every 1 minute.
  evaluation_interval: 15s # Evaluate rules every 15 seconds. The default is every 1 minute.
  # scrape_timeout is set to the global default (10s).

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets:
          # - alertmanager:9093

# Load rules once and periodically evaluate them according to the global &apos;evaluation_interval&apos;.
rule_files:
  # - &quot;first_rules.yml&quot;
  # - &quot;second_rules.yml&quot;
# Here it&apos;s Prometheus itself.
scrape_configs:
  - job_name: &quot;prometheus&quot;
    consul_sd_configs:
    - server: &quot;192.168.73.12:8500&quot;
      tags:
      - &quot;prometheus&quot;
      refresh_interval: 10s

  - job_name: &apos;nodes&apos;
    consul_sd_configs:
    - server: &quot;192.168.73.12:8500&quot;
      tags:
      - &quot;nodes&quot;
      refresh_interval: 5s
# &#x8FD9;&#x91CC;&#xFF1A;
  - job_name: &apos;mysql&apos;
    consul_sd_configs:
    - server: &quot;192.168.73.12:8500&quot;
      tags:
      - &quot;mysql&quot;
      refresh_interval: 5s
[root@server12 prometheus-2
</code></pre>
<p>&#x91CD;&#x542F;Prometheus</p>
<h2 id="&#x4F7F;&#x7528;Consul&#x76D1;&#x63A7;HAProxy"><a href="#&#x4F7F;&#x7528;Consul&#x76D1;&#x63A7;HAProxy" class="headerlink" title="&#x4F7F;&#x7528;Consul&#x76D1;&#x63A7;HAProxy"></a>&#x4F7F;&#x7528;Consul&#x76D1;&#x63A7;HAProxy</h2><p><strong>&#x5B89;&#x88C5;HAProxy&#x548C;web&#x670D;&#x52A1;</strong></p>
<pre><code class="bash">yum install haproxy
yum install -y nginx
systemctl start nginx
systemctl enable nginx
</code></pre>
<p><strong>&#x4FEE;&#x6539; socket &#x6587;&#x4EF6;</strong></p>
<pre><code class="bash">vim /etc/haproxy/haproxy.cfg
</code></pre>
<blockquote>
<p># &#x4FEE;&#x6539;&#x7B2C;36&#x884C;&#xFF1A;<br>stats socket /var/lib/haproxy/haproxy.sock mode 600 level admin</p>
</blockquote>
<p><strong>&#x91CD;&#x542F;HAProxy</strong></p>
<pre><code>systemctl restart haproxy
systemctl status haproxy
</code></pre><p><strong>&#x4E0B;&#x8F7D;&#x914D;&#x7F6E;HAProxy Expoter</strong><br>&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/prometheus/haproxy_exporter/releases/tag/v0.13.0" target="_blank" rel="noopener">https://github.com/prometheus/haproxy_exporter/releases/tag/v0.13.0</a></p>
<pre><code class="bash">tar zxf haproxy_exporter-0.13.0.linux-amd64.tar.gz -C /opt/
cd /opt/haproxy_exporter-0.13.0.linux-amd64/
cp haproxy_exporter /usr/local/bin/
</code></pre>
<p><strong>&#x4FEE;&#x6539;HAProxy&#x914D;&#x7F6E;</strong></p>
<pre><code class="bash">vim /etc/haproxy/haproxy.cfg
</code></pre>
<pre><code class="ini"># &#x5728;59&#x884C;&#x4E0B;&#x6DFB;&#x52A0;&#xFF1A;
listen stats
    bind 0.0.0.0:8080
    mode http
    maxconn 10
    timeout connect         30s
    timeout client          30s
    timeout server          30s
    stats enable
    stats refresh 30s
    stats uri /stats
    stats realm Haproxy Manager
    stats auth admin:admin
    stats hide-version
    stats admin if TRUE
#...
#...
# &#x5728;&#x7B2C;95&#x884C;&#x4E0B;&#x4FEE;&#x6539;&#x5982;&#x4E0B;
backend app
     balance     roundrobin
     server  nginx12 192.168.73.12:80    cookie  server1 weight  6   inter   2000    rise    2   fall    3
     server  nginx11 192.168.73.12:80    cookie  server2 weight  6   inter   2000    rise    2   fall    3
</code></pre>
<p>&#x91CD;&#x542F;HAProxy</p>
<pre><code>systemctl restart haproxy
</code></pre><p><strong>&#x8FD0;&#x884C;haproxy expoter</strong>  </p>
<pre><code>haproxy_exporter --haproxy.scrape-uri=unix:/var/lib/haproxy/haproxy.sock
</code></pre><p><strong>Prometheus&#x76D1;&#x63A7;HAProxy</strong></p>
<pre><code class="yaml"># &#x5728;&#x672B;&#x5C3E;&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#x914D;&#x7F6E;
  - job_name: &apos;haproxy&apos;
    static_configs:
    - targets: [&apos;192.168.73.11:9101&apos;]
</code></pre>
<p>&#x91CD;&#x542F;Prometheus</p>
<hr>
<h2 id="Prometheus&#x76D1;&#x63A7;Nginx"><a href="#Prometheus&#x76D1;&#x63A7;Nginx" class="headerlink" title="Prometheus&#x76D1;&#x63A7;Nginx"></a>Prometheus&#x76D1;&#x63A7;Nginx</h2><p><strong>&#x83B7;&#x53D6;Nginx&#x865A;&#x62DF;&#x4E3B;&#x673A;&#x6D41;&#x91CF;&#x72B6;&#x6001;&#x6A21;&#x5757;nginx-module-vts</strong><br>&#x6A21;&#x5757;&#x9879;&#x76EE;&#x5730;&#x5740;&#xFF1A;<a href="https://github.com/vozlt/nginx-module-vts" target="_blank" rel="noopener">https://github.com/vozlt/nginx-module-vts</a>  </p>
<pre><code class="bash">cd /usr/local/src/
git clone git://github.com/vozlt/nginx-module-vts.git
</code></pre>
<p><strong>&#x6E90;&#x7801;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;Nginx</strong>  </p>
<pre><code class="bash">./configure --with-http_v2_module --with-http_ssl_module --with-http_sub_module --with-http_stub_status_module --with-http_gzip_static_module --with-pcre --with-http_realip_module --with-pcre --with-file-aio --with-stream --with-stream_ssl_module --with-stream_realip_module --add-module=/usr/local/src/nginx-module-vts

make &amp;&amp; make install
</code></pre>
<p><strong>&#x4FEE;&#x6539;Nginx&#x914D;&#x7F6E;</strong></p>
<pre><code class="nginx">http {
...
...
        vhost_traffic_status_zone;
        vhost_traffic_status_filter_by_host on;
...
...
    server {
        location /metrics {
            vhost_traffic_status_display;
            vhost_traffic_status_display_format html;
        }
    }
}
</code></pre>
<p><strong>&#x521B;&#x5EFA;SystemD&#x7BA1;&#x7406;Nginx</strong></p>
<pre><code class="bash">vim /etc/systemd/system/nginx.service
</code></pre>
<pre><code class="ini">[Unit]
Description=The nginx HTTP and reverse proxy server
After=network-online.target remote-fs.target nss-lookup.target
Wants=network-online.target

[Service]
Type=forking
PIDFile=/usr/local/nginx/logs/nginx.pid
# Nginx will fail to start if /run/nginx.pid already exists but has the wrong
# SELinux context. This might happen when running `nginx -t` from the cmdline.
# https://bugzilla.redhat.com/show_bug.cgi?id=1268621
ExecStartPre=/usr/bin/rm -f /usr/local/nginx/logs/nginx.pid
ExecStartPre=/usr/sbin/nginx -t
ExecStart=/usr/sbin/nginx
ExecReload=/usr/sbin/nginx -s reload
KillSignal=SIGQUIT
TimeoutStopSec=5
KillMode=process
PrivateTmp=true

[Install]
WantedBy=multi-user.target
</code></pre>
<pre><code class="bash">systemctl daemon-reload
systemctl start nginx
</code></pre>
<p><strong>Nginx Exporter&#x914D;&#x7F6E;</strong><br>Nginx VTS Exporter&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A; <a href="https://github.com/hnlq715/nginx-vts-exporter" target="_blank" rel="noopener">https://github.com/hnlq715/nginx-vts-exporter</a>  </p>
<pre><code class="bash">tar zxf nginx-vts-exporter-0.10.3.linux-amd64.tar.gz -C /opt/
cd /opt/nginx-vts-exporter-0.10.3.linux-amd64/
nohup ./nginx-vts-exporter -nginx.scrape_uri=http://0.0.0.0/metrics/format/json &amp;
</code></pre>
<p><strong>Prometheus&#x76D1;&#x63A7;Nginx</strong></p>
<pre><code class="yaml">- job_name: nginx
    scrape_interval: 15s
    static_configs:
    - targets: [&apos;192.168.73.3:9913&apos;]
      labels:
        instance: Nginx_A
    - targets: [&apos;192.168.5.11:9913&apos;]
      labels:
        instance: Nginx_B
</code></pre>
<p>&#x91CD;&#x542F;Prometheus</p>
<hr>
<h2 id="Prometheus&#x914D;&#x7F6E;AlertManager"><a href="#Prometheus&#x914D;&#x7F6E;AlertManager" class="headerlink" title="Prometheus&#x914D;&#x7F6E;AlertManager"></a>Prometheus&#x914D;&#x7F6E;AlertManager</h2><blockquote>
<p>AlertManager&#x7528;&#x4E8E;&#x76D1;&#x63A7;&#x544A;&#x8B66;<br>&#x670D;&#x52A1;&#x51FA;&#x73B0;&#x6545;&#x969C;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;AlertManager&#x901A;&#x77E5;&#x7EF4;&#x62A4;&#x8005;<br>&#x53EF;&#x4EE5;&#x662F;&#x53D1;&#x9001;&#x90AE;&#x4EF6;&#x901A;&#x77E5;&#x7EF4;&#x62A4;&#x8005;&#x3001;&#x6216;&#x8005;&#x901A;&#x8FC7;&#x4F01;&#x4E1A;&#x5FAE;&#x4FE1;&#x3001;&#x9489;&#x9489;&#x53D1;&#x9001;&#x4FE1;&#x606F;&#x7ED9;&#x7EF4;&#x62A4;&#x8005;  </p>
</blockquote>
<p><strong>&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;</strong></p>
<pre><code class="bash">curl -O --progress http://192.168.210.200/0221-note/alertmanager-0.24.0.linux-amd64.tar.gz
tar -zxf alertmanager-0.24.0.linux-amd64.tar.gz -C /opt/
cd /opt
mv alertmanager-0.24.0.linux-amd64/ alertmanager-0.24.0
mkdir /run/alertmanager
useradd -rs /bin/false alertmanager
chown alertmanager:alertmanager /opt/alertmanager-0.24.0/*
chown -R alertmanager:alertmanager /run/alertmanager
vim /etc/systemd/system/alertmanager.service
</code></pre>
<pre><code class="ini">[Unit]
Description=Alert Manager
Wants=network-online.target
After=network-online.target

[Service]
Type=simple
User=alertmanager
Group=alertmanager
ExecStart=/opt/alertmanager-0.24.0/alertmanager \
  --config.file=/opt/alertmanager-0.24.0/alertmanager.yml \
  --storage.path=/run/alertmanager

Restart=always

[Install]
WantedBy=multi-user.target
</code></pre>
<pre><code class="bash">systemctl daemon-reload
systemctl restart alertmanager
systemctl status alertmanager
systemctl enable alertmanager
</code></pre>
<p><strong>&#x4FEE;&#x6539;AlertManager&#x914D;&#x7F6E;</strong><br>&#x5148;&#x53BB;&#x81EA;&#x5DF1;&#x7684;&#x90AE;&#x7BB1;&#x83B7;&#x53D6;&#x4E00;&#x4E2A;&#x6388;&#x6743;&#x5BC6;&#x7801;</p>
<pre><code class="bash">vim /opt/alertmanager-0.24.0/alertmanager.yml
</code></pre>
<p>&#x53C2;&#x8003;&#x914D;&#x7F6E;&#xFF1A;</p>
<pre><code class="yaml">global:
  resolve_timeout: 1m
  smtp_smarthost: &apos;smtp.qq.com:465&apos; # 163&#x90AE;&#x7BB1;&#x8BF7;&#x4F7F;&#x7528;smtp.163.com
  smtp_from: &apos;fnaichu@qq.com&apos; # &#x4FEE;&#x6539;&#x4E3A;&#x81EA;&#x5DF1;&#x7684;&#x90AE;&#x7BB1;
  smtp_auth_username: &apos;fnaichu@qq.com&apos; # &#x4FEE;&#x6539;&#x4E3A;&#x81EA;&#x5DF1;&#x7684;&#x90AE;&#x7BB1;
  smtp_auth_password: &apos;&#x8FD9;&#x91CC;&#x7C98;&#x8D34;&#x83B7;&#x53D6;&#x5230;&#x7684;&#x6388;&#x6743;&#x7801;&apos;
  smtp_hello: &apos;@qq.com&apos; # 163.com
  smtp_require_tls: false
route:
  group_by: [&apos;alertname&apos;]
  group_wait: 10s
  group_interval: 2m
  repeat_interval: 5m
  receiver: &apos;web.hook&apos;
receivers:
  - name: &apos;web.hook&apos;
    email_configs:
    - to: &apos;fnaichu@qq.com&apos; # &#x4FEE;&#x6539;&#x4E3A;&#x81EA;&#x5DF1;&#x7684;&#x90AE;&#x7BB1;
      send_resolved: true
    #webhook_configs:
          #- url: &apos;http://127.0.0.1:5001/&apos;
inhibit_rules:
  - source_match:
      severity: &apos;critical&apos;
    target_match:
      severity: &apos;warning&apos;
    equal: [&apos;alertname&apos;, &apos;dev&apos;, &apos;instance&apos;]
</code></pre>
<p><strong>&#x68C0;&#x67E5;AlertManager&#x914D;&#x7F6E;</strong><br><em>&#x63D0;&#x793A;&#xFF1A;Checking &#x2018;alertmanager.yml&#x2019;  SUCCESS&#x5219;&#x914D;&#x7F6E;&#x6B63;&#x786E;</em></p>
<pre><code class="bash">./amtool check-config ./alertmanager.yml
Checking &apos;./alertmanager.yml&apos;  SUCCESS
Found:
 - global config
 - route
 - 1 inhibit rules
 - 1 receivers
 - 0 templates
[root@server12 alertmanager-0.24.0]#
</code></pre>
<p><strong>&#x914D;&#x7F6E;AlertManager&#x89C4;&#x5219;&#xFF1A;</strong></p>
<pre><code class="bash">mkdir /opt/prometheus-2.36.2/rules
vim /opt/prometheus-2.36.2/rules/server_rules.yaml
</code></pre>
<pre><code class="yaml">groups:
  - name: alertmanager_pod.rules
    rules:
    - alert: &quot;node &#x5185;&#x5B58;&#x53EF;&#x7528;&#x5927;&#x5C0F;&quot;
      expr: node_memory_MemFree_bytes &gt; 1 #&#x6545;&#x610F;&#x5199;&#x9519;&#x7684;
      for: 15s
      labels:
        severity: critical
      annotations:
        description: &quot;&#x8282;&#x70B9;&#x53EF;&#x7528;&#x5185;&#x5B58;&#x5C0F;&#x4E8E; 100k&quot;
</code></pre>
<p><strong>&#x4FEE;&#x6539;Prometheus&#x914D;&#x7F6E;</strong></p>
<pre><code class="bash">vim /opt/prometheus-2.36.2/prometheus.yml
</code></pre>
<p><strong>&#x5728;&#x5DF2;&#x6709;&#x7684;&#x914D;&#x7F6E;&#x4E0A;&#x4FEE;&#x6539;&#xFF1A;</strong></p>
<pre><code class="yaml">alerting:
  alertmanagers:
    - static_configs:
        - targets:
          # - alertmanager:9093
          - 192.168.73.12:9093

# Load rules once and periodically evaluate them according to the global &apos;evaluation_interval&apos;.
rule_files:
  # - &quot;first_rules.yml&quot;
  # - &quot;second_rules.yml&quot;
  - ./rules/server_rules.yaml
</code></pre>
<hr>
<h2 id="Prometheus&#x914D;&#x7F6E;pushgateway"><a href="#Prometheus&#x914D;&#x7F6E;pushgateway" class="headerlink" title="Prometheus&#x914D;&#x7F6E;pushgateway"></a>Prometheus&#x914D;&#x7F6E;pushgateway</h2><blockquote>
<p>PushGateway &#x4F5C;&#x4E3A; Prometheus &#x751F;&#x6001;&#x4E2D;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x4E00;&#x5458;&#xFF0C;&#x5B83;&#x5141;&#x8BB8;&#x4EFB;&#x4F55;&#x5BA2;&#x6237;&#x7AEF;&#x5411;&#x5176; Push &#x7B26;&#x5408;&#x89C4;&#x8303;&#x7684;&#x81EA;&#x5B9A;&#x4E49;&#x76D1;&#x63A7;&#x6307;&#x6807;&#xFF0C;&#x5728;&#x7ED3;&#x5408; Prometheus &#x7EDF;&#x4E00;&#x6536;&#x96C6;&#x76D1;&#x63A7;&#x3002;<br>PushGateway &#x4F7F;&#x7528;&#x573A;&#x666F;&#xFF1A;  </p>
<ul>
<li>Prometheus &#x91C7;&#x7528;&#x5B9A;&#x65F6; Pull &#x6A21;&#x5F0F;&#xFF0C;&#x53EF;&#x80FD;&#x7531;&#x4E8E;&#x5B50;&#x7F51;&#x7EDC;&#x6216;&#x8005;&#x9632;&#x706B;&#x5899;&#x7684;&#x539F;&#x56E0;&#xFF0C;&#x4E0D;&#x80FD;&#x76F4;&#x63A5;&#x62C9;&#x53D6;&#x5404;&#x4E2A; Target &#x7684;&#x6307;&#x6807;&#x6570;&#x636E;&#xFF0C;&#x6B64;&#x65F6;&#x53EF;&#x4EE5;&#x91C7;&#x7528;&#x5404;&#x4E2A; Target &#x5F80; PushGateway &#x4E0A; Push &#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E; Prometheus &#x53BB; PushGateway &#x4E0A;&#x5B9A;&#x65F6; pull&#x3002;</li>
<li>&#x5176;&#x6B21;&#x5728;&#x76D1;&#x63A7;&#x5404;&#x4E2A;&#x4E1A;&#x52A1;&#x6570;&#x636E;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x5C06;&#x5404;&#x4E2A;&#x4E0D;&#x540C;&#x7684;&#x4E1A;&#x52A1;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x7EDF;&#x4E00;&#x6C47;&#x603B;&#xFF0C;&#x6B64;&#x65F6;&#x4E5F;&#x53EF;&#x4EE5;&#x91C7;&#x7528; PushGateway &#x6765;&#x7EDF;&#x4E00;&#x6536;&#x96C6;&#xFF0C;&#x7136;&#x540E; Prometheus &#x6765;&#x7EDF;&#x4E00;&#x62C9;&#x53D6;&#x3002;</li>
</ul>
</blockquote>
<p><strong>&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;PushGateway</strong></p>
<pre><code class="bash">curl -O --progress http://192.168.210.200/0221-note/pushgateway-1.4.3.linux-amd64.tar.gz
tar -zxf pushgateway-1.4.3.linux-amd64.tar.gz -C /opt/
cd /opt/pushgateway-1.4.3.linux-amd64/
</code></pre>
<p><strong>&#x5728;Prometheus&#x914D;&#x7F6E;&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#xFF1A;</strong>  </p>
<pre><code class="yaml">  - job_name: &apos;pushgateway&apos;
    static_configs:
    - targets: [&apos;192.168.73.12:9091&apos;]
</code></pre>
<p>&#x91CD;&#x542F;Prometheus</p>
<p><strong>&#x542F;&#x52A8;PushGateway</strong></p>
<pre><code class="bash">./pushgateway
</code></pre>
<p><strong>&#x63A8;&#x9001;&#x6570;&#x636E;&#x6D4B;&#x8BD5;&#xFF1A;</strong></p>
<pre><code class="bash">echo &quot;mytest_metric 2022&quot; | curl --data-binary @- http://192.168.73.12:9091/metrics/job/mytest_job

echo &quot;mytest_metric 0628&quot; | curl --data-binary @- http://192.168.73.12:9091/metrics/job/mytest_job

# &#x63A8;&#x9001;&#x591A;&#x6761;&#x6570;&#x636E;
cat &lt;&lt;EOF | curl --data-binary @- http://192.168.73.12:9091/metrics/job/test_job/instance/192.168.73.12
#TYPE node_memory_usage gauge
node_memory_usage 4311744512
# TYPE memory_total gauge
node_memory_total 103481868288
EOF
</code></pre>
<p>&#x8BBF;&#x95EE;pushgatway&#x7684;&#x4E3B;&#x673A;&#x67E5;&#x770B;&#x6570;&#x636E;&#x662F;&#x5426;&#x63A8;&#x9001;&#x6210;&#x529F;&#xFF1A;<br><a href="http://192.168.73.12:9091/" target="_blank" rel="noopener">http://192.168.73.12:9091/</a></p>
<hr>
<h2 id="&#x6269;&#x5C55;&#x77E5;&#x8BC6;&#x2014;&#x2014;Consul&#x7684;&#x4F7F;&#x7528;"><a href="#&#x6269;&#x5C55;&#x77E5;&#x8BC6;&#x2014;&#x2014;Consul&#x7684;&#x4F7F;&#x7528;" class="headerlink" title="&#x6269;&#x5C55;&#x77E5;&#x8BC6;&#x2014;&#x2014;Consul&#x7684;&#x4F7F;&#x7528;"></a>&#x6269;&#x5C55;&#x77E5;&#x8BC6;&#x2014;&#x2014;Consul&#x7684;&#x4F7F;&#x7528;</h2><blockquote>
<p>&#x670D;&#x52A1;&#x7AEF;<br>consul agent -server -bootstrap-expect 1 -config-dir /etc/consul.d/ -data-dir /var/opt/consul -bind=125.72.214.83 &gt;&gt; /var/opt/consul/consul.log 2&gt;&amp;1<br>&#x6CE8;&#x518C;&#x670D;&#x52A1;<br>curl -X PUT -d &#x2018;{&#x201C;type&#x201D;:&#x201D;localService&#x201D;,&#x201D;outPort&#x201D;:8085,&#x201D;outPath&#x201D;:&#x201D;/websocket&#x201D;, &#x201C;forwardAddress&#x201D;:&#x201D;125.72.2&#xB7;4.83&#x201D;, &#x201C;forwardPort&#x201D;:&#x201D;8085&#x201D;}&#x2019; <a href="http://localhost:8500/v1/kv/websocket/my" target="_blank" rel="noopener">http://localhost:8500/v1/kv/websocket/my</a><br>webui&#x6DFB;&#x52A0;<br>-client 0.0.0.0 -ui<br>&#x5BA2;&#x6237;&#x7AEF;<br>consul agent -config-dir /etc/consul.d/ -data-dir /var/opt/consul -bind=121.42.204.73 -join=121.42.204.73 &gt;consul.log 2&gt;&amp;1<br>-bootstrap&#xFF1A;&#x542F;&#x52A8;&#x6A21;&#x5F0F;&#xFF0C;&#x6B64;&#x6A21;&#x5F0F;&#x4E0B;&#xFF0C;&#x8282;&#x70B9;&#x53EF;&#x4EE5;&#x9009;&#x4E3E;&#x81EA;&#x5DF1;&#x4E3A;leader&#xFF0C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x53EA;&#x80FD;&#x6709;&#x4E00;&#x4E2A;&#x6B64;&#x6A21;&#x5F0F;&#x542F;&#x52A8;&#x7684;&#x8282;&#x70B9;&#x3002;&#x673A;&#x7FA4;&#x542F;&#x52A8;&#x540E;&#xFF0C;&#x65B0;&#x542F;&#x52A8;&#x7684;&#x8282;&#x70B9;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x8FD9;&#x79CD;&#x6A21;&#x5F0F;&#x3002;<br>-bootstrap-expect&#xFF1A;&#x8BBE;&#x5B9A;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x9700;&#x8981;&#x7684;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x6570;&#xFF0C;&#x53EF;&#x4EE5;&#x4E0D;&#x8BBE;&#x7F6E;&#xFF0C;&#x8BBE;&#x7F6E;&#x7684;&#x6570;&#x5B57;&#x5FC5;&#x987B;&#x548C;&#x5B9E;&#x9645;&#x7684;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x6570;&#x5339;&#x914D;&#x3002;consul&#x4F1A;&#x7B49;&#x5F85;&#x76F4;&#x5230;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x4E0B;&#x7684;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x6EE1;&#x8DB3;&#x8BBE;&#x5B9A;&#x624D;&#x4F1A;&#x542F;&#x52A8;&#x96C6;&#x7FA4;&#x670D;&#x52A1;&#x3002;&#x521D;&#x59CB;&#x5316;leader&#x9009;&#x4E3E;&#xFF0C;&#x4E0D;&#x80FD;&#x548C;bootstrap&#x6DF7;&#x7528;&#x3002;&#x5FC5;&#x987B;&#x914D;&#x5408;-server&#x914D;&#x7F6E;&#x3002;<br>-bind&#xFF1A;&#x7ED1;&#x5B9A;&#x7684;&#x5185;&#x90E8;&#x901A;&#x8BAF;&#x5730;&#x5740;&#xFF0C;&#x9ED8;&#x8BA4;0.0.0.0&#xFF0C;&#x5373;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x672C;&#x5730;&#x5730;&#x5740;&#xFF0C;&#x4F1A;&#x5C06;&#x7B2C;&#x4E00;&#x4E2A;&#x53EF;&#x7528;&#x7684;ip&#x5730;&#x5740;&#x6563;&#x64AD;&#x5230;&#x96C6;&#x7FA4;&#x4E2D;&#xFF0C;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x53EF;&#x7528;&#x7684;ipv4&#xFF0C;&#x5219;consul&#x542F;&#x52A8;&#x62A5;&#x9519;&#x3002;[::]ipv6&#xFF0C;TCP UDP&#x534F;&#x8BAE;&#xFF0C;&#x76F8;&#x540C;&#x7684;&#x7AEF;&#x53E3;&#x3002;&#x9632;&#x706B;&#x5899;&#x914D;&#x7F6E;&#x3002;<br>-client&#xFF1A;&#x5BA2;&#x6237;&#x7AEF;&#x6A21;&#x5F0F;&#xFF0C;http dns&#xFF0C;&#x9ED8;&#x8BA4;127.0.0.1&#xFF0C;&#x56DE;&#x73AF;&#x4EE4;&#x724C;&#x7F51;&#x5740;<br>-config-file&#xFF1A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4F4D;&#x7F6E;<br>-config-dir&#xFF1A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x6240;&#x5728;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x4F1A;&#x52A0;&#x8F7D;&#x5176;&#x4E0B;&#x6240;&#x6709;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;.json&#x6216;&#x8005;.hcl&#x6587;&#x4EF6;&#xFF0C;&#x52A0;&#x8F7D;&#x987A;&#x5E8F;&#x4E3A;&#x5B57;&#x6BCD;&#x8868;&#x987A;&#x5E8F;&#xFF1B;&#x53EF;&#x7528;&#x914D;&#x7F6E;&#x591A;&#x4E2A;&#x6B64;&#x914D;&#x7F6E;&#xFF0C;&#x4ECE;&#x800C;&#x52A0;&#x8F7D;&#x591A;&#x4E2A;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x5B50;&#x6587;&#x4EF6;&#x5939;&#x7684;&#x914D;&#x7F6E;&#x4E0D;&#x4F1A;&#x88AB;&#x52A0;&#x8F7D;&#x3002;<br>-config-format&#xFF1A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x683C;&#x5F0F;&#xFF0C;&#x914D;&#x7F6E;&#x4E86;&#xFF0C;&#x5219;&#x52A0;&#x8F7D;&#x76F8;&#x5E94;&#x4E2A;&#x662F;&#x7684;&#x6587;&#x4EF6;&#x3002;&#x4E0D;&#x914D;&#x7F6E;&#xFF0C;&#x5219;consul&#x81EA;&#x52A8;&#x8BC6;&#x522B;&#x3002;<br>-data-dir&#xFF1A;&#x72B6;&#x6001;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x6240;&#x6709;&#x7684;&#x8282;&#x70B9;&#x90FD;&#x9700;&#x8981;&#x3002;&#x6587;&#x4EF6;&#x5939;&#x4F4D;&#x7F6E;&#x9700;&#x8981;&#x4E0D;&#x6536;consul&#x8282;&#x70B9;&#x91CD;&#x542F;&#x5F71;&#x54CD;&#xFF0C;&#x5FC5;&#x987B;&#x80FD;&#x591F;&#x4F7F;&#x7528;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x6587;&#x4EF6;&#x9501;&#xFF0C;unix-based&#x7CFB;&#x7EDF;&#x4E0B;&#xFF0C;&#x6587;&#x4EF6;&#x5939;&#x6587;&#x4EF6;&#x6743;&#x9650;&#x4E3A;0600&#xFF0C;&#x6CE8;&#x610F;&#x505A;&#x597D;&#x8D26;&#x6237;&#x6743;&#x9650;&#x63A7;&#x5236;&#xFF0C;<br>-datacenter&#xFF1A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x540D;&#x79F0;&#xFF0C;&#x9ED8;&#x8BA4;dc1&#xFF0C;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x4E2D;&#x5FC3;&#x7684;&#x6240;&#x6709;&#x8282;&#x70B9;&#x90FD;&#x5FC5;&#x987B;&#x5728;&#x4E00;&#x4E2A;LAN&#x4E2D;&#x3002;<br>-dev&#xFF1A;&#x5F00;&#x53D1;&#x6A21;&#x5F0F;&#xFF0C;&#x53BB;&#x6389;&#x6240;&#x6709;&#x6301;&#x4E45;&#x5316;&#x9009;&#x9879;&#xFF0C;&#x5185;&#x5B58;&#x670D;&#x52A1;&#x5668;&#x6A21;&#x5F0F;&#x3002;<br>-disable-host-node-id&#xFF1A;&#x4E0D;&#x4F7F;&#x7528;host&#x4FE1;&#x606F;&#x751F;&#x6210;node ID&#xFF0C;&#x9002;&#x7528;&#x4E8E;&#x540C;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x90E8;&#x7F72;&#x591A;&#x4E2A;&#x5B9E;&#x4F8B;&#x7528;&#x4E8E;&#x6D4B;&#x8BD5;&#x7684;&#x60C5;&#x51B5;&#x3002;&#x968F;&#x673A;&#x751F;&#x6210;nodeID<br>-dns-port&#xFF1A;v7.0&#x4EE5;&#x540E;&#xFF0C;&#x81EA;&#x5B9A;&#x4E49;dns &#x7AEF;&#x53E3;&#xFF0C;&#x8986;&#x76D6;&#x9ED8;&#x8BA4;8600<br>-enable-script-checks&#xFF1A;&#x662F;&#x5426;&#x5141;&#x8BB8;&#x4F7F;&#x7528;&#x811A;&#x672C;&#x8FDB;&#x884C;&#x5065;&#x5EB7;&#x68C0;&#x67E5;&#xFF0C;&#x9ED8;&#x8BA4;false&#xFF0C;&#x6700;&#x597D;&#x914D;&#x7F6E;enable acl<br>-encrypt&#xFF1A;consul&#x7F51;&#x7EDC;&#x901A;&#x8BAF;&#x52A0;&#x5BC6;key&#xFF0C;base64&#x52A0;&#x5BC6;&#xFF0C;16&#x6BD4;&#x7279;&#xFF1B;consul keygen&#x4EA7;&#x751F;&#x3002;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x5B9E;&#x4F8B;&#x5FC5;&#x987B;&#x63D0;&#x4F9B;&#x76F8;&#x540C;&#x7684;&#xFF0C;&#x53EA;&#x9700;&#x63D0;&#x4F9B;&#x4E00;&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x4F1A;&#x4FDD;&#x5B58;&#x5230;&#x6570;&#x636E;&#x6587;&#x4EF6;&#x3002;&#x91CD;&#x542F;&#x81EA;&#x52A8;&#x52A0;&#x8F7D;&#x3002;consul&#x8282;&#x70B9;&#x542F;&#x52A8;&#x540E;&#x63D0;&#x4F9B;&#xFF0C;&#x4F1A;&#x88AB;&#x5FFD;&#x7565;&#x3002;<br>-hcl&#xFF1A;&#x6DFB;&#x52A0;hcl&#x683C;&#x5F0F;&#x914D;&#x7F6E;&#xFF0C;&#x548C;&#x5DF2;&#x6709;&#x7684;&#x914D;&#x7F6E;&#x5408;&#x5E76;&#x3002;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x591A;&#x4E2A;&#x6B64;&#x914D;&#x7F6E;&#x3002;<br>-http-port&#xFF1A;http api&#x7AEF;&#x53E3;&#xFF0C;&#x8986;&#x76D6;&#x9ED8;&#x8BA4;&#x7684;8500&#x3002;&#x9002;&#x7528;&#x4E8E;&#x4E91;&#x73AF;&#x5883;&#x6307;&#x5B9A;&#x3002;<br>-log-file&#xFF1A;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55;&#x6587;&#x4EF6;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x6587;&#x4EF6;&#x540D;&#xFF0C;&#x5219;&#x9ED8;&#x8BA4;Consul-&#x65F6;&#x95F4;&#x6233;.log<br>-log-level&#xFF1A;&#x65E5;&#x5FD7;&#x7EA7;&#x522B;&#xFF0C;&#x9ED8;&#x8BA4;info&#xFF0C;&#x5305;&#x542B;&#xFF1A;trace&#xFF0C;debug&#xFF0C;info&#xFF0C;warn&#xFF0C;err&#xFF1B;consul monitor&#x76D1;&#x63A7;<br>-log-rotate-bytes&#xFF1A;&#x65B0;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x751F;&#x6210;&#x5927;&#x5C0F;&#x9608;&#x503C;&#x3002;<br>-log-rotate-rotation&#xFF1A;&#x65B0;&#x65E5;&#x5FD7;&#x751F;&#x6210;&#x65F6;&#x95F4;&#x9608;&#x503C;<br>-join&#xFF1A;&#x9700;&#x8981;&#x52A0;&#x5165;&#x7684;&#x5176;&#x5B83;&#x8282;&#x70B9;&#x5730;&#x5740;&#xFF0C;&#x53EF;&#x4EE5;&#x591A;&#x6B21;&#x4F7F;&#x7528;&#xFF0C;&#x52A0;&#x5165;&#x591A;&#x4E2A;&#x8282;&#x70B9;&#x3002;<br>-retry-join&#xFF1A;&#x4F1A;&#x8FDB;&#x884C;&#x52A0;&#x5165;&#x91CD;&#x8BD5;&#xFF0C;&#x9002;&#x7528;&#x4E8E;&#x8BA4;&#x5B9A;&#x52A0;&#x5165;&#x8282;&#x70B9;&#x6700;&#x7EC8;&#x4F1A;&#x6B63;&#x5E38;&#x7684;&#x60C5;&#x51B5;&#x3002;ipv4&#xFF0C;ipv6&#xFF0C;dns<br>-retry-interval&#xFF1A;&#x4E0A;&#x8FF0;&#xFF0C;&#x91CD;&#x8BD5;&#x95F4;&#x9694;&#xFF0C;&#x9ED8;&#x8BA4;30s<br>-retry-max&#xFF1A;&#x91CD;&#x8BD5;&#x6B21;&#x6570;&#xFF0C;&#x9ED8;&#x8BA4;0&#xFF0C;&#x65E0;&#x9650;&#x6B21;&#x91CD;&#x8BD5;<br>-join-wan&#xFF0C; -retry-join-wan&#xFF0C; -retry-interval-wan&#xFF0C; -retry-max-wan<br>-node&#xFF1A;&#x8282;&#x70B9;&#x540D;&#x79F0;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3B;&#x673A;&#x540D;<br>-node-id&#xFF1A;&#x8282;&#x70B9;ID&#xFF0C;<br>-pid-file&#xFF1A;consul &#x5B58;&#x50A8; pid &#x7684;&#x6587;&#x4EF6;&#x4F4D;&#x7F6E;&#xFF0C;&#x7528;&#x4E8E;&#x4E3B;&#x52A8;&#x53D1;&#x4FE1;&#x53F7;&#x3002;&#x5982;&#x505C;&#x6B62;&#x8282;&#x70B9;&#xFF0C;&#x91CD;&#x8F7D;&#x914D;&#x7F6E;&#x7B49;&#x3002;<br>-protocol&#xFF1A;&#x4F7F;&#x7528;&#x7684;&#x534F;&#x8BAE;&#xFF0C;&#x5347;&#x7EA7;&#x65F6;&#x4F7F;&#x7528;&#x3002;consul -v&#x67E5;&#x770B;&#x534F;&#x8BAE;&#x7248;&#x672C;<br>-raft-protocol&#xFF1A;&#x4F7F;&#x7528;raft&#x534F;&#x8BAE;&#x7248;&#x672C;&#xFF0C;&#x9ED8;&#x8BA4;3<br>-raft-snapshot-threshold&#xFF1A;raft&#x6267;&#x884C;&#x5FEB;&#x7167;&#xFF0C;&#x63D0;&#x4EA4;&#x6B21;&#x6570;&#x9608;&#x503C;&#x3002;&#x4E00;&#x822C;&#x4E0D;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#xFF0C;io&#x5BC6;&#x96C6;&#x578B;&#x5E94;&#x7528;&#x53EF;&#x4EE5;&#x8C03;&#x9AD8;&#x3002;&#x907F;&#x514D;&#x6240;&#x6709;&#x7684;&#x8282;&#x70B9;&#x540C;&#x4E00;&#x65F6;&#x95F4;&#x5FEB;&#x7167;&#x3002;&#x6B64;&#x503C;&#x8FC7;&#x5927;&#xFF0C;&#x4F1A;&#x9020;&#x6210;&#x76F8;&#x5E94;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#x53D8;&#x5927;&#xFF0C;&#x8282;&#x70B9;&#x91CD;&#x542F;&#x6062;&#x590D;&#x4F1A;&#x8017;&#x8D39;&#x66F4;&#x957F;&#x65F6;&#x95F4;&#x3002;1.1.0&#x540E;&#xFF0C;&#x9ED8;&#x8BA4;16384&#xFF0C;&#x4E4B;&#x524D;8192.<br>-raft-snapshot-interval&#xFF1A;&#x6267;&#x884C;&#x5FEB;&#x7167;&#x95F4;&#x9694;&#xFF0C;&#x5F71;&#x54CD;&#x7C7B;&#x4F3C;&#x4E0A;&#x4E2A;&#x914D;&#x7F6E;&#xFF0C;1.1.0&#x540E;&#x9ED8;&#x8BA4;30s&#xFF0C;&#x4E4B;&#x524D;5s&#x3002;<br>-rejoin&#xFF1A;&#x8282;&#x70B9;&#x4F1A;&#x5C1D;&#x8BD5;&#x91CD;&#x65B0;&#x52A0;&#x5165;&#x96C6;&#x7FA4;&#x3002;<br>-server&#xFF1A;&#x670D;&#x52A1;&#x7AEF;&#x8282;&#x70B9;&#x6A21;&#x5F0F;&#x3002;<br>-server-port&#xFF1A;&#x670D;&#x52A1;&#x7AEF;RPC&#x7AEF;&#x53E3;&#xFF0C;v1.2.2&#x540E;&#x63D0;&#x4F9B;&#x3002;<br>-non-voting-server&#xFF1A;&#x670D;&#x52A1;&#x8282;&#x70B9;&#x4E0D;&#x53C2;&#x4E0E;&#x9009;&#x4E3E;&#xFF0C;&#x63A5;&#x53D7;&#x65E5;&#x5FD7;&#x590D;&#x5236;&#xFF0C;&#x7528;&#x4E8E;&#x6A2A;&#x5411;&#x6269;&#x5C55;&#xFF0C;&#x670D;&#x52A1;&#x67E5;&#x8BE2;&#x8BF7;&#x6C42;&#x3002;&#xFF08;&#x7C7B;&#x6BD4;zookeeper &#x89C2;&#x5BDF;&#x8005;&#x8282;&#x70B9;&#xFF09;<br>-syslog&#xFF1A;linux OSX&#x7CFB;&#x7EDF;&#xFF0C;&#x914D;&#x7F6E;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#x5230;&#x7CFB;&#x7EDF;&#x65E5;&#x5FD7;&#x3002;<br>-ui&#xFF1A;&#x5185;&#x7F6E;web ui&#x754C;&#x9762;&#x3002;<br>-ui-dir&#xFF1A;web ui &#x8D44;&#x6E90;&#x6587;&#x4EF6;&#x5939;&#xFF0C;&#x4F7F;&#x7528;&#x6B64;&#x914D;&#x7F6E;&#xFF0C;&#x5219;&#x4E0D;&#x9700;&#x4E5F;&#x4E0D;&#x80FD;&#x4F7F;&#x7528;&#x518D;-ui&#x914D;&#x7F6E;&#x3002;  </p>
</blockquote>
<p><strong>&#x9ED8;&#x8BA4;&#x4F7F;&#x7528;&#x7AEF;&#x53E3;&#xFF1A;</strong><br>&#x670D;&#x52A1;&#x7AEF;RPC&#xFF1A;&#x9ED8;&#x8BA4;8300&#xFF0C;TCP&#x3002;<br>Serl LAN&#xFF1A;&#x5904;&#x7406;LAN gossip&#xFF0C;&#x9ED8;&#x8BA4;8301&#xFF0C;TCP UDP&#x3002;<br>Serl WAN&#xFF1A;&#x5904;&#x7406;LAN gossip&#xFF0C;&#x9ED8;&#x8BA4;8302&#xFF0C;TCP UDP&#x3002;<br>HTTP API&#xFF1A;8500&#xFF0C;TCP.<br>DNS&#xFF1A;8600&#xFF0C;TCP,UDP.  </p>
<p><strong>&#x53EF;&#x91CD;&#x8F7D;&#x914D;&#x7F6E;&#xFF1A;</strong><br>Log level<br>Checks<br>Services<br>Watches<br>HTTP Client Address<br>Node Metadata<br>Metric Prefix Filter<br>Discard Check Output<br>RPC rate limiting  </p>
<h2 id="&#x53C2;&#x8003;"><a href="#&#x53C2;&#x8003;" class="headerlink" title="&#x53C2;&#x8003;"></a>&#x53C2;&#x8003;</h2><p>Prometheus&#x624B;&#x518C;(&#x4E0E;Consul&#x96C6;&#x6210;&#xFF09;&#xFF1A;<a href="https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/sd/service-discovery-with-consul" target="_blank" rel="noopener">https://yunlzheng.gitbook.io/prometheus-book/part-ii-prometheus-jin-jie/sd/service-discovery-with-consul</a></p>
<p>Consul&#x547D;&#x4EE4;&#x884C;&#x6700;&#x5168;&#x6587;&#x6863;&#xFF1A;<a href="https://juejin.cn/post/6844903862034235399" target="_blank" rel="noopener">https://juejin.cn/post/6844903862034235399</a></p>
<p>Consul&#x542F;&#x52A8;&#x547D;&#x4EE4;&#xFF1A;<a href="https://www.cnblogs.com/niejunlei/p/5982911.html" target="_blank" rel="noopener">https://www.cnblogs.com/niejunlei/p/5982911.html</a></p>
<p>Nginx&#x865A;&#x62DF;&#x4E3B;&#x673A;&#x6D41;&#x91CF;&#x72B6;&#x6001;&#x6A21;&#x5757;&#xFF08;nginx-module-vts&#xFF09;&#x4F7F;&#x7528;&#x8BF4;&#x660E;&#x6587;&#x6863;&#xFF1A;<a href="http://tobrainto.com/%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84/nginx-module-vts-all/" target="_blank" rel="noopener">http://tobrainto.com/%E7%BD%91%E7%AB%99%E6%9E%B6%E6%9E%84/nginx-module-vts-all/</a></p>
<p>Prometheus&#x76D1;&#x63A7;Nginx <a href="https://www.modb.pro/db/28470" target="_blank" rel="noopener">https://www.modb.pro/db/28470</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
</div>


    <div class="post-guide">
        <div class="item left">
            
        </div>
        <div class="item right">
            
              <a href="/posts/2d95f1c1/">
                ElasticSearch环境搭建
                <i class="fa fa-angle-right" aria-hidden="true"></i>
              </a>
            
        </div>
    </div>




<script>
	
	
</script>
	</div>
	<div id="footer">
	<p>
	©2019-<span id="footerYear"></span> 
	<a href="/">Echo</a> 
	
	
	<br>
	Theme <a href="//github.com/wujun234/hexo-theme-tree" target="_blank">Tree</a>
	by <a href="//github.com/wujun234" target="_blank">WuJun</a>
	Powered by <a href="//hexo.io" target="_blank">Hexo</a>
	</p>
</div>
<script type="text/javascript"> 
	document.getElementById('footerYear').innerHTML = new Date().getFullYear() + '';
</script>
	<button id="totop-toggle" class="toggle"><i class="fa fa-angle-double-up" aria-hidden="true"></i></button>
</body>
</html>