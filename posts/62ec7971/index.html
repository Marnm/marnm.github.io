<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta http-equiv="Content-Language" content="zh-cn">
    <meta charset="utf-8">
    
    
    
    <title>Atlas实现MySQL读写分离 | Deops&#39;s blog | 运维开发工程师</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    
    <meta name="theme-color" content="#77AAFF">
    
    
    <meta name="keywords" content="">
    
    

    

    <!-- Baidu Push -->
<script>
	(function(){
		var bp = document.createElement('script');
		var curProtocol = window.location.protocol.split(':')[0];
		if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
		}
		else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
		}
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(bp, s);
	})();

	var _hmt = _hmt || [];
</script>



    
    <meta name="description" content="MySQL + Atlas &amp;#x2014; &amp;#x8BFB;&amp;#x5199;&amp;#x5206;&amp;#x79BB;&amp;#x5B9E;&amp;#x6218; &amp;#x6570;&amp;#x636E;&amp;#x5E93;&amp;#x7528;&amp;#x6237;&amp;#x914D;&amp;#x7F6E; &amp;#x4E3B;&amp;#x4ECE;&amp;#x6570;&amp;#x636E;&amp;#x5E93;&amp;#x914D;&amp;#x7F6E; Atlas&amp;#x914D;&amp;">
<meta name="keywords" content="Echo">
<meta property="og:type" content="article">
<meta property="og:title" content="Atlas实现MySQL读写分离">
<meta property="og:url" content="https://marnm.github.io/posts/62ec7971/index.html">
<meta property="og:site_name" content="Deops&#39;s blog">
<meta property="og:description" content="MySQL + Atlas &amp;#x2014; &amp;#x8BFB;&amp;#x5199;&amp;#x5206;&amp;#x79BB;&amp;#x5B9E;&amp;#x6218; &amp;#x6570;&amp;#x636E;&amp;#x5E93;&amp;#x7528;&amp;#x6237;&amp;#x914D;&amp;#x7F6E; &amp;#x4E3B;&amp;#x4ECE;&amp;#x6570;&amp;#x636E;&amp;#x5E93;&amp;#x914D;&amp;#x7F6E; Atlas&amp;#x914D;&amp;">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2022-06-07T05:11:47.471Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Atlas实现MySQL读写分离">
<meta name="twitter:description" content="MySQL + Atlas &amp;#x2014; &amp;#x8BFB;&amp;#x5199;&amp;#x5206;&amp;#x79BB;&amp;#x5B9E;&amp;#x6218; &amp;#x6570;&amp;#x636E;&amp;#x5E93;&amp;#x7528;&amp;#x6237;&amp;#x914D;&amp;#x7F6E; &amp;#x4E3B;&amp;#x4ECE;&amp;#x6570;&amp;#x636E;&amp;#x5E93;&amp;#x914D;&amp;#x7F6E; Atlas&amp;#x914D;&amp;">
    
        <link rel="alternate" type="application/atom+xml" title="Deops&#39;s blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link id="style" rel="stylesheet" href="/css/style.css?v=3.0">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    
            
</head>

<body>
    <div id="loading" class="active"></div>
    <aside id="menu" class="hide">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.gif" alt="avatar">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname" id="name">Echo</h5>
          
            <div id="yiyanmotto" class="motto">&nbsp;</div>
          
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
              <li class="waves-block waves-effect">
                  <a href="/">
                    <i class="icon icon-lg icon-home"></i>
                    <span>主 页</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/archives">
                    <i class="icon icon-lg icon-archives"></i>
                    <span>归 档</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/categories">
                    <i class="icon icon-lg icon-th-list"></i>
                    <span>分 类</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/tags">
                    <i class="icon icon-lg icon-tags"></i>
                    <span>标 签</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/about">
                    <i class="icon icon-lg icon-smile-o"></i>
                    <span>关 于</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
      <div class="nav2">
          
              <a class="nav2item" data-title="Email" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=442KgIbNhZajhYybjoKKj82AjI4" target="_parent" title="Email">
                <i class="icon icon-lg icon-envelope-o envelope-o"></i>
              </a>
          
              <a class="nav2item" data-title="Github" href="https://github.com/Marnm" target="_blank" title="Github">
                <i class="icon icon-lg icon-github github"></i>
              </a>
          
              <a class="nav2item" data-title="我的哔哩哔哩" href="https://space.bilibili.com/31374976" target="_blank" title="我的哔哩哔哩">
                <i class="icon icon-lg icon-tv tv"></i>
              </a>
          

            </div>
        
      </ul>
        
    </div>
  </div>
 
</aside>


    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Atlas实现MySQL读写分离</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        <a href="../../atom.xml" target="_blank" class="header-icon waves-effect waves-circle waves-light" id="Rss">
            <i class="icon icon-lg icon-rss"></i>
        </a>
    </div>
</header>
<header class="content-header post-header">
    
    
    <div class="container fade-scale">
        <div id="myheader">
            <h1 class="title">
                
            </h1>
            <h5 class="subtitle">
                
                
            </h5>
        </div>
    </div>

</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MySQL-Atlas-—-读写分离实战"><span class="post-toc-number">1.</span> <span class="post-toc-text">MySQL + Atlas — 读写分离实战</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MySQL-Master"><span class="post-toc-number">2.</span> <span class="post-toc-text">MySQL Master</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#MySQL-Slave"><span class="post-toc-number">3.</span> <span class="post-toc-text">MySQL Slave</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#测试主从同步"><span class="post-toc-number">4.</span> <span class="post-toc-text">测试主从同步</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#Atlas配置"><span class="post-toc-number">5.</span> <span class="post-toc-text">Atlas配置</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#读写分离测试"><span class="post-toc-number">6.</span> <span class="post-toc-text">读写分离测试</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#故障解决"><span class="post-toc-number">7.</span> <span class="post-toc-text">故障解决</span></a></li></ol>
        </nav>
    </aside>
   
<article id="post-Atlas实现MySQL读写分离" class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">Atlas实现MySQL读写分离</h1>
        <div class="post-meta">
            <i class="icon icon-lg icon-calendar-o"></i>
            发表于
            <time class="post-time" title="2022-06-07 12:45:45" datetime="2022-06-07T04:45:45.000Z" itemprop="datePublished">2022-06-07</time>

            <br id="mybreak">
            
<script>
	mybreak.style="display:none";
</script>


            <i>·</i>
            

        </div>
        <div class="post-count-custom">
            <i class="icon icon-lg icon-comment-o"></i>
            阅读本文可能花费您&nbsp;<span class="post-count">33</span>&nbsp;分钟
        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h2 id="MySQL-Atlas-&#x2014;-&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x5B9E;&#x6218;"><a href="#MySQL-Atlas-&#x2014;-&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x5B9E;&#x6218;" class="headerlink" title="MySQL + Atlas &#x2014; &#x8BFB;&#x5199;&#x5206;&#x79BB;&#x5B9E;&#x6218;"></a>MySQL + Atlas &#x2014; &#x8BFB;&#x5199;&#x5206;&#x79BB;&#x5B9E;&#x6218;</h2><ol>
<li>&#x6570;&#x636E;&#x5E93;&#x7528;&#x6237;&#x914D;&#x7F6E;</li>
<li>&#x4E3B;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x914D;&#x7F6E;</li>
<li>Atlas&#x914D;&#x7F6E;</li>
<li>&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;</li>
</ol>
<p><strong>&#x5E8F;&#x7AE0;</strong><br>Atlas&#x662F;360&#x56E2;&#x961F;&#x5F04;&#x51FA;&#x6765;&#x7684;&#x4E00;&#x5957;&#x57FA;&#x4E8E;MySQL-Proxy&#x57FA;&#x7840;&#x4E4B;&#x4E0A;&#x7684;&#x4EE3;&#x7406;&#xFF0C;&#x4FEE;&#x6539;&#x4E86;MySQL-Proxy&#x7684;&#x4E00;&#x4E9B;BUG&#xFF0C;&#x5E76;&#x4E14;&#x4F18;&#x5316;&#x4E86;&#x5F88;&#x591A;&#x4E1C;&#x897F;&#x3002;&#x800C;&#x4E14;&#x5B89;&#x88C5;&#x65B9;&#x4FBF;&#x3002;&#x914D;&#x7F6E;&#x7684;&#x6CE8;&#x91CA;&#x5F88;&#x8BE6;&#x7EC6;&#xFF0C;&#x90FD;&#x662F;&#x4E2D;&#x6587;&#x3002;&#x82F1;&#x6587;&#x4E0D;&#x597D;&#x7684;&#x540C;&#x5B66;&#x6709;&#x798F;&#x4E86;&#x3002;<br>Atlas&#x5B98;&#x65B9;&#x94FE;&#x63A5;&#xFF1A; <a href="https://github.com/Qihoo360/Atlas/blob/master/README_ZH.md" target="_blank" rel="noopener">https://github.com/Qihoo360/Atlas/blob/master/README_ZH.md</a><br>Atlas&#x4E0B;&#x8F7D;&#x94FE;&#x63A5;&#xFF1A; <a href="https://github.com/Qihoo360/Atlas/releases" target="_blank" rel="noopener">https://github.com/Qihoo360/Atlas/releases</a>  </p>
<p>&#x73AF;&#x5883;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x7CFB;&#x7EDF;</th>
<th>IP</th>
<th>&#x89D2;&#x8272;</th>
</tr>
</thead>
<tbody>
<tr>
<td>CentOS7.4</td>
<td>192.168.73.20</td>
<td>Atlas&#x4EE3;&#x7406;&#x670D;&#x52A1;</td>
</tr>
<tr>
<td>RHEL 7.3</td>
<td>192.168.73.21</td>
<td>MySQL_Master</td>
</tr>
<tr>
<td>RHEL 7.3</td>
<td>192.168.73.22</td>
<td>MySQL_Slave</td>
</tr>
</tbody>
</table>
<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong>&#x4E09;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x90FD;&#x8981;&#x5B89;&#x88C5;MySQL&#x6570;&#x636E;&#xFF01;</p>
<h2 id="MySQL-Master"><a href="#MySQL-Master" class="headerlink" title="MySQL Master"></a>MySQL Master</h2><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">datadir</span>=/var/lib/mysql</span><br><span class="line"><span class="attr">socket</span>=/var/lib/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line"><span class="attr">symbolic-links</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-error</span>=/var/log/mysqld.log</span><br><span class="line"><span class="attr">pid-file</span>=/var/run/mysqld/mysqld.pid</span><br><span class="line"></span><br><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">user</span>=mysql</span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">sync_binlog</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">log-bin</span>=mysql-bin</span><br><span class="line"><span class="attr">server-id</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">binlog-do-db</span>=testdb</span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line">skip-name-resolve</span><br><span class="line"></span><br><span class="line"><span class="attr">general_log</span>=<span class="literal">ON</span></span><br><span class="line"><span class="attr">general_log_file</span>= /var/lib/mysql/rhel_sqlsrv.log</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> testdb <span class="keyword">DEFAULT</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"></span><br><span class="line">mysql&gt; grant replication slave on *.* to root@&apos;%&apos; identified by &apos;ccc.456&apos;;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select user,host from mysql.user;</span><br><span class="line">+<span class="comment">---------------+--------------+</span></span><br><span class="line">| user          | host         |</span><br><span class="line">+<span class="comment">---------------+--------------+</span></span><br><span class="line">| root          | %            |</span><br><span class="line">| slave         | 192.168.73.% |</span><br><span class="line">| mysql.session | localhost    |</span><br><span class="line">| mysql.sys     | localhost    |</span><br><span class="line">| root          | localhost    |</span><br><span class="line">+<span class="comment">---------------+--------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">master</span> <span class="keyword">status</span>;</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| mysql-bin.000003 |     1605 | testdb       | mysql            |                   |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; mysqldump -uroot -p -B testdb &gt; testdb.sql</span><br><span class="line">Enter password:</span><br><span class="line">[root@rhel7 ~]&amp; ls</span><br><span class="line">anaconda-ks.cfg  ha.sql  mysql_master_ha  rpm_mysql5.7  testdb.sql</span><br><span class="line">[root@rhel7 ~]&amp; scp testdb.sql root@192.168.73.22:~</span><br><span class="line">testdb.sql                                                 100% 2126     2.1KB/s   00:00</span><br><span class="line">[root@rhel7 ~]&amp;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="MySQL-Slave"><a href="#MySQL-Slave" class="headerlink" title="MySQL Slave"></a>MySQL Slave</h2><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">datadir</span>=/var/lib/mysql</span><br><span class="line"><span class="attr">socket</span>=/var/lib/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line"><span class="attr">symbolic-links</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-error</span>=/var/log/mysqld.log</span><br><span class="line"><span class="attr">pid-file</span>=/var/run/mysqld/mysqld.pid</span><br><span class="line"></span><br><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-bin</span>=mysql-slave2</span><br><span class="line"><span class="attr">server-id</span>=<span class="number">3</span></span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line"><span class="attr">log_slave_updates</span>=<span class="number">1</span></span><br><span class="line">skip-name-resolve</span><br><span class="line"><span class="attr">general_log</span>=<span class="literal">ON</span></span><br><span class="line"><span class="attr">general_log_file</span>=/var/lib/mysql/rhel_sqlsrv.log</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; change master to master_host=&apos;192.168.73.21&apos;, master_user=&apos;root&apos;,master_password=&apos;ccc.456&apos;,master_port=3306,master_log_file=&apos;mysql-bin.000003&apos;,master_log_pos=1605,master_connect_retry=10;</span><br><span class="line">Query OK, 0 rows affected, 2 warnings (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; start slave;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 192.168.73.21</span><br><span class="line">                  Master_User: root</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 10</span><br><span class="line">              Master_Log_File: mysql-bin.000003</span><br><span class="line">          Read_Master_Log_Pos: 1605</span><br><span class="line">               Relay_Log_File: rhel_sqlsrv-relay-bin.000002</span><br><span class="line">                Relay_Log_Pos: 320</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000003</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB:</span><br><span class="line">.........................................&#x7701;&#x7565;...................................................................</span><br><span class="line">             Master_Server_Id: 1</span><br><span class="line">                  Master_UUID: 8f5a42da-cd2d-11ec-8c02-000c29f9275c</span><br><span class="line">             Master_Info_File: /var/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind:</span><br><span class="line">.........................................&#x7701;&#x7565;...................................................................</span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel_sqlsrv ~]&amp; mysql -uroot -p &lt; testdb.sql</span><br><span class="line">Enter password:</span><br><span class="line">[root@rhel_sqlsrv ~]&amp;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;"><a href="#&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;"></a>&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;</h2><p><strong>Master</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Database changed</span><br><span class="line">mysql&gt; insert into book values(&apos;abc&apos;,123,456);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>Slave</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">| Linux                   |    66 |   666 |</span><br><span class="line">| Unix                    |    77 |   777 |</span><br><span class="line">| abc                     |   123 |   456 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="Atlas&#x914D;&#x7F6E;"><a href="#Atlas&#x914D;&#x7F6E;" class="headerlink" title="Atlas&#x914D;&#x7F6E;"></a>Atlas&#x914D;&#x7F6E;</h2><p><strong>&#x5B89;&#x88C5;Atlas</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; rpm -ivh Atlas-2.2.1.el6.x86_64.rpm</span><br><span class="line">Preparing...                          ################################# [100%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:Atlas-2.2.1-1                    ################################# [100%]</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; ll /usr/local/mysql-proxy/ -R</span><br><span class="line">/usr/local/mysql-proxy/:</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root root   75 May  7 04:33 bin</span><br><span class="line">drwxr-xr-x. 2 root root   22 May  7 04:33 conf</span><br><span class="line">drwxr-xr-x. 3 root root 4096 May  7 04:33 lib</span><br><span class="line">drwxr-xr-x. 2 root root    6 Dec 17  2014 log</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/bin:</span><br><span class="line">total 44</span><br><span class="line">-rwxr-xr-x. 1 root root  9696 Dec 17  2014 encrypt</span><br><span class="line">-rwxr-xr-x. 1 root root 23564 Dec 17  2014 mysql-proxy</span><br><span class="line">-rwxr-xr-x. 1 root root  1552 Dec 17  2014 mysql-proxyd</span><br><span class="line">-rw-r--r--. 1 root root     6 Dec 17  2014 VERSION</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/conf:</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r--. 1 root root 2810 Dec 17  2014 test.cnf</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/lib:</span><br><span class="line">total 9812</span><br><span class="line">-rwxr-xr-x. 1 root root  968655 Dec 17  2014 libevent-2.0.so.5</span><br><span class="line">-rwxr-xr-x. 1 root root 3464668 Dec 17  2014 libglib-2.0.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root   35483 Dec 17  2014 libgmodule-2.0.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root    8656 Dec 17  2014 libgthread-2.0.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root 5021619 Dec 17  2014 libjemalloc.so.1</span><br><span class="line">-rwxr-xr-x. 1 root root  172984 Dec 17  2014 liblua-5.1.so</span><br><span class="line">-rwxr-xr-x. 1 root root   14735 Dec 17  2014 libmysql-chassis-glibext.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root   73823 Dec 17  2014 libmysql-chassis.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root   14446 Dec 17  2014 libmysql-chassis-timing.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root  180107 Dec 17  2014 libmysql-proxy.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root   71566 Dec 17  2014 libsql-tokenizer.so.0</span><br><span class="line">drwxr-xr-x. 4 root root      32 May  7 04:33 mysql-proxy</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/lib/mysql-proxy:</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x. 3 root root 162 May  7 04:33 lua</span><br><span class="line">drwxr-xr-x. 2 root root  44 May  7 04:33 plugins</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/lib/mysql-proxy/lua:</span><br><span class="line">total 240</span><br><span class="line">-rw-r--r--. 1 root root   9387 Dec 17  2014 admin.lua</span><br><span class="line">-rwxr-xr-x. 1 root root  15966 Dec 17  2014 chassis.so</span><br><span class="line">-rwxr-xr-x. 1 root root   8988 Dec 17  2014 crc32.so</span><br><span class="line">-rwxr-xr-x. 1 root root   9416 Dec 17  2014 glib2.so</span><br><span class="line">-rwxr-xr-x. 1 root root  18323 Dec 17  2014 lfs.so</span><br><span class="line">-rwxr-xr-x. 1 root root  43879 Dec 17  2014 lpeg.so</span><br><span class="line">-rwxr-xr-x. 1 root root 102944 Dec 17  2014 mysql.so</span><br><span class="line">-rwxr-xr-x. 1 root root   9248 Dec 17  2014 posix.so</span><br><span class="line">drwxr-xr-x. 2 root root    243 May  7 04:33 proxy</span><br><span class="line">-rwxr-xr-x. 1 root root   6626 Dec 17  2014 time.so</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/lib/mysql-proxy/lua/proxy:</span><br><span class="line">total 80</span><br><span class="line">-rw-r--r--. 1 root root   536 Dec 17  2014 auth.lua</span><br><span class="line">-rw-r--r--. 1 root root  6670 Dec 17  2014 auto-config.lua</span><br><span class="line">-rw-r--r--. 1 root root  2807 Dec 17  2014 balance.lua</span><br><span class="line">-rw-r--r--. 1 root root  2873 Dec 17  2014 charset.lua</span><br><span class="line">-rw-r--r--. 1 root root  3477 Dec 17  2014 commands.lua</span><br><span class="line">-rw-r--r--. 1 root root   238 Dec 17  2014 crc32.lua</span><br><span class="line">-rw-r--r--. 1 root root  1906 Dec 17  2014 filter.lua</span><br><span class="line">-rw-r--r--. 1 root root  2706 Dec 17  2014 log.lua</span><br><span class="line">-rw-r--r--. 1 root root  6105 Dec 17  2014 parser.lua</span><br><span class="line">-rw-r--r--. 1 root root 14816 Dec 17  2014 split.lua</span><br><span class="line">-rw-r--r--. 1 root root  6366 Dec 17  2014 test.lua</span><br><span class="line">-rw-r--r--. 1 root root   106 Dec 17  2014 ticker.lua</span><br><span class="line">-rw-r--r--. 1 root root  6215 Dec 17  2014 tokenizer.lua</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#&#x65E5;&#x5FD7;&#x7EA7;&#x522B;&#xFF0C;&#x5206;&#x4E3A;message&#x3001;warning&#x3001;critical&#x3001;error&#x3001;debug&#x4E94;&#x4E2A;&#x7EA7;&#x522B;</span><br><span class="line">/usr/local/mysql-proxy/lib/mysql-proxy/plugins:</span><br><span class="line">total 4920</span><br><span class="line">-rwxr-xr-x. 1 root root   21134 Dec 17  2014 libadmin.so</span><br><span class="line">-rwxr-xr-x. 1 root root 5011799 Dec 17  2014 libproxy.so</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/log:</span><br><span class="line">total 0</span><br></pre></td></tr></tbody></table></figure>
<p><strong>bin&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7684;&#x90FD;&#x662F;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;</strong></p>
<ol>
<li>&#x201C;encrypt&#x201D;&#x662F;&#x7528;&#x6765;&#x5BF9;MySQL&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;&#x7684;&#xFF0C;&#x5728;&#x914D;&#x7F6E;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x7528;&#x5230;</li>
<li>&#x201C;mysql-proxy&#x201D;&#x662F;MySQL&#x81EA;&#x5DF1;&#x7684;&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x4EE3;&#x7406;</li>
<li>&#x201C;mysql-proxyd&#x201D;&#x662F;360&#x5F04;&#x51FA;&#x6765;&#x7684;&#xFF0C;&#x540E;&#x9762;&#x6709;&#x4E2A;&#x201C;d&#x201D;&#xFF0C;&#x670D;&#x52A1;&#x7684;&#x542F;&#x52A8;&#x3001;&#x91CD;&#x542F;&#x3001;&#x505C;&#x6B62;&#xFF0C;&#x90FD;&#x662F;&#x7528;&#x4ED6;&#x6765;&#x6267;&#x884C;&#x7684;</li>
</ol>
<p><strong>conf&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7684;&#x662F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</strong></p>
<ol>
<li>&#x201C;test.cnf&#x201D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x7528;&#x6765;&#x914D;&#x7F6E;&#x4EE3;&#x7406;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;vim&#x6765;&#x7F16;&#x8F91;</li>
<li>lib&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7684;&#x662F;&#x4E00;&#x4E9B;&#x5305;&#xFF0C;&#x4EE5;&#x53CA;Atlas&#x7684;&#x4F9D;&#x8D56;</li>
<li>log&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7684;&#x662F;&#x65E5;&#x5FD7;&#xFF0C;&#x5982;&#x62A5;&#x9519;&#x7B49;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x7684;&#x8BB0;&#x5F55;</li>
</ol>
<p>&#x8FDB;&#x5165;bin&#x76EE;&#x5F55;&#xFF0C;&#x4F7F;&#x7528;encrypt&#x6765;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;&#xFF0C;&#x6211;&#x7684;MySQL&#x6570;&#x636E;&#x7684;&#x7528;&#x6237;&#x540D;&#x662F;root&#xFF0C;&#x5BC6;&#x7801;&#x662F;123456&#xFF0C;&#x6211;&#x9700;&#x8981;&#x5BF9;&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; cd /usr/local/mysql-proxy/</span><br><span class="line">[root@ctos7mini mysql-proxy]&amp; ./bin/encrypt 123456</span><br><span class="line">/iZxz+0GRoA=</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x914D;&#x7F6E;Atlas&#xFF0C;&#x4F7F;&#x7528;vim&#x8FDB;&#x884C;&#x7F16;&#x8F91;</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; cat /usr/local/mysql-proxy/conf/test.cnf</span><br><span class="line">[mysql-proxy]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5E26;#&#x53F7;&#x7684;&#x4E3A;&#x975E;&#x5FC5;&#x9700;&#x7684;&#x914D;&#x7F6E;&#x9879;&#x76EE;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x7BA1;&#x7406;&#x63A5;&#x53E3;&#x7684;&#x7528;&#x6237;&#x540D;</span><br><span class="line">admin-username = root</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x7BA1;&#x7406;&#x63A5;&#x53E3;&#x7684;&#x5BC6;&#x7801;</span><br><span class="line">admin-password = pwd</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x540E;&#x7AEF;&#x8FDE;&#x63A5;&#x7684;MySQL&#x4E3B;&#x5E93;&#x7684;IP&#x548C;&#x7AEF;&#x53E3;&#xFF0C;&#x53EF;&#x8BBE;&#x7F6E;&#x591A;&#x9879;&#xFF0C;&#x7528;&#x9017;&#x53F7;&#x5206;&#x9694;</span><br><span class="line">proxy-backend-addresses = 192.168.73.21:3306</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x540E;&#x7AEF;&#x8FDE;&#x63A5;&#x7684;MySQL&#x4ECE;&#x5E93;&#x7684;IP&#x548C;&#x7AEF;&#x53E3;&#xFF0C;@&#x540E;&#x9762;&#x7684;&#x6570;&#x5B57;&#x4EE3;&#x8868;&#x6743;&#x91CD;&#xFF0C;&#x7528;&#x6765;&#x4F5C;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#xFF0C;&#x82E5;&#x7701;&#x7565;&#x5219;&#x9ED8;&#x8BA4;&#x4E3A;1&#xFF0C;&#x53EF;&#x8BBE;&#x7F6E;&#x591A;&#x9879;&#xFF0C;&#x7528;&#x9017;&#x53F7;&#x5206;&#x9694;</span><br><span class="line">proxy-read-only-backend-addresses = 192.168.73.22:3306@1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x7528;&#x6237;&#x540D;&#x4E0E;&#x5176;&#x5BF9;&#x5E94;&#x7684;&#x52A0;&#x5BC6;&#x8FC7;&#x7684;MySQL&#x5BC6;&#x7801;&#xFF0C;&#x5BC6;&#x7801;&#x4F7F;&#x7528;PREFIX/bin&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x52A0;&#x5BC6;&#x7A0B;&#x5E8F;encrypt&#x52A0;&#x5BC6;&#xFF0C;&#x4E0B;&#x884C;&#x7684;user1&#x548C;user2&#x4E3A;&#x793A;&#x4F8B;&#xFF0C;&#x5C06;&#x5176;&#x66FF;&#x6362;&#x4E3A;&#x4F60;&#x7684;MySQL&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x52A0;&#x5BC6;&#x5BC6;&#x7801;&#xFF01;</span><br><span class="line">pwds = root:/iZxz+0GRoA=</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x8BBE;&#x7F6E;Atlas&#x7684;&#x8FD0;&#x884C;&#x65B9;&#x5F0F;&#xFF0C;&#x8BBE;&#x4E3A;true&#x65F6;&#x4E3A;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x65B9;&#x5F0F;&#xFF0C;&#x8BBE;&#x4E3A;false&#x65F6;&#x4E3A;&#x524D;&#x53F0;&#x65B9;&#x5F0F;&#xFF0C;&#x4E00;&#x822C;&#x5F00;&#x53D1;&#x8C03;&#x8BD5;&#x65F6;&#x8BBE;&#x4E3A;false&#xFF0C;&#x7EBF;&#x4E0A;&#x8FD0;&#x884C;&#x65F6;&#x8BBE;&#x4E3A;true,true&#x540E;&#x9762;&#x4E0D;&#x80FD;&#x6709;&#x7A7A;&#x683C;&#x3002;</span><br><span class="line">daemon = true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x8BBE;&#x7F6E;Atlas&#x7684;&#x8FD0;&#x884C;&#x65B9;&#x5F0F;&#xFF0C;&#x8BBE;&#x4E3A;true&#x65F6;Atlas&#x4F1A;&#x542F;&#x52A8;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E00;&#x4E2A;&#x4E3A;monitor&#xFF0C;&#x4E00;&#x4E2A;&#x4E3A;worker&#xFF0C;monitor&#x5728;worker&#x610F;&#x5916;&#x9000;&#x51FA;&#x540E;&#x4F1A;&#x81EA;&#x52A8;&#x5C06;&#x5176;&#x91CD;&#x542F;&#xFF0C;&#x8BBE;&#x4E3A;false&#x65F6;&#x53EA;&#x6709;worker&#xFF0C;&#x6CA1;&#x6709;monitor&#xFF0C;&#x4E00;&#x822C;&#x5F00;&#x53D1;&#x8C03;&#x8BD5;&#x65F6;&#x8BBE;&#x4E3A;false&#xFF0C;&#x7EBF;&#x4E0A;&#x8FD0;&#x884C;&#x65F6;&#x8BBE;&#x4E3A;true,true&#x540E;&#x9762;&#x4E0D;&#x80FD;&#x6709;&#x7A7A;&#x683C;&#x3002;</span><br><span class="line">keepalive = true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x6570;&#xFF0C;&#x5BF9;Atlas&#x7684;&#x6027;&#x80FD;&#x6709;&#x5F88;&#x5927;&#x5F71;&#x54CD;&#xFF0C;&#x53EF;&#x6839;&#x636E;&#x60C5;&#x51B5;&#x9002;&#x5F53;&#x8BBE;&#x7F6E;</span><br><span class="line">event-threads = 8</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x65E5;&#x5FD7;&#x7EA7;&#x522B;&#xFF0C;&#x5206;&#x4E3A;message&#x3001;warning&#x3001;critical&#x3001;error&#x3001;debug&#x4E94;&#x4E2A;&#x7EA7;&#x522B;</span><br><span class="line">log-level = message</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x65E5;&#x5FD7;&#x5B58;&#x653E;&#x7684;&#x8DEF;&#x5F84;</span><br><span class="line">log-path = /usr/local/mysql-proxy/log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>SQL&#x65E5;&#x5FD7;&#x7684;&#x5F00;&#x5173;&#xFF0C;&#x53EF;&#x8BBE;&#x7F6E;&#x4E3A;OFF&#x3001;ON&#x3001;REALTIME&#xFF0C;OFF&#x4EE3;&#x8868;&#x4E0D;&#x8BB0;&#x5F55;SQL&#x65E5;&#x5FD7;&#xFF0C;ON&#x4EE3;&#x8868;&#x8BB0;&#x5F55;SQL&#x65E5;&#x5FD7;&#xFF0C;REALTIME &#x4EE3;&#x8868;&#x8BB0;&#x5F55;SQL&#x65E5;&#x5FD7;&#x4E14;&#x5B9E;&#x65F6;&#x5199;&#x5165;&#x78C1;&#x76D8;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;OFF</span><br><span class="line"><span class="meta">#</span>sql-log = OFF</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x6162;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#x8BBE;&#x7F6E;&#x3002;&#x5F53;&#x8BBE;&#x7F6E;&#x4E86;&#x8BE5;&#x53C2;&#x6570;&#x65F6;&#xFF0C;&#x5219;&#x65E5;&#x5FD7;&#x53EA;&#x8F93;&#x51FA;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x8D85;&#x8FC7;sql-log-slow&#xFF08;&#x5355;&#x4F4D;&#xFF1A;ms)&#x7684;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55; &#x3002;&#x4E0D;&#x8BBE;&#x7F6E;&#x8BE5;&#x53C2;&#x6570;&#x5219;&#x8F93;&#x51FA;&#x5168;&#x90E8;&#x65E5;&#x5FD7;&#x3002;</span><br><span class="line"><span class="meta">#</span>sql-log-slow = 10</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5B9E;&#x4F8B;&#x540D;&#x79F0;&#xFF0C;&#x7528;&#x4E8E;&#x540C;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x4E0A;&#x591A;&#x4E2A;Atlas&#x5B9E;&#x4F8B;&#x95F4;&#x7684;&#x533A;&#x5206;</span><br><span class="line"><span class="meta">#</span>instance = test</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x76D1;&#x542C;&#x7684;&#x5DE5;&#x4F5C;&#x63A5;&#x53E3;IP&#x548C;&#x7AEF;&#x53E3;</span><br><span class="line">proxy-address = 0.0.0.0:1234</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x76D1;&#x542C;&#x7684;&#x7BA1;&#x7406;&#x63A5;&#x53E3;IP&#x548C;&#x7AEF;&#x53E3;</span><br><span class="line">admin-address = 0.0.0.0:2345</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5206;&#x8868;&#x8BBE;&#x7F6E;&#xFF0C;&#x6B64;&#x4F8B;&#x4E2D;person&#x4E3A;&#x5E93;&#x540D;&#xFF0C;mt&#x4E3A;&#x8868;&#x540D;&#xFF0C;id&#x4E3A;&#x5206;&#x8868;&#x5B57;&#x6BB5;&#xFF0C;3&#x4E3A;&#x5B50;&#x8868;&#x6570;&#x91CF;&#xFF0C;&#x53EF;&#x8BBE;&#x7F6E;&#x591A;&#x9879;&#xFF0C;&#x4EE5;&#x9017;&#x53F7;&#x5206;&#x9694;&#xFF0C; &#x82E5;&#x4E0D;&#x5206;&#x8868;&#x5219;&#x4E0D;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x8BE5;&#x9879;</span><br><span class="line"><span class="meta">#</span>tables = person.mt.id.3</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x9ED8;&#x8BA4;&#x5B57;&#x7B26;&#x96C6;&#xFF0C;&#x8BBE;&#x7F6E;&#x8BE5;&#x9879;&#x540E;&#x5BA2;&#x6237;&#x7AEF;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x6267;&#x884C;SET NAMES&#x8BED;&#x53E5;</span><br><span class="line"><span class="meta">#</span>charset = utf8</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5141;&#x8BB8;&#x8FDE;&#x63A5;Atlas&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x7684;IP&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x7CBE;&#x786E;IP&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;IP&#x6BB5;&#xFF0C;&#x4EE5;&#x9017;&#x53F7;&#x5206;&#x9694;&#xFF0C;&#x82E5;&#x4E0D;&#x8BBE;&#x7F6E;&#x8BE5;&#x9879;&#x5219;&#x5141;&#x8BB8;&#x6240;&#x6709;IP &#x8FDE;&#x63A5;&#xFF0C;&#x5426;&#x5219;&#x53EA;&#x5141;&#x8BB8;&#x5217;&#x8868;&#x4E2D;&#x7684;IP&#x8FDE;&#x63A5;</span><br><span class="line"><span class="meta">#</span>client-ips = 127.0.0.1, 192.168.1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x524D;&#x9762;&#x6302;&#x63A5;&#x7684;LVS&#x7684;&#x7269;&#x7406;&#x7F51;&#x5361;&#x7684;IP(&#x6CE8;&#x610F;&#x4E0D;&#x662F;&#x865A;IP)&#xFF0C;&#x82E5;&#x6709;LVS&#x4E14;&#x8BBE;&#x7F6E;&#x4E86;client-ips&#x5219;&#x6B64;&#x9879;&#x5FC5;&#x987B;&#x8BBE;&#x7F6E;&#xFF0C;&#x5426; &#x5219;&#x53EF;&#x4EE5;&#x4E0D;&#x8BBE;&#x7F6E;</span><br><span class="line"><span class="meta">#</span>lvs-ips = 192.168.1.1</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x542F;&#x52A8;Atlas</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini bin]&amp; cd /usr/local/mysql-proxy/bin/</span><br><span class="line">[root@ctos7mini bin]&amp; ./mysql-proxyd test status</span><br><span class="line">MySQL-Proxy of test is NOT running</span><br><span class="line">[root@ctos7mini bin]&amp; ./mysql-proxyd test start</span><br><span class="line">OK: MySQL-Proxy of test is started</span><br><span class="line">[root@ctos7mini bin]&amp; ./mysql-proxyd test status</span><br><span class="line">MySQL-Proxy of test is running (13844)</span><br><span class="line">MySQL-Proxy of test is running (13846)</span><br><span class="line">[root@ctos7mini bin]&amp; systemctl stop mysqld</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini bin]&amp; mysql -h127.0.0.1 -uroot -P2345 -uroot -ppwd</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 1</span><br><span class="line">Server version: 5.0.99-agent-admin</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">ERROR 1105 (07000): <span class="keyword">use</span> <span class="string">&apos;SELECT * FROM help&apos;</span> <span class="keyword">to</span> see the supported commands</span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">ERROR 1105 (07000): <span class="keyword">use</span> <span class="string">&apos;SELECT * FROM help&apos;</span> <span class="keyword">to</span> see the supported commands</span><br><span class="line">mysql&gt; <span class="keyword">help</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> information about MySQL products <span class="keyword">and</span> services, visit:</span><br><span class="line">   <span class="keyword">http</span>://www.mysql.com/</span><br><span class="line"><span class="keyword">For</span> developer information, <span class="keyword">including</span> the MySQL <span class="keyword">Reference</span> <span class="keyword">Manual</span>, visit:</span><br><span class="line">   <span class="keyword">http</span>://dev.mysql.com/</span><br><span class="line"><span class="keyword">To</span> buy MySQL <span class="keyword">Enterprise</span> support, training, <span class="keyword">or</span> other products, visit:</span><br><span class="line">   https://shop.mysql.com/</span><br><span class="line"></span><br><span class="line"><span class="keyword">List</span> <span class="keyword">of</span> all MySQL commands:</span><br><span class="line">Note that all <span class="built_in">text</span> commands must be <span class="keyword">first</span> <span class="keyword">on</span> line <span class="keyword">and</span> <span class="keyword">end</span> <span class="keyword">with</span> <span class="string">&apos;;&apos;</span></span><br><span class="line">?         (\?) <span class="keyword">Synonym</span> <span class="keyword">for</span> <span class="string">`help&apos;.</span></span><br><span class="line"><span class="string">clear     (\c) Clear the current input statement.</span></span><br><span class="line"><span class="string">connect   (\r) Reconnect to the server. Optional arguments are db and host.</span></span><br><span class="line"><span class="string">delimiter (\d) Set statement delimiter.</span></span><br><span class="line"><span class="string">edit      (\e) Edit command with $EDITOR.</span></span><br><span class="line"><span class="string">ego       (\G) Send command to mysql server, display result vertically.</span></span><br><span class="line"><span class="string">exit      (\q) Exit mysql. Same as quit.</span></span><br><span class="line"><span class="string">go        (\g) Send command to mysql server.</span></span><br><span class="line"><span class="string">help      (\h) Display this help.</span></span><br><span class="line"><span class="string">nopager   (\n) Disable pager, print to stdout.</span></span><br><span class="line"><span class="string">notee     (\t) Don&apos;t write into outfile.</span></span><br><span class="line"><span class="string">pager     (\P) Set PAGER [to_pager]. Print the query results via PAGER.</span></span><br><span class="line"><span class="string">print     (\p) Print current command.</span></span><br><span class="line"><span class="string">prompt    (\R) Change your mysql prompt.</span></span><br><span class="line"><span class="string">quit      (\q) Quit mysql.</span></span><br><span class="line"><span class="string">rehash    (\#) Rebuild completion hash.</span></span><br><span class="line"><span class="string">source    (\.) Execute an SQL script file. Takes a file name as an argument.</span></span><br><span class="line"><span class="string">status    (\s) Get status information from the server.</span></span><br><span class="line"><span class="string">system    (\!) Execute a system shell command.</span></span><br><span class="line"><span class="string">tee       (\T) Set outfile [to_outfile]. Append everything into given outfile.</span></span><br><span class="line"><span class="string">use       (\u) Use another database. Takes database name as argument.</span></span><br><span class="line"><span class="string">charset   (\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.</span></span><br><span class="line"><span class="string">warnings  (\W) Show warnings after every statement.</span></span><br><span class="line"><span class="string">nowarning (\w) Don&apos;t show warnings after every statement.</span></span><br><span class="line"><span class="string">resetconnection(\x) Clean session context.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">For server side help, type &apos;help contents&apos;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select * from help;</span></span><br><span class="line"><span class="string">+----------------------------+---------------------------------------------------------+</span></span><br><span class="line"><span class="string">| command                    | description                                             |</span></span><br><span class="line"><span class="string">+----------------------------+---------------------------------------------------------+</span></span><br><span class="line"><span class="string">| SELECT * FROM help         | shows this help                                         |</span></span><br><span class="line"><span class="string">| SELECT * FROM backends     | lists the backends and their state                      |</span></span><br><span class="line"><span class="string">| SET OFFLINE $backend_id    | offline backend server, $backend_id is backend_ndx&apos;s id |</span></span><br><span class="line"><span class="string">| SET ONLINE $backend_id     | online backend server, ...                              |</span></span><br><span class="line"><span class="string">| ADD MASTER $backend        | example: &quot;add master 127.0.0.1:3306&quot;, ...               |</span></span><br><span class="line"><span class="string">| ADD SLAVE $backend         | example: &quot;add slave 127.0.0.1:3306&quot;, ...                |</span></span><br><span class="line"><span class="string">| REMOVE BACKEND $backend_id | example: &quot;remove backend 1&quot;, ...                        |</span></span><br><span class="line"><span class="string">| SELECT * FROM clients      | lists the clients                                       |</span></span><br><span class="line"><span class="string">| ADD CLIENT $client         | example: &quot;add client 192.168.1.2&quot;, ...                  |</span></span><br><span class="line"><span class="string">| REMOVE CLIENT $client      | example: &quot;remove client 192.168.1.2&quot;, ...               |</span></span><br><span class="line"><span class="string">| SELECT * FROM pwds         | lists the pwds                                          |</span></span><br><span class="line"><span class="string">| ADD PWD $pwd               | example: &quot;add pwd user:raw_password&quot;, ...               |</span></span><br><span class="line"><span class="string">| ADD ENPWD $pwd             | example: &quot;add enpwd user:encrypted_password&quot;, ...       |</span></span><br><span class="line"><span class="string">| REMOVE PWD $pwd            | example: &quot;remove pwd user&quot;, ...                         |</span></span><br><span class="line"><span class="string">| SAVE CONFIG                | save the backends to config file                        |</span></span><br><span class="line"><span class="string">| SELECT VERSION             | display the version of Atlas                            |</span></span><br><span class="line"><span class="string">+----------------------------+---------------------------------------------------------+</span></span><br><span class="line"><span class="string">16 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; ^DBye</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini bin]&amp; mysql -h127.0.0.1 -uroot -P1234 -uroot -pccc.456</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 2</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| ha                 |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -uroot -P1234 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -uroot -P1234 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 4</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| ha                 |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">&quot;%general_log%&quot;</span>;</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| Variable_name    | Value                          |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| general_log      | OFF                            |</span><br><span class="line">| general_log_file | /var/lib/mysql/rhel_sqlsrv.log |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -uroot -P1234 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 5</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">&quot;%general_log%&quot;</span>;</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| Variable_name    | Value                          |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| general_log      | OFF                            |</span><br><span class="line">| general_log_file | /var/lib/mysql/rhel_sqlsrv.log |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -uroot -P2345 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line"><span class="keyword">ERROR</span> <span class="number">1045</span> (<span class="number">28000</span>): <span class="keyword">password</span> doesn<span class="string">&apos;t match</span></span><br><span class="line"><span class="string">[root@ctos7mini bin]&amp; mysql -h127.0.0.1 -uroot -P1234 -uroot -ppwd</span></span><br><span class="line"><span class="string">mysql: [Warning] Using a password on the command line interface can be insecure.</span></span><br><span class="line"><span class="string">ERROR 1045 (28000): Access denied for user &apos;</span>root<span class="string">&apos;@&apos;</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">37884</span><span class="string">&apos; (using password: YES)</span></span><br><span class="line"><span class="string">[root@ctos7mini bin]&amp; mysql -h127.0.0.1 -P2345 -uroot -ppwd</span></span><br><span class="line"><span class="string">mysql: [Warning] Using a password on the command line interface can be insecure.</span></span><br><span class="line"><span class="string">Welcome to the MySQL monitor.  Commands end with ; or \g.</span></span><br><span class="line"><span class="string">Your MySQL connection id is 1</span></span><br><span class="line"><span class="string">Server version: 5.0.99-agent-admin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Oracle is a registered trademark of Oracle Corporation and/or its</span></span><br><span class="line"><span class="string">affiliates. Other names may be trademarks of their respective</span></span><br><span class="line"><span class="string">owners.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Type &apos;</span><span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">ERROR 1105 (07000): <span class="keyword">use</span> <span class="string">&apos;SELECT * FROM help&apos;</span> <span class="keyword">to</span> see the supported commands</span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -P1234 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 7</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| ha                 |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br></pre></td></tr></tbody></table></figure>
<h2 id="&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;"><a href="#&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;"></a>&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;</h2><p><strong>&#x5728;MySQL&#x4E3B;&#x5E93;&#x548C;&#x4ECE;&#x5E93;&#x5F00;&#x542F;general_log&#x65E5;&#x5FD7;&#xFF0C;&#x6CE8;&#x610F;&#x4E3B;&#x5E93;&#x548C;&#x4ECE;&#x5E93;general_log&#x65E5;&#x5FD7;&#x540D;&#x79F0;&#x4E0D;&#x540C;&#xFF01;</strong></p>
<p>&#x4E34;&#x65F6;&#x751F;&#x6548;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;%general_log%&apos;;</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| Variable_name    | Value                          |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| general_log      | OFF                            |</span><br><span class="line">| general_log_file | /var/lib/mysql/rhel_sqlsrv.log |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line">mysql&gt; <span class="keyword">set</span> <span class="keyword">global</span> general_log=<span class="keyword">ON</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6C38;&#x4E45;&#x751F;&#x6548;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; echo &quot;general_log=ON&quot; &gt;&gt; /etc/my.cnf</span><br><span class="line">[root@rhel7 ~]&amp; echo &quot;general_log_file=/var/lib/mysql/rhel.log&quot; &gt;&gt; /etc/my.cnf</span><br><span class="line"></span><br><span class="line">[root@rhel_sqlsrv ~]&amp; echo &quot;general_log=ON&quot; &gt;&gt; /etc/my.cnf</span><br><span class="line">[root@rhel_sqlsrv ~]&amp; echo &quot;general_log_file=/var/lib/mysql/rhel_sqlsrv.log&quot; &gt;&gt; /etc/my.cnf</span><br><span class="line">[root@rhel_sqlsrv ~]&amp; systemctl restart mysqld</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &quot;%general_log%&quot;;</span><br><span class="line">+<span class="comment">------------------+--------------------------+</span></span><br><span class="line">| Variable_name    | Value                    |</span><br><span class="line">+<span class="comment">------------------+--------------------------+</span></span><br><span class="line">| general_log      | ON                       |</span><br><span class="line">| general_log_file | /var/lib/mysql/rhel7.log |</span><br><span class="line">+<span class="comment">------------------+--------------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x6E05;&#x7A7A;&#x6570;&#x636E;&#x5E93;&#x65E5;&#x5FD7;</strong>&#xFF1A;</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; echo &gt; /var/lib/mysql/rhel7.log</span><br><span class="line"></span><br><span class="line">[root@rhel_sqlsrv ~]&amp; echo &gt; /var/lib/mysql/rhel_sqlsrv.log</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x6D4B;&#x8BD5;</strong>&#xFF1A;</p>
<p>Master&#xFF08;rw&#xFF09;:<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; tail -f /var/lib/mysql/rhel7.log</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Slave&#xFF08;ro&#xFF09;:<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel_sqlsrv ~]&amp; tail -f /var/lib/mysql/rhel_sqlsrv.log</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Atlas:<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mysql-proxy]<span class="comment"># mysql -h127.0.0.1 -P1234 -uroot -p</span></span><br><span class="line">Enter password:</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 9</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>ro:<br>slave&#x68C0;&#x6D4B;&#x5230;&#x8BFB;&#x64CD;&#x4F5C;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel_sqlsrv ~]&amp; tail -f /var/lib/mysql/rhel_sqlsrv.log</span><br><span class="line"></span><br><span class="line">2022-05-07T09:07:23.252345Z        13 Connect   root@192.168.73.20 on  using TCP/IP</span><br><span class="line">2022-05-07T09:07:23.252973Z        13 Query     SET CHARACTER_SET_CONNECTION=utf8</span><br><span class="line">2022-05-07T09:07:23.254053Z        13 Query     SET CHARACTER_SET_RESULTS=utf8</span><br><span class="line">2022-05-07T09:07:23.258100Z        13 Query     SET CHARACTER_SET_CLIENT=utf8</span><br><span class="line">2022-05-07T09:07:23.259321Z        13 Query     select @@version_comment limit 1</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>rw:<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]# tail -f /var/lib/mysql/rhel7.log</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5728;Atlas&#x8FDB;&#x884C;&#x8BFB;&#x64CD;&#x4F5C;:<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| ha                 |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> testdb</span><br><span class="line">Reading <span class="keyword">table</span> information <span class="keyword">for</span> completion <span class="keyword">of</span> <span class="keyword">table</span> <span class="keyword">and</span> <span class="keyword">column</span> <span class="keyword">names</span></span><br><span class="line">You can turn <span class="keyword">off</span> this feature <span class="keyword">to</span> <span class="keyword">get</span> a quicker <span class="keyword">startup</span> <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| Tables_in_testdb |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| book             |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">| Linux                   |    66 |   666 |</span><br><span class="line">| Unix                    |    77 |   777 |</span><br><span class="line">| abc                     |   123 |   456 |</span><br><span class="line">| def                     |    83 |   364 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Slave&#x68C0;&#x6D4B;&#x5230;&#x8BFB;&#x64CD;&#x4F5C;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel_sqlsrv ~]# tail -f /var/lib/mysql/rhel_sqlsrv.log</span><br><span class="line"></span><br><span class="line">2022-05-07T09:07:23.252345Z        13 Connect   root@192.168.73.20 on  using TCP/IP</span><br><span class="line">2022-05-07T09:07:23.252973Z        13 Query     SET CHARACTER_SET_CONNECTION=utf8</span><br><span class="line">2022-05-07T09:07:23.254053Z        13 Query     SET CHARACTER_SET_RESULTS=utf8</span><br><span class="line">2022-05-07T09:07:23.258100Z        13 Query     SET CHARACTER_SET_CLIENT=utf8</span><br><span class="line">2022-05-07T09:07:23.259321Z        13 Query     select @@version_comment limit 1</span><br><span class="line">2022-05-07T09:13:04.634499Z        13 Query     show databases</span><br><span class="line">2022-05-07T09:13:09.313174Z        13 Query     SELECT DATABASE()</span><br><span class="line">2022-05-07T09:13:09.314061Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:09.316061Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:09.316710Z        13 Query     show databases</span><br><span class="line">2022-05-07T09:13:09.317592Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:09.318360Z        13 Query     show tables</span><br><span class="line">2022-05-07T09:13:09.319468Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:09.320217Z        13 Field List        book</span><br><span class="line">2022-05-07T09:13:16.960823Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:16.962628Z        13 Query     show tables</span><br><span class="line">2022-05-07T09:13:20.799873Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:20.800737Z        13 Query     select * from book</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5728;Atlas&#x8FDB;&#x884C;&#x5199;&#x64CD;&#x4F5C;&#xFF1A;<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into book values(&apos;test&apos;, 67, 252);</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Master&#x68C0;&#x6D4B;&#x5230;&#x5199;&#x64CD;&#x4F5C;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]# tail -f /var/lib/mysql/rhel7.log</span><br><span class="line"></span><br><span class="line">2022-05-07T10:59:33.029685Z         4 Connect   root@192.168.73.20 on  using TCP/IP</span><br><span class="line">2022-05-07T10:59:33.030609Z         4 Query     SET CHARACTER_SET_CONNECTION=utf8</span><br><span class="line">2022-05-07T10:59:33.031735Z         4 Query     SET CHARACTER_SET_RESULTS=utf8</span><br><span class="line">2022-05-07T10:59:33.032656Z         4 Query     SET CHARACTER_SET_CLIENT=utf8</span><br><span class="line">2022-05-07T10:59:33.033919Z         4 Init DB   testdb</span><br><span class="line">2022-05-07T10:59:33.035018Z         4 Query     insert into book values(&apos;test&apos;, 67, 252)</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="&#x6545;&#x969C;&#x89E3;&#x51B3;"><a href="#&#x6545;&#x969C;&#x89E3;&#x51B3;" class="headerlink" title="&#x6545;&#x969C;&#x89E3;&#x51B3;"></a>&#x6545;&#x969C;&#x89E3;&#x51B3;</h2><p><strong>&#x6545;&#x969C;&#x4E00;</strong></p>
<p><strong>Atlas</strong>&#x8BBF;&#x95EE;&#x5DE5;&#x4F5C;&#x63A5;&#x53E3;&#x65F6;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x53EA;&#x6709;&#x4E00;&#x4E2A;<code>information_schema</code>&#xFF0C;&#x4E0D;&#x663E;&#x793A;&#x5176;&#x4ED6;&#x5E93;&#xFF1A;</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mysql-proxy]# mysql -h192.168.73.21 -uroot -p</span><br><span class="line">Enter password:</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 13</span><br><span class="line">Server version: 5.7.24-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br></pre></td></tr></tbody></table></figure>
<p>&#x6545;&#x969C;&#x5206;&#x6790;&#xFF1A;</p>
<ol>
<li><p>&#x4E3B;&#x4ECE;&#x4E0D;&#x540C;&#x6B65;&#xFF1A;<br>&#x67E5;&#x770B;Slave&#x7684;&#x72B6;&#x6001;&#xFF1A;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Connecting to master</span><br><span class="line">                  Master_Host: 192.168.73.21</span><br><span class="line">                  Master_User: root</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 10</span><br><span class="line">              Master_Log_File: mysql-bin.000005</span><br><span class="line">          Read_Master_Log_Pos: 154</span><br><span class="line">               Relay_Log_File: rhel_sqlsrv-relay-bin.000012</span><br><span class="line">                Relay_Log_Pos: 4</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000005</span><br><span class="line">             Slave_IO_Running: Connecting</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">.........................................&#x7701;&#x7565;...................................................................</span><br><span class="line">        Seconds_Behind_Master: NULL</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 2003</span><br><span class="line">                Last_IO_Error: error connecting to master &apos;root@192.168.73.21:3306&apos; - retry-time: 10  retries: 1</span><br><span class="line"> .........................................&#x7701;&#x7565;...................................................................</span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><code>Atlas</code>&#x6CA1;&#x6709;&#x8FDE;&#x63A5;&#x5230;&#x4E3B;&#x4ECE;<br>&#x8BBF;&#x95EE;Atlas&#x7BA1;&#x7406;&#x63A5;&#x53E3;&#x67E5;&#x770B;&#x4E3B;&#x4ECE;&#x670D;&#x52A1;&#x662F;&#x5426;&#x90FD;&#x5728;&#x7EBF;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mysql-proxy]<span class="comment"># mysql -h127.0.0.1 -P2345 -uroot -ppwd</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 1</span><br><span class="line">Server version: 5.0.99-agent-admin</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> backends;</span><br><span class="line">+<span class="comment">-------------+--------------------+-------+------+</span></span><br><span class="line">| backend_ndx | address            | state | type |</span><br><span class="line">+<span class="comment">-------------+--------------------+-------+------+</span></span><br><span class="line">|           1 | 192.168.73.21:3306 | up    | rw   |</span><br><span class="line">|           2 | 192.168.73.22:3306 | down  | ro   |</span><br><span class="line">+<span class="comment">-------------+--------------------+-------+------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>&#x6839;&#x636E;&#x5B9E;&#x9645;&#x73AF;&#x5883;&#x68C0;&#x67E5;&#xFF0C;&#x4E3B;&#x4ECE;&#x662F;&#x5426;&#x540C;&#x6B65;&#xFF0C;MySQL&#x662F;&#x5426;&#x5141;&#x8BB8;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x7AEF;&#x53E3;&#x662F;&#x5426;&#x5F00;&#x653E;&#x3002;</p>
<p><strong>&#x6545;&#x969C;&#x4E8C;&#xFF1A;</strong></p>
<p>&#x6570;&#x636E;&#x5E93;&#x80FD;&#x591F;&#x67E5;&#x8BE2;&#xFF0C;&#x4E0D;&#x80FD;&#x8FDB;&#x884C;&#x5199;&#x64CD;&#x4F5C;&#xFF1A;</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use testdb</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; select * from book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">| Linux                   |    66 |   666 |</span><br><span class="line">| Unix                    |    77 |   777 |</span><br><span class="line">| abc                     |   123 |   456 |</span><br><span class="line">| def                     |    83 |   364 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`book`</span> <span class="keyword">values</span>(<span class="string">&apos;test&apos;</span>,<span class="number">24</span>,<span class="number">62</span>);</span><br><span class="line">ERROR 1046 (3D000): No database selected</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>Master&#x65E5;&#x5FD7;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2022-05-07T09:24:33.993274Z        17 Query     insert into `book` values(&apos;test&apos;,24,62)</span><br><span class="line">2022-05-07T09:24:39.346670Z        17 Init DB   Access denied for user &apos;root&apos;@&apos;%&apos; to database &apos;testdb&apos;</span><br></pre></td></tr></tbody></table></figure><p></p>
<blockquote>
<p>&#x91CD;&#x542F;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;</p>
</blockquote>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
        </div>

        <blockquote class="post-copyright">
    <div class="content">
        
<span class="post-time">
    最后更新：<time datetime="2022-06-07T05:11:47.471Z" itemprop="dateUpdated">2022-06-07 13:11:47</time>
</span>


        
        原文链接：<a href="/posts/62ec7971/" target="_blank" rel="external">https://marnm.github.io/posts/62ec7971/</a>
        
    </div>
    <footer>
        <div onclick="location.href='https://marnm.github.io'">
            <img src="/img/avatar.gif" alt="Echo">
            <a>Echo</a>
        </div>
    </footer>
</blockquote>

        
    <div class="page-reward">
        <nav class="myreward">
            <a id="rewardBtn" href="javascript:;"><span>打&nbsp;赏</span><span>装成好像很多人打赏的样子</span></a>
        </nav>
    </div>



        <div class="post-footer">
            

            
<div class="page-share-wrap">
    

<div class="page-share" id="pageShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://marnm.github.io/posts/62ec7971/&title=《Atlas实现MySQL读写分离》 — Deops's blog&pic=https://marnm.github.io/img/avatar.gif" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://marnm.github.io/posts/62ec7971/&title=《Atlas实现MySQL读写分离》 — Deops's blog&source=Echo" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://marnm.github.io/posts/62ec7971/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Atlas实现MySQL读写分离》 — Deops's blog&url=https://marnm.github.io/posts/62ec7971/&via=https://marnm.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://marnm.github.io/posts/62ec7971/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>



    <a href="javascript:;" id="shareFab" class="page-share-fab waves-effect waves-circle">
        <i class="icon icon-share-alt icon-lg"></i>
    </a>
</div>



        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/posts/490925f2/" id="post-prev" class="post-nav-link">
        <h4 class="title">
          上一篇：MySQL数据库高级应用之读写分离
        </h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/posts/db0340bd/" id="post-next" class="post-nav-link">
        <h4 class="title" data-hover="下一篇：MySQL高可用集群架构-MHA架构">下一篇：MySQL高可用集群架构-MHA架构</h4>
      </a>
    </div>
  
</nav>



    
    

    

    


</article>

</div>

        <footer class="footer">
    <div class="footer-content">
        <span class="power">
            <i class="icon icon-lg icon-copyright"></i>
            2022
            <i class="icon icon-lg icon-heart"></i>
            <a href="https://marnm.github.io">marnm.github.io</a>
            <br>
            Power by
            <a href="https://hexo.io/" target="_blank" rel="external nofollow">Hexo</a>&nbsp;·&nbsp;
            Theme
            <a class="tomotoeslink" href="https://github.com/tomotoes/hexo-theme-tomotoes/" target="_blank" rel="external nofollow">tomotoes</a>
        </span>

        <br>

        <span id="RunTime" style="color:#a7a7a2;"></span>
        <br>

        <span>
            

        </span>
        <br>

        <span class="license"><a target="_blank" rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">博客内容遵循 知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
    </div>
</footer>

    </main>
    
        
<div id="reward" class="page-modal reward-lay">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <h3 class="reward-title">
        <i class="icon icon-quote-left"></i>
        <span>感谢您的鼓励支持！</span>
        <i class="icon icon-quote-right"></i>
    </h3>
    <div class="reward-content">
        
        <div class="reward-code">
            <img id="rewardCode" data-img="/img/dog.png" alt="打赏二维码">
        </div>
        
        <label class="reward-toggle">
            <input id="rewardToggle" type="checkbox" class="reward-toggle-check" data-wechat="/img/wechat.png" data-alipay="/img/alipay.png">
            <div class="reward-toggle-ctrol">
                <span class="reward-toggle-item wechatPay">&nbsp;&nbsp;微信&nbsp;&nbsp;</span>
                <span class="reward-toggle-item alipayPay">支付宝</span>
            </div>
        </label>
        
        <i class="icon icon-caret-up"></i>
    </div>
</div>


    
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>



<div class="global-share" id="globalShare">
    <ul class="reset share-icons">
      <li>
        <a class="weibo share-sns" target="_blank" href="http://service.weibo.com/share/share.php?url=https://marnm.github.io/posts/62ec7971/&title=《Atlas实现MySQL读写分离》 — Deops's blog&pic=https://marnm.github.io/img/avatar.gif" data-title="微博">
          <i class="icon icon-weibo"></i>
        </a>
      </li>
      <li>
        <a class="weixin share-sns wxFab" href="javascript:;" data-title="微信">
          <i class="icon icon-weixin"></i>
        </a>
      </li>
      <li>
        <a class="qq share-sns" target="_blank" href="http://connect.qq.com/widget/shareqq/index.html?url=https://marnm.github.io/posts/62ec7971/&title=《Atlas实现MySQL读写分离》 — Deops's blog&source=Echo" data-title=" QQ">
          <i class="icon icon-qq"></i>
        </a>
      </li>
      <li>
        <a class="facebook share-sns" target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=https://marnm.github.io/posts/62ec7971/" data-title=" Facebook">
          <i class="icon icon-facebook"></i>
        </a>
      </li>
      <li>
        <a class="twitter share-sns" target="_blank" href="https://twitter.com/intent/tweet?text=《Atlas实现MySQL读写分离》 — Deops's blog&url=https://marnm.github.io/posts/62ec7971/&via=https://marnm.github.io" data-title=" Twitter">
          <i class="icon icon-twitter"></i>
        </a>
      </li>
      <li>
        <a class="google share-sns" target="_blank" href="https://plus.google.com/share?url=https://marnm.github.io/posts/62ec7971/" data-title=" Google+">
          <i class="icon icon-google-plus"></i>
        </a>
      </li>
    </ul>
 </div>


<div class="page-modal wx-share" id="wxShare">
    <a class="close" href="javascript:;"><i class="icon icon-close"></i></a>
    <p class="wechatshare">扫一扫，分享到微信</p>
    <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAK4AAACuCAAAAACKZ2kyAAABxklEQVR42u3aW46DMAwF0O5/08wCKuDaDhkqnXxVVUsO+bD8yOcTr+Nkff/m+/fXz/w8sXBxccfc43Jdb59vefbM3ICLi7ufex1ozqBJaMuPIwp2uLi4r+T2Ql4e1HBxcX+Rm3xTLX5wcXHfyc1TkCTAVRsrj9RquLi4A27e1Hju8yP9XVxc3Bb3KK5qipM0Wwu74+LibuHmASVvdOalVHVfXFzcPdy8MZG3RyeDk+ujwcXF3cPNU5bqeDUJYflLRl1eXFzcpdyk0Tm/aFVNmE4DHy4u7kZu3jBNkptJCFtWq+Hi4g641etT84sXvRYMLi7ue7irZrl5mBsFMlxc3Ae4vcQlT4Z6gxZcXNyd3GpqMr+QUT3FmyErLi7uA9x8UDoZjlbLmJsdcXFxN3KrRcg8MDWbLLi4uNu5STnUG5zkV7VuXhsXF3cjt5eC9Bof1edH54eLi7uIexTXpElavXiBi4v7X9z5iDQJXnmRMw+yuLi4q7i94iQfflRf5uYgcHFxN3J7F7PyNCWPoM2GKS4u7iu5vYKqWbHh4uK+kjtpZ1T/tSCQ4eLitrjV5ubkokaViIuLu5+7drA6aaSuelVcXNwB9w9ROFLB2E4NHAAAAABJRU5ErkJggg==" alt="微信分享二维码">
</div>




    <!-- waves按钮特效 -->
<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<!-- 主题配置脚本 -->
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: true };
</script>

<!-- jquery -->
<script src="/js/jquery.min.js?v=3.0"></script>

<!-- 搜索 -->

<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item waves-block waves-effect" onclick="location.href='{path}'">
    <div class="title ellipsis" title="{title}">{title}</div>
</li>
</template>


<!-- main博客脚本 -->
<script src="/js/main.min.js?v=3.0"></script>

<!-- 动画&配置 -->
<script src="/js/script.min.js?v=3.0"></script>

<!-- 脚本管理 -->
<script>

if(window.innerWidth > 800){
	/* 3D标题 */
	$(".content-header").on("mousemove", threedee);

	/* 底部追随鼠标 */
	$(".footer").hover(2);

	/* gotop键的涟漪 */
	$("#gotop").hover(1);

	/* 赞赏的粒子雨 */
	$("#reward").hover(3);

	/* 微信公众号的底部渲染 */
	$("#wechat").hover(4);

    /* 标题跳动 */
    $(".archivestitle").bumpyText();

	/* 图片点击放大 */
	const postimg = jQuery(".post-content img:not(.github-emoji)");
	postimg.on("click",function(){

		mask.classList.add("in");
		main.classList.add("Mask");
		menu.classList.add("Mask");
		var myimg = this.cloneNode(true);
		myimg.classList.add("imgShow");

		setTimeout(function(){
			jQuery(myimg).animate({
				opacity:"1"
			},1000);
		},0);

		document.body.appendChild(myimg);

		myimg.onclick=function(){
			document.body.removeChild(myimg);
			mask.classList.remove("in");
			main.classList.remove("Mask");
			menu.classList.remove("Mask");
		};

	});

}

/* 名字跳动 */
$("#name").bumpyText();


/* 网站运行时间 */
setInterval(function () {
	setTime("2019/01/01");
}, 1000);

/* 文章块的淡出 */
postshow();

/* 座右铭 */

   getHitokoto();



/* 粘贴提示 */
G($(".post-content"), location.href, "Echo");


/* 控制台 */
if (window.console && window.console.log) {
	setTimeout(function () {
		console.log("\n %c 一个坏掉的番茄 %c  © Simon Ma  http://tomotoes.com \n\n", "color:#FFFFFB;background:#1abc9c;padding:5px 0;border-radius:.5rem 0 0 .5rem;", "color:#FFFFFB;background:#080808;padding:5px 0;border-radius:0 .5rem .5rem 0;");
	}, 0);
}

</script>




<!-- 公式渲染 -->



<!-- 不蒜子 -->


</body>
</html>
