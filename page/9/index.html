<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
    <meta http-equiv="Content-Language" content="zh-cn">
    <meta charset="utf-8">
    
    
    
    <title>Deops&#39;s blog | 运维开发工程师</title>
    <meta name="viewport" content="width=device-width,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    
    <meta name="theme-color" content="#77AAFF">
    
    
    <meta name="keywords" content="Echo">
    
    

    

    <!-- Baidu Push -->
<script>
	(function(){
		var bp = document.createElement('script');
		var curProtocol = window.location.protocol.split(':')[0];
		if (curProtocol === 'https') {
			bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
		}
		else {
			bp.src = 'http://push.zhanzhang.baidu.com/push.js';
		}
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(bp, s);
	})();

	var _hmt = _hmt || [];
</script>



    
    <meta name="description" content="Echo">
<meta name="keywords" content="Echo">
<meta property="og:type" content="website">
<meta property="og:title" content="Deops&#39;s blog">
<meta property="og:url" content="https://marnm.github.io/page/9/index.html">
<meta property="og:site_name" content="Deops&#39;s blog">
<meta property="og:description" content="Echo">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Deops&#39;s blog">
<meta name="twitter:description" content="Echo">
    
        <link rel="alternate" type="application/atom+xml" title="Deops&#39;s blog" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link id="style" rel="stylesheet" href="/css/style.css?v=3.0">
    <script>window.lazyScripts=[]</script>

    <!-- custom head -->
    
            
</head>

<body>
    <div id="loading" class="active"></div>
    <aside id="menu">
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.gif" alt="avatar">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname" id="name">Echo</h5>
          
            <div id="yiyanmotto" class="motto">&nbsp;</div>
          
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
              <li class="waves-block waves-effect">
                  <a href="/">
                    <i class="icon icon-lg icon-home"></i>
                    <span>主 页</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/archives">
                    <i class="icon icon-lg icon-archives"></i>
                    <span>归 档</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/categories">
                    <i class="icon icon-lg icon-th-list"></i>
                    <span>分 类</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/tags">
                    <i class="icon icon-lg icon-tags"></i>
                    <span>标 签</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
              <li class="waves-block waves-effect">
                  <a href="/about">
                    <i class="icon icon-lg icon-smile-o"></i>
                    <span>关 于</span><i class="icon icon-lg icon-caret-left"></i>
                  </a>
              </li>
            
      <div class="nav2">
          
              <a class="nav2item" data-title="Email" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=442KgIbNhZajhYybjoKKj82AjI4" target="_parent" title="Email">
                <i class="icon icon-lg icon-envelope-o envelope-o"></i>
              </a>
          
              <a class="nav2item" data-title="Github" href="https://github.com/Marnm" target="_blank" title="Github">
                <i class="icon icon-lg icon-github github"></i>
              </a>
          
              <a class="nav2item" data-title="我的哔哩哔哩" href="https://space.bilibili.com/31374976" target="_blank" title="我的哔哩哔哩">
                <i class="icon icon-lg icon-tv tv"></i>
              </a>
          

            </div>
        
      </ul>
        
    </div>
  </div>
 
</aside>


    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">Deops&#39;s blog</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="输入感兴趣的关键字">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        <a href="../../atom.xml" target="_blank" class="header-icon waves-effect waves-circle waves-light" id="Rss">
            <i class="icon icon-lg icon-rss"></i>
        </a>
    </div>
</header>
<header class="content-header index-header">
    
    
    <div class="container fade-scale">
        <div id="myheader">
            <h1 class="title">
                 
                    Deops&#39;s blog
                
            </h1>
            <h5 class="subtitle">
                
                    努力成为一名资深运维工程师
                
            </h5>
        </div>
    </div>

</header>

<div class="container body-wrap">
    <ul class="post-list">
    
        <li class="post-list-item fade">
            <article id="post-MyCat垂直分表操作" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/176dc5f3/">MyCat垂直分表操作</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:46:29" datetime="2022-06-07T04:46:29.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p><code>schema.xml</code></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mycat:schema</span> <span class="attr">xmlns:mycat</span>=<span class="string">&quot;http://io.mycat/&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- &#x903B;&#x8F91;&#x5E93;&#x914D;&#x7F6E; mycatdb1,mycatdb2,mycatdb3 &#x662F;&#x903B;&#x8F91;&#x5E93;&#x5E76;&#x4E0D;&#x662F;&#x771F;&#x7684;&#x6570;&#x636E;&#x5E93;--&gt;</span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">&lt;!-- &#x5176;&#x4E2D; checkSQLschema &#x8868;&#x660E;&#x662F;&#x5426;&#x68C0;&#x67E5;&#x5E76;&#x8FC7;&#x6EE4; SQL &#x4E2D;&#x5305;&#x542B; schema &#x7684;&#x60C5;&#x51B5;:</span></span><br><span class="line"><span class="comment">	&#x5982;&#x903B;&#x8F91;&#x5E93;&#x4E3A; mycatdb1&#xFF0C;&#x5219;&#x53EF;&#x80FD;&#x5199;&#x4E3A; select * from mycatdb1.jakingtestdb11&#xFF0C;</span></span><br><span class="line"><span class="comment">	&#x6B64;&#x65F6;&#x4F1A;&#x81EA;&#x52A8;&#x8FC7;&#x6EE4; mycatdb1&#xFF0C;SQL &#x53D8;&#x4E3A; select * from jakingtestdb11&#xFF0C;&#x82E5;&#x4E0D;&#x4F1A;&#x51FA;&#x73B0;&#x4E0A;&#x8FF0;&#x5199;&#x6CD5;&#xFF0C;&#x5219;&#x53EF;&#x4EE5;&#x5173;&#x95ED;&#x5C5E;&#x6027;&#x4E3A; false	</span></span><br><span class="line"><span class="comment">	checkSQLschema=&quot;false&quot;    select * from mycatdb1.jakingtestdb11;</span></span><br><span class="line"><span class="comment">	checkSQLschema=&quot;true&quot;     select * from jakingtestdb11;   --&gt;</span> </span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- sqlMaxLimit &#x9ED8;&#x8BA4;&#x8FD4;&#x56DE;&#x7684;&#x6700;&#x5927;&#x8BB0;&#x5F55;&#x6570;&#x9650;&#x5236;&#xFF0C;MyCat1.4 &#x7248;&#x672C;&#x91CC;&#x9762;&#xFF0C;&#x7528;&#x6237;&#x7684; Limit &#x53C2;&#x6570;&#x4F1A; &#x8986;&#x76D6;&#x6389; MyCat &#x7684; sqlMaxLimit &#x9ED8;&#x8BA4;&#x8BBE;&#x7F6E;--&gt;</span></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x6BCF;&#x4E2A;&#x903B;&#x8F91;&#x5E93;&#x5BF9;&#x5E94;&#x4E00;&#x4E2A; schema ,&#x6BCF;&#x4E2A;schema &#x5BF9;&#x5E94;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x8282;&#x70B9; --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb1&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb1&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb2&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb2&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb3&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb3&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb4&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb4&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb5&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb5&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb6&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb6&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb7&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb7&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb8&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb8&quot;</span>/&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;mycatdb9&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&quot;dnmycatdb9&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- &#x8868;&#x5206;&#x7247;&#x914D;&#x7F6E;&#x5728;&#x8FD9;&#x91CC; --&gt;</span> </span><br><span class="line">	<span class="comment">&lt;!--&lt;/schema&gt; --&gt;</span> </span><br><span class="line">	<span class="comment">&lt;!-- &#x5B9A;&#x4E49; MyCat &#x7684;&#x6570;&#x636E;&#x8282;&#x70B9;&#xFF0C;&#x8282;&#x70B9;&#x914D;&#x7F6E; jakingtestdb01,jakingtestdb02,jakingtestdb03 &#x624D;&#x662F;&#x771F;&#x6B63;&#x7684;&#x6570;&#x636E;&#x5E93;&#xFF0C; </span></span><br><span class="line"><span class="comment">		dataNode &#x4E2D;&#x7684; name &#x6570;&#x636E;&#x8868;&#x793A;&#x8282;&#x70B9;&#x540D;&#x79F0;&#xFF0C; dataHost &#x8868;&#x793A;&#x6570;&#x636E;&#x4E3B;&#x673A;&#x540D;&#x79F0;&#xFF0C; </span></span><br><span class="line"><span class="comment">		database &#x8868;&#x793A;&#x8BE5;&#x8282;&#x70B9;&#x8981;&#x8DEF;&#x7531;&#x7684;&#x6570;&#x636E;&#x5E93;&#x7684;&#x540D;&#x79F0; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x8BBE;&#x5B9A;&#x6570;&#x636E;&#x7ED3;&#x70B9; dnmycatdb1-3 &#x5BF9;&#x5E94;&#x7684; 192.168.10.12 &#x670D;&#x52A1; &#x4EE5;&#x53CA;&#x5BF9;&#x5E94;&#x7684;&#x7269;&#x7406; schema --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb1&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking12&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb01&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb2&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking12&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb02&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb3&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking12&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb03&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x8BBE;&#x5B9A;&#x6570;&#x636E;&#x7ED3;&#x70B9; dnmycatdb4-6 &#x5BF9;&#x5E94;&#x7684; 192.168.10.13 &#x670D;&#x52A1; &#x4EE5;&#x53CA;&#x5BF9;&#x5E94;&#x7684;&#x7269;&#x7406; schema --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb4&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking13&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb04&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb5&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking13&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb05&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb6&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking13&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb06&quot;</span> /&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x8BBE;&#x5B9A;&#x6570;&#x636E;&#x7ED3;&#x70B9; dnmycatdb7-9 &#x5BF9;&#x5E94;&#x7684; 192.168.10.14 &#x670D;&#x52A1; &#x4EE5;&#x53CA;&#x5BF9;&#x5E94;&#x7684;&#x7269;&#x7406; schema --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb7&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking14&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb07&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb8&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking14&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb08&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dnmycatdb9&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;jaking14&quot;</span> <span class="attr">database</span>=<span class="string">&quot;jakingtestdb09&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	<span class="comment">&lt;!-- &#x8BFB;&#x5199;&#x5206;&#x79BB;&#x7684;&#x914D;&#x7F6E; --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- dataHost &#x914D;&#x7F6E;&#x7684;&#x662F;&#x5B9E;&#x9645;&#x7684;&#x540E;&#x7AEF;&#x6570;&#x636E;&#x5E93;&#x96C6;&#x7FA4;&#xFF08;&#x5F53;&#x7136;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;&#x975E;&#x96C6;&#x7FA4;&#xFF09; --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &#x6CE8;&#x610F;&#xFF1A; schema &#x4E2D;&#x7684;&#x6BCF;&#x4E00;&#x4E2A; dataHost &#x4E2D;&#x7684; host &#x5C5E;&#x6027;&#x503C;&#x5FC5;&#x987B;&#x552F;&#x4E00;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x51FA;&#x73B0;&#x4E3B;&#x4ECE;&#x5728;&#x6240;&#x6709; dataHost &#x4E2D;&#x5168;&#x90E8;&#x5207;&#x6362;&#x7684;&#x73B0;&#x8C61; --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- &#x5B9A;&#x4E49;&#x6570;&#x636E;&#x4E3B;&#x673A; dtHost1&#xFF0C;&#x53EA;&#x8FDE;&#x63A5;&#x5230; MySQL &#x8BFB;&#x5199;&#x5206;&#x79BB;&#x96C6;&#x7FA4;&#x4E2D;&#x7684; Master &#x8282;&#x70B9;&#xFF0C;&#x4E0D;&#x4F7F;&#x7528; MyCat &#x6258;&#x7BA1; MySQL &#x4E3B;&#x4ECE;&#x5207;&#x6362; --&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- </span></span><br><span class="line"><span class="comment">		&lt;dataHost name=&quot;dtHost1&quot; maxCon=&quot;500&quot; minCon=&quot;20&quot; balance=&quot;0&quot; </span></span><br><span class="line"><span class="comment">		writeType=&quot;0&quot; dbType=&quot;mysql&quot; dbDriver=&quot;native&quot; switchType=&quot;1&quot; slaveThreshold=&quot;100&quot;&gt; </span></span><br><span class="line"><span class="comment">		&lt;heartbeat&gt;select user()&lt;/heartbeat&gt; </span></span><br><span class="line"><span class="comment">		&lt;writeHost host=&quot;hostM1&quot; url=&quot;192.168.10.63:3306&quot; user=&quot;root&quot; password=&quot;lyz&quot; /&gt; </span></span><br><span class="line"><span class="comment">		&lt;/dataHost&gt; </span></span><br><span class="line"><span class="comment">	--&gt;</span></span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x8BBE;&#x5B9A; 192.168.10.12 &#x76EE;&#x524D;&#x53EA;&#x914D;&#x4E86;&#x4E00;&#x53F0;&#x7269;&#x7406;&#x673A;&#xFF0C;&#x82E5;&#x8981;&#x505A;&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x53EF;&#x4EE5;&#x53C2;&#x8003;&#x4E0A;&#x9762;&#x7684;&#x90E8;&#x5206; --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">&quot;jaking12&quot;</span> <span class="attr">maxCon</span>=<span class="string">&quot;1000&quot;</span> <span class="attr">minCon</span>=<span class="string">&quot;10&quot;</span> <span class="attr">balance</span>=<span class="string">&quot;1&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">writeType</span>=<span class="string">&quot;0&quot;</span> <span class="attr">dbType</span>=<span class="string">&quot;mysql&quot;</span> <span class="attr">dbDriver</span>=<span class="string">&quot;native&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- can have multi write hosts --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">&quot;192.168.10.12&quot;</span> <span class="attr">url</span>=<span class="string">&quot;192.168.10.12:3306&quot;</span> <span class="attr">user</span>=<span class="string">&quot;root&quot;</span> <span class="attr">password</span>=<span class="string">&quot;123456&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">&quot;jaking13&quot;</span> <span class="attr">maxCon</span>=<span class="string">&quot;1000&quot;</span> <span class="attr">minCon</span>=<span class="string">&quot;10&quot;</span> <span class="attr">balance</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">writeType</span>=<span class="string">&quot;0&quot;</span> <span class="attr">dbType</span>=<span class="string">&quot;mysql&quot;</span> <span class="attr">dbDriver</span>=<span class="string">&quot;native&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- can have multi write hosts --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">&quot;192.168.10.13&quot;</span> <span class="attr">url</span>=<span class="string">&quot;192.168.10.13:3306&quot;</span> <span class="attr">user</span>=<span class="string">&quot;root&quot;</span> <span class="attr">password</span>=<span class="string">&quot;123456&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">&quot;jaking14&quot;</span> <span class="attr">maxCon</span>=<span class="string">&quot;1000&quot;</span> <span class="attr">minCon</span>=<span class="string">&quot;10&quot;</span> <span class="attr">balance</span>=<span class="string">&quot;1&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">writeType</span>=<span class="string">&quot;0&quot;</span> <span class="attr">dbType</span>=<span class="string">&quot;mysql&quot;</span> <span class="attr">dbDriver</span>=<span class="string">&quot;native&quot;</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span> </span><br><span class="line"><span class="comment">&lt;!-- can have multi write hosts --&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">&quot;192.168.10.14&quot;</span> <span class="attr">url</span>=<span class="string">&quot;192.168.10.14:3306&quot;</span> <span class="attr">user</span>=<span class="string">&quot;root&quot;</span> <span class="attr">password</span>=<span class="string">&quot;123456&quot;</span> /&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span> </span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mycat:schema</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure>
<p><code>server.xml</code></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- &#x5F00;&#x901A;root&#x7528;&#x6237;&#x8BBF;&#x95EE;mycatdb&#x8BBF;&#x95EE;&#x6743;&#x9650; mycatdbx&#x662F;&#x865A;&#x62DF;&#x7684;schema --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">&quot;root&quot;</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;schemas&quot;</span>&gt;</span>mycatdb1,mycatdb2,mycatdb3,mycatdb4,mycatdb5,mycatdb6,mycatdb7,mycatdb8,mycatdb9<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- &#x5F00;&#x901A;user&#x666E;&#x901A;&#x7528;&#x6237;&#x8BBF;&#x95EE;mycatdb&#x8BBF;&#x95EE;&#x6743;&#x9650; mycatdbx&#x662F;&#x865A;&#x62DF;&#x7684;schema --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>123456<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;schemas&quot;</span>&gt;</span>mycatdb1,mycatdb2,mycatdb3,mycatdb4,mycatdb5,mycatdb6,mycatdb7,mycatdb8,mycatdb9<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;readOnly&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/176dc5f3/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-MySQL数据库高级应用之读写分离" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/490925f2/">MySQL数据库高级应用之读写分离</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:46:08" datetime="2022-06-07T04:46:08.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h1 id="MySQL&#x6570;&#x636E;&#x5E93;&#x9AD8;&#x7EA7;&#x5E94;&#x7528;&#x4E4B;&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x2014;&#x2014;MyCat&#x7BC7;"><a href="#MySQL&#x6570;&#x636E;&#x5E93;&#x9AD8;&#x7EA7;&#x5E94;&#x7528;&#x4E4B;&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x2014;&#x2014;MyCat&#x7BC7;" class="headerlink" title="MySQL&#x6570;&#x636E;&#x5E93;&#x9AD8;&#x7EA7;&#x5E94;&#x7528;&#x4E4B;&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x2014;&#x2014;MyCat&#x7BC7;"></a>MySQL&#x6570;&#x636E;&#x5E93;&#x9AD8;&#x7EA7;&#x5E94;&#x7528;&#x4E4B;&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x2014;&#x2014;MyCat&#x7BC7;</h1><h2 id="&#x914D;&#x7F6E;MySQL&#x4E3B;&#x4ECE;"><a href="#&#x914D;&#x7F6E;MySQL&#x4E3B;&#x4ECE;" class="headerlink" title="&#x914D;&#x7F6E;MySQL&#x4E3B;&#x4ECE;"></a>&#x914D;&#x7F6E;MySQL&#x4E3B;&#x4ECE;</h2><h3 id="Master"><a href="#Master" class="headerlink" title="Master"></a>Master</h3><p>&#x4FEE;&#x6539;&#x914D;&#x7F6E;<br></p><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">symbolic-links</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-error</span>=/var/log/mysqld.log</span><br><span class="line"><span class="attr">pid-file</span>=/var/run/mysqld/mysqld.pid</span><br><span class="line"></span><br><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">user</span>=mysql</span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">sync_binlog</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">log-bin</span>=mysql-bin-master</span><br><span class="line"><span class="attr">server-id</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">binlog-do-db</span>=ha</span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line"><span class="attr">lower_case_table_names</span>=<span class="number">1</span></span><br><span class="line">skip-name-resolve</span><br><span class="line"></span><br><span class="line"><span class="attr">character-set-server</span>=utf8</span><br><span class="line"><span class="attr">collation-server</span>=utf8_general_ci</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x521B;&#x5EFA;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5E76;&#x8BBE;&#x7F6E;&#x6388;&#x6743;&#x7528;&#x6237;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> ha;</span><br><span class="line"><span class="keyword">use</span> ha</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">test</span>(<span class="keyword">id</span> <span class="built_in">int</span>, <span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">replication</span> <span class="keyword">slave</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> root@<span class="string">&apos;%&apos;</span> <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">&apos;123456&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">master</span> <span class="keyword">status</span>;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5BFC;&#x51FA;&#x6570;&#x636E;&#x5E93;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -p -B ha &gt; ha.sql</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="Slave"><a href="#Slave" class="headerlink" title="Slave"></a>Slave</h3><p>&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;<br></p><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">symbolic-links</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-error</span>=/var/log/mysqld.log</span><br><span class="line"><span class="attr">pid-file</span>=/var/run/mysqld/mysqld.pid</span><br><span class="line"></span><br><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-bin</span>=mysql-bin</span><br><span class="line"><span class="attr">server-id</span>=<span class="number">3</span></span><br><span class="line"><span class="attr">binlog-do-db</span>=ha</span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line"><span class="attr">log_slave_updates</span>=<span class="number">1</span></span><br><span class="line">skip-name-resolve</span><br><span class="line"><span class="attr">lower_case_table_names</span>=<span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="attr">character-set-server</span>=utf8</span><br><span class="line"><span class="attr">collation-server</span>=utf8_general_ci</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8BBE;&#x7F6E;&#x4E3B;&#x670D;&#x52A1;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">change</span> <span class="keyword">master</span> <span class="keyword">to</span> master_host=<span class="string">&apos;master_ip_addr&apos;</span>, master_user=<span class="string">&apos;root&apos;</span>, master_password=<span class="string">&apos;123456&apos;</span>, master_log_file=<span class="string">&apos;master_db_bin&apos;</span>;</span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br><span class="line"><span class="keyword">start</span> <span class="keyword">slave</span>;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5BFC;&#x5165;Master&#x7684;&#x6570;&#x636E;&#x5E93;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p &lt; ha.sql</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="&#x5B89;&#x88C5;&#x914D;&#x7F6E;MyCat"><a href="#&#x5B89;&#x88C5;&#x914D;&#x7F6E;MyCat" class="headerlink" title="&#x5B89;&#x88C5;&#x914D;&#x7F6E;MyCat"></a>&#x5B89;&#x88C5;&#x914D;&#x7F6E;MyCat</h2><h3 id="&#x5B89;&#x88C5;jdk&#xFF0C;&#x914D;&#x7F6E;Java&#x73AF;&#x5883;&#x53D8;&#x91CF;"><a href="#&#x5B89;&#x88C5;jdk&#xFF0C;&#x914D;&#x7F6E;Java&#x73AF;&#x5883;&#x53D8;&#x91CF;" class="headerlink" title="&#x5B89;&#x88C5;jdk&#xFF0C;&#x914D;&#x7F6E;Java&#x73AF;&#x5883;&#x53D8;&#x91CF;"></a>&#x5B89;&#x88C5;jdk&#xFF0C;&#x914D;&#x7F6E;Java&#x73AF;&#x5883;&#x53D8;&#x91CF;</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/java</span><br><span class="line"></span><br><span class="line">tar -zxvf jdk-8u201-linux-x64.tar.gz -C /usr/java/</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/profile</span><br><span class="line"></span><br><span class="line">JAVA_HOME=/usr/java/jdk1.8.0_201</span><br><span class="line">PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line">CLASSPATH=$JAVA_HOME/jre/lib/ext:$JAVA_HOME/lib/tools.jar</span><br><span class="line">export PATH JAVA_HOME CLASSPATH</span><br><span class="line">MYCAT_HOME=/usr/local/mycat</span><br><span class="line">PATH=$MYCAT_HOME/bin:$PATH</span><br><span class="line"></span><br><span class="line">source /etc/profile</span><br></pre></td></tr></tbody></table></figure>
<h3 id="&#x5B89;&#x88C5;MyCat"><a href="#&#x5B89;&#x88C5;MyCat" class="headerlink" title="&#x5B89;&#x88C5;MyCat"></a>&#x5B89;&#x88C5;MyCat</h3><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf Mycat-server-1.6.7.3-release-20190927161129-linux.tar.gz -C /usr/local/</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x4FEE;&#x6539;wrapper.conf&#x914D;&#x7F6E;&#x6587;&#x4EF6;</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#********************************************************************</span></span><br><span class="line"><span class="comment"># Wrapper Properties</span></span><br><span class="line"><span class="comment">#********************************************************************</span></span><br><span class="line"><span class="comment"># Java Application</span></span><br><span class="line"><span class="comment"># &#x6539;&#x6210;JDK&#x5B89;&#x88C5;&#x76EE;&#x5F55;</span></span><br><span class="line">wrapper.java.command=/usr/java/jdk1.8.0_201/bin/java</span><br><span class="line">wrapper.working.dir=..</span><br><span class="line"></span><br><span class="line"><span class="comment"># Java Main class.  This class must implement the WrapperListener interface</span></span><br><span class="line"><span class="comment">#  or guarantee that the WrapperManager class is initialized.  Helper</span></span><br><span class="line"><span class="comment">#  classes are provided to do this for you.  See the Integration section</span></span><br><span class="line"><span class="comment">#  of the documentation for details.</span></span><br><span class="line">wrapper.java.mainclass=org.tanukisoftware.wrapper.WrapperSimpleApp</span><br><span class="line">set.default.REPO_DIR=lib</span><br><span class="line">set.APP_BASE=.</span><br><span class="line"></span><br><span class="line"><span class="comment"># Java Classpath (include wrapper.jar)  Add class path elements as</span></span><br><span class="line"><span class="comment">#  needed starting from 1</span></span><br><span class="line">wrapper.java.classpath.1=lib/wrapper.jar</span><br><span class="line">wrapper.java.classpath.2=conf</span><br><span class="line">wrapper.java.classpath.3=%REPO_DIR%/*</span><br><span class="line"></span><br><span class="line"><span class="comment"># Java Library Path (location of Wrapper.DLL or libwrapper.so)</span></span><br><span class="line">wrapper.java.library.path.1=lib</span><br><span class="line"></span><br><span class="line"><span class="comment"># Java Additional Parameters</span></span><br><span class="line"><span class="comment">#wrapper.java.additional.1=</span></span><br><span class="line">wrapper.java.additional.1=-DMYCAT_HOME=.</span><br><span class="line">wrapper.java.additional.2=-server</span><br><span class="line">wrapper.java.additional.3=-XX:MaxPermSize=64M</span><br><span class="line">wrapper.java.additional.4=-XX:+AggressiveOpts</span><br><span class="line">wrapper.java.additional.5=-XX:MaxDirectMemorySize=2G</span><br><span class="line">wrapper.java.additional.6=-Dcom.sun.management.jmxremote</span><br><span class="line">wrapper.java.additional.7=-Dcom.sun.management.jmxremote.port=1984</span><br><span class="line">wrapper.java.additional.8=-Dcom.sun.management.jmxremote.authenticate=false</span><br><span class="line">wrapper.java.additional.9=-Dcom.sun.management.jmxremote.ssl=false</span><br><span class="line"><span class="comment"># &#x5982;&#x679C;MyCat&#x8FD8;&#x662F;&#x8D77;&#x4E0D;&#x6765;&#x8C03;&#x6574;&#x4E00;&#x4E0B;&#x6027;&#x80FD;&#x8981;&#x6C42;</span></span><br><span class="line">wrapper.java.additional.10=-Xmx640M</span><br><span class="line">wrapper.java.additional.11=-Xms256M</span><br><span class="line"></span><br><span class="line"><span class="comment"># Initial Java Heap Size (in MB)</span></span><br><span class="line"><span class="comment">#wrapper.java.initmemory=3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Maximum Java Heap Size (in MB)</span></span><br><span class="line"><span class="comment">#wrapper.java.maxmemory=64</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Application parameters.  Add parameters as needed starting from 1</span></span><br><span class="line">wrapper.app.parameter.1=io.mycat.MycatStartup</span><br><span class="line">wrapper.app.parameter.2=start</span><br><span class="line"></span><br><span class="line"><span class="comment">#********************************************************************</span></span><br><span class="line"><span class="comment"># Wrapper Logging Properties</span></span><br><span class="line"><span class="comment">#********************************************************************</span></span><br><span class="line"><span class="comment"># Format of output for the console.  (See docs for formats)</span></span><br><span class="line">wrapper.console.format=PM</span><br><span class="line"></span><br><span class="line"><span class="comment"># Log Level for console output.  (See docs for log levels)</span></span><br><span class="line">wrapper.console.loglevel=INFO</span><br><span class="line"></span><br><span class="line"><span class="comment"># Log file to use for wrapper output logging.</span></span><br><span class="line">wrapper.logfile=logs/wrapper.log</span><br><span class="line"></span><br><span class="line"><span class="comment"># Format of output for the log file.  (See docs for formats)</span></span><br><span class="line">wrapper.logfile.format=LPTM</span><br><span class="line"></span><br><span class="line"><span class="comment"># Log Level for log file output.  (See docs for log levels)</span></span><br><span class="line">wrapper.logfile.loglevel=INFO</span><br><span class="line"></span><br><span class="line"><span class="comment"># Maximum size that the log file will be allowed to grow to before</span></span><br><span class="line"><span class="comment">#  the log is rolled. Size is specified in bytes.  The default value</span></span><br><span class="line"><span class="comment">#  of 0, disables log rolling.  May abbreviate with the &apos;k&apos; (kb) or</span></span><br><span class="line"><span class="comment">#  &apos;m&apos; (mb) suffix.  For example: 10m = 10 megabytes.</span></span><br><span class="line">wrapper.logfile.maxsize=512m</span><br><span class="line"></span><br><span class="line"><span class="comment"># Maximum number of rolled log files which will be allowed before old</span></span><br><span class="line"><span class="comment">#  files are deleted.  The default value of 0 implies no limit.</span></span><br><span class="line">wrapper.logfile.maxfiles=30</span><br><span class="line"></span><br><span class="line"><span class="comment"># Log Level for sys/event log output.  (See docs for log levels)</span></span><br><span class="line">wrapper.syslog.loglevel=NONE</span><br><span class="line"></span><br><span class="line"><span class="comment">#********************************************************************</span></span><br><span class="line"><span class="comment"># Wrapper Windows Properties</span></span><br><span class="line"><span class="comment">#********************************************************************</span></span><br><span class="line"><span class="comment"># Title to use when running as a console</span></span><br><span class="line">wrapper.console.title=Mycat-server</span><br><span class="line"></span><br><span class="line"><span class="comment">#********************************************************************</span></span><br><span class="line"><span class="comment"># Wrapper Windows NT/2000/XP Service Properties</span></span><br><span class="line"><span class="comment">#********************************************************************</span></span><br><span class="line"><span class="comment"># WARNING - Do not modify any of these properties when an application</span></span><br><span class="line"><span class="comment">#  using this configuration file has been installed as a service.</span></span><br><span class="line"><span class="comment">#  Please uninstall the service before modifying this section.  The</span></span><br><span class="line"><span class="comment">#  service can then be reinstalled.</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># Name of the service</span></span><br><span class="line">wrapper.ntservice.name=mycat</span><br><span class="line"></span><br><span class="line"><span class="comment"># Display name of the service</span></span><br><span class="line">wrapper.ntservice.displayname=Mycat-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># Description of the service</span></span><br><span class="line">wrapper.ntservice.description=The project of Mycat-server</span><br><span class="line"></span><br><span class="line"><span class="comment"># Service dependencies.  Add dependencies as needed starting from 1</span></span><br><span class="line">wrapper.ntservice.dependency.1=</span><br><span class="line"></span><br><span class="line"><span class="comment"># Mode in which the service is installed.  AUTO_START or DEMAND_START</span></span><br><span class="line">wrapper.ntservice.starttype=AUTO_START</span><br><span class="line"></span><br><span class="line"><span class="comment"># Allow the service to interact with the desktop.</span></span><br><span class="line">wrapper.ntservice.interactive=false</span><br><span class="line"></span><br><span class="line">wrapper.ping.timeout=120</span><br><span class="line">configuration.directory.in.classpath.first=conf</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x4FEE;&#x6539;server.xml</strong><br></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- - - Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span></span><br><span class="line"><span class="comment">        - you may not use this file except in compliance with the License. - You</span></span><br><span class="line"><span class="comment">        may obtain a copy of the License at - - http://www.apache.org/licenses/LICENSE-2.0</span></span><br><span class="line"><span class="comment">        - - Unless required by applicable law or agreed to in writing, software -</span></span><br><span class="line"><span class="comment">        distributed under the License is distributed on an &quot;AS IS&quot; BASIS, - WITHOUT</span></span><br><span class="line"><span class="comment">        WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. - See the</span></span><br><span class="line"><span class="comment">        License for the specific language governing permissions and - limitations</span></span><br><span class="line"><span class="comment">        under the License. --&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mycat:server SYSTEM &quot;server.dtd&quot;&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mycat:server</span> <span class="attr">xmlns:mycat</span>=<span class="string">&quot;http://io.mycat/&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">system</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;nonePasswordLogin&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span> <span class="comment">&lt;!-- 0&#x4E3A;&#x9700;&#x8981;&#x5BC6;&#x7801;&#x767B;&#x9646;&#x3001;1&#x4E3A;&#x4E0D;&#x9700;&#x8981;&#x5BC6;&#x7801;&#x767B;&#x9646; ,&#x9ED8;&#x8BA4;&#x4E3A;0&#xFF0C;&#x8BBE;&#x7F6E;&#x4E3A;1&#x5219;&#x9700;&#x8981;&#x6307;&#x5B9A;&#x9ED8;&#x8BA4;&#x8D26;&#x6237;--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;useHandshakeV10&quot;</span>&gt;</span>1<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;useSqlStat&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span>  <span class="comment">&lt;!-- 1&#x4E3A;&#x5F00;&#x542F;&#x5B9E;&#x65F6;&#x7EDF;&#x8BA1;&#x3001;0&#x4E3A;&#x5173;&#x95ED; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;useGlobleTableCheck&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span>  <span class="comment">&lt;!-- 1&#x4E3A;&#x5F00;&#x542F;&#x5168;&#x52A0;&#x73ED;&#x4E00;&#x81F4;&#x6027;&#x68C0;&#x6D4B;&#x3001;0&#x4E3A; &#x5173;&#x95ED; --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sqlExecuteTimeout&quot;</span>&gt;</span>300<span class="tag">&lt;/<span class="name">property</span>&gt;</span>  <span class="comment">&lt;!-- SQL &#x6267;&#x884C;&#x8D85;&#x65F6; &#x5355;&#x4F4D;:&#x79D2;--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sequnceHandlerType&quot;</span>&gt;</span>2<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;property name=&quot;sequnceHandlerPattern&quot;&gt;(?:(\s*next\s+value\s+for\s*MYCATSEQ_(\w+))(,|\)|\s)*)+&lt;/property&gt;--&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&#x5FC5;&#x987B;&#x5E26;&#x6709;MYCATSEQ_&#x6216;&#x8005; mycatseq_&#x8FDB;&#x5165;&#x5E8F;&#x5217;&#x5339;&#x914D;&#x6D41;&#x7A0B; &#x6CE8;&#x610F;MYCATSEQ_&#x6709;&#x7A7A;&#x683C;&#x7684;&#x60C5;&#x51B5;--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;sequnceHandlerPattern&quot;</span>&gt;</span>(?:(\s*next\s+value\s+for\s*MYCATSEQ_(\w+))(,|\)|\s)*)+<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;subqueryRelationshipCheck&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">property</span>&gt;</span> <span class="comment">&lt;!-- &#x5B50;&#x67E5;&#x8BE2;&#x4E2D;&#x5B58;&#x5728;&#x5173;&#x8054;&#x67E5;&#x8BE2;&#x7684;&#x60C5;&#x51B5;&#x4E0B;,&#x68C0;&#x67E5;&#x5173;&#x8054;&#x5B57;&#x6BB5;&#x4E2D;&#x662F;&#x5426;&#x6709;&#x5206;&#x7247;&#x5B57;&#x6BB5; .&#x9ED8;&#x8BA4; false --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--  &lt;property name=&quot;useCompression&quot;&gt;1&lt;/property&gt;--&gt;</span> <span class="comment">&lt;!--1&#x4E3A;&#x5F00;&#x542F;mysql&#x538B;&#x7F29;&#x534F;&#x8BAE;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--  &lt;property name=&quot;fakeMySQLVersion&quot;&gt;5.6.20&lt;/property&gt;--&gt;</span> <span class="comment">&lt;!--&#x8BBE;&#x7F6E;&#x6A21;&#x62DF;&#x7684;MySQL&#x7248;&#x672C; &#x53F7;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- &lt;property name=&quot;processorBufferChunk&quot;&gt;40960&lt;/property&gt; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        &lt;property name=&quot;processors&quot;&gt;1&lt;/property&gt;</span></span><br><span class="line"><span class="comment">        &lt;property name=&quot;processorExecutor&quot;&gt;32&lt;/property&gt;</span></span><br><span class="line"><span class="comment">         --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&#x9ED8;&#x8BA4;&#x4E3A;type 0: DirectByteBufferPool | type 1 ByteBufferArena | type 2 NettyBufferPool --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;processorBufferPoolType&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&#x9ED8;&#x8BA4;&#x662F;65535 64K &#x7528;&#x4E8E;sql&#x89E3;&#x6790;&#x65F6;&#x6700;&#x5927;&#x6587;&#x672C;&#x957F;&#x5EA6; --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;property name=&quot;maxStringLiteralLength&quot;&gt;65535&lt;/property&gt;--&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;property name=&quot;sequnceHandlerType&quot;&gt;0&lt;/property&gt;--&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;property name=&quot;backSocketNoDelay&quot;&gt;1&lt;/property&gt;--&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;property name=&quot;frontSocketNoDelay&quot;&gt;1&lt;/property&gt;--&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;property name=&quot;processorExecutor&quot;&gt;16&lt;/property&gt;--&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                        &lt;property name=&quot;serverPort&quot;&gt;8066&lt;/property&gt; &lt;property name=&quot;managerPort&quot;&gt;9066&lt;/property&gt;</span></span><br><span class="line"><span class="comment">                        &lt;property name=&quot;idleTimeout&quot;&gt;300000&lt;/property&gt; &lt;property name=&quot;bindIp&quot;&gt;0.0.0.0&lt;/property&gt;</span></span><br><span class="line"><span class="comment">                        &lt;property name=&quot;dataNodeIdleCheckPeriod&quot;&gt;300000&lt;/property&gt; 5 * 60 * 1000L; //&#x8FDE;&#x63A5;&#x7A7A;&#x95F2;&#x68C0;&#x67E5;</span></span><br><span class="line"><span class="comment">                        &lt;property name=&quot;frontWriteQueueSize&quot;&gt;4096&lt;/property&gt; &lt;property name=&quot;processors&quot;&gt;32&lt;/property&gt; --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x5F00;&#x5173;&#xFF0C;0&#x4E3A;&#x4E0D;&#x8FC7;&#x6EE4;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#xFF0C;1&#x4E3A;&#x8FC7;&#x6EE4;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#xFF08;&#x5982;&#x679C;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x5185; &#x53EA;&#x6D89;&#x53CA;&#x5168;&#x5C40;&#x8868;&#xFF0C;&#x5219;&#x4E0D;&#x8FC7;&#x6EE4;&#xFF09;&#xFF0C;2&#x4E3A;&#x4E0D;&#x8FC7;&#x6EE4;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;,&#x4F46;&#x662F;&#x8BB0;&#x5F55;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x65E5;&#x5FD7;--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;handleDistributedTransactions&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                        off heap for merge/order/group/limit      1&#x5F00;&#x542F;   0&#x5173;&#x95ED;</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;useOffHeapForMerge&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                        &#x5355;&#x4F4D;&#x4E3A;m</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;memoryPageSize&quot;</span>&gt;</span>64k<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                        &#x5355;&#x4F4D;&#x4E3A;k</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;spillsFileBufferSize&quot;</span>&gt;</span>1k<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;useStreamOutput&quot;</span>&gt;</span>0<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                        &#x5355;&#x4F4D;&#x4E3A;m</span></span><br><span class="line"><span class="comment">                --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;systemReserveMemorySize&quot;</span>&gt;</span>384m<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!--&#x662F;&#x5426;&#x91C7;&#x7528;zookeeper&#x534F;&#x8C03;&#x5207;&#x6362;  --&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;useZKSwitch&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- XA Recovery Log&#x65E5;&#x5FD7;&#x8DEF;&#x5F84; --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;property name=&quot;XARecoveryLogBaseDir&quot;&gt;./&lt;/property&gt;--&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- XA Recovery Log&#x65E5;&#x5FD7;&#x540D;&#x79F0; --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&lt;property name=&quot;XARecoveryLogBaseName&quot;&gt;tmlog&lt;/property&gt;--&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--&#x5982;&#x679C;&#x4E3A; true&#x7684;&#x8BDD; &#x4E25;&#x683C;&#x9075;&#x5B88;&#x9694;&#x79BB;&#x7EA7;&#x522B;,&#x4E0D;&#x4F1A;&#x5728;&#x4EC5;&#x4EC5;&#x53EA;&#x6709;select&#x8BED;&#x53E5;&#x7684;&#x65F6;&#x5019;&#x5728;&#x4E8B;&#x52A1;&#x4E2D;&#x5207;&#x6362;&#x8FDE;&#x63A5;--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;strictTxIsolation&quot;</span>&gt;</span>false<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;useZKSwitch&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">system</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- &#x5168;&#x5C40;SQL&#x9632;&#x706B;&#x5899;&#x8BBE;&#x7F6E; --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&#x767D;&#x540D;&#x5355;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x901A;&#x914D;&#x7B26;%&#x6216;&#x7740;*--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&#x4F8B;&#x5982;&lt;host host=&quot;127.0.0.*&quot; user=&quot;root&quot;/&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&#x4F8B;&#x5982;&lt;host host=&quot;127.0.*&quot; user=&quot;root&quot;/&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&#x4F8B;&#x5982;&lt;host host=&quot;127.*&quot; user=&quot;root&quot;/&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&#x4F8B;&#x5982;&lt;host host=&quot;1*7.*&quot; user=&quot;root&quot;/&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&#x8FD9;&#x4E9B;&#x914D;&#x7F6E;&#x60C5;&#x51B5;&#x4E0B;&#x5BF9;&#x4E8E;127.0.0.1&#x90FD;&#x80FD;&#x4EE5;root&#x8D26;&#x6237;&#x767B;&#x5F55;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">        &lt;firewall&gt;</span></span><br><span class="line"><span class="comment">           &lt;whitehost&gt;</span></span><br><span class="line"><span class="comment">              &lt;host host=&quot;1*7.0.0.*&quot; user=&quot;root&quot;/&gt;</span></span><br><span class="line"><span class="comment">           &lt;/whitehost&gt;</span></span><br><span class="line"><span class="comment">       &lt;blacklist check=&quot;false&quot;&gt;</span></span><br><span class="line"><span class="comment">       &lt;/blacklist&gt;</span></span><br><span class="line"><span class="comment">        &lt;/firewall&gt;</span></span><br><span class="line"><span class="comment">        --&gt;</span></span><br><span class="line">		<span class="comment">&lt;!-- fnaichu:&#x4FEE;&#x6539;&#x76F8;&#x5173;&#x6570;&#x636E;&#x5E93;&#x914D;&#x7F6E;&#xFF1A; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">&quot;root&quot;</span> <span class="attr">defaultAccount</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>ccc.456<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;schemas&quot;</span>&gt;</span>ha<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">&lt;!-- &#x8868;&#x7EA7; DML &#x6743;&#x9650;&#x8BBE;&#x7F6E; --&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">                &lt;privileges check=&quot;false&quot;&gt;</span></span><br><span class="line"><span class="comment">                        &lt;schema name=&quot;TESTDB&quot; dml=&quot;0110&quot; &gt;</span></span><br><span class="line"><span class="comment">                                &lt;table name=&quot;tb01&quot; dml=&quot;0000&quot;&gt;&lt;/table&gt;</span></span><br><span class="line"><span class="comment">                                &lt;table name=&quot;tb02&quot; dml=&quot;1111&quot;&gt;&lt;/table&gt;</span></span><br><span class="line"><span class="comment">                        &lt;/schema&gt;</span></span><br><span class="line"><span class="comment">                &lt;/privileges&gt;</span></span><br><span class="line"><span class="comment">                 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"></span><br><span class="line">		<span class="comment">&lt;!-- fnaichu:&#x4FEE;&#x6539;&#x8FD9;&#x91CC; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">user</span> <span class="attr">name</span>=<span class="string">&quot;user&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span>&gt;</span>user<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;schemas&quot;</span>&gt;</span>ha<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;readOnly&quot;</span>&gt;</span>true<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">mycat:server</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x4FEE;&#x6539;schema.xml</strong><br></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE mycat:schema SYSTEM &quot;schema.dtd&quot;&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mycat:schema</span> <span class="attr">xmlns:mycat</span>=<span class="string">&quot;http://io.mycat/&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">schema</span> <span class="attr">name</span>=<span class="string">&quot;ha&quot;</span> <span class="attr">checkSQLschema</span>=<span class="string">&quot;false&quot;</span> <span class="attr">sqlMaxLimit</span>=<span class="string">&quot;100&quot;</span> <span class="attr">dataNode</span>=<span class="string">&apos;dn1&apos;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">schema</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataNode</span> <span class="attr">name</span>=<span class="string">&quot;dn1&quot;</span> <span class="attr">dataHost</span>=<span class="string">&quot;dthost&quot;</span> <span class="attr">database</span>=<span class="string">&quot;ha&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dataHost</span> <span class="attr">name</span>=<span class="string">&quot;dthost&quot;</span> <span class="attr">maxCon</span>=<span class="string">&quot;500&quot;</span> <span class="attr">minCon</span>=<span class="string">&quot;10&quot;</span> <span class="attr">balance</span>=<span class="string">&quot;3&quot;</span> <span class="attr">writeType</span>=<span class="string">&quot;0&quot;</span> <span class="attr">dbType</span>=<span class="string">&quot;mysql&quot;</span> <span class="attr">dbDriver</span>=<span class="string">&quot;native&quot;</span> <span class="attr">switchType</span>=<span class="string">&quot;1&quot;</span> <span class="attr">slaveThreshold</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">heartbeat</span>&gt;</span>select user()<span class="tag">&lt;/<span class="name">heartbeat</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">writeHost</span> <span class="attr">host</span>=<span class="string">&quot;rhel7&quot;</span> <span class="attr">url</span>=<span class="string">&quot;192.168.73.21:3306&quot;</span> <span class="attr">user</span>=<span class="string">&quot;root&quot;</span> <span class="attr">password</span>=<span class="string">&quot;ccc.456&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">readHost</span> <span class="attr">host</span>=<span class="string">&quot;rhel_sqlsrv&quot;</span> <span class="attr">url</span>=<span class="string">&quot;192.168.73.22:3306&quot;</span> <span class="attr">user</span>=<span class="string">&quot;root&quot;</span> <span class="attr">password</span>=<span class="string">&quot;ccc.456&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">writeHost</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dataHost</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mycat:schema</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x4FEE;&#x6539;log4j2.xml&#x6587;&#x4EF6;</strong><br></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Configuration</span> <span class="attr">status</span>=<span class="string">&quot;WARN&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Appenders</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Console</span> <span class="attr">name</span>=<span class="string">&quot;Console&quot;</span> <span class="attr">target</span>=<span class="string">&quot;SYSTEM_OUT&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">PatternLayout</span> <span class="attr">pattern</span>=<span class="string">&quot;%d [%-5p][%t] %m %throwable{full} (%C:%F:%L) %n&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Console</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">RollingFile</span> <span class="attr">name</span>=<span class="string">&quot;RollingFile&quot;</span> <span class="attr">fileName</span>=<span class="string">&quot;${sys:MYCAT_HOME}/logs/mycat.log&quot;</span></span></span><br><span class="line"><span class="tag">                     <span class="attr">filePattern</span>=<span class="string">&quot;${sys:MYCAT_HOME}/logs/$${date:yyyy-MM}/mycat-%d{MM-dd}-%i.log.gz&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">PatternLayout</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Pattern</span>&gt;</span>%d{yyyy-MM-dd HH:mm:ss.SSS} %5p [%t] (%l) - %m%n<span class="tag">&lt;/<span class="name">Pattern</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">PatternLayout</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">Policies</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">OnStartupTriggeringPolicy</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">SizeBasedTriggeringPolicy</span> <span class="attr">size</span>=<span class="string">&quot;250 MB&quot;</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">TimeBasedTriggeringPolicy</span>/&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">Policies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">RollingFile</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Appenders</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">Loggers</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;AsyncLogger name=&quot;io.mycat&quot; level=&quot;info&quot; includeLocation=&quot;true&quot; additivity=&quot;false&quot;&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;AppenderRef ref=&quot;Console&quot;/&gt;--&gt;</span></span><br><span class="line">            <span class="comment">&lt;!--&lt;AppenderRef ref=&quot;RollingFile&quot;/&gt;--&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--&lt;/AsyncLogger&gt;--&gt;</span></span><br><span class="line">		</span><br><span class="line">		<span class="comment">&lt;!-- fnaichu:&#x8C03;&#x6574;&#x65E5;&#x5FD7;&#x7EA7;&#x522B; --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">asyncRoot</span> <span class="attr">level</span>=<span class="string">&quot;debug&quot;</span> <span class="attr">includeLocation</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">&lt;!--&lt;AppenderRef ref=&quot;Console&quot; /&gt;--&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">AppenderRef</span> <span class="attr">ref</span>=<span class="string">&quot;RollingFile&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;/<span class="name">asyncRoot</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">Loggers</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Configuration</span>&gt;</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="&#x6D4B;&#x8BD5;&#x8BFB;&#x5199;&#x5206;&#x79BB;"><a href="#&#x6D4B;&#x8BD5;&#x8BFB;&#x5199;&#x5206;&#x79BB;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x8BFB;&#x5199;&#x5206;&#x79BB;"></a>&#x6D4B;&#x8BD5;&#x8BFB;&#x5199;&#x5206;&#x79BB;</h2><p>&#x76EE;&#x524D;MyCAT&#x6709;&#x4E24;&#x4E2A;&#x7AEF;&#x53E3;&#xFF0C;8066&#x6570;&#x636E;&#x7AEF;&#x53E3;&#xFF0C;9066&#x7BA1;&#x7406;&#x7AEF;&#x53E3;&#xFF0C;&#x6D4B;&#x8BD5;&#x8BFB;&#x5199;&#x64CD;&#x4F5C;&#x7528;8066&#x6570;&#x636E;&#x7AEF;&#x53E3;</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; netstat -pantul | grep 66</span><br><span class="line">tcp6       0      0 :::46667                :::*                    LISTEN      4136/java</span><br><span class="line"></span><br><span class="line">tcp6       0      0 :::8066                 :::*                    LISTEN      4136/java</span><br><span class="line"></span><br><span class="line">tcp6       0      0 :::9066                 :::*                    LISTEN      4136/java</span><br><span class="line"></span><br><span class="line">[root@ctos7mini ~]#</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]<span class="comment"># mysql -uroot -pccc.456 -h192.168.73.20 -P8066</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 5</span><br><span class="line">Server version: 5.6.29-mycat-1.6.7.3-<span class="keyword">release</span><span class="number">-20190927161129</span> MyCat <span class="keyword">Server</span> (OpenCloudDB)</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">2000</span>, <span class="number">2018</span>, <span class="keyword">Oracle</span> <span class="keyword">and</span>/<span class="keyword">or</span> its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Oracle</span> <span class="keyword">is</span> a registered trademark <span class="keyword">of</span> <span class="keyword">Oracle</span> Corporation <span class="keyword">and</span>/<span class="keyword">or</span> its</span><br><span class="line">affiliates. Other <span class="keyword">names</span> may be trademarks <span class="keyword">of</span> their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Type</span> <span class="string">&apos;help;&apos;</span> <span class="keyword">or</span> <span class="string">&apos;\h&apos;</span> <span class="keyword">for</span> help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">| DATABASE |</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">| ha       |</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[root@ctos7mini ~]<span class="comment"># mysql -uroot -pccc.456 -h192.168.73.20 -P9066</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 4</span><br><span class="line">Server version: 5.6.29-mycat-1.6.7.3-<span class="keyword">release</span><span class="number">-20190927161129</span> MyCat <span class="keyword">Server</span> (monitor)</span><br><span class="line"></span><br><span class="line">Copyright (c) <span class="number">2000</span>, <span class="number">2018</span>, <span class="keyword">Oracle</span> <span class="keyword">and</span>/<span class="keyword">or</span> its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Oracle</span> <span class="keyword">is</span> a registered trademark <span class="keyword">of</span> <span class="keyword">Oracle</span> Corporation <span class="keyword">and</span>/<span class="keyword">or</span> its</span><br><span class="line">affiliates. Other <span class="keyword">names</span> may be trademarks <span class="keyword">of</span> their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line"><span class="keyword">Type</span> <span class="string">&apos;help;&apos;</span> <span class="keyword">or</span> <span class="string">&apos;\h&apos;</span> <span class="keyword">for</span> help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">| DATABASE |</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">| ha       |</span><br><span class="line">+<span class="comment">----------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x89C2;&#x5BDF;&#x65E5;&#x5FD7;&#x53D8;&#x5316;</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f /usr/local/mycat/logs/mycat.log</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">2022-05-08 01:19:04.198 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.server.NonBlockingSession.releaseConnection(NonBlockingSession.java:386)) - release connection MySQLConnection [id=11, lastTime=1651943944189, user=root, schema=ha, old shema=ha, borrowed=true, fromSlaveDB=true, threadId=15, charset=utf8, txIsolation=3, autocommit=true, attachment=dn1{select * from test}, respHandler=SingleNodeHandler [node=dn1{select * from test}, packetId=6], host=192.168.73.22, port=3306, statusSync=null, writeQueue=0, modifiedSQLExecuted=false]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2022-05-08 01:22:56.420 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.server.NonBlockingSession.releaseConnection(NonBlockingSession.java:386)) - release connection MySQLConnection [id=10, lastTime=1651944176407, user=root, schema=ha, old shema=ha, borrowed=true, fromSlaveDB=false, threadId=23, charset=utf8, txIsolation=3, autocommit=true, attachment=dn1{insert into test values (2,&apos;superman&apos;)}, respHandler=SingleNodeHandler [node=dn1{insert into test values (2,&apos;superman&apos;)}, packetId=1], host=192.168.73.21, port=3306, statusSync=null, writeQueue=0, modifiedSQLExecuted=true]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">2022-05-08 01:36:04.542 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.server.NonBlockingSession.execute(NonBlockingSession.java:126)) - ServerConnection [id=3, schema=ha, host=192.168.73.20, user=root,txIsolation=3, autocommit=true, schema=ha, executeSql=insert into test values (2,&apos;superman&apos;)]insert into test values (2,&apos;superman&apos;), route={</span><br><span class="line">   1 -&gt; dn1{insert into test values (2,&apos;superman&apos;)}</span><br><span class="line">} rrs</span><br><span class="line">2022-05-08 01:36:04.542 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.backend.mysql.nio.handler.SingleNodeHandler.execute(SingleNodeHandler.java:170)) - rrs.getRunOnSlave() default</span><br><span class="line">2022-05-08 01:36:04.542 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.backend.mysql.nio.handler.SingleNodeHandler.execute(SingleNodeHandler.java:172)) - node.getRunOnSlave()  default</span><br><span class="line">2022-05-08 01:36:04.542 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.backend.mysql.nio.handler.SingleNodeHandler.execute(SingleNodeHandler.java:182)) - node.getRunOnSlave() null</span><br><span class="line">2022-05-08 01:36:04.542 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.backend.mysql.nio.handler.SingleNodeHandler.execute(SingleNodeHandler.java:184)) - node.getRunOnSlave() null</span><br><span class="line">2022-05-08 01:36:04.542 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.backend.datasource.PhysicalDBNode.getConnection(PhysicalDBNode.java:102)) - rrs.getRunOnSlave()  default</span><br><span class="line">2022-05-08 01:36:04.542 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.backend.datasource.PhysicalDBNode.getConnection(PhysicalDBNode.java:133)) - rrs.getRunOnSlave()  default</span><br><span class="line">2022-05-08 01:36:04.554 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.server.NonBlockingSession.releaseConnection(NonBlockingSession.java:386)) - release connection MySQLConnection [id=10, lastTime=1651944964528, user=root, schema=ha, old shema=ha, borrowed=true, fromSlaveDB=false, threadId=23, charset=utf8, txIsolation=3, autocommit=true, attachment=dn1{insert into test values (2,&apos;superman&apos;)}, respHandler=SingleNodeHandler [node=dn1{insert into test values (2,&apos;superman&apos;)}, packetId=1], host=192.168.73.21, port=3306, statusSync=null, writeQueue=0, modifiedSQLExecuted=true]</span><br><span class="line">2022-05-08 01:36:04.554 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.backend.datasource.PhysicalDatasource.releaseChannel(PhysicalDatasource.java:633)) - release channel MySQLConnection [id=10, lastTime=1651944964528, user=root, schema=ha, old shema=ha, borrowed=true, fromSlaveDB=false, threadId=23, charset=utf8, txIsolation=3, autocommit=true, attachment=null, respHandler=null, host=192.168.73.21, port=3306, statusSync=null, writeQueue=0, modifiedSQLExecuted=false]</span><br><span class="line"></span><br><span class="line">2022-05-08 01:36:40.600 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.backend.datasource.PhysicalDBPool.getRWBanlanceCon(PhysicalDBPool.java:551)) - select read source rhel_sqlsrv for dataHost:dthost</span><br><span class="line">2022-05-08 01:36:40.601 DEBUG [$_NIOREACTOR-0-RW] (io.mycat.server.NonBlockingSession.releaseConnection(NonBlockingSession.java:386)) - release connection MySQLConnection [id=17, lastTime=1651945000587, user=root, schema=ha, old shema=ha, borrowed=true, fromSlaveDB=true, threadId=20, charset=utf8, txIsolation=3, autocommit=true, attachment=dn1{select * from test}, respHandler=SingleNodeHandler [node=dn1{select * from test}, packetId=10], host=192.168.73.22, port=3306, statusSync=null, writeQueue=0, modifiedSQLExecuted=false]</span><br><span class="line"></span><br><span class="line">2022-05-08 01:53:32.188 DEBUG [Timer0] (io.mycat.sqlengine.SQLJob.connectionAcquired(SQLJob.java:89)) - con query sql:select user() to con:MySQLConnection [id=1, lastTime=1651946012188, user=root, schema=ha, old shema=ha, borrowed=true, fromSlaveDB=false, threadId=22, charset=utf8, txIsolation=3, autocommit=true, attachment=null, respHandler=null, host=192.168.73.21, port=3306, statusSync=null, writeQueue=0, modifiedSQLExecuted=false]</span><br><span class="line">2022-05-08 01:53:32.188 DEBUG [Timer0] (io.mycat.sqlengine.SQLJob.connectionAcquired(SQLJob.java:89)) - con query sql:select user() to con:MySQLConnection [id=14, lastTime=1651946012188, user=root, schema=ha, old shema=ha, borrowed=true, fromSlaveDB=true, threadId=18, charset=utf8, txIsolation=3, autocommit=true, attachment=null, respHandler=null, host=192.168.73.22, port=3306, statusSync=null, writeQueue=0, modifiedSQLExecuted=false]</span><br></pre></td></tr></tbody></table></figure>
<p>&#x8BFB;&#x64CD;&#x4F5C;&#x662F;&#x5728;Slave 192.168.73.22&#x4E0A;&#x8FDB;&#x884C;&#x7684;</p>
<p>&#x5199;&#x64CD;&#x4F5C;&#x662F;&#x5728;Master 192.168.73.21&#x4E0A;&#x8FDB;&#x884C;&#x7684;</p>
<h2 id="&#x66FF;&#x6362;log4j"><a href="#&#x66FF;&#x6362;log4j" class="headerlink" title="&#x66FF;&#x6362;log4j"></a>&#x66FF;&#x6362;log4j</h2><p>&#x53C2;&#x8003;&#xFF1A;<a href="https://www.yuque.com/ccazhw/tuacvk/doq6pc" target="_blank" rel="noopener">https://www.yuque.com/ccazhw/tuacvk/doq6pc</a></p>
<p>log4j-2.15-jar&#x5305;&#xFF0C;&#x66FF;&#x6362;&#x5373;&#x53EF;&#xFF0C;&#x6700;&#x65B0;&#x7684;log4j&#x7684;jar&#x8BF7;&#x5230;&#x963F;&#x91CC;&#x4E91;maven&#x4ED3;&#x5E93;&#x4E0B;&#x8F7D;</p>
<ol>
<li>&#x66FF;&#x6362;log4j&#x4E3A;log4j-1.15,1.15&#x524D;&#x7684;&#x7248;&#x672C;&#x6709;&#x6F0F;&#x6D1E;<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mycat]&amp; ll ./lib/log4j*</span><br><span class="line">-rwxrwxrwx. 1 mycat mycat  489884 Sep 27  2019 ./lib/log4j-1.2.17.jar</span><br><span class="line">-rwxrwxrwx. 1 mycat mycat   36947 Sep 27  2019 ./lib/log4j-1.2-api-2.5.jar</span><br><span class="line">-rwxrwxrwx. 1 mycat mycat  146761 Sep 27  2019 ./lib/log4j-api-2.5.jar</span><br><span class="line">-rwxrwxrwx. 1 mycat mycat 1106090 Sep 27  2019 ./lib/log4j-core-2.5.jar</span><br><span class="line">-rwxrwxrwx. 1 mycat mycat   22935 Sep 27  2019 ./lib/log4j-slf4j-impl-2.5.jar</span><br><span class="line">[root@ctos7mini mycat]#</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>&#x5220;&#x6389;<code>log4j-1.2.17.jar</code>&#xFF0C;<br>&#x66FF;&#x6362;lib&#x6587;&#x4EF6;&#x5939;&#x4E0A;&#x8FF0;&#x7684;4&#x4E2A;&#x6587;&#x4EF6;,&#x66FF;&#x6362;&#x4E3A;&#x4E0B;&#x9762;4&#x4E2A;&#x6587;&#x4EF6; </p>
<p>&#x5B83;&#x4EEC;&#x7684;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#x662F;<br><a href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-1.2-api" target="_blank" rel="noopener">https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-1.2-api</a><br><a href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-api" target="_blank" rel="noopener">https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-api</a><br><a href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core" target="_blank" rel="noopener">https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-core</a><br><a href="https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-slf4j-impl" target="_blank" rel="noopener">https://mvnrepository.com/artifact/org.apache.logging.log4j/log4j-slf4j-impl</a>  </p>
<p>&#x8FD9;&#x662F;&#x7F13;&#x5B58;&#x4E0B;&#x6765;&#x7684;&#x6253;&#x5305;&#x597D;&#x7684;,&#x4E0D;&#x4FDD;&#x8BC1;&#x6700;&#x65B0;<br><a href="http://dl.mycat.org.cn/1.6.7.6/20211221142218/log4j-2.17.zip" target="_blank" rel="noopener">http://dl.mycat.org.cn/1.6.7.6/20211221142218/log4j-2.17.zip</a></p>
<h2 id="MyCat&#x6545;&#x969C;&#x89E3;&#x51B3;"><a href="#MyCat&#x6545;&#x969C;&#x89E3;&#x51B3;" class="headerlink" title="MyCat&#x6545;&#x969C;&#x89E3;&#x51B3;"></a>MyCat&#x6545;&#x969C;&#x89E3;&#x51B3;</h2><script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/490925f2/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-Atlas实现MySQL读写分离" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/62ec7971/">Atlas实现MySQL读写分离</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:45:45" datetime="2022-06-07T04:45:45.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h2 id="MySQL-Atlas-&#x2014;-&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x5B9E;&#x6218;"><a href="#MySQL-Atlas-&#x2014;-&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x5B9E;&#x6218;" class="headerlink" title="MySQL + Atlas &#x2014; &#x8BFB;&#x5199;&#x5206;&#x79BB;&#x5B9E;&#x6218;"></a>MySQL + Atlas &#x2014; &#x8BFB;&#x5199;&#x5206;&#x79BB;&#x5B9E;&#x6218;</h2><ol>
<li>&#x6570;&#x636E;&#x5E93;&#x7528;&#x6237;&#x914D;&#x7F6E;</li>
<li>&#x4E3B;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x914D;&#x7F6E;</li>
<li>Atlas&#x914D;&#x7F6E;</li>
<li>&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;</li>
</ol>
<p><strong>&#x5E8F;&#x7AE0;</strong><br>Atlas&#x662F;360&#x56E2;&#x961F;&#x5F04;&#x51FA;&#x6765;&#x7684;&#x4E00;&#x5957;&#x57FA;&#x4E8E;MySQL-Proxy&#x57FA;&#x7840;&#x4E4B;&#x4E0A;&#x7684;&#x4EE3;&#x7406;&#xFF0C;&#x4FEE;&#x6539;&#x4E86;MySQL-Proxy&#x7684;&#x4E00;&#x4E9B;BUG&#xFF0C;&#x5E76;&#x4E14;&#x4F18;&#x5316;&#x4E86;&#x5F88;&#x591A;&#x4E1C;&#x897F;&#x3002;&#x800C;&#x4E14;&#x5B89;&#x88C5;&#x65B9;&#x4FBF;&#x3002;&#x914D;&#x7F6E;&#x7684;&#x6CE8;&#x91CA;&#x5F88;&#x8BE6;&#x7EC6;&#xFF0C;&#x90FD;&#x662F;&#x4E2D;&#x6587;&#x3002;&#x82F1;&#x6587;&#x4E0D;&#x597D;&#x7684;&#x540C;&#x5B66;&#x6709;&#x798F;&#x4E86;&#x3002;<br>Atlas&#x5B98;&#x65B9;&#x94FE;&#x63A5;&#xFF1A; <a href="https://github.com/Qihoo360/Atlas/blob/master/README_ZH.md" target="_blank" rel="noopener">https://github.com/Qihoo360/Atlas/blob/master/README_ZH.md</a><br>Atlas&#x4E0B;&#x8F7D;&#x94FE;&#x63A5;&#xFF1A; <a href="https://github.com/Qihoo360/Atlas/releases" target="_blank" rel="noopener">https://github.com/Qihoo360/Atlas/releases</a>  </p>
<p>&#x73AF;&#x5883;&#xFF1A;</p>
<table>
<thead>
<tr>
<th>&#x7CFB;&#x7EDF;</th>
<th>IP</th>
<th>&#x89D2;&#x8272;</th>
</tr>
</thead>
<tbody>
<tr>
<td>CentOS7.4</td>
<td>192.168.73.20</td>
<td>Atlas&#x4EE3;&#x7406;&#x670D;&#x52A1;</td>
</tr>
<tr>
<td>RHEL 7.3</td>
<td>192.168.73.21</td>
<td>MySQL_Master</td>
</tr>
<tr>
<td>RHEL 7.3</td>
<td>192.168.73.22</td>
<td>MySQL_Slave</td>
</tr>
</tbody>
</table>
<p><strong>&#x6CE8;&#x610F;&#xFF1A;</strong>&#x4E09;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x90FD;&#x8981;&#x5B89;&#x88C5;MySQL&#x6570;&#x636E;&#xFF01;</p>
<h2 id="MySQL-Master"><a href="#MySQL-Master" class="headerlink" title="MySQL Master"></a>MySQL Master</h2><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">datadir</span>=/var/lib/mysql</span><br><span class="line"><span class="attr">socket</span>=/var/lib/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line"><span class="attr">symbolic-links</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-error</span>=/var/log/mysqld.log</span><br><span class="line"><span class="attr">pid-file</span>=/var/run/mysqld/mysqld.pid</span><br><span class="line"></span><br><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">user</span>=mysql</span><br><span class="line"></span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">sync_binlog</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">log-bin</span>=mysql-bin</span><br><span class="line"><span class="attr">server-id</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">binlog-do-db</span>=testdb</span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line">skip-name-resolve</span><br><span class="line"></span><br><span class="line"><span class="attr">general_log</span>=<span class="literal">ON</span></span><br><span class="line"><span class="attr">general_log_file</span>= /var/lib/mysql/rhel_sqlsrv.log</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> testdb <span class="keyword">DEFAULT</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"></span><br><span class="line">mysql&gt; grant replication slave on *.* to root@&apos;%&apos; identified by &apos;ccc.456&apos;;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select user,host from mysql.user;</span><br><span class="line">+<span class="comment">---------------+--------------+</span></span><br><span class="line">| user          | host         |</span><br><span class="line">+<span class="comment">---------------+--------------+</span></span><br><span class="line">| root          | %            |</span><br><span class="line">| slave         | 192.168.73.% |</span><br><span class="line">| mysql.session | localhost    |</span><br><span class="line">| mysql.sys     | localhost    |</span><br><span class="line">| root          | localhost    |</span><br><span class="line">+<span class="comment">---------------+--------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">master</span> <span class="keyword">status</span>;</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| mysql-bin.000003 |     1605 | testdb       | mysql            |                   |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; mysqldump -uroot -p -B testdb &gt; testdb.sql</span><br><span class="line">Enter password:</span><br><span class="line">[root@rhel7 ~]&amp; ls</span><br><span class="line">anaconda-ks.cfg  ha.sql  mysql_master_ha  rpm_mysql5.7  testdb.sql</span><br><span class="line">[root@rhel7 ~]&amp; scp testdb.sql root@192.168.73.22:~</span><br><span class="line">testdb.sql                                                 100% 2126     2.1KB/s   00:00</span><br><span class="line">[root@rhel7 ~]&amp;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="MySQL-Slave"><a href="#MySQL-Slave" class="headerlink" title="MySQL Slave"></a>MySQL Slave</h2><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">datadir</span>=/var/lib/mysql</span><br><span class="line"><span class="attr">socket</span>=/var/lib/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line"><span class="attr">symbolic-links</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-error</span>=/var/log/mysqld.log</span><br><span class="line"><span class="attr">pid-file</span>=/var/run/mysqld/mysqld.pid</span><br><span class="line"></span><br><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-bin</span>=mysql-slave2</span><br><span class="line"><span class="attr">server-id</span>=<span class="number">3</span></span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line"><span class="attr">log_slave_updates</span>=<span class="number">1</span></span><br><span class="line">skip-name-resolve</span><br><span class="line"><span class="attr">general_log</span>=<span class="literal">ON</span></span><br><span class="line"><span class="attr">general_log_file</span>=/var/lib/mysql/rhel_sqlsrv.log</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; change master to master_host=&apos;192.168.73.21&apos;, master_user=&apos;root&apos;,master_password=&apos;ccc.456&apos;,master_port=3306,master_log_file=&apos;mysql-bin.000003&apos;,master_log_pos=1605,master_connect_retry=10;</span><br><span class="line">Query OK, 0 rows affected, 2 warnings (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; start slave;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 192.168.73.21</span><br><span class="line">                  Master_User: root</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 10</span><br><span class="line">              Master_Log_File: mysql-bin.000003</span><br><span class="line">          Read_Master_Log_Pos: 1605</span><br><span class="line">               Relay_Log_File: rhel_sqlsrv-relay-bin.000002</span><br><span class="line">                Relay_Log_Pos: 320</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000003</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB:</span><br><span class="line">.........................................&#x7701;&#x7565;...................................................................</span><br><span class="line">             Master_Server_Id: 1</span><br><span class="line">                  Master_UUID: 8f5a42da-cd2d-11ec-8c02-000c29f9275c</span><br><span class="line">             Master_Info_File: /var/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind:</span><br><span class="line">.........................................&#x7701;&#x7565;...................................................................</span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel_sqlsrv ~]&amp; mysql -uroot -p &lt; testdb.sql</span><br><span class="line">Enter password:</span><br><span class="line">[root@rhel_sqlsrv ~]&amp;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;"><a href="#&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;"></a>&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;</h2><p><strong>Master</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Database changed</span><br><span class="line">mysql&gt; insert into book values(&apos;abc&apos;,123,456);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>Slave</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">| Linux                   |    66 |   666 |</span><br><span class="line">| Unix                    |    77 |   777 |</span><br><span class="line">| abc                     |   123 |   456 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="Atlas&#x914D;&#x7F6E;"><a href="#Atlas&#x914D;&#x7F6E;" class="headerlink" title="Atlas&#x914D;&#x7F6E;"></a>Atlas&#x914D;&#x7F6E;</h2><p><strong>&#x5B89;&#x88C5;Atlas</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; rpm -ivh Atlas-2.2.1.el6.x86_64.rpm</span><br><span class="line">Preparing...                          ################################# [100%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:Atlas-2.2.1-1                    ################################# [100%]</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; ll /usr/local/mysql-proxy/ -R</span><br><span class="line">/usr/local/mysql-proxy/:</span><br><span class="line">total 4</span><br><span class="line">drwxr-xr-x. 2 root root   75 May  7 04:33 bin</span><br><span class="line">drwxr-xr-x. 2 root root   22 May  7 04:33 conf</span><br><span class="line">drwxr-xr-x. 3 root root 4096 May  7 04:33 lib</span><br><span class="line">drwxr-xr-x. 2 root root    6 Dec 17  2014 log</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/bin:</span><br><span class="line">total 44</span><br><span class="line">-rwxr-xr-x. 1 root root  9696 Dec 17  2014 encrypt</span><br><span class="line">-rwxr-xr-x. 1 root root 23564 Dec 17  2014 mysql-proxy</span><br><span class="line">-rwxr-xr-x. 1 root root  1552 Dec 17  2014 mysql-proxyd</span><br><span class="line">-rw-r--r--. 1 root root     6 Dec 17  2014 VERSION</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/conf:</span><br><span class="line">total 4</span><br><span class="line">-rw-r--r--. 1 root root 2810 Dec 17  2014 test.cnf</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/lib:</span><br><span class="line">total 9812</span><br><span class="line">-rwxr-xr-x. 1 root root  968655 Dec 17  2014 libevent-2.0.so.5</span><br><span class="line">-rwxr-xr-x. 1 root root 3464668 Dec 17  2014 libglib-2.0.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root   35483 Dec 17  2014 libgmodule-2.0.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root    8656 Dec 17  2014 libgthread-2.0.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root 5021619 Dec 17  2014 libjemalloc.so.1</span><br><span class="line">-rwxr-xr-x. 1 root root  172984 Dec 17  2014 liblua-5.1.so</span><br><span class="line">-rwxr-xr-x. 1 root root   14735 Dec 17  2014 libmysql-chassis-glibext.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root   73823 Dec 17  2014 libmysql-chassis.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root   14446 Dec 17  2014 libmysql-chassis-timing.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root  180107 Dec 17  2014 libmysql-proxy.so.0</span><br><span class="line">-rwxr-xr-x. 1 root root   71566 Dec 17  2014 libsql-tokenizer.so.0</span><br><span class="line">drwxr-xr-x. 4 root root      32 May  7 04:33 mysql-proxy</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/lib/mysql-proxy:</span><br><span class="line">total 0</span><br><span class="line">drwxr-xr-x. 3 root root 162 May  7 04:33 lua</span><br><span class="line">drwxr-xr-x. 2 root root  44 May  7 04:33 plugins</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/lib/mysql-proxy/lua:</span><br><span class="line">total 240</span><br><span class="line">-rw-r--r--. 1 root root   9387 Dec 17  2014 admin.lua</span><br><span class="line">-rwxr-xr-x. 1 root root  15966 Dec 17  2014 chassis.so</span><br><span class="line">-rwxr-xr-x. 1 root root   8988 Dec 17  2014 crc32.so</span><br><span class="line">-rwxr-xr-x. 1 root root   9416 Dec 17  2014 glib2.so</span><br><span class="line">-rwxr-xr-x. 1 root root  18323 Dec 17  2014 lfs.so</span><br><span class="line">-rwxr-xr-x. 1 root root  43879 Dec 17  2014 lpeg.so</span><br><span class="line">-rwxr-xr-x. 1 root root 102944 Dec 17  2014 mysql.so</span><br><span class="line">-rwxr-xr-x. 1 root root   9248 Dec 17  2014 posix.so</span><br><span class="line">drwxr-xr-x. 2 root root    243 May  7 04:33 proxy</span><br><span class="line">-rwxr-xr-x. 1 root root   6626 Dec 17  2014 time.so</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/lib/mysql-proxy/lua/proxy:</span><br><span class="line">total 80</span><br><span class="line">-rw-r--r--. 1 root root   536 Dec 17  2014 auth.lua</span><br><span class="line">-rw-r--r--. 1 root root  6670 Dec 17  2014 auto-config.lua</span><br><span class="line">-rw-r--r--. 1 root root  2807 Dec 17  2014 balance.lua</span><br><span class="line">-rw-r--r--. 1 root root  2873 Dec 17  2014 charset.lua</span><br><span class="line">-rw-r--r--. 1 root root  3477 Dec 17  2014 commands.lua</span><br><span class="line">-rw-r--r--. 1 root root   238 Dec 17  2014 crc32.lua</span><br><span class="line">-rw-r--r--. 1 root root  1906 Dec 17  2014 filter.lua</span><br><span class="line">-rw-r--r--. 1 root root  2706 Dec 17  2014 log.lua</span><br><span class="line">-rw-r--r--. 1 root root  6105 Dec 17  2014 parser.lua</span><br><span class="line">-rw-r--r--. 1 root root 14816 Dec 17  2014 split.lua</span><br><span class="line">-rw-r--r--. 1 root root  6366 Dec 17  2014 test.lua</span><br><span class="line">-rw-r--r--. 1 root root   106 Dec 17  2014 ticker.lua</span><br><span class="line">-rw-r--r--. 1 root root  6215 Dec 17  2014 tokenizer.lua</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#&#x65E5;&#x5FD7;&#x7EA7;&#x522B;&#xFF0C;&#x5206;&#x4E3A;message&#x3001;warning&#x3001;critical&#x3001;error&#x3001;debug&#x4E94;&#x4E2A;&#x7EA7;&#x522B;</span><br><span class="line">/usr/local/mysql-proxy/lib/mysql-proxy/plugins:</span><br><span class="line">total 4920</span><br><span class="line">-rwxr-xr-x. 1 root root   21134 Dec 17  2014 libadmin.so</span><br><span class="line">-rwxr-xr-x. 1 root root 5011799 Dec 17  2014 libproxy.so</span><br><span class="line"></span><br><span class="line">/usr/local/mysql-proxy/log:</span><br><span class="line">total 0</span><br></pre></td></tr></tbody></table></figure>
<p><strong>bin&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7684;&#x90FD;&#x662F;&#x53EF;&#x6267;&#x884C;&#x6587;&#x4EF6;</strong></p>
<ol>
<li>&#x201C;encrypt&#x201D;&#x662F;&#x7528;&#x6765;&#x5BF9;MySQL&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;&#x7684;&#xFF0C;&#x5728;&#x914D;&#x7F6E;&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x7528;&#x5230;</li>
<li>&#x201C;mysql-proxy&#x201D;&#x662F;MySQL&#x81EA;&#x5DF1;&#x7684;&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x4EE3;&#x7406;</li>
<li>&#x201C;mysql-proxyd&#x201D;&#x662F;360&#x5F04;&#x51FA;&#x6765;&#x7684;&#xFF0C;&#x540E;&#x9762;&#x6709;&#x4E2A;&#x201C;d&#x201D;&#xFF0C;&#x670D;&#x52A1;&#x7684;&#x542F;&#x52A8;&#x3001;&#x91CD;&#x542F;&#x3001;&#x505C;&#x6B62;&#xFF0C;&#x90FD;&#x662F;&#x7528;&#x4ED6;&#x6765;&#x6267;&#x884C;&#x7684;</li>
</ol>
<p><strong>conf&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7684;&#x662F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</strong></p>
<ol>
<li>&#x201C;test.cnf&#x201D;&#x53EA;&#x6709;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x7528;&#x6765;&#x914D;&#x7F6E;&#x4EE3;&#x7406;&#x7684;&#xFF0C;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;vim&#x6765;&#x7F16;&#x8F91;</li>
<li>lib&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7684;&#x662F;&#x4E00;&#x4E9B;&#x5305;&#xFF0C;&#x4EE5;&#x53CA;Atlas&#x7684;&#x4F9D;&#x8D56;</li>
<li>log&#x76EE;&#x5F55;&#x4E0B;&#x653E;&#x7684;&#x662F;&#x65E5;&#x5FD7;&#xFF0C;&#x5982;&#x62A5;&#x9519;&#x7B49;&#x9519;&#x8BEF;&#x4FE1;&#x606F;&#x7684;&#x8BB0;&#x5F55;</li>
</ol>
<p>&#x8FDB;&#x5165;bin&#x76EE;&#x5F55;&#xFF0C;&#x4F7F;&#x7528;encrypt&#x6765;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;&#xFF0C;&#x6211;&#x7684;MySQL&#x6570;&#x636E;&#x7684;&#x7528;&#x6237;&#x540D;&#x662F;root&#xFF0C;&#x5BC6;&#x7801;&#x662F;123456&#xFF0C;&#x6211;&#x9700;&#x8981;&#x5BF9;&#x5BC6;&#x7801;&#x8FDB;&#x884C;&#x52A0;&#x5BC6;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; cd /usr/local/mysql-proxy/</span><br><span class="line">[root@ctos7mini mysql-proxy]&amp; ./bin/encrypt 123456</span><br><span class="line">/iZxz+0GRoA=</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x914D;&#x7F6E;Atlas&#xFF0C;&#x4F7F;&#x7528;vim&#x8FDB;&#x884C;&#x7F16;&#x8F91;</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; cat /usr/local/mysql-proxy/conf/test.cnf</span><br><span class="line">[mysql-proxy]</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5E26;#&#x53F7;&#x7684;&#x4E3A;&#x975E;&#x5FC5;&#x9700;&#x7684;&#x914D;&#x7F6E;&#x9879;&#x76EE;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x7BA1;&#x7406;&#x63A5;&#x53E3;&#x7684;&#x7528;&#x6237;&#x540D;</span><br><span class="line">admin-username = root</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x7BA1;&#x7406;&#x63A5;&#x53E3;&#x7684;&#x5BC6;&#x7801;</span><br><span class="line">admin-password = pwd</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x540E;&#x7AEF;&#x8FDE;&#x63A5;&#x7684;MySQL&#x4E3B;&#x5E93;&#x7684;IP&#x548C;&#x7AEF;&#x53E3;&#xFF0C;&#x53EF;&#x8BBE;&#x7F6E;&#x591A;&#x9879;&#xFF0C;&#x7528;&#x9017;&#x53F7;&#x5206;&#x9694;</span><br><span class="line">proxy-backend-addresses = 192.168.73.21:3306</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x540E;&#x7AEF;&#x8FDE;&#x63A5;&#x7684;MySQL&#x4ECE;&#x5E93;&#x7684;IP&#x548C;&#x7AEF;&#x53E3;&#xFF0C;@&#x540E;&#x9762;&#x7684;&#x6570;&#x5B57;&#x4EE3;&#x8868;&#x6743;&#x91CD;&#xFF0C;&#x7528;&#x6765;&#x4F5C;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#xFF0C;&#x82E5;&#x7701;&#x7565;&#x5219;&#x9ED8;&#x8BA4;&#x4E3A;1&#xFF0C;&#x53EF;&#x8BBE;&#x7F6E;&#x591A;&#x9879;&#xFF0C;&#x7528;&#x9017;&#x53F7;&#x5206;&#x9694;</span><br><span class="line">proxy-read-only-backend-addresses = 192.168.73.22:3306@1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x7528;&#x6237;&#x540D;&#x4E0E;&#x5176;&#x5BF9;&#x5E94;&#x7684;&#x52A0;&#x5BC6;&#x8FC7;&#x7684;MySQL&#x5BC6;&#x7801;&#xFF0C;&#x5BC6;&#x7801;&#x4F7F;&#x7528;PREFIX/bin&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x52A0;&#x5BC6;&#x7A0B;&#x5E8F;encrypt&#x52A0;&#x5BC6;&#xFF0C;&#x4E0B;&#x884C;&#x7684;user1&#x548C;user2&#x4E3A;&#x793A;&#x4F8B;&#xFF0C;&#x5C06;&#x5176;&#x66FF;&#x6362;&#x4E3A;&#x4F60;&#x7684;MySQL&#x7684;&#x7528;&#x6237;&#x540D;&#x548C;&#x52A0;&#x5BC6;&#x5BC6;&#x7801;&#xFF01;</span><br><span class="line">pwds = root:/iZxz+0GRoA=</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x8BBE;&#x7F6E;Atlas&#x7684;&#x8FD0;&#x884C;&#x65B9;&#x5F0F;&#xFF0C;&#x8BBE;&#x4E3A;true&#x65F6;&#x4E3A;&#x5B88;&#x62A4;&#x8FDB;&#x7A0B;&#x65B9;&#x5F0F;&#xFF0C;&#x8BBE;&#x4E3A;false&#x65F6;&#x4E3A;&#x524D;&#x53F0;&#x65B9;&#x5F0F;&#xFF0C;&#x4E00;&#x822C;&#x5F00;&#x53D1;&#x8C03;&#x8BD5;&#x65F6;&#x8BBE;&#x4E3A;false&#xFF0C;&#x7EBF;&#x4E0A;&#x8FD0;&#x884C;&#x65F6;&#x8BBE;&#x4E3A;true,true&#x540E;&#x9762;&#x4E0D;&#x80FD;&#x6709;&#x7A7A;&#x683C;&#x3002;</span><br><span class="line">daemon = true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x8BBE;&#x7F6E;Atlas&#x7684;&#x8FD0;&#x884C;&#x65B9;&#x5F0F;&#xFF0C;&#x8BBE;&#x4E3A;true&#x65F6;Atlas&#x4F1A;&#x542F;&#x52A8;&#x4E24;&#x4E2A;&#x8FDB;&#x7A0B;&#xFF0C;&#x4E00;&#x4E2A;&#x4E3A;monitor&#xFF0C;&#x4E00;&#x4E2A;&#x4E3A;worker&#xFF0C;monitor&#x5728;worker&#x610F;&#x5916;&#x9000;&#x51FA;&#x540E;&#x4F1A;&#x81EA;&#x52A8;&#x5C06;&#x5176;&#x91CD;&#x542F;&#xFF0C;&#x8BBE;&#x4E3A;false&#x65F6;&#x53EA;&#x6709;worker&#xFF0C;&#x6CA1;&#x6709;monitor&#xFF0C;&#x4E00;&#x822C;&#x5F00;&#x53D1;&#x8C03;&#x8BD5;&#x65F6;&#x8BBE;&#x4E3A;false&#xFF0C;&#x7EBF;&#x4E0A;&#x8FD0;&#x884C;&#x65F6;&#x8BBE;&#x4E3A;true,true&#x540E;&#x9762;&#x4E0D;&#x80FD;&#x6709;&#x7A7A;&#x683C;&#x3002;</span><br><span class="line">keepalive = true</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5DE5;&#x4F5C;&#x7EBF;&#x7A0B;&#x6570;&#xFF0C;&#x5BF9;Atlas&#x7684;&#x6027;&#x80FD;&#x6709;&#x5F88;&#x5927;&#x5F71;&#x54CD;&#xFF0C;&#x53EF;&#x6839;&#x636E;&#x60C5;&#x51B5;&#x9002;&#x5F53;&#x8BBE;&#x7F6E;</span><br><span class="line">event-threads = 8</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x65E5;&#x5FD7;&#x7EA7;&#x522B;&#xFF0C;&#x5206;&#x4E3A;message&#x3001;warning&#x3001;critical&#x3001;error&#x3001;debug&#x4E94;&#x4E2A;&#x7EA7;&#x522B;</span><br><span class="line">log-level = message</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x65E5;&#x5FD7;&#x5B58;&#x653E;&#x7684;&#x8DEF;&#x5F84;</span><br><span class="line">log-path = /usr/local/mysql-proxy/log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>SQL&#x65E5;&#x5FD7;&#x7684;&#x5F00;&#x5173;&#xFF0C;&#x53EF;&#x8BBE;&#x7F6E;&#x4E3A;OFF&#x3001;ON&#x3001;REALTIME&#xFF0C;OFF&#x4EE3;&#x8868;&#x4E0D;&#x8BB0;&#x5F55;SQL&#x65E5;&#x5FD7;&#xFF0C;ON&#x4EE3;&#x8868;&#x8BB0;&#x5F55;SQL&#x65E5;&#x5FD7;&#xFF0C;REALTIME &#x4EE3;&#x8868;&#x8BB0;&#x5F55;SQL&#x65E5;&#x5FD7;&#x4E14;&#x5B9E;&#x65F6;&#x5199;&#x5165;&#x78C1;&#x76D8;&#xFF0C;&#x9ED8;&#x8BA4;&#x4E3A;OFF</span><br><span class="line"><span class="meta">#</span>sql-log = OFF</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x6162;&#x65E5;&#x5FD7;&#x8F93;&#x51FA;&#x8BBE;&#x7F6E;&#x3002;&#x5F53;&#x8BBE;&#x7F6E;&#x4E86;&#x8BE5;&#x53C2;&#x6570;&#x65F6;&#xFF0C;&#x5219;&#x65E5;&#x5FD7;&#x53EA;&#x8F93;&#x51FA;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x8D85;&#x8FC7;sql-log-slow&#xFF08;&#x5355;&#x4F4D;&#xFF1A;ms)&#x7684;&#x65E5;&#x5FD7;&#x8BB0;&#x5F55; &#x3002;&#x4E0D;&#x8BBE;&#x7F6E;&#x8BE5;&#x53C2;&#x6570;&#x5219;&#x8F93;&#x51FA;&#x5168;&#x90E8;&#x65E5;&#x5FD7;&#x3002;</span><br><span class="line"><span class="meta">#</span>sql-log-slow = 10</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5B9E;&#x4F8B;&#x540D;&#x79F0;&#xFF0C;&#x7528;&#x4E8E;&#x540C;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x4E0A;&#x591A;&#x4E2A;Atlas&#x5B9E;&#x4F8B;&#x95F4;&#x7684;&#x533A;&#x5206;</span><br><span class="line"><span class="meta">#</span>instance = test</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x76D1;&#x542C;&#x7684;&#x5DE5;&#x4F5C;&#x63A5;&#x53E3;IP&#x548C;&#x7AEF;&#x53E3;</span><br><span class="line">proxy-address = 0.0.0.0:1234</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x76D1;&#x542C;&#x7684;&#x7BA1;&#x7406;&#x63A5;&#x53E3;IP&#x548C;&#x7AEF;&#x53E3;</span><br><span class="line">admin-address = 0.0.0.0:2345</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5206;&#x8868;&#x8BBE;&#x7F6E;&#xFF0C;&#x6B64;&#x4F8B;&#x4E2D;person&#x4E3A;&#x5E93;&#x540D;&#xFF0C;mt&#x4E3A;&#x8868;&#x540D;&#xFF0C;id&#x4E3A;&#x5206;&#x8868;&#x5B57;&#x6BB5;&#xFF0C;3&#x4E3A;&#x5B50;&#x8868;&#x6570;&#x91CF;&#xFF0C;&#x53EF;&#x8BBE;&#x7F6E;&#x591A;&#x9879;&#xFF0C;&#x4EE5;&#x9017;&#x53F7;&#x5206;&#x9694;&#xFF0C; &#x82E5;&#x4E0D;&#x5206;&#x8868;&#x5219;&#x4E0D;&#x9700;&#x8981;&#x8BBE;&#x7F6E;&#x8BE5;&#x9879;</span><br><span class="line"><span class="meta">#</span>tables = person.mt.id.3</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x9ED8;&#x8BA4;&#x5B57;&#x7B26;&#x96C6;&#xFF0C;&#x8BBE;&#x7F6E;&#x8BE5;&#x9879;&#x540E;&#x5BA2;&#x6237;&#x7AEF;&#x4E0D;&#x518D;&#x9700;&#x8981;&#x6267;&#x884C;SET NAMES&#x8BED;&#x53E5;</span><br><span class="line"><span class="meta">#</span>charset = utf8</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>&#x5141;&#x8BB8;&#x8FDE;&#x63A5;Atlas&#x7684;&#x5BA2;&#x6237;&#x7AEF;&#x7684;IP&#xFF0C;&#x53EF;&#x4EE5;&#x662F;&#x7CBE;&#x786E;IP&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x662F;IP&#x6BB5;&#xFF0C;&#x4EE5;&#x9017;&#x53F7;&#x5206;&#x9694;&#xFF0C;&#x82E5;&#x4E0D;&#x8BBE;&#x7F6E;&#x8BE5;&#x9879;&#x5219;&#x5141;&#x8BB8;&#x6240;&#x6709;IP &#x8FDE;&#x63A5;&#xFF0C;&#x5426;&#x5219;&#x53EA;&#x5141;&#x8BB8;&#x5217;&#x8868;&#x4E2D;&#x7684;IP&#x8FDE;&#x63A5;</span><br><span class="line"><span class="meta">#</span>client-ips = 127.0.0.1, 192.168.1</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span>Atlas&#x524D;&#x9762;&#x6302;&#x63A5;&#x7684;LVS&#x7684;&#x7269;&#x7406;&#x7F51;&#x5361;&#x7684;IP(&#x6CE8;&#x610F;&#x4E0D;&#x662F;&#x865A;IP)&#xFF0C;&#x82E5;&#x6709;LVS&#x4E14;&#x8BBE;&#x7F6E;&#x4E86;client-ips&#x5219;&#x6B64;&#x9879;&#x5FC5;&#x987B;&#x8BBE;&#x7F6E;&#xFF0C;&#x5426; &#x5219;&#x53EF;&#x4EE5;&#x4E0D;&#x8BBE;&#x7F6E;</span><br><span class="line"><span class="meta">#</span>lvs-ips = 192.168.1.1</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x542F;&#x52A8;Atlas</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini bin]&amp; cd /usr/local/mysql-proxy/bin/</span><br><span class="line">[root@ctos7mini bin]&amp; ./mysql-proxyd test status</span><br><span class="line">MySQL-Proxy of test is NOT running</span><br><span class="line">[root@ctos7mini bin]&amp; ./mysql-proxyd test start</span><br><span class="line">OK: MySQL-Proxy of test is started</span><br><span class="line">[root@ctos7mini bin]&amp; ./mysql-proxyd test status</span><br><span class="line">MySQL-Proxy of test is running (13844)</span><br><span class="line">MySQL-Proxy of test is running (13846)</span><br><span class="line">[root@ctos7mini bin]&amp; systemctl stop mysqld</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini bin]&amp; mysql -h127.0.0.1 -uroot -P2345 -uroot -ppwd</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 1</span><br><span class="line">Server version: 5.0.99-agent-admin</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">ERROR 1105 (07000): <span class="keyword">use</span> <span class="string">&apos;SELECT * FROM help&apos;</span> <span class="keyword">to</span> see the supported commands</span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">ERROR 1105 (07000): <span class="keyword">use</span> <span class="string">&apos;SELECT * FROM help&apos;</span> <span class="keyword">to</span> see the supported commands</span><br><span class="line">mysql&gt; <span class="keyword">help</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">For</span> information about MySQL products <span class="keyword">and</span> services, visit:</span><br><span class="line">   <span class="keyword">http</span>://www.mysql.com/</span><br><span class="line"><span class="keyword">For</span> developer information, <span class="keyword">including</span> the MySQL <span class="keyword">Reference</span> <span class="keyword">Manual</span>, visit:</span><br><span class="line">   <span class="keyword">http</span>://dev.mysql.com/</span><br><span class="line"><span class="keyword">To</span> buy MySQL <span class="keyword">Enterprise</span> support, training, <span class="keyword">or</span> other products, visit:</span><br><span class="line">   https://shop.mysql.com/</span><br><span class="line"></span><br><span class="line"><span class="keyword">List</span> <span class="keyword">of</span> all MySQL commands:</span><br><span class="line">Note that all <span class="built_in">text</span> commands must be <span class="keyword">first</span> <span class="keyword">on</span> line <span class="keyword">and</span> <span class="keyword">end</span> <span class="keyword">with</span> <span class="string">&apos;;&apos;</span></span><br><span class="line">?         (\?) <span class="keyword">Synonym</span> <span class="keyword">for</span> <span class="string">`help&apos;.</span></span><br><span class="line"><span class="string">clear     (\c) Clear the current input statement.</span></span><br><span class="line"><span class="string">connect   (\r) Reconnect to the server. Optional arguments are db and host.</span></span><br><span class="line"><span class="string">delimiter (\d) Set statement delimiter.</span></span><br><span class="line"><span class="string">edit      (\e) Edit command with $EDITOR.</span></span><br><span class="line"><span class="string">ego       (\G) Send command to mysql server, display result vertically.</span></span><br><span class="line"><span class="string">exit      (\q) Exit mysql. Same as quit.</span></span><br><span class="line"><span class="string">go        (\g) Send command to mysql server.</span></span><br><span class="line"><span class="string">help      (\h) Display this help.</span></span><br><span class="line"><span class="string">nopager   (\n) Disable pager, print to stdout.</span></span><br><span class="line"><span class="string">notee     (\t) Don&apos;t write into outfile.</span></span><br><span class="line"><span class="string">pager     (\P) Set PAGER [to_pager]. Print the query results via PAGER.</span></span><br><span class="line"><span class="string">print     (\p) Print current command.</span></span><br><span class="line"><span class="string">prompt    (\R) Change your mysql prompt.</span></span><br><span class="line"><span class="string">quit      (\q) Quit mysql.</span></span><br><span class="line"><span class="string">rehash    (\#) Rebuild completion hash.</span></span><br><span class="line"><span class="string">source    (\.) Execute an SQL script file. Takes a file name as an argument.</span></span><br><span class="line"><span class="string">status    (\s) Get status information from the server.</span></span><br><span class="line"><span class="string">system    (\!) Execute a system shell command.</span></span><br><span class="line"><span class="string">tee       (\T) Set outfile [to_outfile]. Append everything into given outfile.</span></span><br><span class="line"><span class="string">use       (\u) Use another database. Takes database name as argument.</span></span><br><span class="line"><span class="string">charset   (\C) Switch to another charset. Might be needed for processing binlog with multi-byte charsets.</span></span><br><span class="line"><span class="string">warnings  (\W) Show warnings after every statement.</span></span><br><span class="line"><span class="string">nowarning (\w) Don&apos;t show warnings after every statement.</span></span><br><span class="line"><span class="string">resetconnection(\x) Clean session context.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">For server side help, type &apos;help contents&apos;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; select * from help;</span></span><br><span class="line"><span class="string">+----------------------------+---------------------------------------------------------+</span></span><br><span class="line"><span class="string">| command                    | description                                             |</span></span><br><span class="line"><span class="string">+----------------------------+---------------------------------------------------------+</span></span><br><span class="line"><span class="string">| SELECT * FROM help         | shows this help                                         |</span></span><br><span class="line"><span class="string">| SELECT * FROM backends     | lists the backends and their state                      |</span></span><br><span class="line"><span class="string">| SET OFFLINE $backend_id    | offline backend server, $backend_id is backend_ndx&apos;s id |</span></span><br><span class="line"><span class="string">| SET ONLINE $backend_id     | online backend server, ...                              |</span></span><br><span class="line"><span class="string">| ADD MASTER $backend        | example: &quot;add master 127.0.0.1:3306&quot;, ...               |</span></span><br><span class="line"><span class="string">| ADD SLAVE $backend         | example: &quot;add slave 127.0.0.1:3306&quot;, ...                |</span></span><br><span class="line"><span class="string">| REMOVE BACKEND $backend_id | example: &quot;remove backend 1&quot;, ...                        |</span></span><br><span class="line"><span class="string">| SELECT * FROM clients      | lists the clients                                       |</span></span><br><span class="line"><span class="string">| ADD CLIENT $client         | example: &quot;add client 192.168.1.2&quot;, ...                  |</span></span><br><span class="line"><span class="string">| REMOVE CLIENT $client      | example: &quot;remove client 192.168.1.2&quot;, ...               |</span></span><br><span class="line"><span class="string">| SELECT * FROM pwds         | lists the pwds                                          |</span></span><br><span class="line"><span class="string">| ADD PWD $pwd               | example: &quot;add pwd user:raw_password&quot;, ...               |</span></span><br><span class="line"><span class="string">| ADD ENPWD $pwd             | example: &quot;add enpwd user:encrypted_password&quot;, ...       |</span></span><br><span class="line"><span class="string">| REMOVE PWD $pwd            | example: &quot;remove pwd user&quot;, ...                         |</span></span><br><span class="line"><span class="string">| SAVE CONFIG                | save the backends to config file                        |</span></span><br><span class="line"><span class="string">| SELECT VERSION             | display the version of Atlas                            |</span></span><br><span class="line"><span class="string">+----------------------------+---------------------------------------------------------+</span></span><br><span class="line"><span class="string">16 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">mysql&gt; ^DBye</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini bin]&amp; mysql -h127.0.0.1 -uroot -P1234 -uroot -pccc.456</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 2</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| ha                 |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -uroot -P1234 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -uroot -P1234 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 4</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| ha                 |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">&quot;%general_log%&quot;</span>;</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| Variable_name    | Value                          |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| general_log      | OFF                            |</span><br><span class="line">| general_log_file | /var/lib/mysql/rhel_sqlsrv.log |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -uroot -P1234 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 5</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">variables</span> <span class="keyword">like</span> <span class="string">&quot;%general_log%&quot;</span>;</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| Variable_name    | Value                          |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| general_log      | OFF                            |</span><br><span class="line">| general_log_file | /var/lib/mysql/rhel_sqlsrv.log |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -uroot -P2345 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line"><span class="keyword">ERROR</span> <span class="number">1045</span> (<span class="number">28000</span>): <span class="keyword">password</span> doesn<span class="string">&apos;t match</span></span><br><span class="line"><span class="string">[root@ctos7mini bin]&amp; mysql -h127.0.0.1 -uroot -P1234 -uroot -ppwd</span></span><br><span class="line"><span class="string">mysql: [Warning] Using a password on the command line interface can be insecure.</span></span><br><span class="line"><span class="string">ERROR 1045 (28000): Access denied for user &apos;</span>root<span class="string">&apos;@&apos;</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span>:<span class="number">37884</span><span class="string">&apos; (using password: YES)</span></span><br><span class="line"><span class="string">[root@ctos7mini bin]&amp; mysql -h127.0.0.1 -P2345 -uroot -ppwd</span></span><br><span class="line"><span class="string">mysql: [Warning] Using a password on the command line interface can be insecure.</span></span><br><span class="line"><span class="string">Welcome to the MySQL monitor.  Commands end with ; or \g.</span></span><br><span class="line"><span class="string">Your MySQL connection id is 1</span></span><br><span class="line"><span class="string">Server version: 5.0.99-agent-admin</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Oracle is a registered trademark of Oracle Corporation and/or its</span></span><br><span class="line"><span class="string">affiliates. Other names may be trademarks of their respective</span></span><br><span class="line"><span class="string">owners.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">Type &apos;</span><span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">ERROR 1105 (07000): <span class="keyword">use</span> <span class="string">&apos;SELECT * FROM help&apos;</span> <span class="keyword">to</span> see the supported commands</span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@ctos7mini <span class="keyword">bin</span>]&amp; mysql -h127<span class="number">.0</span><span class="number">.0</span><span class="number">.1</span> -P1234 -uroot -pccc<span class="number">.456</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 7</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| ha                 |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br></pre></td></tr></tbody></table></figure>
<h2 id="&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;"><a href="#&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;" class="headerlink" title="&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;"></a>&#x8BFB;&#x5199;&#x5206;&#x79BB;&#x6D4B;&#x8BD5;</h2><p><strong>&#x5728;MySQL&#x4E3B;&#x5E93;&#x548C;&#x4ECE;&#x5E93;&#x5F00;&#x542F;general_log&#x65E5;&#x5FD7;&#xFF0C;&#x6CE8;&#x610F;&#x4E3B;&#x5E93;&#x548C;&#x4ECE;&#x5E93;general_log&#x65E5;&#x5FD7;&#x540D;&#x79F0;&#x4E0D;&#x540C;&#xFF01;</strong></p>
<p>&#x4E34;&#x65F6;&#x751F;&#x6548;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;%general_log%&apos;;</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| Variable_name    | Value                          |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">| general_log      | OFF                            |</span><br><span class="line">| general_log_file | /var/lib/mysql/rhel_sqlsrv.log |</span><br><span class="line">+<span class="comment">------------------+--------------------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br><span class="line">mysql&gt; <span class="keyword">set</span> <span class="keyword">global</span> general_log=<span class="keyword">ON</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6C38;&#x4E45;&#x751F;&#x6548;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; echo &quot;general_log=ON&quot; &gt;&gt; /etc/my.cnf</span><br><span class="line">[root@rhel7 ~]&amp; echo &quot;general_log_file=/var/lib/mysql/rhel.log&quot; &gt;&gt; /etc/my.cnf</span><br><span class="line"></span><br><span class="line">[root@rhel_sqlsrv ~]&amp; echo &quot;general_log=ON&quot; &gt;&gt; /etc/my.cnf</span><br><span class="line">[root@rhel_sqlsrv ~]&amp; echo &quot;general_log_file=/var/lib/mysql/rhel_sqlsrv.log&quot; &gt;&gt; /etc/my.cnf</span><br><span class="line">[root@rhel_sqlsrv ~]&amp; systemctl restart mysqld</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &quot;%general_log%&quot;;</span><br><span class="line">+<span class="comment">------------------+--------------------------+</span></span><br><span class="line">| Variable_name    | Value                    |</span><br><span class="line">+<span class="comment">------------------+--------------------------+</span></span><br><span class="line">| general_log      | ON                       |</span><br><span class="line">| general_log_file | /var/lib/mysql/rhel7.log |</span><br><span class="line">+<span class="comment">------------------+--------------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x6E05;&#x7A7A;&#x6570;&#x636E;&#x5E93;&#x65E5;&#x5FD7;</strong>&#xFF1A;</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; echo &gt; /var/lib/mysql/rhel7.log</span><br><span class="line"></span><br><span class="line">[root@rhel_sqlsrv ~]&amp; echo &gt; /var/lib/mysql/rhel_sqlsrv.log</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x6D4B;&#x8BD5;</strong>&#xFF1A;</p>
<p>Master&#xFF08;rw&#xFF09;:<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; tail -f /var/lib/mysql/rhel7.log</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Slave&#xFF08;ro&#xFF09;:<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel_sqlsrv ~]&amp; tail -f /var/lib/mysql/rhel_sqlsrv.log</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Atlas:<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mysql-proxy]<span class="comment"># mysql -h127.0.0.1 -P1234 -uroot -p</span></span><br><span class="line">Enter password:</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 9</span><br><span class="line">Server version: 5.0.81-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>ro:<br>slave&#x68C0;&#x6D4B;&#x5230;&#x8BFB;&#x64CD;&#x4F5C;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel_sqlsrv ~]&amp; tail -f /var/lib/mysql/rhel_sqlsrv.log</span><br><span class="line"></span><br><span class="line">2022-05-07T09:07:23.252345Z        13 Connect   root@192.168.73.20 on  using TCP/IP</span><br><span class="line">2022-05-07T09:07:23.252973Z        13 Query     SET CHARACTER_SET_CONNECTION=utf8</span><br><span class="line">2022-05-07T09:07:23.254053Z        13 Query     SET CHARACTER_SET_RESULTS=utf8</span><br><span class="line">2022-05-07T09:07:23.258100Z        13 Query     SET CHARACTER_SET_CLIENT=utf8</span><br><span class="line">2022-05-07T09:07:23.259321Z        13 Query     select @@version_comment limit 1</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>rw:<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]# tail -f /var/lib/mysql/rhel7.log</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5728;Atlas&#x8FDB;&#x884C;&#x8BFB;&#x64CD;&#x4F5C;:<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| ha                 |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> testdb</span><br><span class="line">Reading <span class="keyword">table</span> information <span class="keyword">for</span> completion <span class="keyword">of</span> <span class="keyword">table</span> <span class="keyword">and</span> <span class="keyword">column</span> <span class="keyword">names</span></span><br><span class="line">You can turn <span class="keyword">off</span> this feature <span class="keyword">to</span> <span class="keyword">get</span> a quicker <span class="keyword">startup</span> <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| Tables_in_testdb |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| book             |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">| Linux                   |    66 |   666 |</span><br><span class="line">| Unix                    |    77 |   777 |</span><br><span class="line">| abc                     |   123 |   456 |</span><br><span class="line">| def                     |    83 |   364 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Slave&#x68C0;&#x6D4B;&#x5230;&#x8BFB;&#x64CD;&#x4F5C;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel_sqlsrv ~]# tail -f /var/lib/mysql/rhel_sqlsrv.log</span><br><span class="line"></span><br><span class="line">2022-05-07T09:07:23.252345Z        13 Connect   root@192.168.73.20 on  using TCP/IP</span><br><span class="line">2022-05-07T09:07:23.252973Z        13 Query     SET CHARACTER_SET_CONNECTION=utf8</span><br><span class="line">2022-05-07T09:07:23.254053Z        13 Query     SET CHARACTER_SET_RESULTS=utf8</span><br><span class="line">2022-05-07T09:07:23.258100Z        13 Query     SET CHARACTER_SET_CLIENT=utf8</span><br><span class="line">2022-05-07T09:07:23.259321Z        13 Query     select @@version_comment limit 1</span><br><span class="line">2022-05-07T09:13:04.634499Z        13 Query     show databases</span><br><span class="line">2022-05-07T09:13:09.313174Z        13 Query     SELECT DATABASE()</span><br><span class="line">2022-05-07T09:13:09.314061Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:09.316061Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:09.316710Z        13 Query     show databases</span><br><span class="line">2022-05-07T09:13:09.317592Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:09.318360Z        13 Query     show tables</span><br><span class="line">2022-05-07T09:13:09.319468Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:09.320217Z        13 Field List        book</span><br><span class="line">2022-05-07T09:13:16.960823Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:16.962628Z        13 Query     show tables</span><br><span class="line">2022-05-07T09:13:20.799873Z        13 Init DB   testdb</span><br><span class="line">2022-05-07T09:13:20.800737Z        13 Query     select * from book</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5728;Atlas&#x8FDB;&#x884C;&#x5199;&#x64CD;&#x4F5C;&#xFF1A;<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; insert into book values(&apos;test&apos;, 67, 252);</span><br><span class="line">Query OK, 1 row affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Master&#x68C0;&#x6D4B;&#x5230;&#x5199;&#x64CD;&#x4F5C;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]# tail -f /var/lib/mysql/rhel7.log</span><br><span class="line"></span><br><span class="line">2022-05-07T10:59:33.029685Z         4 Connect   root@192.168.73.20 on  using TCP/IP</span><br><span class="line">2022-05-07T10:59:33.030609Z         4 Query     SET CHARACTER_SET_CONNECTION=utf8</span><br><span class="line">2022-05-07T10:59:33.031735Z         4 Query     SET CHARACTER_SET_RESULTS=utf8</span><br><span class="line">2022-05-07T10:59:33.032656Z         4 Query     SET CHARACTER_SET_CLIENT=utf8</span><br><span class="line">2022-05-07T10:59:33.033919Z         4 Init DB   testdb</span><br><span class="line">2022-05-07T10:59:33.035018Z         4 Query     insert into book values(&apos;test&apos;, 67, 252)</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="&#x6545;&#x969C;&#x89E3;&#x51B3;"><a href="#&#x6545;&#x969C;&#x89E3;&#x51B3;" class="headerlink" title="&#x6545;&#x969C;&#x89E3;&#x51B3;"></a>&#x6545;&#x969C;&#x89E3;&#x51B3;</h2><p><strong>&#x6545;&#x969C;&#x4E00;</strong></p>
<p><strong>Atlas</strong>&#x8BBF;&#x95EE;&#x5DE5;&#x4F5C;&#x63A5;&#x53E3;&#x65F6;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x53EA;&#x6709;&#x4E00;&#x4E2A;<code>information_schema</code>&#xFF0C;&#x4E0D;&#x663E;&#x793A;&#x5176;&#x4ED6;&#x5E93;&#xFF1A;</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mysql-proxy]# mysql -h192.168.73.21 -uroot -p</span><br><span class="line">Enter password:</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 13</span><br><span class="line">Server version: 5.7.24-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+--------------------+</span><br><span class="line">| Database           |</span><br><span class="line">+--------------------+</span><br><span class="line">| information_schema |</span><br><span class="line">+--------------------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br></pre></td></tr></tbody></table></figure>
<p>&#x6545;&#x969C;&#x5206;&#x6790;&#xFF1A;</p>
<ol>
<li><p>&#x4E3B;&#x4ECE;&#x4E0D;&#x540C;&#x6B65;&#xFF1A;<br>&#x67E5;&#x770B;Slave&#x7684;&#x72B6;&#x6001;&#xFF1A;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Connecting to master</span><br><span class="line">                  Master_Host: 192.168.73.21</span><br><span class="line">                  Master_User: root</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 10</span><br><span class="line">              Master_Log_File: mysql-bin.000005</span><br><span class="line">          Read_Master_Log_Pos: 154</span><br><span class="line">               Relay_Log_File: rhel_sqlsrv-relay-bin.000012</span><br><span class="line">                Relay_Log_Pos: 4</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000005</span><br><span class="line">             Slave_IO_Running: Connecting</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">.........................................&#x7701;&#x7565;...................................................................</span><br><span class="line">        Seconds_Behind_Master: NULL</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 2003</span><br><span class="line">                Last_IO_Error: error connecting to master &apos;root@192.168.73.21:3306&apos; - retry-time: 10  retries: 1</span><br><span class="line"> .........................................&#x7701;&#x7565;...................................................................</span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p><code>Atlas</code>&#x6CA1;&#x6709;&#x8FDE;&#x63A5;&#x5230;&#x4E3B;&#x4ECE;<br>&#x8BBF;&#x95EE;Atlas&#x7BA1;&#x7406;&#x63A5;&#x53E3;&#x67E5;&#x770B;&#x4E3B;&#x4ECE;&#x670D;&#x52A1;&#x662F;&#x5426;&#x90FD;&#x5728;&#x7EBF;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mysql-proxy]<span class="comment"># mysql -h127.0.0.1 -P2345 -uroot -ppwd</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 1</span><br><span class="line">Server version: 5.0.99-agent-admin</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> backends;</span><br><span class="line">+<span class="comment">-------------+--------------------+-------+------+</span></span><br><span class="line">| backend_ndx | address            | state | type |</span><br><span class="line">+<span class="comment">-------------+--------------------+-------+------+</span></span><br><span class="line">|           1 | 192.168.73.21:3306 | up    | rw   |</span><br><span class="line">|           2 | 192.168.73.22:3306 | down  | ro   |</span><br><span class="line">+<span class="comment">-------------+--------------------+-------+------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>&#x6839;&#x636E;&#x5B9E;&#x9645;&#x73AF;&#x5883;&#x68C0;&#x67E5;&#xFF0C;&#x4E3B;&#x4ECE;&#x662F;&#x5426;&#x540C;&#x6B65;&#xFF0C;MySQL&#x662F;&#x5426;&#x5141;&#x8BB8;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x7AEF;&#x53E3;&#x662F;&#x5426;&#x5F00;&#x653E;&#x3002;</p>
<p><strong>&#x6545;&#x969C;&#x4E8C;&#xFF1A;</strong></p>
<p>&#x6570;&#x636E;&#x5E93;&#x80FD;&#x591F;&#x67E5;&#x8BE2;&#xFF0C;&#x4E0D;&#x80FD;&#x8FDB;&#x884C;&#x5199;&#x64CD;&#x4F5C;&#xFF1A;</p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use testdb</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; select * from book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">| Linux                   |    66 |   666 |</span><br><span class="line">| Unix                    |    77 |   777 |</span><br><span class="line">| abc                     |   123 |   456 |</span><br><span class="line">| def                     |    83 |   364 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">insert</span> <span class="keyword">into</span> <span class="string">`book`</span> <span class="keyword">values</span>(<span class="string">&apos;test&apos;</span>,<span class="number">24</span>,<span class="number">62</span>);</span><br><span class="line">ERROR 1046 (3D000): No database selected</span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>Master&#x65E5;&#x5FD7;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">2022-05-07T09:24:33.993274Z        17 Query     insert into `book` values(&apos;test&apos;,24,62)</span><br><span class="line">2022-05-07T09:24:39.346670Z        17 Init DB   Access denied for user &apos;root&apos;@&apos;%&apos; to database &apos;testdb&apos;</span><br></pre></td></tr></tbody></table></figure><p></p>
<blockquote>
<p>&#x91CD;&#x542F;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;</p>
</blockquote>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/62ec7971/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-MySQL高可用集群架构-MHA架构" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/db0340bd/">MySQL高可用集群架构-MHA架构</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:45:20" datetime="2022-06-07T04:45:20.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h1 id="MySQL&#x9AD8;&#x53EF;&#x7528;&#x96C6;&#x7FA4;&#x2014;&#x2014;MHA&#x67B6;&#x6784;"><a href="#MySQL&#x9AD8;&#x53EF;&#x7528;&#x96C6;&#x7FA4;&#x2014;&#x2014;MHA&#x67B6;&#x6784;" class="headerlink" title="MySQL&#x9AD8;&#x53EF;&#x7528;&#x96C6;&#x7FA4;&#x2014;&#x2014;MHA&#x67B6;&#x6784;"></a>MySQL&#x9AD8;&#x53EF;&#x7528;&#x96C6;&#x7FA4;&#x2014;&#x2014;MHA&#x67B6;&#x6784;</h1><p><strong>&#x7B80;&#x4ECB;&#xFF1A;</strong></p>
<p>MHA&#xFF08;Master High Availability&#xFF09;&#x76EE;&#x524D;&#x5728;MySQL&#x9AD8;&#x53EF;&#x7528;&#x65B9;&#x9762;&#x662F;&#x4E00;&#x4E2A;&#x76F8;&#x5BF9;&#x6210;&#x719F;&#x7684;&#x89E3;&#x51B3;&#x65B9;&#x6848;&#xFF0C;&#x5B83;&#x7531;&#x65E5;&#x672C;DeNA&#x516C;&#x53F8;youshimaton&#xFF08;&#x73B0;&#x5C31;&#x804C;&#x4E8E;Facebook&#x516C;&#x53F8;&#xFF09;&#x5F00;&#x53D1;&#xFF0C;&#x662F;&#x4E00;&#x5957;&#x4F18;&#x79C0;&#x7684;&#x4F5C;&#x4E3A;MySQL&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x73AF;&#x5883;&#x4E0B;&#x6545;&#x969C;&#x5207;&#x6362;&#x548C;&#x4E3B;&#x4ECE;&#x63D0;&#x5347;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x8F6F;&#x4EF6;&#x3002;&#x5728;MySQL&#x6545;&#x969C;&#x5207;&#x6362;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;MHA&#x80FD;&#x505A;&#x5230;&#x5728;0~30&#x79D2;&#x4E4B;&#x5185;&#x81EA;&#x52A8;&#x5B8C;&#x6210;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6545;&#x969C;&#x5207;&#x6362;&#x64CD;&#x4F5C;&#xFF0C;&#x5E76;&#x4E14;&#x5728;&#x8FDB;&#x884C;&#x6545;&#x969C;&#x5207;&#x6362;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;MHA&#x80FD;&#x5728;&#x6700;&#x5927;&#x7A0B;&#x5EA6;&#x4E0A;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x4E00;&#x81F4;&#x6027;&#xFF0C;&#x4EE5;&#x8FBE;&#x5230;&#x771F;&#x6B63;&#x610F;&#x4E49;&#x4E0A;&#x7684;&#x9AD8;&#x53EF;&#x7528;&#x3002;</p>
<p>&#x8BE5;&#x8F6F;&#x4EF6;&#x7531;&#x4E24;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#xFF1A;MHA Manager&#xFF08;&#x7BA1;&#x7406;&#x8282;&#x70B9;&#xFF09;&#x548C;MHA Node&#xFF08;&#x6570;&#x636E;&#x8282;&#x70B9;&#xFF09;&#x3002;  </p>
<p>MHA Manager&#x53EF;&#x4EE5;&#x5355;&#x72EC;&#x90E8;&#x7F72;&#x5728;&#x4E00;&#x53F0;&#x72EC;&#x7ACB;&#x7684;&#x673A;&#x5668;&#x4E0A;&#x7BA1;&#x7406;&#x591A;&#x4E2A;master-slave&#x96C6;&#x7FA4;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x90E8;&#x7F72;&#x5728;&#x4E00;&#x53F0;slave&#x8282;&#x70B9;&#x4E0A;&#x3002;<br>MHA Node&#x8FD0;&#x884C;&#x5728;&#x6BCF;&#x53F0;MySQL&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;MHA Manager&#x4F1A;&#x5B9A;&#x65F6;&#x63A2;&#x6D4B;&#x96C6;&#x7FA4;&#x4E2D;&#x7684;master&#x8282;&#x70B9;&#xFF0C;&#x5F53;master&#x51FA;&#x73B0;&#x6545;&#x969C;&#x65F6;&#xFF0C;&#x5B83;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x5C06;&#x6700;&#x65B0;&#x6570;&#x636E;&#x7684;slave&#x63D0;&#x5347;&#x4E3A;&#x65B0;&#x7684;master&#xFF0C;&#x7136;&#x540E;&#x5C06;&#x6240;&#x6709;&#x5176;&#x4ED6;&#x7684;slave&#x91CD;&#x65B0;&#x6307;&#x5411;&#x65B0;&#x7684;master&#x3002;&#x6574;&#x4E2A;&#x6545;&#x969C;&#x8F6C;&#x79FB;&#x8FC7;&#x7A0B;&#x5BF9;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x5B8C;&#x5168;&#x900F;&#x660E;&#x3002;</p>
<p>&#x5728;MHA&#x81EA;&#x52A8;&#x6545;&#x969C;&#x5207;&#x6362;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;MHA&#x8BD5;&#x56FE;&#x4ECE;&#x5B95;&#x673A;&#x7684;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x4FDD;&#x5B58;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#xFF0C;&#x6700;&#x5927;&#x7A0B;&#x5EA6;&#x7684;&#x4FDD;&#x8BC1;&#x6570;&#x636E;&#x7684;&#x4E0D;&#x4E22;&#x5931;&#xFF0C;&#x4F46;&#x8FD9;&#x5E76;&#x4E0D;&#x603B;&#x662F;&#x53EF;&#x884C;&#x7684;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x786C;&#x4EF6;&#x6545;&#x969C;&#x6216;&#x65E0;&#x6CD5;&#x901A;&#x8FC7;ssh&#x8BBF;&#x95EE;&#xFF0C;MHA&#x6CA1;&#x6CD5;&#x4FDD;&#x5B58;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#xFF0C;&#x53EA;&#x8FDB;&#x884C;&#x6545;&#x969C;&#x8F6C;&#x79FB;&#x800C;&#x4E22;&#x5931;&#x4E86;&#x6700;&#x65B0;&#x7684;&#x6570;&#x636E;&#x3002;&#x4F7F;&#x7528;MySQL 5.5&#x7684;&#x534A;&#x540C;&#x6B65;&#x590D;&#x5236;&#xFF0C;&#x53EF;&#x4EE5;&#x5927;&#x5927;&#x964D;&#x4F4E;&#x6570;&#x636E;&#x4E22;&#x5931;&#x7684;&#x98CE;&#x9669;&#x3002;MHA&#x53EF;&#x4EE5;&#x4E0E;&#x534A;&#x540C;&#x6B65;&#x590D;&#x5236;&#x7ED3;&#x5408;&#x8D77;&#x6765;&#x3002;&#x5982;&#x679C;&#x53EA;&#x6709;&#x4E00;&#x4E2A;slave&#x5DF2;&#x7ECF;&#x6536;&#x5230;&#x4E86;&#x6700;&#x65B0;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#xFF0C;MHA&#x53EF;&#x4EE5;&#x5C06;&#x6700;&#x65B0;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x5E94;&#x7528;&#x4E8E;&#x5176;&#x4ED6;&#x6240;&#x6709;&#x7684;slave&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x56E0;&#x6B64;&#x53EF;&#x4EE5;&#x4FDD;&#x8BC1;&#x6240;&#x6709;&#x8282;&#x70B9;&#x7684;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;&#x3002;</p>
<p>&#x76EE;&#x524D;MHA&#x4E3B;&#x8981;&#x652F;&#x6301;&#x4E00;&#x4E3B;&#x591A;&#x4ECE;&#x7684;&#x67B6;&#x6784;&#xFF0C;&#x8981;&#x642D;&#x5EFA;MHA,&#x8981;&#x6C42;&#x4E00;&#x4E2A;&#x590D;&#x5236;&#x96C6;&#x7FA4;&#x4E2D;&#x5FC5;&#x987B;&#x6700;&#x5C11;&#x6709;&#x4E09;&#x53F0;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4E00;&#x4E3B;&#x4E8C;&#x4ECE;&#xFF0C;&#x5373;&#x4E00;&#x53F0;&#x5145;&#x5F53;master&#xFF0C;&#x4E00;&#x53F0;&#x5145;&#x5F53;&#x5907;&#x7528;master&#xFF0C;&#x53E6;&#x5916;&#x4E00;&#x53F0;&#x5145;&#x5F53;&#x4ECE;&#x5E93;&#xFF0C;&#x56E0;&#x4E3A;&#x81F3;&#x5C11;&#x9700;&#x8981;&#x4E09;&#x53F0;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x51FA;&#x4E8E;&#x673A;&#x5668;&#x6210;&#x672C;&#x7684;&#x8003;&#x8651;&#xFF0C;&#x6DD8;&#x5B9D;&#x4E5F;&#x5728;&#x8BE5;&#x57FA;&#x7840;&#x4E0A;&#x8FDB;&#x884C;&#x4E86;&#x6539;&#x9020;&#xFF0C;&#x76EE;&#x524D;&#x6DD8;&#x5B9D;TMHA&#x5DF2;&#x7ECF;&#x652F;&#x6301;&#x4E00;&#x4E3B;&#x4E00;&#x4ECE;&#x3002;MHA &#x9002;&#x5408;&#x4EFB;&#x4F55;&#x5B58;&#x50A8;&#x5F15;&#x64CE;, &#x53EA;&#x8981;&#x80FD;&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x7684;&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x5B83;&#x90FD;&#x652F;&#x6301;&#xFF0C;&#x4E0D;&#x9650;&#x4E8E;&#x652F;&#x6301;&#x4E8B;&#x7269;&#x7684; innodb &#x5F15;&#x64CE;&#x3002;</p>
<p>&#x5B98;&#x65B9;&#x4ECB;&#x7ECD;&#xFF1A;<a href="https://code.google.com/p/mysql-master-ha/" target="_blank" rel="noopener">https://code.google.com/p/mysql-master-ha/</a></p>
<p>&#x56FE;01&#x5C55;&#x793A;&#x4E86;&#x5982;&#x4F55;&#x901A;&#x8FC7;MHA Manager&#x7BA1;&#x7406;&#x591A;&#x7EC4;&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x3002;&#x53EF;&#x4EE5;&#x5C06;MHA&#x5DE5;&#x4F5C;&#x539F;&#x7406;&#x603B;&#x7ED3;&#x4E3A;&#x5982;&#x4E0B;&#xFF1A;<br></p><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://192.168.85.188:8081/uploads/1652923038589086640mha_str.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure><p></p>
<p>&#xFF08;1&#xFF09;&#x4ECE;&#x5B95;&#x673A;&#x5D29;&#x6E83;&#x7684;master&#x4FDD;&#x5B58;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x4E8B;&#x4EF6;&#xFF08;binlog events&#xFF09;;</p>
<p>&#xFF08;2&#xFF09;&#x8BC6;&#x522B;&#x542B;&#x6709;&#x6700;&#x65B0;&#x66F4;&#x65B0;&#x7684;slave&#xFF1B;</p>
<p>&#xFF08;3&#xFF09;&#x5E94;&#x7528;&#x5DEE;&#x5F02;&#x7684;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#xFF08;relay log&#xFF09;&#x5230;&#x5176;&#x4ED6;&#x7684;slave&#xFF1B;</p>
<p>&#xFF08;4&#xFF09;&#x5E94;&#x7528;&#x4ECE;master&#x4FDD;&#x5B58;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x4E8B;&#x4EF6;&#xFF08;binlog events&#xFF09;&#xFF1B;</p>
<p>&#xFF08;5&#xFF09;&#x63D0;&#x5347;&#x4E00;&#x4E2A;slave&#x4E3A;&#x65B0;&#x7684;master&#xFF1B;</p>
<p>&#xFF08;6&#xFF09;&#x4F7F;&#x5176;&#x4ED6;&#x7684;slave&#x8FDE;&#x63A5;&#x65B0;&#x7684;master&#x8FDB;&#x884C;&#x590D;&#x5236;&#xFF1B;</p>
<p>MHA&#x8F6F;&#x4EF6;&#x7531;&#x4E24;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#xFF0C;Manager&#x5DE5;&#x5177;&#x5305;&#x548C;Node&#x5DE5;&#x5177;&#x5305;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x8BF4;&#x660E;&#x5982;&#x4E0B;&#x3002;</p>
<p><strong>MHA Manager</strong>&#x5DE5;&#x5177;&#x5305;&#x7531;&#x4E24;&#x90E8;&#x5206;&#x7EC4;&#x6210;&#xFF0C;Manager&#x5DE5;&#x5177;&#x5305;&#x548C;Node&#x5DE5;&#x5177;&#x5305;&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x8BF4;&#x660E;&#x5982;&#x4E0B;&#x3002;</p>
<p>Manager&#x5DE5;&#x5177;&#x5305;&#x4E3B;&#x8981;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x5DE5;&#x5177;&#xFF1A;</p>
<table>
<thead>
<tr>
<th><strong>&#x540D; &#x79F0;</strong></th>
<th><strong>&#x4F5C; &#x7528;</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>masterha_check_ssh</td>
<td>&#x68C0;&#x67E5;MHA&#x7684;SSH&#x914D;&#x7F6E;&#x72B6;&#x51B5;</td>
</tr>
<tr>
<td>masterha_check_repl</td>
<td>&#x68C0;&#x67E5;MySQL&#x590D;&#x5236;&#x72B6;&#x51B5;</td>
</tr>
<tr>
<td>masterha_manager</td>
<td>&#x542F;&#x52A8;MHA</td>
</tr>
<tr>
<td>masterha_check_status</td>
<td>&#x68C0;&#x6D4B;&#x5F53;&#x524D;MHA&#x8FD0;&#x884C;&#x72B6;&#x6001;</td>
</tr>
<tr>
<td>masterha_master_monitor</td>
<td>&#x68C0;&#x6D4B;master&#x662F;&#x5426;&#x5B95;&#x673A;</td>
</tr>
<tr>
<td>masterha_master_switch</td>
<td>&#x63A7;&#x5236;&#x6545;&#x969C;&#x8F6C;&#x79FB;&#xFF08;&#x81EA;&#x52A8;&#x6216;&#x624B;&#x52A8;&#xFF09;</td>
</tr>
<tr>
<td>masterha_conf_host</td>
<td>&#x6DFB;&#x52A0;&#x6216;&#x5220;&#x9664;&#x914D;&#x7F6E;&#x7684;server&#x4FE1;&#x606F;</td>
</tr>
</tbody>
</table>
<p><strong>MHA Node</strong>&#x5DE5;&#x5177;&#x5305;&#xFF08;&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x901A;&#x5E38;&#x6709;MHA Manager&#x7684;&#x811A;&#x672C;&#x89E6;&#x53D1;&#xFF0C;&#x65E0;&#x9700;&#x4EBA;&#x4E3A;&#x64CD;&#x4F5C;&#xFF09;&#x4E3B;&#x8981;&#x5305;&#x62EC;&#x4EE5;&#x4E0B;&#x51E0;&#x4E2A;&#x5DE5;&#x5177;&#xFF1A;</p>
<table>
<thead>
<tr>
<th><strong>&#x540D; &#x79F0;</strong></th>
<th><strong>&#x4F5C; &#x7528;</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>save_binary_logs</td>
<td>&#x4FDD;&#x5B58;&#x548C;&#x590D;&#x5236;master&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;</td>
</tr>
<tr>
<td>apply_diff_relay_logs</td>
<td>&#x8BC6;&#x522B;&#x5DEE;&#x5F02;&#x7684;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x4E8B;&#x4EF6;&#x5E76;&#x5C06;&#x5176;&#x5DEE;&#x5F02;&#x7684;&#x4E8B;&#x4EF6;&#x5E94;&#x7528;&#x4E8E;&#x5176;&#x4ED6;&#x7684;slave</td>
</tr>
<tr>
<td>filter_mysqlbinlog</td>
<td>&#x53BB;&#x9664;&#x4E0D;&#x5FC5;&#x8981;&#x7684;ROLLBACK&#x4E8B;&#x4EF6;&#xFF08;&#x5DF2;&#x5E9F;&#x5F03;&#xFF09;</td>
</tr>
<tr>
<td>purge_relay_logs</td>
<td>&#x6E05;&#x9664;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#xFF08;&#x4E0D;&#x4F1A;&#x963B;&#x585E;SQL&#x7EBF;&#x7A0B;&#xFF09;</td>
</tr>
</tbody>
</table>
<p><em>&#x6CE8;&#x610F;&#xFF1A;</em><br>&#x4E3A;&#x4E86;&#x5C3D;&#x53EF;&#x80FD;&#x7684;&#x51CF;&#x5C11;&#x4E3B;&#x5E93;&#x786C;&#x4EF6;&#x635F;&#x574F;&#x5B95;&#x673A;&#x9020;&#x6210;&#x7684;&#x6570;&#x636E;&#x4E22;&#x5931;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x914D;&#x7F6E;MHA&#x7684;&#x540C;&#x65F6;&#x5EFA;&#x8BAE;&#x914D;&#x7F6E;&#x6210;MySQL 5.5&#x7684;&#x534A;&#x540C;&#x6B65;&#x590D;&#x5236;&#x3002;&#x5173;&#x4E8E;&#x534A;&#x540C;&#x6B65;&#x590D;&#x5236;&#x539F;&#x7406;&#x5404;&#x4F4D;&#x81EA;&#x5DF1;&#x8FDB;&#x884C;&#x67E5;&#x9605;&#x3002;&#xFF08;&#x4E0D;&#x662F;&#x5FC5;&#x987B;&#xFF09;</p>
<h2 id="1-&#x5B89;&#x88C5;&#x90E8;&#x7F72;MHA"><a href="#1-&#x5B89;&#x88C5;&#x90E8;&#x7F72;MHA" class="headerlink" title="1. &#x5B89;&#x88C5;&#x90E8;&#x7F72;MHA"></a>1. &#x5B89;&#x88C5;&#x90E8;&#x7F72;MHA</h2><p>&#x63A5;&#x4E0B;&#x6765;&#x90E8;&#x7F72;MHA&#xFF0C;&#x5177;&#x4F53;&#x7684;&#x642D;&#x5EFA;&#x73AF;&#x5883;&#x5982;&#x4E0B;&#xFF08;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x4E3A;2&#x53F0;CentOS7.4 64bit&#xFF0C;2&#x53F0;RHEL7.3 64bit&#xFF09;</p>
<table>
<thead>
<tr>
<th>&#x89D2;&#x8272;</th>
<th>IP&#x5730;&#x5740;</th>
<th>&#x4E3B;&#x673A;&#x540D;</th>
<th>&#x5DE5;&#x5177;</th>
<th>&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;</th>
</tr>
</thead>
<tbody>
<tr>
<td>manager</td>
<td>192.168.73.20</td>
<td>ctos7mini</td>
<td>mha4mysql-manager,mha4mysql-node</td>
<td>CentOS7.4 x64</td>
</tr>
<tr>
<td>master</td>
<td>192.168.73.21</td>
<td>rhel7</td>
<td>mha4mysql-node</td>
<td>RHEL7.3 x64</td>
</tr>
<tr>
<td>slave,candicate master</td>
<td>192.168.73.22</td>
<td>rhel_sqlsrv</td>
<td>mha4mysql-node</td>
<td>RHEL7.3 x64</td>
</tr>
<tr>
<td>slave</td>
<td>192.168.73.23</td>
<td>ctos_sqlsrv</td>
<td>mha4mysql-node</td>
<td>CentOS7.4 x64</td>
</tr>
</tbody>
</table>
<p>&#x5176;&#x4E2D;master&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x5199;&#x670D;&#x52A1;&#xFF0C;&#x5907;&#x9009;Candicate master&#xFF08;&#x5B9E;&#x9645;&#x4E3A;slave1&#xFF09;&#x63D0;&#x4F9B;&#x8BFB;&#x670D;&#x52A1;&#xFF0C;slave2&#x4E5F;&#x63D0;&#x4F9B;&#x8BFB;&#x670D;&#x52A1;&#xFF0C;&#x4E00;&#x65E6;master&#x5B95;&#x673A;&#xFF0C;&#x5C06;&#x4F1A;&#x628A;&#x5907;&#x9009;master&#x63D0;&#x5347;&#x4E3A;&#x65B0;&#x7684;master&#xFF0C;slave&#x6307;&#x5411;&#x65B0;&#x7684;master</p>
<p><strong>&#xFF08;1&#xFF09;&#x5728;&#x5B89;&#x88C5;MHA&#x5DE5;&#x5177;&#x4E4B;&#x524D;&#xFF0C;&#x5148;&#x8981;&#x5B89;&#x88C5;epel&#x6E90;&#xFF0C;&#x89E3;&#x51B3;&#x4F9D;&#x8D56;&#x5305;&#x95EE;&#x9898;&#xFF1A;</strong></p>
<p>Centos6&#x5B89;&#x88C5;&#x6E90;&#xFF1A;<br>    rpm -ivh <a href="http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm&#xFF08;&#x5DF2;&#x5931;&#x6548;&#xFF0C;&#x5B98;&#x65B9;&#x4E0D;&#x518D;&#x652F;&#x6301;&#xFF09;" target="_blank" rel="noopener">http://dl.fedoraproject.org/pub/epel/6/x86_64/epel-release-6-8.noarch.rpm&#xFF08;&#x5DF2;&#x5931;&#x6548;&#xFF0C;&#x5B98;&#x65B9;&#x4E0D;&#x518D;&#x652F;&#x6301;&#xFF09;</a><br>Centos7&#x5B89;&#x88C5;&#x6E90;&#xFF1A;<br>    rpm -ivh <a href="https://dl.fedoraproject.org/pub/epel/7/x86_64/Packages/e/epel-release-7-14.noarch.rpm" target="_blank" rel="noopener">https://dl.fedoraproject.org/pub/epel/7/x86_64/Packages/e/epel-release-7-14.noarch.rpm</a><br>Centos8&#x5B89;&#x88C5;&#x6E90;&#xFF1A;8&#x4EE5;&#x4E0A;&#x9700;&#x8981;&#x5B89;&#x88C5;2&#x4E2A;&#xFF1A;<br>    rpm -ivh <a href="https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/Packages/e/epel-release-8-15.el8.noarch.rpm" target="_blank" rel="noopener">https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/Packages/e/epel-release-8-15.el8.noarch.rpm</a><br>    rpm -ivh <a href="https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/Packages/e/epel-next-release-8-15.el8.noarch.rpm" target="_blank" rel="noopener">https://dl.fedoraproject.org/pub/epel/8/Everything/x86_64/Packages/e/epel-next-release-8-15.el8.noarch.rpm</a>  </p>
<p>Centos9&#x5B89;&#x88C5;&#x6E90;&#xFF1A;<br>    rpm -ivh <a href="https://dl.fedoraproject.org/pub/epel/9/Everything/x86_64/Packages/e/epel-release-9-2.el9.noarch.rpm" target="_blank" rel="noopener">https://dl.fedoraproject.org/pub/epel/9/Everything/x86_64/Packages/e/epel-release-9-2.el9.noarch.rpm</a><br>    rpm -ivh <a href="https://dl.fedoraproject.org/pub/epel/9/Everything/x86_64/Packages/e/epel-next-release-9-2.el9.noarch.rpm" target="_blank" rel="noopener">https://dl.fedoraproject.org/pub/epel/9/Everything/x86_64/Packages/e/epel-next-release-9-2.el9.noarch.rpm</a>  </p>
<p>RHEL7&#x5B89;&#x88C5;&#x6E90;&#xFF1A;yum install <a href="https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm" target="_blank" rel="noopener">https://dl.fedoraproject.org/pub/epel/epel-release-latest-7.noarch.rpm</a><br>RHEL8&#x5B89;&#x88C5;&#x6E90;&#xFF1A;dnf install <a href="https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm" target="_blank" rel="noopener">https://dl.fedoraproject.org/pub/epel/epel-release-latest-8.noarch.rpm</a><br>RHEL9-Beta&#x5B89;&#x88C5;&#x6E90;&#xFF1A;dnf install <a href="https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm" target="_blank" rel="noopener">https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm</a>  </p>
<p>MHA Manager&#x4E2D;&#x4E3B;&#x8981;&#x5305;&#x62EC;&#x4E86;&#x51E0;&#x4E2A;&#x7BA1;&#x7406;&#x5458;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;&#xFF0C;&#x4F8B;&#x5982;master_manger&#xFF0C;master_master_switch&#x7B49;&#xFF1B;MHA Manger&#x4E5F;&#x4F9D;&#x8D56;&#x4E8E;perl&#x6A21;&#x5757;&#xFF0C;&#x5177;&#x4F53;&#x5982;&#x4E0B;&#xFF1A;</p>
<p>&#xFF08;1&#xFF09;&#x5B89;&#x88C5;MHA Node&#x8F6F;&#x4EF6;&#x5305;&#x4E4B;&#x524D;&#x9700;&#x8981;&#x5B89;&#x88C5;&#x4F9D;&#x8D56;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;yum&#x5B8C;&#x6210;&#xFF0C;&#x9996;&#x5148;epel&#x6E90;&#x8981;&#x5B89;&#x88C5;&#x6CE8;&#x610F;&#xFF1A;&#x521A;&#x624D;&#x5DF2;&#x7ECF;&#x914D;&#x7F6E;epel&#x6E90;</p>
<p>&#xFF08;2&#xFF09;&#x5B89;&#x88C5;MHA Manager &#x9996;&#x5148;&#x5B89;&#x88C5;MHA Manger&#x4F9D;&#x8D56;&#x7684;perl&#x6A21;&#x5757;&#xFF08;&#x6211;&#x8FD9;&#x91CC;&#x4F7F;&#x7528;yum&#x5B89;&#x88C5;&#xFF09;&#xFF1A;</p>
<p>&#x5728;&#x6240;&#x6709;&#x673A;&#x5668;&#x4E0A;&#x4F7F;&#x7528;yum&#x5B89;&#x88C5;&#x5168;&#x90E8;&#x4F9D;&#x8D56;</p>
<pre><code>yum install perl-DBD-MySQL perl-Config-Tiny perl-Log-Dispatch perl-Parallel-ForkManager perl-Time-HiRes perl-ExtUtils-CBuilder perl-ExtUtils-MakeMaker perl-CPAN -y
</code></pre><p><strong>&#x6CE8;&#xFF01;</strong>&#x5728;RHEL&#x7CFB;&#x7EDF;&#x4E2D;&#x5B89;&#x88C5;&#x4E86;epel&#x6E90;&#x4E4B;&#x540E;&#x4F9D;&#x65E7;&#x4F1A;&#x51FA;&#x73B0;&#x7F3A;&#x5C11;&#x4F9D;&#x8D56;&#x5305;&#x95EE;&#x9898;</p>
<p><strong>&#xFF08;2&#xFF09;&#x83B7;&#x53D6;MHA&#x76F8;&#x5173;&#x5305;&#xFF0C;&#x5728;&#x6240;&#x6709;&#x7684;&#x8282;&#x70B9;&#x5B89;&#x88C5;mha-node&#xFF1A;</strong></p>
<p>&#x76F8;&#x5173;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<br>&#x963F;&#x91CC;&#x4E91;&#x76D8;&#x5206;&#x4EAB;&#xFF1A;<a href="https://www.aliyundrive.com/s/cMNxKg6srT6" target="_blank" rel="noopener">https://www.aliyundrive.com/s/cMNxKg6srT6</a><br>mha_manager_0.55 (RHEL/CentOS 4,5)<br><a href="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-manager-0.55-1.el5.noarch.rpm" target="_blank" rel="noopener">https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-manager-0.55-1.el5.noarch.rpm</a><br>mha_manager_0.55 (RHEL/CentOS 6)<br><a href="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-manager-0.55-0.el6.noarch.rpm" target="_blank" rel="noopener">https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-manager-0.55-0.el6.noarch.rpm</a>  </p>
<p>mha_manager_0.54 (RHEL/CentOS 4,5)<br><a href="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-manager-0.54-0.el5.noarch.rpm" target="_blank" rel="noopener">https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-manager-0.54-0.el5.noarch.rpm</a><br>mha_manager_0.54 (RHEL/CentOS 6)<br><a href="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-manager-0.54-0.el6.noarch.rpm" target="_blank" rel="noopener">https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-manager-0.54-0.el6.noarch.rpm</a>  </p>
<p>mha_node_0.54 (RHEL/CentOS 4,5)<br><a href="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-node-0.54-1.el5.noarch.rpm" target="_blank" rel="noopener">https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-node-0.54-1.el5.noarch.rpm</a><br>mha_node_0.54 (RHEL/CentOS 6)<br><a href="https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-node-0.54-0.el6.noarch.rpm" target="_blank" rel="noopener">https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/mysql-master-ha/mha4mysql-node-0.54-0.el6.noarch.rpm</a>  </p>
<p>mha_node&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x540E;&#x4F1A;&#x5728;/usr/bin/&#x76EE;&#x5F55;&#x4E0B;&#x751F;&#x6210;&#x4EE5;&#x4E0B;&#x811A;&#x672C;&#x6587;&#x4EF6;&#xFF1A;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; rpm -ivh mha4mysql-node-0.54-0.el6.noarch.rpm</span><br><span class="line">[root@ctos7mini ~]&amp; cd /usr/bin/</span><br><span class="line">[root@ctos7mini bin]&amp; ll app* filter* purge* save*</span><br><span class="line">-rwxr-xr-x. 1 root root 15977 Dec  1  2012 apply_diff_relay_logs</span><br><span class="line">-rwxr-xr-x. 1 root root  4807 Dec  1  2012 filter_mysqlbinlog</span><br><span class="line">-rwxr-xr-x. 1 root root  7401 Dec  1  2012 purge_relay_logs</span><br><span class="line">-rwxr-xr-x. 1 root root  7263 Dec  1  2012 save_binary_logs</span><br><span class="line">[root@ctos7mini bin]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#xFF08;3&#xFF09;&#x5B89;&#x88C5;MHA Manager</strong></p>
<p>&#x5B89;&#x88C5;MHA Manager&#x8F6F;&#x4EF6;&#x5305;&#xFF1A;<br></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mysql_master_ha]# rpm -ivh mha4mysql-manager-0.54-0.el6.noarch.rpm</span><br><span class="line">Preparing...                          ################################# [100%]</span><br><span class="line">Updating / installing...</span><br><span class="line">   1:mha4mysql-manager-0.54-0.el6     ################################# [100%]</span><br><span class="line">[root@ctos7mini mysql_master_ha]#</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x6CE8;&#x610F;&#xFF01;</strong> &#x5982;&#x679C;&#x5728;RHEL&#x4E0A;&#x53EF;&#x80FD;&#x51FA;&#x73B0;&#x65E0;&#x6CD5;&#x5B89;&#x88C5;MHA Manager&#xFF0C;&#x51FA;&#x73B0;&#x7F3A;&#x5C11;&#x4F9D;&#x8D56;&#xFF0C;&#x63D0;&#x793A;&#x9700;&#x8981;&#x5B89;&#x88C5;<code>perl-Config-Tiny</code><br>&#x9700;&#x8981;&#x5728;rhel&#x7CFB;&#x7EDF;&#x624B;&#x52A8;&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;&#xFF1A;  </p>
<pre><code>rpm -ivh http://mirror.centos.org/centos/7/os/x86_64/Packages/perl-Config-Tiny-2.14-7.el7.noarch.rpm
</code></pre><p>MHA Manager&#x5B89;&#x88C5;&#x5B8C;&#x6210;&#x540E;&#x4F1A;&#x5728;/usr/bin&#x76EE;&#x5F55;&#x4E0B;&#x9762;&#x751F;&#x6210;&#x4EE5;&#x4E0B;&#x811A;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x524D;&#x9762;&#x5DF2;&#x7ECF;&#x8BF4;&#x8FC7;&#x8FD9;&#x4E9B;&#x811A;&#x672C;&#x7684;&#x4F5C;&#x7528;&#xFF0C;&#x8FD9;&#x91CC;&#x4E0D;&#x518D;&#x91CD;&#x590D;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini mysql_master_ha]&amp;ll /usr/bin/mast*</span><br><span class="line">-rwxr-xr-x. 1 root root 1995 Dec  1  2012 /usr/bin/masterha_check_repl</span><br><span class="line">-rwxr-xr-x. 1 root root 1779 Dec  1  2012 /usr/bin/masterha_check_ssh</span><br><span class="line">-rwxr-xr-x. 1 root root 1865 Dec  1  2012 /usr/bin/masterha_check_status</span><br><span class="line">-rwxr-xr-x. 1 root root 3201 Dec  1  2012 /usr/bin/masterha_conf_host</span><br><span class="line">-rwxr-xr-x. 1 root root 2517 Dec  1  2012 /usr/bin/masterha_manager</span><br><span class="line">-rwxr-xr-x. 1 root root 2165 Dec  1  2012 /usr/bin/masterha_master_monitor</span><br><span class="line">-rwxr-xr-x. 1 root root 2373 Dec  1  2012 /usr/bin/masterha_master_switch</span><br><span class="line">-rwxr-xr-x. 1 root root 3879 Dec  1  2012 /usr/bin/masterha_secondary_check</span><br><span class="line">-rwxr-xr-x. 1 root root 1739 Dec  1  2012 /usr/bin/masterha_stop</span><br><span class="line">[root@ctos7mini mysql_master_ha]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#xFF08;4&#xFF09;&#x914D;&#x7F6E;&#x6240;&#x6709;&#x4E3B;&#x673A;&#x76F8;&#x4E92;SSH&#x767B;&#x5F55;&#x65E0;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;&#xFF08;&#x4F7F;&#x7528;key&#x767B;&#x5F55;&#xFF0C;&#x5DE5;&#x4F5C;&#x4E2D;&#x5E38;&#x7528;&#xFF09;</strong><br>&#x6709;&#x4E00;&#x70B9;&#x9700;&#x8981;&#x6CE8;&#x610F;&#xFF1A;&#x4E0D;&#x80FD;&#x7981;&#x6B62; password &#x767B;&#x9646;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x51FA;&#x73B0;&#x9519;&#x8BEF;</p>
<p>&#x5728;&#x6240;&#x6709;&#x4E3B;&#x673A;&#x4E0A;&#x914D;&#x7F6E;ssh&#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]# ssh-keygen -t rsa</span><br><span class="line">Generating public/private rsa key pair.</span><br><span class="line">Enter file in which to save the key (/root/.ssh/id_rsa): &#x56DE;&#x8F66;</span><br><span class="line">Enter passphrase (empty for no passphrase): &#x56DE;&#x8F66;</span><br><span class="line">Enter same passphrase again: &#x56DE;&#x8F66;</span><br><span class="line">Your identification has been saved in /root/.ssh/id_rsa.</span><br><span class="line">Your public key has been saved in /root/.ssh/id_rsa.pub.</span><br><span class="line">The key fingerprint is:</span><br><span class="line">c2:95:fa:7e:f5:ef:07:3f:70:a2:ec:bb:3a:5a:9f:d9 root@rhel7</span><br><span class="line">The key&apos;s randomart image is:</span><br><span class="line">+--[ RSA 2048]----+</span><br><span class="line">|                 |</span><br><span class="line">|         .       |</span><br><span class="line">|        o        |</span><br><span class="line">|     . o         |</span><br><span class="line">|      + S        |</span><br><span class="line">|       o    .o.. |</span><br><span class="line">|        ......+o |</span><br><span class="line">|       ...oo+ ..o|</span><br><span class="line">|       .oo+BoE o=|</span><br><span class="line">+-----------------+</span><br><span class="line">[root@rhel7 ~]#</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; ssh-copy-id root@192.168.73.20</span><br><span class="line">[root@rhel7 ~]&amp; ssh-copy-id root@192.168.73.22</span><br><span class="line">[root@rhel7 ~]&amp; ssh-copy-id root@192.168.73.23</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5176;&#x4ED6;&#x4E3B;&#x673A;&#x91CD;&#x590D;&#x4EE5;&#x4E0A;&#x64CD;&#x4F5C;</p>
<p><strong>ssh&#x914D;&#x7F6E;&#x6269;&#x5C55;</strong></p>
<blockquote>
<p>&#x89E3;&#x51B3;rhel&#x8FDE;&#x63A5;ssh&#x7B49;&#x5F85;&#x65F6;&#x95F4;&#x8FC7;&#x4E45;&#x7684;&#x95EE;&#x9898;</p>
</blockquote>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[root@rhel7 ~]&amp; vim /etc/ssh/sshd_config</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> &#x53BB;&#x6389;&#x6CE8;&#x91CA;&#xFF0C;&#x6539;&#x4E3A;no</span></span><br><span class="line">UseDNS no</span><br></pre></td></tr></tbody></table></figure>
<h2 id="2-&#x642D;&#x5EFA;MySQL&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x73AF;&#x5883;"><a href="#2-&#x642D;&#x5EFA;MySQL&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x73AF;&#x5883;" class="headerlink" title="2. &#x642D;&#x5EFA;MySQL&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x73AF;&#x5883;"></a>2. &#x642D;&#x5EFA;MySQL&#x4E3B;&#x4ECE;&#x590D;&#x5236;&#x73AF;&#x5883;</h2><p>&#x6CE8;&#x610F;&#xFF1A;binlog-do-db &#x548C; replicate-ignore-db &#x8BBE;&#x7F6E;&#x5FC5;&#x987B;&#x76F8;&#x540C;&#xFF1B;MHA &#x5728;&#x542F;&#x52A8;&#x65F6;&#x5019;&#x4F1A;&#x68C0;&#x6D4B;&#x8FC7;&#x6EE4;&#x89C4;&#x5219;&#xFF0C;&#x5982;&#x679C;&#x8FC7;&#x6EE4;&#x89C4;&#x5219;&#x4E0D;&#x540C;&#xFF0C;MHA &#x4E0D;&#x542F;&#x52A8;&#x76D1;&#x63A7;&#x548C;&#x6545;&#x969C;&#x8F6C;&#x79FB;</p>
<h3 id="&#x5728;192-168-73-21&#x4E0A;&#x914D;&#x7F6E;MySQL-master"><a href="#&#x5728;192-168-73-21&#x4E0A;&#x914D;&#x7F6E;MySQL-master" class="headerlink" title="&#x5728;192.168.73.21&#x4E0A;&#x914D;&#x7F6E;MySQL master"></a>&#x5728;192.168.73.21&#x4E0A;&#x914D;&#x7F6E;MySQL master</h3><p><strong>&#x521B;&#x5EFA;&#x9700;&#x8981;&#x540C;&#x6B65;&#x7684;&#x6570;&#x636E;&#x5E93;</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p123456</span><br><span class="line">mysql&gt; CREATE DATABASE ha DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;</span><br><span class="line">mysql&gt; use HA;</span><br><span class="line">mysql&gt; CREATE TABLE test(id int,name varchar(20));</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x914D;&#x7F6E;<code>my.cnf</code>&#xFF0C;&#x6DFB;&#x52A0;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#xFF1A;</strong><br></p><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &#x5141;&#x8BB8;&#x8FDC;&#x7A0B;&#x8BBF;&#x95EE;</span></span><br><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># &#x542F;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;</span></span><br><span class="line"><span class="attr">log-bin</span>=mysql-bin-master</span><br><span class="line"><span class="comment"># &#x672C;&#x673A;&#x6570;&#x636E;&#x5E93;ID&#x6807;&#x8BC6;</span></span><br><span class="line"><span class="attr">server-id</span>=<span class="number">1</span></span><br><span class="line"><span class="comment"># &#x53EF;&#x4EE5;&#x88AB;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x590D;&#x5236;&#x7684;&#x5E93;&#xFF0C;&#x4E8C;&#x8FDB;&#x5236;&#x9700;&#x8981;&#x540C;&#x6B65;&#x7684;&#x6570;&#x636E;&#x5E93;&#x540D;</span></span><br><span class="line"><span class="attr">binlog-do-db</span>=ha</span><br><span class="line"><span class="comment"># &#x4E0D;&#x53EF;&#x4EE5;&#x88AB;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x590D;&#x5236;&#x7684;&#x5E93;</span></span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line"></span><br><span class="line"><span class="comment"># [&#x53EF;&#x9009;]&#x81EA;MySQL5.6&#x7248;&#x672C;&#xFF0C;&#x5F15;&#x5165;&#x4E86;&#x65B0;&#x5BC6;&#x7801;&#x6821;&#x9A8C;&#x63D2;&#x4EF6;validate_password, &#x7528;&#x4E8E;&#x7BA1;&#x7406;&#x7528;&#x6237;&#x5BC6;&#x7801;&#x957F;&#x5EA6;&#x3001;&#x5F3A;&#x5EA6;&#x7B49;&#xFF0C;&#x4FDD;&#x969C;&#x8D26;&#x53F7;&#x7684;&#x5B89;&#x5168;&#x6027;</span></span><br><span class="line"><span class="attr">validate-password</span>=<span class="literal">off</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6587;&#x6863;&#xFF1A;&#x5B89;&#x88C5;validate_password&#x63D2;&#x4EF6;.md<br><a href="http://note.youdao.com/noteshare?id=3808ed864a33805181a8cbea885a6784&amp;sub=02140C7F57F9404499D06E2EF7006296" target="_blank" rel="noopener">http://note.youdao.com/noteshare?id=3808ed864a33805181a8cbea885a6784&amp;sub=02140C7F57F9404499D06E2EF7006296</a></p>
<p>&#x91CD;&#x542F;MySQL</p>
<p><strong>&#x6388;&#x6743;</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; grant replication slave on *.* to slave@&apos;192.168.73.%&apos; identified by &apos;123456&apos;;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x67E5;&#x770B;&#x72B6;&#x6001;&#x4FE1;&#x606F;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show master status;</span><br><span class="line">+<span class="comment">-------------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| File                    | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+<span class="comment">-------------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| mysql-bin-master.000001 |      154 | ha           | mysql            |                   |</span><br><span class="line">+<span class="comment">-------------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="&#x5728;192-168-73-22&#x4E0A;&#x914D;&#x7F6E;MySQL-slave"><a href="#&#x5728;192-168-73-22&#x4E0A;&#x914D;&#x7F6E;MySQL-slave" class="headerlink" title="&#x5728;192.168.73.22&#x4E0A;&#x914D;&#x7F6E;MySQL slave"></a>&#x5728;192.168.73.22&#x4E0A;&#x914D;&#x7F6E;MySQL slave</h3><p><strong>&#x914D;&#x7F6E;<code>my.cnf</code>&#xFF0C;&#x6DFB;&#x52A0;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#xFF1A;</strong></p>
<figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-bin</span>=mysql-slave1</span><br><span class="line"><span class="attr">server-id</span>=<span class="number">2</span></span><br><span class="line"><span class="attr">binlog-do-db</span>=ha</span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line"><span class="comment">#&#x53EA;&#x6709;&#x5F00;&#x542F;log_slave_updates&#xFF0C;&#x4ECE;&#x5E93;binlog&#x624D;&#x4F1A;&#x8BB0;&#x5F55;&#x4E3B;&#x5E93;&#x540C;&#x6B65;&#x7684;&#x64CD;&#x4F5C;&#x65E5;&#x5FD7;</span></span><br><span class="line"><span class="attr">log_slave_updates</span>=<span class="number">1</span></span><br></pre></td></tr></tbody></table></figure>
<p>&#x91CD;&#x542F;MySQL</p>
<p><strong>&#x6388;&#x6743;&#x5E76;&#x5EFA;&#x7ACB;&#x4E3B;&#x4ECE;&#x5173;&#x7CFB;</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; grant replication slave on *.* to slave@&apos;192.168.73.%&apos; identified by &apos;123456&apos;;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; change master to master_host=&apos;192.168.73.21&apos;,master_user=&apos;slave&apos;,master_password=&apos;123456&apos;;</span><br><span class="line">Query OK, 0 rows affected, 2 warnings (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show master status;</span><br><span class="line">+<span class="comment">---------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| File                | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+<span class="comment">---------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| mysql-slave1.000002 |      154 | ha           | mysql            |                   |</span><br><span class="line">+<span class="comment">---------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">slave</span> <span class="keyword">status</span>\G</span><br><span class="line">*************************** <span class="number">1.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">               Slave_IO_State: Waiting <span class="keyword">for</span> <span class="keyword">master</span> <span class="keyword">to</span> send <span class="keyword">event</span></span><br><span class="line">                  Master_Host: <span class="number">192.168</span><span class="number">.73</span><span class="number">.21</span></span><br><span class="line">                  Master_User: <span class="keyword">slave</span></span><br><span class="line">                  Master_Port: <span class="number">3306</span></span><br><span class="line">                Connect_Retry: <span class="number">60</span></span><br><span class="line">              Master_Log_File: mysql-<span class="keyword">bin</span>-<span class="keyword">master</span><span class="number">.000002</span></span><br><span class="line">          Read_Master_Log_Pos: <span class="number">154</span></span><br><span class="line">               Relay_Log_File: ctos_sqlsrv-relay-<span class="keyword">bin</span><span class="number">.000011</span></span><br><span class="line">                Relay_Log_Pos: <span class="number">381</span></span><br><span class="line">        Relay_Master_Log_File: mysql-<span class="keyword">bin</span>-<span class="keyword">master</span><span class="number">.000002</span></span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB:</span><br><span class="line">.................................................&#x7701;&#x7565;.......................................................</span><br><span class="line">                  Master_UUID: <span class="number">8</span>f5a42da-cd2d<span class="number">-11</span>ec<span class="number">-8</span>c02<span class="number">-000</span>c29f9275c</span><br><span class="line">             Master_Info_File: /<span class="keyword">var</span>/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: <span class="number">0</span></span><br><span class="line">          SQL_Remaining_Delay: <span class="literal">NULL</span></span><br><span class="line">      Slave_SQL_Running_State: <span class="keyword">Slave</span> has <span class="keyword">read</span> all relay <span class="keyword">log</span>; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">.................................................&#x7701;&#x7565;........................................................</span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="&#x5728;192-168-73-23&#x4E0A;&#x914D;&#x7F6E;MySQL-slave"><a href="#&#x5728;192-168-73-23&#x4E0A;&#x914D;&#x7F6E;MySQL-slave" class="headerlink" title="&#x5728;192.168.73.23&#x4E0A;&#x914D;&#x7F6E;MySQL slave"></a>&#x5728;192.168.73.23&#x4E0A;&#x914D;&#x7F6E;MySQL slave</h3><p><strong>&#x914D;&#x7F6E;<code>my.cnf</code>&#xFF0C;&#x6DFB;&#x52A0;&#x9700;&#x8981;&#x7684;&#x53C2;&#x6570;&#xFF1A;</strong><br></p><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bind-address</span>    = <span class="number">0.0</span>.<span class="number">0.0</span></span><br><span class="line"></span><br><span class="line"><span class="attr">log-bin</span>=mysql-slave2</span><br><span class="line"><span class="attr">server-id</span>=<span class="number">3</span></span><br><span class="line"><span class="attr">binlog-do-db</span>=ha</span><br><span class="line"><span class="attr">binlog-ignore-db</span>=mysql</span><br><span class="line"><span class="attr">log_slave_updates</span>=<span class="number">1</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x91CD;&#x542F;MySQL</p>
<p><strong>&#x6388;&#x6743;&#x5E76;&#x5EFA;&#x7ACB;&#x4E3B;&#x4ECE;&#x5173;&#x7CFB;</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">master</span> <span class="keyword">status</span>;</span><br><span class="line">+<span class="comment">---------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| File                | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+<span class="comment">---------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| mysql-slave2.000002 |      601 | ha           | mysql            |                   |</span><br><span class="line">+<span class="comment">---------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">change</span> <span class="keyword">master</span> <span class="keyword">to</span> master_host=<span class="string">&apos;192.168.73.21&apos;</span>,master_user=<span class="string">&apos;slave&apos;</span>,master_password=<span class="string">&apos;123456&apos;</span>;</span><br><span class="line">Query OK, 0 rows affected, 2 warnings (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; start slave;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 192.168.73.21</span><br><span class="line">                  Master_User: slave</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-bin-master.000002</span><br><span class="line">          Read_Master_Log_Pos: 154</span><br><span class="line">               Relay_Log_File: rhel_sqlsrv-relay-bin.000003</span><br><span class="line">                Relay_Log_Pos: 381</span><br><span class="line">        Relay_Master_Log_File: mysql-bin-master.000002</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">.................................................&#x7701;&#x7565;.......................................................</span><br><span class="line">             Master_Server_Id: 1</span><br><span class="line">                  Master_UUID: 8f5a42da-cd2d-11ec-8c02-000c29f9275c</span><br><span class="line">             Master_Info_File: /var/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">.................................................&#x7701;&#x7565;.......................................................</span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x4E24;&#x53F0;slave&#x670D;&#x52A1;&#x5668;&#x8BBE;&#x7F6E;read_only&#xFF08;&#x4ECE;&#x5E93;&#x5BF9;&#x5916;&#x63D0;&#x4F9B;&#x8BFB;&#x670D;&#x52A1;&#xFF0C;&#x53EA;&#x6240;&#x4EE5;&#x6CA1;&#x6709;&#x5199;&#x8FDB;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;slave&#x968F;&#x65F6;&#x4F1A;&#x63D0;&#x5347;&#x4E3A;master&#xFF09;</strong></p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set global read_only=1;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x521B;&#x5EFA;&#x76D1;&#x63A7;&#x7528;&#x6237;&#xFF08;&#x5728;&#x4E3B;&#x4ECE;&#x4E0A;&#x90FD;&#x6267;&#x884C;&#xFF09;&#xFF1A;</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> all <span class="keyword">privileges</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="string">&apos;root&apos;</span>@<span class="string">&apos;192.168.10.%&apos;</span> <span class="keyword">identified</span>&#xA0; <span class="keyword">by</span> <span class="string">&apos;123456&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5230;&#x8FD9;&#x91CC;&#x6574;&#x4E2A;&#x96C6;&#x7FA4;&#x73AF;&#x5883;&#x5DF2;&#x7ECF;&#x642D;&#x5EFA;&#x5B8C;&#x6BD5;&#xFF0C;&#x5269;&#x4E0B;&#x7684;&#x5C31;&#x662F;&#x914D;&#x7F6E;MHA&#x8F6F;&#x4EF6;&#x4E86;</p>
<h2 id="3-&#x914D;&#x7F6E;MHA"><a href="#3-&#x914D;&#x7F6E;MHA" class="headerlink" title="3. &#x914D;&#x7F6E;MHA"></a>3. &#x914D;&#x7F6E;MHA</h2><p><strong>&#xFF08;1&#xFF09;&#x521B;&#x5EFA;MHA&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;&#xFF0C;&#x5E76;&#x4E14;&#x521B;&#x5EFA;&#x76F8;&#x5173;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF08;&#x5728;&#x8F6F;&#x4EF6;&#x5305;&#x89E3;&#x538B;&#x540E;&#x7684;&#x76EE;&#x5F55;&#x91CC;&#x9762;&#x6709;&#x6837;&#x4F8B;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF09;</strong></p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; mkdir -p /etc/masterha</span><br><span class="line">[root@ctos7mini ~]&amp; mkdir -p /var/log/masterha/app1</span><br><span class="line">[root@ctos7mini ~]&amp; vim /etc/masterha/app1.cnf</span><br></pre></td></tr></tbody></table></figure>
<p>&#x4FEE;&#x6539;app1.cnf&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x4FEE;&#x6539;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF08;&#x6CE8;&#x610F;&#xFF0C;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x6CE8;&#x91CA;&#x9700;&#x8981;&#x53BB;&#x6389;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x662F;&#x4E3A;&#x4E86;&#x89E3;&#x91CA;&#x6E05;&#x695A;&#xFF09;&#xFF1A;</p>
<p><strong>&#x53C2;&#x6570;&#x8BF4;&#x660E;</strong><br></p><figure class="highlight c"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">[server <span class="keyword">default</span>]</span><br><span class="line">manager_workdir=/var/<span class="built_in">log</span>/masterha/app1&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;<span class="comment">//&#x8BBE;&#x7F6E;manager&#x7684;&#x5DE5;&#x4F5C;&#x76EE;&#x5F55;</span></span><br><span class="line">manager_log=/var/<span class="built_in">log</span>/masterha/app1/manager.<span class="built_in">log</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;manager&#x7684;&#x65E5;&#x5FD7;</span></span><br><span class="line">master_binlog_dir=/data/mysql&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;master &#x4FDD;&#x5B58;binlog&#x7684;&#x4F4D;&#x7F6E;&#xFF0C;&#x4EE5;&#x4FBF;MHA&#x53EF;&#x4EE5;&#x627E;&#x5230;master&#x7684;&#x65E5;&#x5FD7;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x7684;&#x4E5F;&#x5C31;&#x662F;mysql&#x7684;&#x6570;&#x636E;&#x76EE;&#x5F55;</span></span><br><span class="line">master_ip_failover_script= /usr/local/bin/master_ip_failover&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x81EA;&#x52A8;failover&#x65F6;&#x5019;&#x7684;&#x5207;&#x6362;&#x811A;&#x672C;</span></span><br><span class="line">master_ip_online_change_script= /usr/local/bin/master_ip_online_change&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x624B;&#x52A8;&#x5207;&#x6362;&#x65F6;&#x5019;&#x7684;&#x5207;&#x6362;&#x811A;&#x672C;</span></span><br><span class="line">password=<span class="number">123456</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;mysql&#x4E2D;root&#x7528;&#x6237;&#x7684;&#x5BC6;&#x7801;&#xFF0C;&#x8FD9;&#x4E2A;&#x5BC6;&#x7801;&#x662F;&#x524D;&#x6587;&#x4E2D;&#x521B;&#x5EFA;&#x76D1;&#x63A7;&#x7528;&#x6237;&#x7684;&#x90A3;&#x4E2A;&#x5BC6;&#x7801;</span></span><br><span class="line">user=root&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#x8BBE;&#x7F6E;&#x76D1;&#x63A7;&#x7528;&#x6237;root</span><br><span class="line">ping_interval=<span class="number">1</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x76D1;&#x63A7;&#x4E3B;&#x5E93;&#xFF0C;&#x53D1;&#x9001;ping&#x5305;&#x7684;&#x65F6;&#x95F4;&#x95F4;&#x9694;&#xFF0C;&#x9ED8;&#x8BA4;&#x662F;3&#x79D2;&#xFF0C;&#x5C1D;&#x8BD5;&#x4E09;&#x6B21;&#x6CA1;&#x6709;&#x56DE;&#x5E94;&#x7684;&#x65F6;&#x5019;&#x81EA;&#x52A8;&#x8FDB;&#x884C;railover</span></span><br><span class="line">remote_workdir=/tmp&#xA0;&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x8FDC;&#x7AEF;mysql&#x5728;&#x53D1;&#x751F;&#x5207;&#x6362;&#x65F6;binlog&#x7684;&#x4FDD;&#x5B58;&#x4F4D;&#x7F6E;</span></span><br><span class="line">repl_password=<span class="number">123456</span>&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x590D;&#x5236;&#x7528;&#x6237;&#x7684;&#x5BC6;&#x7801;</span></span><br><span class="line">repl_user=repl&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x590D;&#x5236;&#x73AF;&#x5883;&#x4E2D;&#x7684;&#x590D;&#x5236;&#x7528;&#x6237;&#x540D;</span></span><br><span class="line">report_script=/usr/local/send_report&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x53D1;&#x751F;&#x5207;&#x6362;&#x540E;&#x53D1;&#x9001;&#x7684;&#x62A5;&#x8B66;&#x7684;&#x811A;&#x672C;</span></span><br><span class="line">shutdown_script=<span class="string">&quot;&quot;</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;&#x6545;&#x969C;&#x53D1;&#x751F;&#x540E;&#x5173;&#x95ED;&#x6545;&#x969C;&#x4E3B;&#x673A;&#x811A;&#x672C;&#xFF08;&#x8BE5;&#x811A;&#x672C;&#x7684;&#x4E3B;&#x8981;&#x4F5C;&#x7528;&#x662F;&#x5173;&#x95ED;&#x4E3B;&#x673A;&#x653E;&#x5728;&#x53D1;&#x751F;&#x8111;&#x88C2;,&#x8FD9;&#x91CC;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#xFF09;</span></span><br><span class="line">ssh_user=root&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; <span class="comment">//&#x8BBE;&#x7F6E;ssh&#x7684;&#x767B;&#x5F55;&#x7528;&#x6237;&#x540D;</span></span><br><span class="line"> </span><br><span class="line">[server1]</span><br><span class="line">hostname=<span class="number">192.168</span><span class="number">.10</span><span class="number">.12</span></span><br><span class="line">port=<span class="number">3306</span></span><br><span class="line"> </span><br><span class="line">[server2]</span><br><span class="line">hostname=<span class="number">192.168</span><span class="number">.10</span><span class="number">.13</span></span><br><span class="line">port=<span class="number">3306</span></span><br><span class="line">candidate_master=<span class="number">1</span>&#xA0;&#xA0; #&#x8BBE;&#x7F6E;&#x4E3A;&#x5019;&#x9009;master&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x8BE5;&#x53C2;&#x6570;&#x4EE5;&#x540E;&#xFF0C;&#x53D1;&#x751F;&#x4E3B;&#x4ECE;&#x5207;&#x6362;&#x4EE5;&#x540E;&#x5C06;&#x4F1A;&#x5C06;&#x6B64;&#x4ECE;&#x5E93;&#x63D0;&#x5347;&#x4E3A;&#x4E3B;&#x5E93;&#xFF0C;&#x5373;&#x4F7F;&#x8FD9;&#x4E2A;&#x4E3B;&#x5E93;&#x4E0D;&#x662F;&#x96C6;&#x7FA4;&#x4E2D;&#x4E8B;&#x4EF6;&#x6700;&#x65B0;&#x7684;slave</span><br><span class="line">check_repl_delay=<span class="number">0</span>&#xA0;&#xA0; #&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x5982;&#x679C;&#x4E00;&#x4E2A;slave&#x843D;&#x540E;master <span class="number">100</span>M&#x7684;relay logs&#x7684;&#x8BDD;&#xFF0C;MHA&#x5C06;&#x4E0D;&#x4F1A;&#x9009;&#x62E9;&#x8BE5;slave&#x4F5C;&#x4E3A;&#x4E00;&#x4E2A;&#x65B0;&#x7684;master&#xFF0C;&#x56E0;&#x4E3A;&#x5BF9;&#x4E8E;&#x8FD9;&#x4E2A;slave&#x7684;&#x6062;&#x590D;&#x9700;&#x8981;&#x82B1;&#x8D39;&#x5F88;&#x957F;&#x65F6;&#x95F4;&#xFF0C;&#x901A;&#x8FC7;&#x8BBE;&#x7F6E;check_repl_delay=<span class="number">0</span>,MHA&#x89E6;&#x53D1;&#x5207;&#x6362;&#x5728;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x65B0;&#x7684;master&#x7684;&#x65F6;&#x5019;&#x5C06;&#x4F1A;&#x5FFD;&#x7565;&#x590D;&#x5236;&#x5EF6;&#x65F6;&#xFF0C;&#x8FD9;&#x4E2A;&#x53C2;&#x6570;&#x5BF9;&#x4E8E;&#x8BBE;&#x7F6E;&#x4E86;candidate_master=<span class="number">1</span>&#x7684;&#x4E3B;&#x673A;&#x975E;&#x5E38;&#x6709;&#x7528;&#xFF0C;&#x56E0;&#x4E3A;&#x8FD9;&#x4E2A;&#x5019;&#x9009;&#x4E3B;&#x5728;&#x5207;&#x6362;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#x4E00;&#x5B9A;&#x662F;&#x65B0;&#x7684;master</span><br><span class="line"> </span><br><span class="line">[server3]</span><br><span class="line">hostname=<span class="number">192.168</span><span class="number">.10</span><span class="number">.14</span></span><br><span class="line">port=<span class="number">3306</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x53C2;&#x8003;&#x914D;&#x7F6E;&#xFF1A;</strong><br></p><figure class="highlight ini"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[server default]</span></span><br><span class="line"><span class="attr">manager_workdir</span>=/var/log/masterha/app1</span><br><span class="line"><span class="attr">manager_log</span>=/var/log/masterha/app1/manager.log</span><br><span class="line"><span class="attr">master_binlog_dir</span>=/var/lib/mysql</span><br><span class="line"><span class="attr">master_ip_failover_script</span>= /usr/local/bin/master_ip_failover</span><br><span class="line"><span class="attr">master_ip_online_change_script</span>= /usr/local/bin/master_ip_online_change&#xA0;</span><br><span class="line"><span class="attr">password</span>=<span class="number">123456</span></span><br><span class="line"><span class="attr">user</span>=root</span><br><span class="line"><span class="attr">ping_interval</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">remote_workdir</span>=/tmp</span><br><span class="line"><span class="attr">repl_password</span>=<span class="number">123456</span></span><br><span class="line"><span class="attr">repl_user</span>=slave</span><br><span class="line"><span class="comment">#report_script=/usr/local/send_report</span></span><br><span class="line"><span class="attr">shutdown_script</span>=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="attr">ssh_user</span>=root</span><br><span class="line"></span><br><span class="line"><span class="section">[server1]</span></span><br><span class="line"><span class="attr">hostname</span>=<span class="number">192.168</span>.<span class="number">73.21</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"></span><br><span class="line"><span class="section">[server2]</span></span><br><span class="line"><span class="attr">hostname</span>=<span class="number">192.168</span>.<span class="number">73.22</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"><span class="attr">candidate_master</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">check_repl_delay</span>=<span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="section">[server3]</span></span><br><span class="line"><span class="attr">hostname</span>=<span class="number">192.168</span>.<span class="number">73.23</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#xFF08;2&#xFF09;&#x8BBE;&#x7F6E;relay log&#x7684;&#x6E05;&#x9664;&#x65B9;&#x5F0F;&#xFF08;&#x5728;&#x6BCF;&#x4E2A;slave&#x8282;&#x70B9;&#x4E0A;&#xFF09;&#xFF1A;</strong></p>
<figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; set global relay_log_purge=0;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p><span style="color:red">&#x6CE8;&#x610F;&#xFF1A;</span><br>MHA&#x5728;&#x53D1;&#x751F;&#x5207;&#x6362;&#x7684;&#x8FC7;&#x7A0B;&#x4E2D;&#xFF0C;&#x4ECE;&#x5E93;&#x7684;&#x6062;&#x590D;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F9D;&#x8D56;&#x4E8E;relay log&#x7684;&#x76F8;&#x5173;&#x4FE1;&#x606F;&#xFF0C;&#x6240;&#x4EE5;&#x8FD9;&#x91CC;&#x8981;&#x5C06;relay log&#x7684;&#x81EA;&#x52A8;&#x6E05;&#x9664;&#x8BBE;&#x7F6E;&#x4E3A;OFF&#xFF0C;&#x91C7;&#x7528;&#x624B;&#x52A8;&#x6E05;&#x695A;relay log&#x7684;&#x65B9;&#x5F0F;&#x3002;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;slave&#x4E0A;&#x7684;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x4F1A;&#x5728;SQL&#x7EBF;&#x7A0B;&#x6267;&#x884C;&#x5B8C;&#x6BD5;&#x540E;&#x88AB;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x3002;<strong>&#x4F46;&#x662F;&#x5728;MHA&#x73AF;&#x5883;&#x4E2D;&#xFF0C;&#x8FD9;&#x4E9B;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x5728;&#x6062;&#x590D;&#x5176;&#x5B83;slave&#x65F6;&#x53EF;&#x80FD;&#x4F1A;&#x88AB;&#x7528;&#x5230;&#xFF0C;&#x56E0;&#x6B64;&#x9700;&#x8981;&#x7981;&#x7528;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x7684;&#x81EA;&#x52A8;&#x5220;&#x9664;&#x529F;&#x80FD;&#x3002;</strong>&#x5B9A;&#x671F;&#x6E05;&#x695A;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x9700;&#x8981;&#x8003;&#x8651;&#x5230;&#x590D;&#x5236;&#x5EF6;&#x65F6;&#x7684;&#x95EE;&#x9898;&#x3002;&#x5728;ext3&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x4E0B;&#xFF0C;&#x5220;&#x9664;&#x5927;&#x7684;&#x6587;&#x4EF6;&#x9700;&#x8981;&#x4E00;&#x5B9A;&#x7684;&#x65F6;&#x95F4;&#xFF0C;&#x4F1A;&#x5BFC;&#x81F4;&#x4E25;&#x91CD;&#x7684;&#x590D;&#x5236;&#x5EF6;&#x65F6;&#x3002;&#x4E3A;&#x4E86;&#x907F;&#x514D;&#x590D;&#x5236;&#x5EF6;&#x65F6;&#xFF0C;&#x9700;&#x8981;&#x6682;&#x65F6;&#x4E3A;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#x521B;&#x5EFA;&#x786C;&#x94FE;&#x63A5;&#xFF0C;&#x56E0;&#x4E3A;&#x5728;Linux&#x7CFB;&#x7EDF;&#x4E2D;&#x901A;&#x8FC7;&#x786C;&#x94FE;&#x63A5;&#x5220;&#x9664;&#x5927;&#x6587;&#x4EF6;&#x901F;&#x5EA6;&#x4F1A;&#x5F88;&#x5FEB;&#x3002;&#xFF08;&#x5728;MySQL&#x6570;&#x636E;&#x5E93;&#x4E2D;&#xFF0C;&#x5220;&#x9664;&#x5927;&#x8868;&#x65F6;&#xFF0C;&#x901A;&#x5E38;&#x4E5F;&#x91C7;&#x7528;&#x5EFA;&#x7ACB;&#x786C;&#x94FE;&#x63A5;&#x7684;&#x65B9;&#x5F0F;&#xFF09;</p>
<p><strong>&#xFF08;3&#xFF09;.&#x68C0;&#x67E5;SSH&#x914D;&#x7F6E;</strong></p>
<p>&#x68C0;&#x67E5;MHA Manger&#x5230;&#x6240;&#x6709;MHA Node&#x7684;SSH&#x8FDE;&#x63A5;&#x72B6;&#x6001;&#xFF1A;</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; masterha_check_ssh --conf=/etc/masterha/app1.cnf</span><br><span class="line">Fri May  6 22:31:51 2022 - [warning] Global configuration file /etc/masterha_default.cnf not found. Skipping.</span><br><span class="line">Fri May  6 22:31:51 2022 - [info] Reading application default configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Fri May  6 22:31:51 2022 - [info] Reading server configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Fri May  6 22:31:51 2022 - [info] Starting SSH connection tests..</span><br><span class="line">Fri May  6 22:31:54 2022 - [debug]</span><br><span class="line">Fri May  6 22:31:51 2022 - [debug]  Connecting via SSH from root@192.168.73.21(192.168.73.21:22) to root@192.168.73.22(192.168.73.22:22)..</span><br><span class="line">Fri May  6 22:31:52 2022 - [debug]   ok.</span><br><span class="line">Fri May  6 22:31:52 2022 - [debug]  Connecting via SSH from root@192.168.73.21(192.168.73.21:22) to root@192.168.73.23(192.168.73.23:22)..</span><br><span class="line">Fri May  6 22:31:53 2022 - [debug]   ok.</span><br><span class="line">Fri May  6 22:31:55 2022 - [debug]</span><br><span class="line">Fri May  6 22:31:52 2022 - [debug]  Connecting via SSH from root@192.168.73.23(192.168.73.23:22) to root@192.168.73.21(192.168.73.21:22)..</span><br><span class="line">Fri May  6 22:31:53 2022 - [debug]   ok.</span><br><span class="line">Fri May  6 22:31:53 2022 - [debug]  Connecting via SSH from root@192.168.73.23(192.168.73.23:22) to root@192.168.73.22(192.168.73.22:22)..</span><br><span class="line">Fri May  6 22:31:54 2022 - [debug]   ok.</span><br><span class="line">Fri May  6 22:31:55 2022 - [debug]</span><br><span class="line">Fri May  6 22:31:52 2022 - [debug]  Connecting via SSH from root@192.168.73.22(192.168.73.22:22) to root@192.168.73.21(192.168.73.21:22)..</span><br><span class="line">Fri May  6 22:31:53 2022 - [debug]   ok.</span><br><span class="line">Fri May  6 22:31:53 2022 - [debug]  Connecting via SSH from root@192.168.73.22(192.168.73.22:22) to root@192.168.73.23(192.168.73.23:22)..</span><br><span class="line">Fri May  6 22:31:54 2022 - [debug]   ok.</span><br><span class="line">Fri May  6 22:31:55 2022 - [info] All SSH connection tests passed successfully.</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5404;&#x4E2A;&#x8282;&#x70B9;ssh&#x9A8C;&#x8BC1;&#x90FD;&#x662F;ok&#x624D;&#x6B63;&#x5E38;</p>
<p><strong>&#xFF08;4&#xFF09;.&#x68C0;&#x67E5;&#x6574;&#x4E2A;&#x590D;&#x5236;&#x73AF;&#x5883;&#x72B6;&#x51B5;</strong></p>
<p>&#x914D;&#x7F6E;VIP<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; ifconfig ens33</span><br><span class="line">[root@rhel7 ~]&amp; ip -4 addr show dev ens33</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    inet 192.168.73.21/24 brd 192.168.73.255 scope global ens33</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line"></span><br><span class="line">[root@ctos7mini ~]&amp; ip addr add 192.168.73.73/24 brd 192.168.10.255 dev ens33 label ens33:1</span><br><span class="line"></span><br><span class="line">[root@ctos7mini ~]&amp; ip -4 addr show dev ens33</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    inet 192.168.73.20/24 brd 192.168.73.255 scope global ens33</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet 192.168.73.73/24 brd 192.168.10.255 scope global secondary ens33:1</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x521B;&#x5EFA;&#x81EA;&#x52A8;&#x5207;&#x6362;&#x811A;&#x672C;</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; vim /usr/local/bin/master_ip_failover</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight perl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env perl</span></span><br><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"><span class="keyword">use</span> warnings <span class="string">FATAL =&gt;</span> <span class="string">&apos;all&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> Getopt::Long;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> (</span><br><span class="line">    $command,          $ssh_user,        $orig_master_host, $orig_master_ip,</span><br><span class="line">    $orig_master_port, $new_master_host, $new_master_ip,    $new_master_port</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> $vip = <span class="string">&apos;192.168.73.73&apos;</span>;</span><br><span class="line"><span class="keyword">my</span> $brdc = <span class="string">&apos;192.168.73.255&apos;</span>;</span><br><span class="line"><span class="keyword">my</span> $ifdev = <span class="string">&apos;ens33&apos;</span>;</span><br><span class="line"><span class="keyword">my</span> $key = <span class="string">&apos;1&apos;</span>;</span><br><span class="line"><span class="keyword">my</span> $ssh_start_vip = <span class="string">&quot;/usr/sbin/ip addr add $vip/24 brd $brdc dev $ifdev label $ifdev:$key;/usr/sbin/arping -q -A -c 1 -I $ifdev:$key $vip;iptables -F;&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $ssh_stop_vip = <span class="string">&quot;/usr/sbin/ip addr del $vip/24 dev $ifdev label $ifdev:$key&quot;</span>;</span><br><span class="line"></span><br><span class="line">GetOptions(</span><br><span class="line">    <span class="string">&apos;command=s&apos;</span>          =&gt; \$command,</span><br><span class="line">    <span class="string">&apos;ssh_user=s&apos;</span>         =&gt; \$ssh_user,</span><br><span class="line">    <span class="string">&apos;orig_master_host=s&apos;</span> =&gt; \$orig_master_host,</span><br><span class="line">    <span class="string">&apos;orig_master_ip=s&apos;</span>   =&gt; \$orig_master_ip,</span><br><span class="line">    <span class="string">&apos;orig_master_port=i&apos;</span> =&gt; \$orig_master_port,</span><br><span class="line">    <span class="string">&apos;new_master_host=s&apos;</span>  =&gt; \$new_master_host,</span><br><span class="line">    <span class="string">&apos;new_master_ip=s&apos;</span>   =&gt; \$new_master_ip,</span><br><span class="line">    <span class="string">&apos;new_master_port=i&apos;</span>  =&gt; \$new_master_port,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">exit</span> &amp;main();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">main</span> </span>{</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> <span class="string">&quot;\n\nIN SCRIPT TEST====$ssh_stop_vip==$ssh_start_vip===\n\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( $command eq <span class="string">&quot;stop&quot;</span> || $command eq <span class="string">&quot;stopssh&quot;</span> ) {</span><br><span class="line"></span><br><span class="line">        <span class="keyword">my</span> $exit_code = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">eval</span> {</span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;Disabling the VIP on old master: $orig_master_host \n&quot;</span>;</span><br><span class="line">            &amp;stop_vip();</span><br><span class="line">            $exit_code = <span class="number">0</span>;</span><br><span class="line">        };</span><br><span class="line">        <span class="keyword">if</span> ($@) {</span><br><span class="line">            <span class="keyword">warn</span> <span class="string">&quot;Got Error: $@\n&quot;</span>;</span><br><span class="line">            <span class="keyword">exit</span> $exit_code;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">exit</span> $exit_code;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">elsif</span> ( $command eq <span class="string">&quot;start&quot;</span> ) {</span><br><span class="line"></span><br><span class="line">        <span class="keyword">my</span> $exit_code = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">eval</span> {</span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;Enabling the VIP - $vip on the new master - $new_master_host \n&quot;</span>;</span><br><span class="line">            &amp;start_vip();</span><br><span class="line">            $exit_code = <span class="number">0</span>;</span><br><span class="line">        };</span><br><span class="line">        <span class="keyword">if</span> ($@) {</span><br><span class="line">            <span class="keyword">warn</span> $@;</span><br><span class="line">            <span class="keyword">exit</span> $exit_code;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">exit</span> $exit_code;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">elsif</span> ( $command eq <span class="string">&quot;status&quot;</span> ) {</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;Checking the Status of the script.. OK \n&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span> <span class="number">0</span>;</span><br><span class="line">    }</span><br><span class="line">    <span class="keyword">else</span> {</span><br><span class="line">        &amp;usage();</span><br><span class="line">        <span class="keyword">exit</span> <span class="number">1</span>;</span><br><span class="line">    }</span><br><span class="line">}</span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">start_vip</span>() </span>{</span><br><span class="line">    <span class="string">`ssh $ssh_user\@$new_master_host \&quot; $ssh_start_vip \&quot;`</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment"># A simple system call that disable the VIP on the old_master</span></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">stop_vip</span>() </span>{</span><br><span class="line">    <span class="string">`ssh $ssh_user\@$orig_master_host \&quot; $ssh_stop_vip \&quot;`</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">usage</span> </span>{</span><br><span class="line">    <span class="keyword">print</span></span><br><span class="line">    <span class="string">&quot;Usage: master_ip_failover --command=start|stop|stopssh|status --orig_master_host=host --orig_master_ip=ip --orig_master_port=port --new_master_host=host --new_master_ip=ip --new_master_port=port\n&quot;</span>;</span><br><span class="line">}</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; vim /usr/local/bin/master_ip_online_change</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight perl"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env perl</span></span><br><span class="line"><span class="keyword">use</span> strict;</span><br><span class="line"><span class="keyword">use</span> warnings <span class="string">FATAL =&gt;</span><span class="string">&apos;all&apos;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">use</span> Getopt::Long;</span><br><span class="line"></span><br><span class="line"><span class="comment">#my $vip = &apos;172.25.0.100/24&apos;;  # Virtual IP</span></span><br><span class="line"><span class="keyword">my</span> $vip = <span class="string">&apos;192.168.73.73/24&apos;</span>;  <span class="comment"># Virtual IP</span></span><br><span class="line"><span class="keyword">my</span> $key = <span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $ssh_start_vip = <span class="string">&quot;/sbin/ifconfig ens33:$key $vip&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $ssh_stop_vip = <span class="string">&quot;/sbin/ifconfig ens33:$key down&quot;</span>;</span><br><span class="line"><span class="keyword">my</span> $exit_code = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">my</span> (</span><br><span class="line">  $command,              $orig_master_is_new_slave, $orig_master_host,</span><br><span class="line">  $orig_master_ip,       $orig_master_port,         $orig_master_user,</span><br><span class="line">  $orig_master_password, $orig_master_ssh_user,     $new_master_host,</span><br><span class="line">  $new_master_ip,        $new_master_port,          $new_master_user,</span><br><span class="line">  $new_master_password,  $new_master_ssh_user,</span><br><span class="line">);</span><br><span class="line">GetOptions(</span><br><span class="line">  <span class="string">&apos;command=s&apos;</span>                =&gt; \$command,</span><br><span class="line">  <span class="string">&apos;orig_master_is_new_slave&apos;</span> =&gt; \$orig_master_is_new_slave,</span><br><span class="line">  <span class="string">&apos;orig_master_host=s&apos;</span>       =&gt; \$orig_master_host,</span><br><span class="line">  <span class="string">&apos;orig_master_ip=s&apos;</span>         =&gt; \$orig_master_ip,</span><br><span class="line">  <span class="string">&apos;orig_master_port=i&apos;</span>       =&gt; \$orig_master_port,</span><br><span class="line">  <span class="string">&apos;orig_master_user=s&apos;</span>       =&gt; \$orig_master_user,</span><br><span class="line">  <span class="string">&apos;orig_master_password=s&apos;</span>   =&gt; \$orig_master_password,</span><br><span class="line">  <span class="string">&apos;orig_master_ssh_user=s&apos;</span>   =&gt; \$orig_master_ssh_user,</span><br><span class="line">  <span class="string">&apos;new_master_host=s&apos;</span>        =&gt; \$new_master_host,</span><br><span class="line">  <span class="string">&apos;new_master_ip=s&apos;</span>          =&gt; \$new_master_ip,</span><br><span class="line">  <span class="string">&apos;new_master_port=i&apos;</span>        =&gt; \$new_master_port,</span><br><span class="line">  <span class="string">&apos;new_master_user=s&apos;</span>        =&gt; \$new_master_user,</span><br><span class="line">  <span class="string">&apos;new_master_password=s&apos;</span>    =&gt; \$new_master_password,</span><br><span class="line">  <span class="string">&apos;new_master_ssh_user=s&apos;</span>    =&gt; \$new_master_ssh_user,</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">exit</span> &amp;main();</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">main</span> </span>{</span><br><span class="line"></span><br><span class="line"><span class="comment">#print &quot;\n\nIN SCRIPT TEST====$ssh_stop_vip==$ssh_start_vip===\n\n&quot;;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> ( $command eq <span class="string">&quot;stop&quot;</span> || $command eq <span class="string">&quot;stopssh&quot;</span> ) {</span><br><span class="line"></span><br><span class="line">        <span class="comment"># $orig_master_host, $orig_master_ip, $orig_master_port are passed.</span></span><br><span class="line">        <span class="comment"># If you manage master ip address at global catalog database,</span></span><br><span class="line">        <span class="comment"># invalidate orig_master_ip here.</span></span><br><span class="line">        <span class="keyword">my</span> $exit_code = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">eval</span> {</span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;\n\n\n***************************************************************\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;Disabling the VIP - $vip on old master: $orig_master_host\n&quot;</span>;</span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;***************************************************************\n\n\n\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">&amp;stop_vip();</span><br><span class="line">            $exit_code = <span class="number">0</span>;</span><br><span class="line">        };</span><br><span class="line">        <span class="keyword">if</span> ($@) {</span><br><span class="line">            <span class="keyword">warn</span> <span class="string">&quot;Got Error: $@\n&quot;</span>;</span><br><span class="line">            <span class="keyword">exit</span> $exit_code;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">exit</span> $exit_code;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">elsif</span> ( $command eq <span class="string">&quot;start&quot;</span> ) {</span><br><span class="line"></span><br><span class="line">        <span class="comment"># all arguments are passed.</span></span><br><span class="line">        <span class="comment"># If you manage master ip address at global catalog database,</span></span><br><span class="line">        <span class="comment"># activate new_master_ip here.</span></span><br><span class="line">        <span class="comment"># You can also grant write access (create user, set read_only=0, etc) here.</span></span><br><span class="line"><span class="keyword">my</span> $exit_code = <span class="number">10</span>;</span><br><span class="line">        <span class="keyword">eval</span> {</span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;\n\n\n***************************************************************\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;Enabling the VIP - $vip on new master: $new_master_host \n&quot;</span>;</span><br><span class="line">            <span class="keyword">print</span> <span class="string">&quot;***************************************************************\n\n\n\n&quot;</span>;</span><br><span class="line"></span><br><span class="line">&amp;start_vip();</span><br><span class="line">            $exit_code = <span class="number">0</span>;</span><br><span class="line">        };</span><br><span class="line">        <span class="keyword">if</span> ($@) {</span><br><span class="line">            <span class="keyword">warn</span> $@;</span><br><span class="line">            <span class="keyword">exit</span> $exit_code;</span><br><span class="line">        }</span><br><span class="line">        <span class="keyword">exit</span> $exit_code;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">elsif</span> ( $command eq <span class="string">&quot;status&quot;</span> ) {</span><br><span class="line">        <span class="keyword">print</span> <span class="string">&quot;Checking the Status of the script.. OK \n&quot;</span>;</span><br><span class="line">        <span class="string">`ssh $orig_master_ssh_user\@$orig_master_host \&quot; $ssh_start_vip \&quot;`</span>;</span><br><span class="line">        <span class="keyword">exit</span> <span class="number">0</span>;</span><br><span class="line">}</span><br><span class="line"><span class="keyword">else</span> {</span><br><span class="line">&amp;usage();</span><br><span class="line">        <span class="keyword">exit</span> <span class="number">1</span>;</span><br><span class="line">}</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="comment"># A simple system call that enable the VIP on the new master</span></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">start_vip</span>() </span>{</span><br><span class="line"><span class="string">`ssh $new_master_ssh_user\@$new_master_host \&quot; $ssh_start_vip \&quot;`</span>;</span><br><span class="line">}</span><br><span class="line"><span class="comment"># A simple system call that disable the VIP on the old_master</span></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">stop_vip</span>() </span>{</span><br><span class="line"><span class="string">`ssh $orig_master_ssh_user\@$orig_master_host \&quot; $ssh_stop_vip \&quot;`</span>;</span><br><span class="line">}</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">sub</span> <span class="title">usage</span> </span>{</span><br><span class="line"><span class="keyword">print</span></span><br><span class="line"><span class="string">&quot;Usage: master_ip_failover --command=start|stop|stopssh|status --orig_master_host=host --orig_master_ip=ip --orig_master_port=port --new_master_host=host --new_master_ip=ip --new_master_port=port\n&quot;</span>;</span><br><span class="line">}</span><br><span class="line">[root@ctos7mini ~]<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure>
<p>&#x4FEE;&#x6539;&#x6587;&#x4EF6;&#x6743;&#x9650;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; chmod 755 /usr/local/bin/master_ip_failover</span><br><span class="line">[root@ctos7mini ~]&amp; chmod 755 /usr/local/bin/master_ip_online_change</span><br><span class="line">[root@ctos7mini ~]&amp; grep /usr/local/bin/master_ip_failover /etc/masterha/app1.cnf</span><br><span class="line">master_ip_failover_script= /usr/local/bin/master_ip_failover</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x901A;&#x8FC7;masterha_check_repl&#x811A;&#x672C;&#x67E5;&#x770B;&#x6574;&#x4E2A;&#x96C6;&#x7FA4;&#x7684;&#x72B6;&#x6001;</strong></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; masterha_check_repl --conf=/etc/masterha/app1.cnf</span><br><span class="line">Fri May  6 22:54:08 2022 - [warning] Global configuration file /etc/masterha_default.cnf not found. Skipping.</span><br><span class="line">Fri May  6 22:54:08 2022 - [info] Reading application default configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Fri May  6 22:54:08 2022 - [info] Reading server configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Fri May  6 22:54:08 2022 - [info] MHA::MasterMonitor version 0.54.</span><br><span class="line">Fri May  6 22:54:09 2022 - [info] Dead Servers:</span><br><span class="line">Fri May  6 22:54:09 2022 - [info] Alive Servers:</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]   192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]   192.168.73.22(192.168.73.22:3306)</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]   192.168.73.23(192.168.73.23:3306)</span><br><span class="line">Fri May  6 22:54:09 2022 - [info] Alive Slaves:</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]   192.168.73.22(192.168.73.22:3306)  Version=5.7.24-log (oldest major version between slaves) log-bin:enabled</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]     Replicating from 192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]     Primary candidate for the new Master (candidate_master is set)</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]   192.168.73.23(192.168.73.23:3306)  Version=5.7.24-log (oldest major version between slaves) log-bin:enabled</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]     Replicating from 192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Fri May  6 22:54:09 2022 - [info] Current Alive Master: 192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Fri May  6 22:54:09 2022 - [info] Checking slave configurations..</span><br><span class="line">Fri May  6 22:54:09 2022 - [info] Checking replication filtering settings..</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]  binlog_do_db= ha, binlog_ignore_db= mysql</span><br><span class="line">Fri May  6 22:54:09 2022 - [info]  Replication filtering check ok.</span><br><span class="line">Fri May  6 22:54:09 2022 - [info] Starting SSH connection tests..</span><br><span class="line">Fri May  6 22:54:12 2022 - [info] All SSH connection tests passed successfully.</span><br><span class="line">Fri May  6 22:54:12 2022 - [info] Checking MHA Node version..</span><br><span class="line">Fri May  6 22:54:14 2022 - [info]  Version check ok.</span><br><span class="line">Fri May  6 22:54:14 2022 - [info] Checking SSH publickey authentication settings on the current master..</span><br><span class="line">Fri May  6 22:54:14 2022 - [info] HealthCheck: SSH to 192.168.73.21 is reachable.</span><br><span class="line">Fri May  6 22:54:15 2022 - [info] Master MHA Node version is 0.54.</span><br><span class="line">Fri May  6 22:54:15 2022 - [info] Checking recovery script configurations on the current master..</span><br><span class="line">Fri May  6 22:54:15 2022 - [info]   Executing command: save_binary_logs --command=test --start_pos=4 --binlog_dir=/var/lib/mysql --output_file=/tmp/save_binary_logs_test --manager_version=0.54 --start_file=mysql-bin-master.000002</span><br><span class="line">Fri May  6 22:54:15 2022 - [info]   Connecting to root@192.168.73.21(192.168.73.21)..</span><br><span class="line">  Creating /tmp if not exists..    ok.</span><br><span class="line">  Checking output directory is accessible or not..</span><br><span class="line">   ok.</span><br><span class="line">  Binlog found at /var/lib/mysql, up to mysql-bin-master.000002</span><br><span class="line">Fri May  6 22:54:15 2022 - [info] Master setting check done.</span><br><span class="line">Fri May  6 22:54:15 2022 - [info] Checking SSH publickey authentication and checking recovery script configurations on all alive slave servers..</span><br><span class="line">Fri May  6 22:54:15 2022 - [info]   Executing command : apply_diff_relay_logs --command=test --slave_user=&apos;root&apos; --slave_host=192.168.73.22 --slave_ip=192.168.73.22 --slave_port=3306 --workdir=/tmp --target_version=5.7.24-log --manager_version=0.54 --relay_log_info=/var/lib/mysql/relay-log.info  --relay_dir=/var/lib/mysql/  --slave_pass=xxx</span><br><span class="line">Fri May  6 22:54:15 2022 - [info]   Connecting to root@192.168.73.22(192.168.73.22:22)..</span><br><span class="line">  Checking slave recovery environment settings..</span><br><span class="line">    Opening /var/lib/mysql/relay-log.info ... ok.</span><br><span class="line">    Relay log found at /var/lib/mysql, up to rhel_sqlsrv-relay-bin.000003</span><br><span class="line">    Temporary relay log file is /var/lib/mysql/rhel_sqlsrv-relay-bin.000003</span><br><span class="line">    Testing mysql connection and privileges..mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line"> done.</span><br><span class="line">    Testing mysqlbinlog output.. done.</span><br><span class="line">    Cleaning up test file(s).. done.</span><br><span class="line">Fri May  6 22:54:26 2022 - [info]   Executing command : apply_diff_relay_logs --command=test --slave_user=&apos;root&apos; --slave_host=192.168.73.23 --slave_ip=192.168.73.23 --slave_port=3306 --workdir=/tmp --target_version=5.7.24-log --manager_version=0.54 --relay_log_info=/var/lib/mysql/relay-log.info  --relay_dir=/var/lib/mysql/  --slave_pass=xxx</span><br><span class="line">Fri May  6 22:54:26 2022 - [info]   Connecting to root@192.168.73.23(192.168.73.23:22)..</span><br><span class="line">  Checking slave recovery environment settings..</span><br><span class="line">    Opening /var/lib/mysql/relay-log.info ... ok.</span><br><span class="line">    Relay log found at /var/lib/mysql, up to ctos_sqlsrv-relay-bin.000011</span><br><span class="line">    Temporary relay log file is /var/lib/mysql/ctos_sqlsrv-relay-bin.000011</span><br><span class="line">    Testing mysql connection and privileges..mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line"> done.</span><br><span class="line">    Testing mysqlbinlog output.. done.</span><br><span class="line">    Cleaning up test file(s).. done.</span><br><span class="line">Fri May  6 22:54:37 2022 - [info] Slaves settings check done.</span><br><span class="line">Fri May  6 22:54:37 2022 - [info]</span><br><span class="line">192.168.73.21 (current master)</span><br><span class="line"> +--192.168.73.22</span><br><span class="line"> +--192.168.73.23</span><br><span class="line"></span><br><span class="line">Fri May  6 22:54:37 2022 - [info] Checking replication health on 192.168.73.22..</span><br><span class="line">Fri May  6 22:54:37 2022 - [info]  ok.</span><br><span class="line">Fri May  6 22:54:37 2022 - [info] Checking replication health on 192.168.73.23..</span><br><span class="line">Fri May  6 22:54:37 2022 - [info]  ok.</span><br><span class="line">Fri May  6 22:54:37 2022 - [info] Checking master_ip_failover_script status:</span><br><span class="line">Fri May  6 22:54:37 2022 - [info]   /usr/local/bin/master_ip_failover --command=status --ssh_user=root --orig_master_host=192.168.73.21 --orig_master_ip=192.168.73.21 --orig_master_port=3306</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">IN SCRIPT TEST====/usr/sbin/ip addr del 192.168.73.73/24 dev ens33 label ens33:1==/usr/sbin/ip addr add 192.168.73.73/24 brd 192.168.73.255 dev ens33 label ens33:1;/usr/sbin/arping -q -A -c 1 -I ens33:1 192.168.73.73;iptables -F;===</span><br><span class="line"></span><br><span class="line">Checking the Status of the script.. OK</span><br><span class="line">Fri May  6 22:54:37 2022 - [info]  OK.</span><br><span class="line">Fri May  6 22:54:37 2022 - [warning] shutdown_script is not defined.</span><br><span class="line">Fri May  6 22:54:37 2022 - [info] Got exit code 0 (Not master dead).</span><br><span class="line"></span><br><span class="line">MySQL Replication Health is OK.</span><br></pre></td></tr></tbody></table></figure>
<p><code>MySQL Replication Health is NOT OK!</code> &#x5982;&#x679C;&#x63D0;&#x793A;&#x8FD9;&#x4E2A;&#x4E0D;OK&#xFF0C;&#x8BF4;&#x660E;&#x6709;&#x95EE;&#x9898;&#x3002;&#xFF08;&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#x53C2;&#x8003;&#x6700;&#x540E;&#x7AE0;&#x8282;&#xFF09;<br><code>MySQL Replication Health is OK.</code>&#x663E;&#x793A;Ok &#xFF0C;&#x6B63;&#x5E38;&#xFF01;</p>
<p>&#x53C2;&#x6570;&#x8C03;&#x8BD5;&#xFF1A;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ln -s /usr/local/mysql57/bin/mysqlbinlog /usr/local/bin/mysqlbinlog</span><br><span class="line">ln -s /usr/local/mysql57/bin/mysql /usr/local/bin/mysql</span><br><span class="line">[root@ctos7mini ~]&amp; grep master_ip_failover /etc/masterha/app1.cnf</span><br><span class="line"><span class="meta">#</span><span class="bash">master_ip_failover_script= /usr/<span class="built_in">local</span>/bin/master_ip_failover</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#xFF08;5&#xFF09;&#x68C0;&#x67E5;MHA Manager&#x7684;&#x72B6;&#x6001;&#xFF1A;</strong></p>
<p>&#x901A;&#x8FC7;master_check_status&#x811A;&#x672C;&#x67E5;&#x770B;Manager&#x7684;&#x72B6;&#x6001;&#xFF1A;</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; masterha_check_status --conf=/etc/masterha/app1.cnf</span><br><span class="line">app1 is stopped(2:NOT_RUNNING).</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x5982;&#x679C;&#x6B63;&#x5E38;&#xFF0C;&#x4F1A;&#x663E;&#x793A;&#x201D;PING_OK&#x201D;&#xFF0C;&#x5426;&#x5219;&#x4F1A;&#x663E;&#x793A;&#x201D;NOT_RUNNING&#x201D;&#xFF0C;&#x8FD9;&#x4EE3;&#x8868;MHA&#x76D1;&#x63A7;&#x6CA1;&#x6709;&#x5F00;&#x542F;</p>
<p><strong>&#xFF08;6&#xFF09;&#x5F00;&#x542F;MHA Manager&#x76D1;&#x63A7;</strong></p>
<pre><code>nohup masterha_manager --conf=/etc/masterha/app1.cnf --remove_dead_master_conf --ignore_last_failover &lt; /dev/null &gt; /var/log/masterha/app1/manager.log 2&gt;&amp;1 &amp;
</code></pre><p>&#x542F;&#x52A8;&#x53C2;&#x6570;&#x4ECB;&#x7ECD;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--remove_dead_master_conf&#xA0;&#xA0;&#xA0; &#x8BE5;&#x53C2;&#x6570;&#x4EE3;&#x8868;&#x5F53;&#x53D1;&#x751F;&#x4E3B;&#x4ECE;&#x5207;&#x6362;&#x540E;&#xFF0C;&#x8001;&#x7684;&#x4E3B;&#x5E93;&#x7684;ip&#x5C06;&#x4F1A;&#x4ECE;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#x79FB;&#x9664;</span><br><span class="line">--manger_log&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#x65E5;&#x5FD7;&#x5B58;&#x653E;&#x4F4D;&#x7F6E;</span><br><span class="line">--ignore_last_failover&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#x5728;&#x7F3A;&#x7701;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x5982;&#x679C;MHA&#x68C0;&#x6D4B;&#x5230;&#x8FDE;&#x7EED;&#x53D1;&#x751F;&#x5B95;&#x673A;&#xFF0C;&#x4E14;&#x4E24;&#x6B21;&#x5B95;&#x673A;&#x95F4;&#x9694;&#x4E0D;&#x8DB3;8&#x5C0F;&#x65F6;&#x7684;&#x8BDD;&#xFF0C;&#x5219;&#x4E0D;&#x4F1A;&#x8FDB;&#x884C;Failover&#xFF0C;&#x4E4B;&#x6240;&#x4EE5;&#x8FD9;&#x6837;&#x9650;&#x5236;&#x662F;&#x4E3A;&#x4E86;&#x907F;&#x514D;ping-pong&#x6548;&#x5E94;&#x3002;&#x8BE5;&#x53C2;&#x6570;&#x4EE3;&#x8868;&#x5FFD;&#x7565;&#x4E0A;&#x6B21;MHA&#x89E6;&#x53D1;&#x5207;&#x6362;&#x4EA7;&#x751F;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;MHA&#x53D1;&#x751F;&#x5207;&#x6362;&#x540E;&#x4F1A;&#x5728;&#x65E5;&#x5FD7;&#x76EE;&#x5F55;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x4E0A;&#x9762;&#x6211;&#x8BBE;&#x7F6E;&#x7684;/data&#x4EA7;&#x751F;app1.failover.complete&#x6587;&#x4EF6;&#xFF0C;&#x4E0B;&#x6B21;&#x518D;&#x6B21;&#x5207;&#x6362;&#x7684;&#x65F6;&#x5019;&#x5982;&#x679C;&#x53D1;&#x73B0;&#x8BE5;&#x76EE;&#x5F55;&#x4E0B;&#x5B58;&#x5728;&#x8BE5;&#x6587;&#x4EF6;&#x5C06;&#x4E0D;&#x5141;&#x8BB8;&#x89E6;&#x53D1;&#x5207;&#x6362;&#xFF0C;&#x9664;&#x975E;&#x5728;&#x7B2C;&#x4E00;&#x6B21;&#x5207;&#x6362;&#x540E;&#x6536;&#x5230;&#x5220;&#x9664;&#x8BE5;&#x6587;&#x4EF6;&#xFF0C;&#x4E3A;&#x4E86;&#x65B9;&#x4FBF;&#xFF0C;&#x8FD9;&#x91CC;&#x8BBE;&#x7F6E;&#x4E3A;--ignore_last_failover</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x7EE7;&#x7EED;&#x68C0;&#x67E5;MHA Manager&#x76D1;&#x63A7;&#x662F;&#x5426;&#x6B63;&#x5E38;&#xFF1A;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; masterha_check_status --conf=/etc/masterha/app1.cnf</span><br><span class="line">app1 (pid:2803) is running(0:PING_OK), master:192.168.73.21</span><br><span class="line">[6]-  Exit 1                  nohup masterha_manager --conf=/etc/masterha/app1.cnf --remove_dead_master_conf --ignore_last_failover &lt; /dev/null &gt; /var/log/masterha/app1/manager.log 2&gt;&amp;1</span><br><span class="line">[7]+  Exit 1                  nohup masterha_manager --conf=/etc/masterha/app1.cnf --remove_dead_master_conf --ignore_last_failover &lt; /dev/null &gt; /var/log/masterha/app1/manager.log 2&gt;&amp;1</span><br><span class="line">[root@ctos7mini ~]&amp; jobs</span><br><span class="line">[1]+  Running                 nohup masterha_manager --conf=/etc/masterha/app1.cnf --remove_dead_master_conf --ignore_last_failover &lt; /dev/null &gt; /var/log/masterha/app1/manager.log 2&gt;&amp;1 &amp;</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x53EF;&#x4EE5;&#x770B;&#x89C1;&#x5DF2;&#x7ECF;&#x5728;&#x76D1;&#x63A7;&#x4E86;&#xFF0C;&#x800C;&#x4E14;master&#x7684;&#x4E3B;&#x673A;&#x4E3A;192.168.73.21</p>
<p><strong>&#xFF08;7&#xFF09;&#x67E5;&#x770B;&#x542F;&#x52A8;&#x65E5;&#x5FD7;</strong><br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; tail -n 10 /var/log/masterha/app1/manager.log</span><br><span class="line">Fri May  6 23:16:28 2022 - [info]  OK.</span><br><span class="line">Fri May  6 23:16:28 2022 - [warning] shutdown_script is not defined.</span><br><span class="line">Fri May  6 23:16:28 2022 - [info] Set master ping interval 1 seconds.</span><br><span class="line">Fri May  6 23:16:28 2022 - [warning] secondary_check_script is not defined. It is highly recommended setting it to check master reachability from two or more routes.</span><br><span class="line">Fri May  6 23:16:28 2022 - [info] Starting ping health check on 192.168.73.21(192.168.73.21:3306)..</span><br><span class="line">Fri May  6 23:16:32 2022 - [warning] Got error when monitoring master:  at /usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm line 446.</span><br><span class="line">Fri May  6 23:16:32 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln448] Target master&apos;s advisory lock is already held by someone. Please check whether you monitor the same master from multiple monitoring processes.</span><br><span class="line">Fri May  6 23:16:32 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln468] Error happened on health checking.  at /usr/bin/masterha_manager line 50.</span><br><span class="line">Fri May  6 23:16:32 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln482] Error happened on monitoring servers.</span><br><span class="line">Fri May  6 23:16:32 2022 - [info] Got exit code 1 (Not master dead).</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6E05;&#x7A7A;&#x65E5;&#x5FD7;&#xFF0C;&#x7136;&#x540E;&#x5173;&#x95ED;&#x76D1;&#x63A7;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; echo &gt; /var/log/masterha/app1/manager.log</span><br><span class="line"></span><br><span class="line">[root@ctos7mini ~]&amp; masterha_stop --conf=/etc/masterha/app1.cnf</span><br><span class="line">Stopped app1 successfully.</span><br><span class="line">[1]+  Exit 1                  nohup masterha_manager --conf=/etc/masterha/app1.cnf --remove_dead_master_conf --ignore_last_failover &lt; /dev/null &gt; /var/log/masterha/app1/manager.log 2&gt;&amp;1</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x7EE7;&#x7EED;&#x5F00;&#x542F;&#x76D1;&#x63A7;</p>
<pre><code>nohup masterha_manager --conf=/etc/masterha/app1.cnf --remove_dead_master_conf --ignore_last_failover &lt; /dev/null &gt; /var/log/masterha/app1/manager.log 2&gt;&amp;1 &amp;
</code></pre><p>&#x89C2;&#x770B;&#x65E5;&#x5FD7;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; tail -n 10 /var/log/masterha/app1/manager.log</span><br><span class="line"></span><br><span class="line">IN SCRIPT TEST====/usr/sbin/ip addr del 192.168.73.73/24 dev ens33 label ens33:1==/usr/sbin/ip addr add 192.168.73.73/24 brd 192.168.73.255 dev ens33 label ens33:1;/usr/sbin/arping -q -A -c 1 -I ens33:1 192.168.73.73;iptables -F;===</span><br><span class="line"></span><br><span class="line">Checking the Status of the script.. OK</span><br><span class="line">Fri May  6 23:30:53 2022 - [info]  OK.</span><br><span class="line">Fri May  6 23:30:53 2022 - [warning] shutdown_script is not defined.</span><br><span class="line">Fri May  6 23:30:53 2022 - [info] Set master ping interval 1 seconds.</span><br><span class="line">Fri May  6 23:30:53 2022 - [warning] secondary_check_script is not defined. It is highly recommended setting it to check master reachability from two or more routes.</span><br><span class="line">Fri May  6 23:30:53 2022 - [info] Starting ping health check on 192.168.73.21(192.168.73.21:3306)..</span><br><span class="line">Fri May  6 23:30:53 2022 - [info] Ping(SELECT) succeeded, waiting until MySQL doesn&apos;t respond..</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5176;&#x4E2D;<code>Ping(SELECT) succeeded, waiting until MySQL doesn&apos;t respond..</code>&#x8BF4;&#x660E;&#x6574;&#x4E2A;&#x7CFB;&#x7EDF;&#x5DF2;&#x7ECF;&#x5F00;&#x59CB;&#x76D1;&#x63A7;&#x4E86;</p>
<p><strong>&#xFF08;9&#xFF09;&#x6A21;&#x62DF;&#x6545;&#x969C;</strong></p>
<p>&#x505C;&#x6389;MySQL&#x4E3B;&#x5E93;</p>
<pre><code>[root@rhel7 ~]# systemctl stop mysqld
</code></pre><p>&#x67E5;&#x770B;&#x65E5;&#x5FD7;&#xFF0C;&#x89C2;&#x5BDF;&#x96C6;&#x7FA4;&#x72B6;&#x51B5;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; tail -n 20 /var/log/masterha/app1/manager.log</span><br><span class="line"></span><br><span class="line">----- Failover Report -----</span><br><span class="line"></span><br><span class="line">app1: MySQL Master failover 192.168.73.21 to 192.168.73.22 succeeded</span><br><span class="line"></span><br><span class="line">Master 192.168.73.21 is down!</span><br><span class="line"></span><br><span class="line">Check MHA Manager logs at ctos7mini:/var/log/masterha/app1/manager.log for details.</span><br><span class="line"></span><br><span class="line">Started automated(non-interactive) failover.</span><br><span class="line">Invalidated master IP address on 192.168.73.21.</span><br><span class="line">The latest slave 192.168.73.22(192.168.73.22:3306) has all relay logs for recovery.</span><br><span class="line">Selected 192.168.73.22 as a new master.</span><br><span class="line">192.168.73.22: OK: Applying all logs succeeded.</span><br><span class="line">192.168.73.22: OK: Activated master IP address.</span><br><span class="line">192.168.73.23: This host has the latest relay log events.</span><br><span class="line">Generating relay diff files from the latest slave succeeded.</span><br><span class="line">192.168.73.23: OK: Applying all logs succeeded. Slave started, replicating from 192.168.73.22.</span><br><span class="line">192.168.73.22: Resetting slave info succeeded.</span><br><span class="line">Master failover to 192.168.73.22(192.168.73.22:3306) completed successfully.</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x67E5;&#x770B;192.168.73.22&#x7684;slave&#x72B6;&#x6001;&#xFF1A;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show slave status\G</span><br><span class="line">Empty <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x67E5;&#x770B;192.168.73.23&#x7684;slave&#x72B6;&#x6001;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 192.168.73.22</span><br><span class="line">                  Master_User: slave</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-slave2.000002</span><br><span class="line">          Read_Master_Log_Pos: 1048</span><br><span class="line">               Relay_Log_File: ctos_sqlsrv-relay-bin.000002</span><br><span class="line">                Relay_Log_Pos: 323</span><br><span class="line">        Relay_Master_Log_File: mysql-slave2.000002</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB:</span><br><span class="line">.................................................&#x7701;&#x7565;.......................................................</span><br><span class="line">             Master_Server_Id: 3</span><br><span class="line">                  Master_UUID: 90e5e492-cd2d-11ec-88d4-000c299254eb</span><br><span class="line">             Master_Info_File: /var/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind:</span><br><span class="line">.................................................&#x7701;&#x7565;.......................................................</span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x4E3B;&#x5E93;&#x53D8;&#x6210;&#x4E86;192.168.73.22&#xFF01;</p>
<p>&#x67E5;&#x770B;&#x5907;&#x7528;&#x4E3B;&#x5E93;&#x7684;IP&#x5730;&#x5740;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos_sqlsrv ~]&amp; ip addr show dev ens33</span><br><span class="line">2: ens33: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000</span><br><span class="line">    link/ether 00:0c:29:27:5c:d4 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 192.168.73.23/24 brd 192.168.73.255 scope global ens33</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet 192.168.73.73/24 brd 192.168.73.255 scope global secondary ens33:1</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::412f:a64f:e2ff:e154/64 scope link</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">[root@ctos_sqlsrv ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>ip&#x6F02;&#x79FB;&#x5230;&#x4E86;&#x5907;&#x7528;master&#x4E0A;</p>
<p>&#x5F00;&#x542F;down&#x6389;&#x7684;master&#xFF0C;&#x624B;&#x52A8;&#x8FDB;&#x884C;&#x5207;&#x6362;&#x4E3B;&#x5E93;&#xFF1A;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"> [root@ctos7mini ~]&amp; masterha_master_switch --conf=/etc/masterha/app1.cnf --master_state=alive --new_master_host=192.168.73.21 --new_master_port=3306 --orig_master_is_new_slave --running_updates_limit=10000</span><br><span class="line">Sat May  7 03:08:13 2022 - [info] MHA::MasterRotate version 0.54.</span><br><span class="line">Sat May  7 03:08:13 2022 - [info] Starting online master switch..</span><br><span class="line">Sat May  7 03:08:13 2022 - [info]</span><br><span class="line">Sat May  7 03:08:13 2022 - [info] * Phase 1: Configuration Check Phase..</span><br><span class="line">Sat May  7 03:08:13 2022 - [info]</span><br><span class="line">Sat May  7 03:08:13 2022 - [warning] Global configuration file /etc/masterha_default.cnf not found. Skipping.</span><br><span class="line">Sat May  7 03:08:13 2022 - [info] Reading application default configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Sat May  7 03:08:13 2022 - [info] Reading server configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Sat May  7 03:08:14 2022 - [info] Current Alive Master: 192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Sat May  7 03:08:14 2022 - [info] Alive Slaves:</span><br><span class="line">Sat May  7 03:08:14 2022 - [info]   192.168.73.22(192.168.73.22:3306)  Version=5.7.24-log (oldest major version between slaves) log-bin:enabled</span><br><span class="line">Sat May  7 03:08:14 2022 - [info]     Replicating from 192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Sat May  7 03:08:14 2022 - [info]     Primary candidate for the new Master (candidate_master is set)</span><br><span class="line">Sat May  7 03:08:14 2022 - [info]   192.168.73.23(192.168.73.23:3306)  Version=5.7.24-log (oldest major version between slaves) log-bin:enabled</span><br><span class="line">Sat May  7 03:08:14 2022 - [info]     Replicating from 192.168.73.21(192.168.73.21:3306)</span><br><span class="line"></span><br><span class="line">It is better to execute FLUSH NO_WRITE_TO_BINLOG TABLES on the master before switching. Is it ok to execute on 192.168.73.21(192.168.73.21:3306)? (YES/no): yes</span><br><span class="line">Sat May  7 03:08:17 2022 - [info] Executing FLUSH NO_WRITE_TO_BINLOG TABLES. This may take long time..</span><br><span class="line">Sat May  7 03:08:17 2022 - [info]  ok.</span><br><span class="line">Sat May  7 03:08:17 2022 - [info] Checking MHA is not monitoring or doing failover..</span><br><span class="line">Sat May  7 03:08:17 2022 - [info] Checking replication health on 192.168.73.22..</span><br><span class="line">Sat May  7 03:08:17 2022 - [info]  ok.</span><br><span class="line">Sat May  7 03:08:17 2022 - [info] Checking replication health on 192.168.73.23..</span><br><span class="line">Sat May  7 03:08:17 2022 - [info]  ok.</span><br><span class="line">Sat May  7 03:08:17 2022 - [info] 192.168.73.21 can be new master.</span><br><span class="line">Sat May  7 03:08:17 2022 - [info]</span><br><span class="line">From:</span><br><span class="line">192.168.73.21 (current master)</span><br><span class="line"> +--192.168.73.22</span><br><span class="line"> +--192.168.73.23</span><br><span class="line"></span><br><span class="line">To:</span><br><span class="line">192.168.73.21 (new master)</span><br><span class="line"> +--192.168.73.22</span><br><span class="line"> +--192.168.73.23</span><br><span class="line"> +--192.168.73.21</span><br><span class="line"></span><br><span class="line">Starting master switch from 192.168.73.21(192.168.73.21:3306) to 192.168.73.21(192.168.73.21:3306)? (yes/NO): yes</span><br><span class="line">Sat May  7 03:08:19 2022 - [info] Checking whether 192.168.73.21(192.168.73.21:3306) is ok for the new master..</span><br><span class="line">Sat May  7 03:08:19 2022 - [info]  ok.</span><br><span class="line">Sat May  7 03:08:19 2022 - [info] 192.168.73.21(192.168.73.21:3306): SHOW SLAVE STATUS returned empty result. To check replication filtering rules, temporarily executing CHANGE MASTER to a dummy host.</span><br><span class="line">Sat May  7 03:08:19 2022 - [info] 192.168.73.21(192.168.73.21:3306): Resetting slave pointing to the dummy host.</span><br><span class="line">Sat May  7 03:08:19 2022 - [info] ** Phase 1: Configuration Check Phase completed.</span><br><span class="line">Sat May  7 03:08:19 2022 - [info]</span><br><span class="line">Sat May  7 03:08:19 2022 - [info] * Phase 2: Rejecting updates Phase..</span><br><span class="line">Sat May  7 03:08:19 2022 - [info]</span><br><span class="line">Sat May  7 03:08:19 2022 - [info] Executing master ip online change script to disable write on the current master:</span><br><span class="line">Sat May  7 03:08:19 2022 - [info]   /usr/local/bin/master_ip_online_change --command=stop --orig_master_host=192.168.73.21 --orig_master_ip=192.168.73.21 --orig_master_port=3306 --orig_master_user=&apos;root&apos; --orig_master_password=&apos;ccc.456&apos; --new_master_host=192.168.73.21 --new_master_ip=192.168.73.21 --new_master_port=3306 --new_master_user=&apos;root&apos; --new_master_password=&apos;ccc.456&apos;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">***************************************************************</span><br><span class="line">Disabling the VIP - 192.168.73.73/24 on old master: 192.168.73.21</span><br><span class="line">***************************************************************</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Got Error: Use of uninitialized value $orig_master_ssh_user in concatenation (.) or string at /usr/local/bin/master_ip_online_change line 101.</span><br><span class="line"></span><br><span class="line">Sat May  7 03:08:19 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ManagerUtil.pm, ln178] Got ERROR:  at /usr/bin/masterha_master_switch line 53.</span><br><span class="line">[root@ctos7mini ~]&amp;</span><br></pre></td></tr></tbody></table></figure><p></p>
<h2 id="masterha&#x6545;&#x969C;&#x89E3;&#x51B3;"><a href="#masterha&#x6545;&#x969C;&#x89E3;&#x51B3;" class="headerlink" title="masterha&#x6545;&#x969C;&#x89E3;&#x51B3;"></a>masterha&#x6545;&#x969C;&#x89E3;&#x51B3;</h2><p><strong>&#x6545;&#x969C;&#x4E00;&#xFF1A;</strong><br></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">Fri May  6 22:43:11 2022 - [warning] Global configuration file /etc/masterha_default.cnf not found. Skipping.</span><br><span class="line">Fri May  6 22:43:11 2022 - [info] Reading application default configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Fri May  6 22:43:11 2022 - [info] Reading server configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Fri May  6 22:43:11 2022 - [info] MHA::MasterMonitor version 0.54.</span><br><span class="line">Fri May  6 22:43:11 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ServerManager.pm, ln255] Got MySQL error when connecting 192.168.73.22(192.168.73.22:3306) :1045:Access denied for user &apos;root&apos;@&apos;192.168.73.20&apos; (using password: YES), but this is not mysql crash. Check MySQL server settings.</span><br><span class="line"> at /usr/share/perl5/vendor_perl/MHA/ServerManager.pm line 251.</span><br><span class="line">Fri May  6 22:43:11 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ServerManager.pm, ln255] Got MySQL error when connecting 192.168.73.23(192.168.73.23:3306) :1045:Access denied for user &apos;root&apos;@&apos;192.168.73.20&apos; (using password: YES), but this is not mysql crash. Check MySQL server settings.</span><br><span class="line"> at /usr/share/perl5/vendor_perl/MHA/ServerManager.pm line 251.</span><br><span class="line">Fri May  6 22:43:11 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ServerManager.pm, ln255] Got MySQL error when connecting 192.168.73.21(192.168.73.21:3306) :1045:Access denied for user &apos;root&apos;@&apos;192.168.73.20&apos; (using password: YES), but this is not mysql crash. Check MySQL server settings.</span><br><span class="line"> at /usr/share/perl5/vendor_perl/MHA/ServerManager.pm line 251.</span><br><span class="line">Fri May  6 22:43:12 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ServerManager.pm, ln263] Got fatal error, stopping operations</span><br><span class="line">Fri May  6 22:43:12 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln386] Error happend on checking configurations.  at /usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm line 300.</span><br><span class="line">Fri May  6 22:43:12 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln482] Error happened on monitoring servers.</span><br><span class="line">Fri May  6 22:43:12 2022 - [info] Got exit code 1 (Not master dead).</span><br><span class="line"></span><br><span class="line">MySQL Replication Health is NOT OK!</span><br></pre></td></tr></tbody></table></figure><p></p>
<blockquote>
<p>mha&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x6570;&#x636E;&#x5E93;&#x7528;&#x6237;&#x5BC6;&#x7801;&#x4E0D;&#x6B63;&#x786E;&#xFF0C;&#x6216;&#x6CA1;&#x5F00;&#x542F;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;</p>
</blockquote>
<p><strong>&#x6545;&#x969C;&#x4E8C;&#xFF1A;</strong><br></p><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">Fri May  6 22:47:47 2022 - [warning] Global configuration file /etc/masterha_default.cnf not found. Skipping.</span><br><span class="line">Fri May  6 22:47:47 2022 - [info] Reading application default configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Fri May  6 22:47:47 2022 - [info] Reading server configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Fri May  6 22:47:47 2022 - [info] MHA::MasterMonitor version 0.54.</span><br><span class="line">Fri May  6 22:47:48 2022 - [info] Dead Servers:</span><br><span class="line">Fri May  6 22:47:48 2022 - [info] Alive Servers:</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]   192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]   192.168.73.22(192.168.73.22:3306)</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]   192.168.73.23(192.168.73.23:3306)</span><br><span class="line">Fri May  6 22:47:48 2022 - [info] Alive Slaves:</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]   192.168.73.22(192.168.73.22:3306)  Version=5.7.24-log (oldest major version between slaves) log-bin:enabled</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]     Replicating from 192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]     Primary candidate for the new Master (candidate_master is set)</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]   192.168.73.23(192.168.73.23:3306)  Version=5.7.24-log (oldest major version between slaves) log-bin:enabled</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]     Replicating from 192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Fri May  6 22:47:48 2022 - [info] Current Alive Master: 192.168.73.21(192.168.73.21:3306)</span><br><span class="line">Fri May  6 22:47:48 2022 - [info] Checking slave configurations..</span><br><span class="line">Fri May  6 22:47:48 2022 - [info] Checking replication filtering settings..</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]  binlog_do_db= ha, binlog_ignore_db= mysql</span><br><span class="line">Fri May  6 22:47:48 2022 - [info]  Replication filtering check ok.</span><br><span class="line">Fri May  6 22:47:48 2022 - [info] Starting SSH connection tests..</span><br><span class="line">Fri May  6 22:47:52 2022 - [info] All SSH connection tests passed successfully.</span><br><span class="line">Fri May  6 22:47:52 2022 - [info] Checking MHA Node version..</span><br><span class="line">Fri May  6 22:47:52 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ManagerUtil.pm, ln122] Got error when getting node version. Error:</span><br><span class="line">Fri May  6 22:47:52 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ManagerUtil.pm, ln123]</span><br><span class="line">bash: apply_diff_relay_logs: command not found</span><br><span class="line">Fri May  6 22:47:52 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ManagerUtil.pm, ln151] node version on 192.168.73.22 not found! Maybe MHA Node package is not installed?</span><br><span class="line"> at /usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm line 346.</span><br><span class="line">Fri May  6 22:47:52 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln386] Error happend on checking configurations. node version on 192.168.73.22 not found! Maybe MHA Node package is not installed?</span><br><span class="line"> at /usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm line 346.</span><br><span class="line">        ...propagated at /usr/share/perl5/vendor_perl/MHA/ManagerUtil.pm line 152.</span><br><span class="line">Fri May  6 22:47:52 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln482] Error happened on monitoring servers.</span><br><span class="line">Fri May  6 22:47:52 2022 - [info] Got exit code 1 (Not master dead).</span><br><span class="line"></span><br><span class="line">MySQL Replication Health is NOT OK!</span><br></pre></td></tr></tbody></table></figure><p></p>
<blockquote>
<p>MySQL&#x670D;&#x52A1;&#x5668;&#x6CA1;&#x6709;&#x5B89;&#x88C5;mha node&#x5DE5;&#x5177;</p>
</blockquote>
<p><strong>&#x6545;&#x969C;&#x4E09;&#xFF1A;</strong></p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="https://gitee.com/fnaichu/mypicbed/raw/master/img/202205061455441.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<blockquote>
<p>&#x5BFC;&#x81F4;&#x8BE5;&#x6545;&#x969C;&#x7684;&#x539F;&#x56E0;&#x6709;&#x5F88;&#x591A;&#xFF0C;&#x5927;&#x90E8;&#x5206;&#x662F;&#x4F9D;&#x8D56;&#x5305;&#x5173;&#x7CFB;&#x6CA1;&#x6709;&#x89E3;&#x51B3;&#xFF0C;&#x5177;&#x4F53;&#x9700;&#x8981;&#x6839;&#x636E;&#x5B9E;&#x65F6;&#x73AF;&#x5883;&#x5206;&#x6790;&#x89E3;&#x51B3;</p>
</blockquote>
<ul>
<li>&#x53C2;&#x8003;&#x601D;&#x8DEF;&#xFF1A;<br>&#x786E;&#x4FDD;MySQL&#x7684;<code>libs</code>&#x548C;<code>libs-compat</code>&#x5305;&#x5B89;&#x88C5;&#x4E86;&#xFF0C;&#x5B83;&#x63D0;&#x4F9B;&#x4E86;MySQL&#x9700;&#x8981;&#x7684;&#x52A8;&#x6001;&#x94FE;&#x63A5;&#x5E93;<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@ctos7mini ~]&amp; rpm -qa |grep mysql-community</span><br><span class="line">mysql-community-common-5.7.24-1.el7.x86_64</span><br><span class="line">mysql-community-libs-compat-5.7.32-1.el7.x86_64</span><br><span class="line">mysql-community-libs-5.7.24-1.el7.x86_64</span><br><span class="line">mysql-community-server-5.7.24-1.el7.x86_64</span><br><span class="line">mysql-community-client-5.7.24-1.el7.x86_64</span><br></pre></td></tr></tbody></table></figure>
</li>
</ul>
<p><strong>&#x6545;&#x969C;&#x56DB;&#xFF1A;</strong><br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Sat May  7 00:13:00 2022 - [warning] Global configuration file /etc/masterha_default.cnf not found. Skipping.</span><br><span class="line">Sat May  7 00:13:00 2022 - [info] Reading application default configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Sat May  7 00:13:00 2022 - [info] Reading server configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Sat May  7 00:13:00 2022 - [info] MHA::MasterMonitor version 0.54.</span><br><span class="line">Sat May  7 00:13:01 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ServerManager.pm, ln622] Master 192.168.73.21:3306 from which slave 192.168.73.23(192.168.73.23:3306) replicates is not defined in the configuration file!</span><br><span class="line">Sat May  7 00:13:01 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln386] Error happend on checking configurations.  at /usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm line 300.</span><br><span class="line">Sat May  7 00:13:01 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln482] Error happened on monitoring servers.</span><br><span class="line">Sat May  7 00:13:01 2022 - [info] Got exit code 1 (Not master dead).</span><br><span class="line"></span><br><span class="line">MySQL Replication Health is NOT OK!</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">Sat May  7 00:35:16 2022 - [warning] Global configuration file /etc/masterha_default.cnf not found. Skipping.</span><br><span class="line">Sat May  7 00:35:16 2022 - [info] Reading application default configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Sat May  7 00:35:16 2022 - [info] Reading server configurations from /etc/masterha/app1.cnf..</span><br><span class="line">Sat May  7 00:35:16 2022 - [info] MHA::MasterMonitor version 0.54.</span><br><span class="line">Sat May  7 00:35:17 2022 - [error][/usr/share/perl5/vendor_perl/MHA/ServerManager.pm, ln193] There is no alive slave. We can&apos;t do failover</span><br><span class="line">Sat May  7 00:35:17 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln386] Error happend on checking configurations.  at /usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm line 300.</span><br><span class="line">Sat May  7 00:35:17 2022 - [error][/usr/share/perl5/vendor_perl/MHA/MasterMonitor.pm, ln482] Error happened on monitoring servers.</span><br><span class="line">Sat May  7 00:35:17 2022 - [info] Got exit code 1 (Not master dead).</span><br><span class="line"></span><br><span class="line">MySQL Replication Health is NOT OK!</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/db0340bd/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-MySQL的GTID主从同步" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/d77fafec/">MySQL的GTID主从同步</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:45:07" datetime="2022-06-07T04:45:07.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h2 id="MySQL-GTID-&#x4E3B;&#x4ECE;&#x540C;&#x6B65;"><a href="#MySQL-GTID-&#x4E3B;&#x4ECE;&#x540C;&#x6B65;" class="headerlink" title="MySQL GTID &#x4E3B;&#x4ECE;&#x540C;&#x6B65;"></a>MySQL GTID &#x4E3B;&#x4ECE;&#x540C;&#x6B65;</h2><p><strong>&#x6982;&#x5FF5;</strong></p>
<p>&#x4ECE; MySQL 5.6.5 &#x5F00;&#x59CB;&#x65B0;&#x589E;&#x4E86;&#x4E00;&#x79CD;&#x57FA;&#x4E8E; GTID &#x7684;&#x590D;&#x5236;&#x65B9;&#x5F0F;&#x3002;&#x901A;&#x8FC7; GTID&#x4FDD;&#x8BC1;&#x4E86;&#x6BCF;&#x4E2A;&#x5728;&#x4E3B;&#x5E93;&#x4E0A;&#x63D0;&#x4EA4;&#x7684;&#x4E8B;&#x52A1;&#x5728;&#x96C6;&#x7FA4;&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;ID&#x3002;<br>&#x8FD9;&#x79CD;&#x65B9;&#x5F0F;&#x5F3A;&#x5316;&#x4E86;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4E3B;&#x5907;&#x4E00;&#x81F4;&#x6027;&#xFF0C;&#x6545;&#x969C;&#x6062;&#x590D;&#x4EE5;&#x53CA;&#x5BB9;&#x9519;&#x80FD;&#x529B;&#x3002;<br>&#x5728;&#x539F;&#x6765;&#x57FA;&#x4E8E;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x7684;&#x590D;&#x5236;&#xFF0C;&#x4ECE;&#x5E93;&#x9700;&#x8981;&#x544A;&#x77E5;&#x4E3B;&#x5E93;&#x8981;&#x4ECE;&#x54EA;&#x4E2A;&#x504F;&#x79FB;&#x91CF;&#x8FDB;&#x884C;&#x589E;&#x91CF;&#x540C;&#x6B65;&#xFF0C;&#x5982;&#x679C;&#x6307;&#x5B9A;&#x9519;&#x8BEF;&#x4F1A;&#x9020;&#x6210;&#x6570;&#x636E;&#x7684;&#x9057;&#x6F0F;&#xFF0C;&#x4ECE;&#x800C;&#x9020;&#x6210;&#x6570;&#x636E;&#x7684;&#x4E0D;&#x4E00;&#x81F4;&#x3002;<br>&#x501F;&#x52A9;GTID&#xFF0C;&#x5728;&#x53D1;&#x751F;&#x4E3B;&#x5907;&#x5207;&#x6362;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;MySQL&#x7684;&#x5176;&#x5B83;&#x4ECE;&#x5E93;&#x53EF;&#x4EE5;&#x81EA;&#x52A8;&#x5728;&#x65B0;&#x4E3B;&#x5E93;&#x4E0A;&#x627E;&#x5230;&#x6B63;&#x786E;&#x7684;&#x590D;&#x5236;&#x4F4D;&#x7F6E;&#xFF0C;&#x8FD9;&#x5927;&#x5927;&#x7B80;&#x5316;&#x4E86;&#x590D;&#x6742;&#x590D;&#x5236;&#x62D3;&#x6251;&#x4E0B;&#x96C6;&#x7FA4;&#x7684;&#x7EF4;&#x62A4;&#xFF0C;<br>&#x4E5F;&#x51CF;&#x5C11;&#x4E86;&#x4EBA;&#x4E3A;&#x8BBE;&#x7F6E;&#x590D;&#x5236;&#x4F4D;&#x7F6E;&#x53D1;&#x751F;&#x8BEF;&#x64CD;&#x4F5C;&#x7684;&#x98CE;&#x9669;&#x3002;&#x53E6;&#x5916;&#xFF0C;&#x57FA;&#x4E8E;GTID&#x7684;&#x590D;&#x5236;&#x53EF;&#x4EE5;&#x5FFD;&#x7565;&#x5DF2;&#x7ECF;&#x6267;&#x884C;&#x8FC7;&#x7684;&#x4E8B;&#x52A1;&#xFF0C;&#x51CF;&#x5C11;&#x4E86;&#x6570;&#x636E;&#x53D1;&#x751F;&#x4E0D;&#x4E00;&#x81F4;&#x7684;&#x98CE;&#x9669;&#x3002;</p>
<h2 id="&#x4EC0;&#x4E48;&#x662F;GTID&#xFF1F;"><a href="#&#x4EC0;&#x4E48;&#x662F;GTID&#xFF1F;" class="headerlink" title="&#x4EC0;&#x4E48;&#x662F;GTID&#xFF1F;"></a>&#x4EC0;&#x4E48;&#x662F;GTID&#xFF1F;</h2><p>GTID (Global Transaction ID) &#x662F;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x5DF2;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x7684;&#x7F16;&#x53F7;&#xFF0C;&#x5E76;&#x4E14;&#x662F;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x552F;&#x4E00;&#x7684;&#x7F16;&#x53F7;&#x3002; GTID &#x5B9E;&#x9645;&#x4E0A; &#x662F;&#x7531;UUID+TID &#x7EC4;&#x6210;&#x7684;&#x3002;<br>&#x5176;&#x4E2D; UUID &#x662F;&#x4E00;&#x4E2A; MySQL &#x5B9E;&#x4F8B;&#x7684;&#x552F;&#x4E00;&#x6807;&#x8BC6;&#x3002;TID&#x4EE3;&#x8868;&#x4E86;&#x8BE5;&#x5B9E;&#x4F8B;&#x4E0A;&#x5DF2;&#x7ECF;&#x63D0;&#x4EA4;&#x7684;&#x4E8B;&#x52A1;&#x6570;&#x91CF;&#xFF0C;&#x5E76;&#x4E14;&#x968F;&#x7740;&#x4E8B;&#x52A1;&#x63D0;&#x4EA4;&#x5355;&#x8C03;&#x9012;&#x589E;&#x3002;</p>
<p>&#x4E0B;&#x9762;&#x662F;&#x4E00;&#x4E2A;GTID&#x7684;&#x5177;&#x4F53;&#x5F62;&#x5F0F;&#xFF1A;03a1eb63-c21a-11ec-b07f-000c2987bea6:1-25&#xFF0C;&#x5192;&#x53F7;&#x5206;&#x5272;&#x524D;&#x8FB9;&#x4E3A;UUID&#xFF0C;&#x540E;&#x8FB9;&#x4E3A;TID&#x3002;  </p>
<p>GTID &#x96C6;&#x5408;&#x53EF;&#x4EE5;&#x5305;&#x542B;&#x6765;&#x81EA;&#x591A;&#x4E2A; MySQL &#x5B9E;&#x4F8B;&#x7684;&#x4E8B;&#x52A1;&#xFF0C;&#x5B83;&#x4EEC;&#x4E4B;&#x95F4;&#x7528;&#x9017;&#x53F7;&#x5206;&#x9694;&#x3002;  </p>
<p>&#x5982;&#x679C;&#x6765;&#x81EA;&#x540C;&#x4E00;MySQL&#x5B9E;&#x4F8B;&#x7684;&#x4E8B;&#x52A1;&#x5E8F;&#x53F7;&#x6709;&#x591A;&#x4E2A;&#x8303;&#x56F4;&#x533A;&#x95F4;&#xFF0C;&#x5404;&#x7EC4;&#x8303;&#x56F4;&#x4E4B;&#x95F4;&#x7528;&#x5192;&#x53F7;&#x5206;&#x9694;&#x3002;<br>&#x4F8B;&#x5982;&#xFF1A; 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-6,03a1eb63-c21a-11ec-b07f-000c2987bea6:1-25<br>    &#x53EF;&#x4EE5;&#x4F7F;&#x7528;show master status&#x5B9E;&#x65F6;&#x67E5;&#x770B;&#x5F53;&#x524D;&#x4E8B;&#x52A1;&#x6267;&#x884C;&#x6570;&#x3002;  </p>
<h2 id="GTID&#x7684;&#x4F5C;&#x7528;"><a href="#GTID&#x7684;&#x4F5C;&#x7528;" class="headerlink" title="GTID&#x7684;&#x4F5C;&#x7528;"></a>GTID&#x7684;&#x4F5C;&#x7528;</h2><p>GTID&#x91C7;&#x7528;&#x4E86;&#x65B0;&#x7684;&#x590D;&#x5236;&#x534F;&#x8BAE;&#xFF0C;&#x65E7;&#x534F;&#x8BAE;&#x662F;&#xFF0C;&#x9996;&#x5148;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x5728;&#x4E00;&#x4E2A;&#x7279;&#x5B9A;&#x7684;&#x504F;&#x79FB;&#x91CF;&#x4F4D;&#x7F6E;&#x8FDE;&#x63A5;&#x5230;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x4E00;&#x4E2A;&#x7ED9;&#x5B9A;&#x7684;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x518D;&#x4ECE;&#x7ED9;&#x5B9A;&#x7684;&#x8FDE;&#x63A5;&#x70B9;&#x5F00;&#x59CB;&#x53D1;&#x9001;&#x6240;&#x6709;&#x7684;&#x4E8B;&#x4EF6;&#x3002;<br>&#x65B0;&#x534F;&#x8BAE;&#x6709;&#x6240;&#x4E0D;&#x540C;&#xFF0C;&#x652F;&#x6301;&#x4EE5;&#x5168;&#x5C40;&#x7EDF;&#x4E00;&#x4E8B;&#x52A1;ID (GTID)&#x4E3A;&#x57FA;&#x7840;&#x7684;&#x590D;&#x5236;&#x3002;&#x5F53;&#x5728;&#x4E3B;&#x5E93;&#x4E0A;&#x63D0;&#x4EA4;&#x4E8B;&#x52A1;&#x6216;&#x8005;&#x88AB;&#x4ECE;&#x5E93;&#x5E94;&#x7528;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x5B9A;&#x4F4D;&#x548C;&#x8FFD;&#x8E2A;&#x6BCF;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x3002;<br>GTID&#x590D;&#x5236;&#x662F;&#x5168;&#x90E8;&#x4EE5;&#x4E8B;&#x52A1;&#x4E3A;&#x57FA;&#x7840;&#xFF0C;&#x4F7F;&#x5F97;&#x68C0;&#x67E5;&#x4E3B;&#x4ECE;&#x4E00;&#x81F4;&#x6027;&#x53D8;&#x5F97;&#x975E;&#x5E38;&#x7B80;&#x5355;&#x3002;&#x5982;&#x679C;&#x6240;&#x6709;&#x4E3B;&#x5E93;&#x4E0A;&#x63D0;&#x4EA4;&#x7684;&#x4E8B;&#x52A1;&#x4E5F;&#x540C;&#x6837;&#x63D0;&#x4EA4;&#x5230;&#x4ECE;&#x5E93;&#x4E0A;&#xFF0C;&#x4E00;&#x81F4;&#x6027;&#x5C31;&#x5F97;&#x5230;&#x4E86;&#x4FDD;&#x8BC1;&#x3002;  </p>
<h2 id="GTID&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;"><a href="#GTID&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;" class="headerlink" title="GTID&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;"></a>GTID&#x7684;&#x5DE5;&#x4F5C;&#x539F;&#x7406;</h2><p>&#x2460; &#x5F53;&#x4E00;&#x4E2A;&#x4E8B;&#x52A1;&#x5728;&#x4E3B;&#x5E93;&#x7AEF;&#x6267;&#x884C;&#x5E76;&#x63D0;&#x4EA4;&#x65F6;&#xFF0C;&#x4EA7;&#x751F;GTID&#xFF0C;&#x4E00;&#x540C;&#x8BB0;&#x5F55;&#x5230;binlog&#x65E5;&#x5FD7;&#x4E2D;&#x3002;<br>&#x2461; binlog&#x4F20;&#x8F93;&#x5230;slave,&#x5E76;&#x5B58;&#x50A8;&#x5230;slave&#x7684;relaylog&#x540E;&#xFF0C;&#x8BFB;&#x53D6;&#x8FD9;&#x4E2A;GTID&#x7684;&#x8FD9;&#x4E2A;&#x503C;&#x8BBE;&#x7F6E;GTID_next&#x53D8;&#x91CF;&#xFF0C;&#x5373;&#x544A;&#x8BC9;Slave&#xFF0C;&#x4E0B;&#x4E00;&#x4E2A;&#x8981;&#x6267;&#x884C;&#x7684;GTID&#x503C;&#x3002;<br>&#x2462; sql&#x7EBF;&#x7A0B;&#x4ECE;relay log&#x4E2D;&#x83B7;&#x53D6;GTID&#xFF0C;&#x7136;&#x540E;&#x5BF9;&#x6BD4;slave&#x7AEF;&#x7684;binlog&#x662F;&#x5426;&#x6709;&#x8BE5;GTID&#x3002;<br>&#x2463; &#x5982;&#x679C;&#x6709;&#x8BB0;&#x5F55;&#xFF0C;&#x8BF4;&#x660E;&#x8BE5;GTID&#x7684;&#x4E8B;&#x52A1;&#x5DF2;&#x7ECF;&#x6267;&#x884C;&#xFF0C;slave&#x4F1A;&#x5FFD;&#x7565;&#x3002;<br>&#x2464; &#x5982;&#x679C;&#x6CA1;&#x6709;&#x8BB0;&#x5F55;&#xFF0C;slave&#x5C31;&#x4F1A;&#x6267;&#x884C;&#x8BE5;GTID&#x4E8B;&#x52A1;&#xFF0C;&#x5E76;&#x8BB0;&#x5F55;&#x8BE5;GTID&#x5230;&#x81EA;&#x8EAB;&#x7684;binlog&#xFF0C;&#x5728;&#x8BFB;&#x53D6;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#x524D;&#x4F1A;&#x5148;&#x68C0;&#x67E5;&#x5176;&#x4ED6;session&#x6301;&#x6709;&#x8BE5;GTID&#xFF0C;&#x786E;&#x4FDD;&#x4E0D;&#x88AB;&#x91CD;&#x590D;&#x6267;&#x884C;&#x3002;<br>&#x2465; &#x5728;&#x89E3;&#x6790;&#x8FC7;&#x7A0B;&#x4E2D;&#x4F1A;&#x5224;&#x65AD;&#x662F;&#x5426;&#x6709;&#x4E3B;&#x952E;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5C31;&#x7528;&#x4E8C;&#x7EA7;&#x7D22;&#x5F15;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x5C31;&#x7528;&#x5168;&#x90E8;&#x626B;&#x63CF;&#x3002;  </p>
<h2 id="GTID&#x6BD4;&#x4F20;&#x7EDF;&#x590D;&#x5236;&#x7684;&#x4F18;&#x52BF;"><a href="#GTID&#x6BD4;&#x4F20;&#x7EDF;&#x590D;&#x5236;&#x7684;&#x4F18;&#x52BF;" class="headerlink" title="GTID&#x6BD4;&#x4F20;&#x7EDF;&#x590D;&#x5236;&#x7684;&#x4F18;&#x52BF;"></a>GTID&#x6BD4;&#x4F20;&#x7EDF;&#x590D;&#x5236;&#x7684;&#x4F18;&#x52BF;</h2><ul>
<li>&#x66F4;&#x7B80;&#x5355;&#x7684;&#x5B9E;&#x73B0;failover&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x627E;log_file&#x548C;log_Pos  </li>
<li>&#x66F4;&#x7B80;&#x5355;&#x7684;&#x642D;&#x5EFA;&#x4E3B;&#x4ECE;&#x590D;&#x5236;</li>
<li>&#x6BD4;&#x4F20;&#x7EDF;&#x590D;&#x5236;&#x66F4;&#x52A0;&#x5B89;&#x5168;</li>
<li>GTID&#x662F;&#x8FDE;&#x7EED;&#x6CA1;&#x6709;&#x7A7A;&#x6D1E;&#x7684;&#xFF0C;&#x56E0;&#x6B64;&#x4E3B;&#x4ECE;&#x5E93;&#x51FA;&#x73B0;&#x6570;&#x636E;&#x51B2;&#x7A81;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x6DFB;&#x52A0;&#x7A7A;&#x4E8B;&#x7269;&#x7684;&#x65B9;&#x5F0F;&#x8FDB;&#x884C;&#x8DF3;&#x8FC7;</li>
</ul>
<h2 id="&#x914D;&#x7F6E;&#x4E00;&#x4E3B;&#x4E00;&#x4ECE;GTID"><a href="#&#x914D;&#x7F6E;&#x4E00;&#x4E3B;&#x4E00;&#x4ECE;GTID" class="headerlink" title="&#x914D;&#x7F6E;&#x4E00;&#x4E3B;&#x4E00;&#x4ECE;GTID"></a>&#x914D;&#x7F6E;&#x4E00;&#x4E3B;&#x4E00;&#x4ECE;GTID</h2><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#x6570;&#x636E;&#x5E93;&#x89D2;&#x8272;           IP         &#x7CFB;&#x7EDF;&#x4E0E;MySQL&#x7248;&#x672C;         &#x6709;&#x65E0;&#x6570;&#x636E;</span><br><span class="line">&#x4E3B;&#x6570;&#x636E;&#x5E93;	    192.168.10.11    RHEL7 MySQL5.7        &#x65E0;&#x6570;&#x636E;</span><br><span class="line">&#x4ECE;&#x6570;&#x636E;&#x5E93;	    192.168.10.12    RHEL7 MySQL5.7        &#x65E0;&#x6570;&#x636E;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5728;&#x4E3B;&#x6570;&#x636E;&#x5E93;&#x91CC;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x540C;&#x6B65;&#x8D26;&#x6237;&#x6388;&#x6743;&#x7ED9;&#x4ECE;&#x6570;&#x636E;&#x5E93;&#x4F7F;&#x7528;</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@server11 ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 5</span><br><span class="line">Server version: 5.7.24 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; grant replication slave on *.* to &apos;Jaking&apos;@&apos;192.168.10.%&apos; identified by &apos;Jaking@vip.163.com&apos;;</span><br><span class="line">Query OK, 0 rows affected, 1 warning (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; flush privileges;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; exit</span><br><span class="line">Bye</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x914D;&#x7F6E;&#x4E3B;&#x5E93;&#x6587;&#x4EF6;</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">[root@server11 ~]# vim /etc/my.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">port=3306</span><br><span class="line">datadir=/var/lib/mysql</span><br><span class="line">socket=/var/lib/mysql/mysql.sock</span><br><span class="line">skip-name-resolve</span><br><span class="line">symbolic-links=0</span><br><span class="line"></span><br><span class="line">log-error=/var/log/mysqld.log</span><br><span class="line">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class="line">skip-name-resolve</span><br><span class="line"></span><br><span class="line">log-bin=mysql-bin                        // &#x5F00;&#x542F;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;</span><br><span class="line">server-id=11                             // &#x670D;&#x52A1;&#x5668;ID&#xFF0C;&#x5FC5;&#x987B;&#x552F;&#x4E00;</span><br><span class="line">gtid-mode=on                             #&#x5F00;&#x542F;gtid&#x6A21;&#x5F0F;</span><br><span class="line">enforce-gtid-consistency=on       //&#x5F3A;&#x5236;gtid&#x4E00;&#x81F4;&#x6027;&#xFF0C;&#x5F00;&#x542F;&#x540E;&#x5BF9;&#x7279;&#x5B9A;&#x7684;create table&#x4E0D;&#x652F;&#x6301;</span><br><span class="line">binlog-format=row                       //&#x9ED8;&#x8BA4;&#x4E3A;mixed&#x6DF7;&#x5408;&#x6A21;&#x5F0F;&#xFF0C;&#x66F4;&#x6539;&#x6210;row&#x590D;&#x5236;&#xFF0C;&#x4E3A;&#x4E86;&#x6570;&#x636E;&#x4E00;&#x81F4;&#x6027;</span><br><span class="line">log-slave-updates=1                    //&#x4ECE;&#x5E93;binlog&#x8BB0;&#x5F55;&#x4E3B;&#x5E93;&#x540C;&#x6B65;&#x7684;&#x64CD;&#x4F5C;&#x65E5;&#x5FD7;</span><br><span class="line">skip-slave-start=1                         //&#x8DF3;&#x8FC7;slave&#x590D;&#x5236;&#x7EBF;&#x7A0B;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">[root@server11 ~]# systemctl restart mysqld</span><br><span class="line">[root@server11 ~]# systemctl status mysqld </span><br><span class="line">&#x25CF; mysqld.service - MySQL Server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Fri 2022-04-22 05:28:12 EDT; 6s ago</span><br><span class="line">     Docs: man:mysqld(8)</span><br><span class="line">           http://dev.mysql.com/doc/refman/en/using-systemd.html</span><br><span class="line">  Process: 11752 ExecStart=/usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 11730 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 11755 (mysqld)</span><br><span class="line">    Tasks: 27</span><br><span class="line">   CGroup: /system.slice/mysqld.service</span><br><span class="line">           &#x2514;&#x2500;11755 /usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld...</span><br><span class="line"></span><br><span class="line">Apr 22 05:28:11 server11 systemd[1]: Stopped MySQL Server.</span><br><span class="line">Apr 22 05:28:11 server11 systemd[1]: Starting MySQL Server...</span><br><span class="line">Apr 22 05:28:12 server11 systemd[1]: Started MySQL Server.</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x67E5;&#x770B;GTID&#x6A21;&#x5F0F;&#x72B6;&#x6001;</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@server11 ~]# mysql -uroot -pJaking@vip.163.com -e &apos;show variables like &quot;%GTID%&quot;;&apos;</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">+----------------------------------+-----------+</span><br><span class="line">| Variable_name                    | Value     |</span><br><span class="line">+----------------------------------+-----------+</span><br><span class="line">| binlog_gtid_simple_recovery      | ON        |</span><br><span class="line">| enforce_gtid_consistency         | ON        |</span><br><span class="line">| gtid_executed_compression_period | 1000      |</span><br><span class="line">| gtid_mode                        | ON        |</span><br><span class="line">| gtid_next                        | AUTOMATIC |</span><br><span class="line">| gtid_owned                       |           |</span><br><span class="line">| gtid_purged                      |           |</span><br><span class="line">| session_track_gtids              | OFF       |</span><br><span class="line">+----------------------------------+-----------+</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x914D;&#x7F6E;&#x4ECE;&#x5E93;&#x6587;&#x4EF6;</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">[root@server12 ~]# vim /etc/my.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">port=3306</span><br><span class="line">datadir=/var/lib/mysql</span><br><span class="line">socket=/var/lib/mysql/mysql.sock</span><br><span class="line">symbolic-links=0</span><br><span class="line"></span><br><span class="line">log-error=/var/log/mysqld.log</span><br><span class="line">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class="line">skip-name-resolve</span><br><span class="line"></span><br><span class="line">log-bin=mysql-bin</span><br><span class="line">server-id=12</span><br><span class="line">gtid-mode=on  </span><br><span class="line">enforce-gtid-consistency=on          </span><br><span class="line">binlog-format=row</span><br><span class="line">log-slave-updates=1</span><br><span class="line">skip-slave-start=1</span><br><span class="line">[root@server12 ~]# systemctl restart mysqld</span><br><span class="line">[root@server12 ~]# systemctl status mysqld </span><br><span class="line">&#x25CF; mysqld.service - MySQL Server</span><br><span class="line">   Loaded: loaded (/usr/lib/systemd/system/mysqld.service; enabled; vendor preset: disabled)</span><br><span class="line">   Active: active (running) since Fri 2022-04-22 18:08:39 CST; 8s ago</span><br><span class="line">     Docs: man:mysqld(8)</span><br><span class="line">           http://dev.mysql.com/doc/refman/en/using-systemd.html</span><br><span class="line">  Process: 2749 ExecStart=/usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/mysqld.pid $MYSQLD_OPTS (code=exited, status=0/SUCCESS)</span><br><span class="line">  Process: 2731 ExecStartPre=/usr/bin/mysqld_pre_systemd (code=exited, status=0/SUCCESS)</span><br><span class="line"> Main PID: 2753 (mysqld)</span><br><span class="line">   CGroup: /system.slice/mysqld.service</span><br><span class="line">           &#x2514;&#x2500;2753 /usr/sbin/mysqld --daemonize --pid-file=/var/run/mysqld/...</span><br><span class="line"></span><br><span class="line">Apr 22 18:08:38 server12 systemd[1]: Starting MySQL Server...</span><br><span class="line">Apr 22 18:08:39 server12 systemd[1]: Started MySQL Server.</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x67E5;&#x770B;GTID&#x6A21;&#x5F0F;&#x72B6;&#x6001;</strong></p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@server12 ~]# mysql -uroot -pJaking@vip.163.com -e &apos;show variables like &quot;%GTID%&quot;;&apos;</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">+----------------------------------+-----------+</span><br><span class="line">| Variable_name                    | Value     |</span><br><span class="line">+----------------------------------+-----------+</span><br><span class="line">| binlog_gtid_simple_recovery      | ON        |</span><br><span class="line">| enforce_gtid_consistency         | ON        |</span><br><span class="line">| gtid_executed_compression_period | 1000      |</span><br><span class="line">| gtid_mode                        | ON        |</span><br><span class="line">| gtid_next                        | AUTOMATIC |</span><br><span class="line">| gtid_owned                       |           |</span><br><span class="line">| gtid_purged                      |           |</span><br><span class="line">| session_track_gtids              | OFF       |</span><br><span class="line">+----------------------------------+-----------+</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x5F00;&#x542F;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line">[root@server12 ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.7.24-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">change</span> <span class="keyword">master</span> <span class="keyword">to</span></span><br><span class="line">     master_host=<span class="string">&apos;192.168.10.11&apos;</span>,</span><br><span class="line">     master_user=<span class="string">&apos;Jaking&apos;</span>,</span><br><span class="line">     master_password=<span class="string">&apos;Jaking@vip.163.com&apos;</span>,</span><br><span class="line">     master_auto_position=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected, 2 warnings (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; start slave;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 192.168.10.11</span><br><span class="line">                  Master_User: Jaking</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-bin.000002</span><br><span class="line">          Read_Master_Log_Pos: 154</span><br><span class="line">               Relay_Log_File: server12-relay-bin.000002</span><br><span class="line">                Relay_Log_Pos: 367</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000002</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB: </span><br><span class="line">          Replicate_Ignore_DB: </span><br><span class="line">           Replicate_Do_Table: </span><br><span class="line">       Replicate_Ignore_Table: </span><br><span class="line">      Replicate_Wild_Do_Table: </span><br><span class="line">  Replicate_Wild_Ignore_Table: </span><br><span class="line">                   Last_Errno: 0</span><br><span class="line">                   Last_Error: </span><br><span class="line">                 Skip_Counter: 0</span><br><span class="line">          Exec_Master_Log_Pos: 154</span><br><span class="line">              Relay_Log_Space: 577</span><br><span class="line">              Until_Condition: None</span><br><span class="line">               Until_Log_File: </span><br><span class="line">                Until_Log_Pos: 0</span><br><span class="line">           Master_SSL_Allowed: No</span><br><span class="line">           Master_SSL_CA_File: </span><br><span class="line">           Master_SSL_CA_Path: </span><br><span class="line">              Master_SSL_Cert: </span><br><span class="line">            Master_SSL_Cipher: </span><br><span class="line">               Master_SSL_Key: </span><br><span class="line">        Seconds_Behind_Master: 0</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 0</span><br><span class="line">                Last_IO_Error: </span><br><span class="line">               Last_SQL_Errno: 0</span><br><span class="line">               Last_SQL_Error: </span><br><span class="line">  Replicate_Ignore_Server_Ids: </span><br><span class="line">             Master_Server_Id: 11</span><br><span class="line">                  Master_UUID: 03a1eb63-c21a-11ec-b07f-000c2987bea6</span><br><span class="line">             Master_Info_File: /var/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind: </span><br><span class="line">      Last_IO_Error_Timestamp: </span><br><span class="line">     Last_SQL_Error_Timestamp: </span><br><span class="line">               Master_SSL_Crl: </span><br><span class="line">           Master_SSL_Crlpath: </span><br><span class="line">           Retrieved_Gtid_Set: </span><br><span class="line">            Executed_Gtid_Set: </span><br><span class="line">                Auto_Position: 1</span><br><span class="line">         Replicate_Rewrite_DB: </span><br><span class="line">                 Channel_Name: </span><br><span class="line">           Master_TLS_Version: </span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x67E5;&#x770B;&#x4E3B;&#x4ECE;&#x5E93;&#x7684;&#x4FE1;&#x606F;&#x662F;&#x5426;&#x540C;&#x6B65;</p>
<p>&#x67E5;&#x770B;&#x4E3B;&#x5E93;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@server11 ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 5</span><br><span class="line">Server version: 5.7.24-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x67E5;&#x770B;&#x4ECE;&#x5E93;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">[root@server12 ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 6</span><br><span class="line">Server version: 5.7.24-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<h2 id="&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;"><a href="#&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;" class="headerlink" title="&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;"></a>&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;</h2><p>&#x5728;&#x4E3B;&#x5E93;&#x6267;&#x884C;&#x4EE5;&#x4E0B;SQL&#x8BED;&#x53E5;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> BOOK;</span><br><span class="line"><span class="keyword">USE</span> BOOK;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> book (<span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">66</span>),price <span class="built_in">int</span>,pages <span class="built_in">int</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;Linux&apos;</span>,<span class="string">&apos;30&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;Cloud Computing&apos;</span>,<span class="string">&apos;60&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;Operation System&apos;</span>,<span class="string">&apos;80&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;Artificial Intelligence&apos;</span>,<span class="string">&apos;166&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> book;</span><br><span class="line"><span class="comment">------------------------------------------------------------------------------------</span></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> BOOK.book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5728;&#x4ECE;&#x5E93;&#x67E5;&#x770B;&#x6570;&#x636E;&#x662F;&#x5426;&#x540C;&#x6B65;&#x8FC7;&#x6765;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> BOOK.book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x67E5;&#x770B;&#x4E3B;&#x5E93;&#x72B6;&#x6001;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show master status;</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                        |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">| mysql-bin.000002 |     1620 |              |                  | 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-6 |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x67E5;&#x770B;&#x4ECE;&#x5E93;&#x72B6;&#x6001;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show master status;</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                        |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">| mysql-bin.000002 |     1584 |              |                  | 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-6 |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x4ECE;&#x5E93;&#x505C;&#x6389;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; stop slave;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: </span><br><span class="line">                  Master_Host: 192.168.10.11</span><br><span class="line">                  Master_User: Jaking</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-bin.000002</span><br><span class="line">          Read_Master_Log_Pos: 1620</span><br><span class="line">               Relay_Log_File: server12-relay-bin.000002</span><br><span class="line">                Relay_Log_Pos: 1833</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000002</span><br><span class="line">             Slave_IO_Running: No</span><br><span class="line">            Slave_SQL_Running: No</span><br><span class="line">              Replicate_Do_DB: </span><br><span class="line">          Replicate_Ignore_DB: </span><br><span class="line">           Replicate_Do_Table: </span><br><span class="line">       Replicate_Ignore_Table: </span><br><span class="line">      Replicate_Wild_Do_Table: </span><br><span class="line">  Replicate_Wild_Ignore_Table: </span><br><span class="line">                   Last_Errno: 0</span><br><span class="line">                   Last_Error: </span><br><span class="line">                 Skip_Counter: 0</span><br><span class="line">          Exec_Master_Log_Pos: 1620</span><br><span class="line">              Relay_Log_Space: 2043</span><br><span class="line">              Until_Condition: None</span><br><span class="line">               Until_Log_File: </span><br><span class="line">                Until_Log_Pos: 0</span><br><span class="line">           Master_SSL_Allowed: No</span><br><span class="line">           Master_SSL_CA_File: </span><br><span class="line">           Master_SSL_CA_Path: </span><br><span class="line">              Master_SSL_Cert: </span><br><span class="line">            Master_SSL_Cipher: </span><br><span class="line">               Master_SSL_Key: </span><br><span class="line">        Seconds_Behind_Master: NULL</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 0</span><br><span class="line">                Last_IO_Error: </span><br><span class="line">               Last_SQL_Errno: 0</span><br><span class="line">               Last_SQL_Error: </span><br><span class="line">  Replicate_Ignore_Server_Ids: </span><br><span class="line">             Master_Server_Id: 11</span><br><span class="line">                  Master_UUID: 03a1eb63-c21a-11ec-b07f-000c2987bea6</span><br><span class="line">             Master_Info_File: /var/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: </span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind: </span><br><span class="line">      Last_IO_Error_Timestamp: </span><br><span class="line">     Last_SQL_Error_Timestamp: </span><br><span class="line">               Master_SSL_Crl: </span><br><span class="line">           Master_SSL_Crlpath: </span><br><span class="line">           Retrieved_Gtid_Set: 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-6</span><br><span class="line">            Executed_Gtid_Set: 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-6</span><br><span class="line">                Auto_Position: 1</span><br><span class="line">         Replicate_Rewrite_DB: </span><br><span class="line">                 Channel_Name: </span><br><span class="line">           Master_TLS_Version: </span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5728;&#x4E3B;&#x5E93;&#x521B;&#x5EFA;&#x6570;&#x636E;&#x540E;&#x4ECE;&#x5E93;&#x5F00;&#x542F;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x67E5;&#x770B;&#x662F;&#x5426;&#x540C;&#x6B65;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="string">`testbookdb`</span> <span class="keyword">DEFAULT</span> <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="keyword">use</span> testbookdb;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> book1 (bTypeId <span class="built_in">int</span>,bName <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,publishing <span class="built_in">char</span>(<span class="number">16</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;1&apos;</span>,<span class="string">&apos;&#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;&apos;</span>,<span class="string">&apos;66&apos;</span>,<span class="string">&apos;&#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;2&apos;</span>,<span class="string">&apos;&#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;&apos;</span>,<span class="string">&apos;68&apos;</span>,<span class="string">&apos;&#x4EBA;&#x6C11;&#x90AE;&#x7535;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;3&apos;</span>,<span class="string">&apos;&#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;&apos;</span>,<span class="string">&apos;90&apos;</span>,<span class="string">&apos;&#x673A;&#x68B0;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;4&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;&apos;</span>,<span class="string">&apos;71&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;5&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL2&#x300B;&apos;</span>,<span class="string">&apos;72&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;6&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL3&#x300B;&apos;</span>,<span class="string">&apos;73&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;7&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL4&#x300B;&apos;</span>,<span class="string">&apos;74&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;8&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL5&#x300B;&apos;</span>,<span class="string">&apos;75&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;9&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL6&#x300B;&apos;</span>,<span class="string">&apos;76&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;10&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL7&#x300B;&apos;</span>,<span class="string">&apos;77&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;11&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL8&#x300B;&apos;</span>,<span class="string">&apos;78&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;12&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL9&#x300B;&apos;</span>,<span class="string">&apos;79&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> book2 (<span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,pages <span class="built_in">int</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;&#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;&apos;</span>,<span class="string">&apos;30&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;&#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;&apos;</span>,<span class="string">&apos;60&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;&#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;&apos;</span>,<span class="string">&apos;80&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;&apos;</span>,<span class="string">&apos;166&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> book1;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> book2;</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from book1;</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">| bTypeId | bName                             | price | publishing            |</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">|       1 | &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;             |    66 | &#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       2 | &#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;                    |    68 | &#x4EBA;&#x6C11;&#x90AE;&#x7535;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       3 | &#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;            |    90 | &#x673A;&#x68B0;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       4 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;                   |    71 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       5 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL2&#x300B;                  |    72 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       6 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL3&#x300B;                  |    73 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       7 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL4&#x300B;                  |    74 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       8 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL5&#x300B;                  |    75 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       9 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL6&#x300B;                  |    76 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      10 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL7&#x300B;                  |    77 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      11 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL8&#x300B;                  |    78 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      12 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL9&#x300B;                  |    79 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book2;</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">| name                              | price | pages |</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">| &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;             |    30 |   666 |</span><br><span class="line">| &#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;                    |    60 |   666 |</span><br><span class="line">| &#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;            |    80 |   666 |</span><br><span class="line">| &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;                   |   166 |   666 |</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x67E5;&#x770B;&#x4E3B;&#x5E93;&#x72B6;&#x6001;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show master status;</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------------------------------+</span></span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                         |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------------------------------+</span></span><br><span class="line">| mysql-bin.000002 |     7389 |              |                  | 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-25 |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------------------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x67E5;&#x770B;&#x4ECE;&#x5E93;&#x72B6;&#x6001;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show master status;</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                        |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">| mysql-bin.000002 |     1584 |              |                  | 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-6 |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+------------------------------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x4ECE;&#x5E93;&#x5F00;&#x542F;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x67E5;&#x770B;&#x662F;&#x5426;&#x540C;&#x6B65;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; start slave;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show slave status\G</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">               Slave_IO_State: Waiting for master to send event</span><br><span class="line">                  Master_Host: 192.168.10.11</span><br><span class="line">                  Master_User: Jaking</span><br><span class="line">                  Master_Port: 3306</span><br><span class="line">                Connect_Retry: 60</span><br><span class="line">              Master_Log_File: mysql-bin.000002</span><br><span class="line">          Read_Master_Log_Pos: 7389</span><br><span class="line">               Relay_Log_File: server12-relay-bin.000003</span><br><span class="line">                Relay_Log_Pos: 6223</span><br><span class="line">        Relay_Master_Log_File: mysql-bin.000002</span><br><span class="line">             Slave_IO_Running: Yes</span><br><span class="line">            Slave_SQL_Running: Yes</span><br><span class="line">              Replicate_Do_DB: </span><br><span class="line">          Replicate_Ignore_DB: </span><br><span class="line">           Replicate_Do_Table: </span><br><span class="line">       Replicate_Ignore_Table: </span><br><span class="line">      Replicate_Wild_Do_Table: </span><br><span class="line">  Replicate_Wild_Ignore_Table: </span><br><span class="line">                   Last_Errno: 0</span><br><span class="line">                   Last_Error: </span><br><span class="line">                 Skip_Counter: 0</span><br><span class="line">          Exec_Master_Log_Pos: 7389</span><br><span class="line">              Relay_Log_Space: 8112</span><br><span class="line">              Until_Condition: None</span><br><span class="line">               Until_Log_File: </span><br><span class="line">                Until_Log_Pos: 0</span><br><span class="line">           Master_SSL_Allowed: No</span><br><span class="line">           Master_SSL_CA_File: </span><br><span class="line">           Master_SSL_CA_Path: </span><br><span class="line">              Master_SSL_Cert: </span><br><span class="line">            Master_SSL_Cipher: </span><br><span class="line">               Master_SSL_Key: </span><br><span class="line">        Seconds_Behind_Master: 0</span><br><span class="line">Master_SSL_Verify_Server_Cert: No</span><br><span class="line">                Last_IO_Errno: 0</span><br><span class="line">                Last_IO_Error: </span><br><span class="line">               Last_SQL_Errno: 0</span><br><span class="line">               Last_SQL_Error: </span><br><span class="line">  Replicate_Ignore_Server_Ids: </span><br><span class="line">             Master_Server_Id: 11</span><br><span class="line">                  Master_UUID: 03a1eb63-c21a-11ec-b07f-000c2987bea6</span><br><span class="line">             Master_Info_File: /var/lib/mysql/master.info</span><br><span class="line">                    SQL_Delay: 0</span><br><span class="line">          SQL_Remaining_Delay: NULL</span><br><span class="line">      Slave_SQL_Running_State: Slave has read all relay log; waiting for more updates</span><br><span class="line">           Master_Retry_Count: 86400</span><br><span class="line">                  Master_Bind: </span><br><span class="line">      Last_IO_Error_Timestamp: </span><br><span class="line">     Last_SQL_Error_Timestamp: </span><br><span class="line">               Master_SSL_Crl: </span><br><span class="line">           Master_SSL_Crlpath: </span><br><span class="line">           Retrieved_Gtid_Set: 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-25</span><br><span class="line">            Executed_Gtid_Set: 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-25</span><br><span class="line">                Auto_Position: 1</span><br><span class="line">         Replicate_Rewrite_DB: </span><br><span class="line">                 Channel_Name: </span><br><span class="line">           Master_TLS_Version: </span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testbookdb         |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> testbookdb;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">| Tables_in_testbookdb |</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">| book1                |</span><br><span class="line">| book2                |</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book1;</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">| bTypeId | bName                             | price | publishing            |</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">|       1 | &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;             |    66 | &#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       2 | &#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;                    |    68 | &#x4EBA;&#x6C11;&#x90AE;&#x7535;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       3 | &#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;            |    90 | &#x673A;&#x68B0;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       4 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;                   |    71 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       5 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL2&#x300B;                  |    72 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       6 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL3&#x300B;                  |    73 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       7 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL4&#x300B;                  |    74 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       8 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL5&#x300B;                  |    75 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       9 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL6&#x300B;                  |    76 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      10 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL7&#x300B;                  |    77 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      11 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL8&#x300B;                  |    78 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      12 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL9&#x300B;                  |    79 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book2;</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">| name                              | price | pages |</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">| &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;             |    30 |   666 |</span><br><span class="line">| &#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;                    |    60 |   666 |</span><br><span class="line">| &#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;            |    80 |   666 |</span><br><span class="line">| &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;                   |   166 |   666 |</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">master</span> <span class="keyword">status</span>;</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------------------------------+</span></span><br><span class="line">| File             | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set                         |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------------------------------+</span></span><br><span class="line">| mysql-bin.000002 |     7113 |              |                  | 03a1eb63-c21a-11ec-b07f-000c2987bea6:1-25 |</span><br><span class="line">+<span class="comment">------------------+----------+--------------+------------------+-------------------------------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/d77fafec/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-MySQL传统主从同步" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/607e4760/">MySQL传统主从同步</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:44:52" datetime="2022-06-07T04:44:52.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h2 id="&#x73AF;&#x5883;"><a href="#&#x73AF;&#x5883;" class="headerlink" title="&#x73AF;&#x5883;"></a>&#x73AF;&#x5883;</h2><table>
<thead>
<tr>
<th><strong>&#x4E3B;&#x673A;&#x540D;</strong></th>
<th><strong>IP</strong></th>
<th><strong>&#x7CFB;&#x7EDF;/MySQL&#x7248;&#x672C;</strong></th>
<th>&#x89D2;&#x8272;</th>
</tr>
</thead>
<tbody>
<tr>
<td>MySQL_1</td>
<td>192.168.10.67</td>
<td>RHEL7.3/MySQL5.7</td>
<td>Master</td>
</tr>
<tr>
<td>MySQL_2</td>
<td>192.168.10.68</td>
<td>RHEL7.3/MySQL5.7</td>
<td>Slave</td>
</tr>
</tbody>
</table>
<h2 id="&#x539F;&#x7406;"><a href="#&#x539F;&#x7406;" class="headerlink" title="&#x539F;&#x7406;"></a>&#x539F;&#x7406;</h2><figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://192.168.85.188:8081/uploads/1652922895516766641123.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>1)&#x3001;&#x5728;master&#x673A;&#x5668;&#x4E0A;&#x7684;&#x64CD;&#x4F5C;&#xFF1A;</p>
<p>&#x3000;  &#x5F53;master&#x4E0A;&#x7684;&#x6570;&#x636E;&#x53D1;&#x751F;&#x53D8;&#x5316;&#x65F6;&#xFF0C;&#x8BE5;&#x4E8B;&#x4EF6;&#x53D8;&#x5316;&#x4F1A;&#x6309;&#x7167;&#x987A;&#x5E8F;&#x5199;&#x5165;bin-log&#x4E2D;&#x3002;&#x5F53;slave&#x94FE;&#x63A5;&#x5230;master&#x7684;&#x65F6;&#x5019;&#xFF0C;master&#x673A;&#x5668;&#x4F1A;&#x4E3A;slave&#x5F00;&#x542F;binlog dump&#x7EBF;&#x7A0B;&#x3002;&#x5F53;master&#x7684;binlog&#x53D1;&#x751F;&#x53D8;&#x5316;&#x7684;&#x65F6;&#x5019;&#xFF0C;bin-log dump&#x7EBF;&#x7A0B;&#x4F1A;&#x901A;&#x77E5;slave&#xFF0C;&#x5E76;&#x5C06;&#x76F8;&#x5E94;&#x7684;binlog&#x5185;&#x5BB9;&#x53D1;&#x9001;&#x7ED9;slave&#x3002;</p>
<p>2)&#x3001;&#x5728;slave&#x673A;&#x5668;&#x4E0A;&#x64CD;&#x4F5C;&#xFF1A;</p>
<p>&#x3000;  &#x5F53;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x5F00;&#x542F;&#x7684;&#x65F6;&#x5019;&#xFF0C;slave&#x4E0A;&#x4F1A;&#x521B;&#x5EFA;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF1A;I/O&#x7EBF;&#x7A0B;&#x3002;&#x8BE5;&#x7EBF;&#x7A0B;&#x8FDE;&#x63A5;&#x5230;master&#x673A;&#x5668;&#xFF0C;master&#x673A;&#x5668;&#x4E0A;&#x7684;binlog dump &#x7EBF;&#x7A0B;&#x4F1A;&#x5C06;binlog&#x7684;&#x5185;&#x5BB9;&#x53D1;&#x9001;&#x7ED9;&#x8BE5;I/O&#x7EBF;&#x7A0B;&#x3002;&#x8BE5;I/O&#x7EBF;&#x7A0B;&#x63A5;&#x6536;&#x5230;binlog&#x5185;&#x5BB9;&#x540E;&#xFF0C;&#x518D;&#x5C06;&#x5185;&#x5BB9;&#x5199;&#x5165;&#x5230;&#x672C;&#x5730;&#x7684;relay log&#xFF1B;sql&#x7EBF;&#x7A0B;&#x3002;&#x8BE5;&#x7EBF;&#x7A0B;&#x8BFB;&#x53D6;&#x5230;I/O&#x7EBF;&#x7A0B;&#x5199;&#x5165;&#x7684;relay log&#x3002;&#x5E76;&#x4E14;&#x6839;&#x636E;replay log&#x3002;&#x5E76;&#x4E14;&#x6839;&#x636E;relay log &#x7684;&#x5185;&#x5BB9;&#x5BF9;slave&#x6570;&#x636E;&#x5E93;&#x505A;&#x76F8;&#x5E94;&#x7684;&#x64CD;&#x4F5C;&#x3002;</p>
<p>3)&#x3001;MySQL&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x539F;&#x7406;&#x56FE;&#x5982;&#x4E0B;:</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="http://192.168.85.188:8081/uploads/1652922926865746299theory.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
<p>&#x4ECE;&#x5E93;&#x751F;&#x6210;&#x4E24;&#x4E2A;&#x7EBF;&#x7A0B;&#xFF0C;&#x4E00;&#x4E2A;I/O&#x7EBF;&#x7A0B;&#xFF0C;&#x4E00;&#x4E2A;SQL&#x7EBF;&#x7A0B;&#xFF1B;<br>I/O&#x7EBF;&#x7A0B;&#x53BB;&#x8BF7;&#x6C42;&#x4E3B;&#x5E93;&#x7684;binlog&#xFF0C;&#x5E76;&#x5C06;&#x5F97;&#x5230;&#x7684;binlog&#x65E5;&#x5FD7;&#x5199;&#x5230;relay log&#xFF08;&#x4E2D;&#x7EE7;&#x65E5;&#x5FD7;&#xFF09; &#x6587;&#x4EF6;&#x4E2D;&#xFF1B;<br>&#x4E3B;&#x5E93;&#x4F1A;&#x751F;&#x6210;&#x4E00;&#x4E2A; log dump &#x7EBF;&#x7A0B;&#xFF0C;&#x7528;&#x6765;&#x7ED9;&#x4ECE;&#x5E93;I/O&#x7EBF;&#x7A0B;&#x4F20;binlog&#xFF1B;<br>SQL &#x7EBF;&#x7A0B;&#xFF0C;&#x4F1A;&#x8BFB;&#x53D6;relay log&#x6587;&#x4EF6;&#x4E2D;&#x7684;&#x65E5;&#x5FD7;&#xFF0C;&#x5E76;&#x89E3;&#x6790;&#x6210;&#x5177;&#x4F53;&#x64CD;&#x4F5C;&#xFF0C;&#x6765;&#x5B9E;&#x73B0;&#x4E3B;&#x4ECE;&#x7684;&#x64CD;&#x4F5C;&#x4E00;&#x81F4;&#xFF0C;&#x800C;&#x6700;&#x7EC8;&#x6570;&#x636E;&#x4E00;&#x81F4;&#xFF1B;  </p>
<p><span style="color:red"><em>&#x6CE8;&#x610F;&#xFF1A;&#x642D;&#x5EFA;MySQL&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x524D;&#xFF0C;&#x9700;&#x8981;&#x5206;&#x522B;&#x5728;&#x4E3B;&#x6570;&#x636E;&#x548C;&#x4ECE;&#x6570;&#x636E;&#x4E0A;&#x5B89;&#x88C5;&#x5E76;&#x914D;&#x7F6E;&#x597D;MySQL&#x6570;&#x636E;&#x5E93;&#xFF01;  </em></span></p>
<h2 id="&#x914D;&#x7F6E;-Master-192-168-10-67"><a href="#&#x914D;&#x7F6E;-Master-192-168-10-67" class="headerlink" title="&#x914D;&#x7F6E; Master 192.168.10.67"></a>&#x914D;&#x7F6E; Master 192.168.10.67</h2><h3 id="&#x914D;&#x7F6E;-etc-my-cnf"><a href="#&#x914D;&#x7F6E;-etc-my-cnf" class="headerlink" title="&#x914D;&#x7F6E; /etc/my.cnf"></a>&#x914D;&#x7F6E; /etc/my.cnf</h3><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL1&#xA0;mysql&#x2010;5.7.19]#&#xA0;vim&#xA0;/etc/my.cnf</span><br><span class="line">[client]</span><br><span class="line">port=3306</span><br><span class="line">socket=/data/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line">[mysqld]  </span><br><span class="line">character&#x2010;set&#x2010;server=utf8</span><br><span class="line">collation&#x2010;server=utf8_general_ci</span><br><span class="line"></span><br><span class="line">skip&#x2010;name&#x2010;resolve</span><br><span class="line">user=mysql</span><br><span class="line">port=3306</span><br><span class="line">basedir=/usr/local/mysql57</span><br><span class="line">datadir=/data/mysql</span><br><span class="line">tmpdir=/tmp</span><br><span class="line">socket=/data/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line">log&#x2010;error=/data/mysql/mysqld.log</span><br><span class="line">pid&#x2010;file=/data/mysql/mysqld.pid</span><br><span class="line"></span><br><span class="line">log&#x2010;bin=mysql&#x2010;bin&#x2010;master&#xA0;#&#x542F;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;</span><br><span class="line">binlog_format=mixed</span><br><span class="line">server&#x2010;id=1&#xA0;#&#x672C;&#x673A;&#x6570;&#x636E;&#x5E93;ID&#xA0;&#x6807;&#x793A;</span><br><span class="line">binlog&#x2010;do&#x2010;db=TESTDB&#xA0;#&#x53EF;&#x4EE5;&#x88AB;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x590D;&#x5236;&#x7684;&#x5E93;,&#xA0;&#x4E8C;&#x8FDB;&#x5236;&#x9700;&#x8981;&#x540C;&#x6B65;&#x7684;&#x6570;&#x636E;&#x5E93;&#x540D;</span><br><span class="line">binlog&#x2010;ignore&#x2010;db=mysql&#xA0;#&#x4E0D;&#x53EF;&#x4EE5;&#x88AB;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x590D;&#x5236;&#x7684;&#x5E93;</span><br><span class="line">lower_case_table_names=1</span><br><span class="line">#&#x6CE8;&#x610F;&#xFF1A;Linux&#x4E0B;&#x90E8;&#x7F72;&#x5B89;&#x88C5;MySQL&#xFF0C;&#x9ED8;&#x8BA4;&#x4E0D;&#x5FFD;&#x7565;&#x8868;&#x540D;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5230;/etc/my.cnf&#xA0;&#x4E0B;&#x914D;&#x7F6E;&#xA0;lower_case_table_names=1&#xA0;&#x4F7F;Linux&#x73AF;&#x5883;&#x4E0B;MySQL&#x5FFD;&#x7565;&#x8868;&#x540D;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x5426;&#x5219;&#x4F7F;&#x7528;MyCAT&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x63D0;&#x793A;&#x627E;&#x4E0D;&#x5230;&#x8868;&#x7684;&#x9519;&#x8BEF;&#xFF01;</span><br><span class="line"> ~</span><br><span class="line"> ~</span><br><span class="line">&quot;/etc/my.cnf&quot;&#xA0;24L,&#xA0;556C&#xA0;written</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL1&#xA0;~]#&#xA0;service&#xA0;mysqld&#xA0;restart</span><br><span class="line">Shutting&#xA0;down&#xA0;MySQL...........&#xA0;SUCCESS!</span><br><span class="line">Starting&#xA0;MySQL.&#xA0;SUCCESS!</span><br></pre></td></tr></tbody></table></figure>
<p>&#x521B;&#x5EFA;&#x8981;&#x540C;&#x6B65;&#x7684;&#x6570;&#x636E;&#x5E93;&#x5E76;&#x521B;&#x5EFA;&#x8868;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL1&#xA0;mysql&#x2010;5.7.19]<span class="comment">#&#xA0;mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql&gt;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> TESTDB;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="keyword">use</span> TESTDB;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TABLE666 (bTypeId <span class="built_in">int</span>,bName <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,publishing <span class="built_in">char</span>(<span class="number">16</span>));</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE DATABASE TESTDB;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> TESTDB;</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE TABLE TABLE666 (bTypeId int,bName char(16),price int,publishing char(16));</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x6388;&#x6743;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL1&#xA0;mysql&#x2010;5.7.19]<span class="comment">#&#xA0;mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line"><span class="comment">#&#x5982;&#x679C;&#x63D0;&#x793A;&#xA0;mysql&#xA0;&#x547D;&#x4EE4;&#x4E0D;&#x5B58;&#x5728;&#xFF0C;&#x8BF7;&#x5C1D;&#x8BD5;&#x7528;&#xA0;/usr/local/mysql57/bin/mysql&#xA0;&#x2010;uroot&#xA0;&#x2010;p&quot;Jaking@vip.163.com&quot;&#xA0;&#x6765;&#x767B;&#x5F55;MySQL&#x6570;&#x636E;&#x5E93;</span></span><br><span class="line">mysql:&#xA0;[Warning]&#xA0;Using&#xA0;a&#xA0;password&#xA0;on&#xA0;the&#xA0;command&#xA0;line&#xA0;interface&#xA0;can&#xA0;be&#xA0;insecure.</span><br><span class="line">Welcome&#xA0;to&#xA0;the&#xA0;MySQL&#xA0;monitor.&#xA0;Commands&#xA0;<span class="keyword">end</span>&#xA0;<span class="keyword">with</span>&#xA0;;&#xA0;or&#xA0;\g.</span><br><span class="line">Your&#xA0;MySQL&#xA0;connection&#xA0;id&#xA0;is&#xA0;3</span><br><span class="line">Server&#xA0;version:&#xA0;5.7.19&#x2010;log&#xA0;Source&#xA0;distribution</span><br><span class="line"></span><br><span class="line">Copyright&#xA0;(c)&#xA0;2000,&#xA0;2017,&#xA0;Oracle&#xA0;and/or&#xA0;its&#xA0;affiliates.&#xA0;All&#xA0;rights&#xA0;reserved.</span><br><span class="line"></span><br><span class="line">Oracle&#xA0;is&#xA0;a&#xA0;registered&#xA0;trademark&#xA0;of&#xA0;Oracle&#xA0;Corporation&#xA0;and/or&#xA0;its</span><br><span class="line">affiliates.&#xA0;Other&#xA0;names&#xA0;may&#xA0;be&#xA0;trademarks&#xA0;of&#xA0;their&#xA0;respective owners.</span><br><span class="line"></span><br><span class="line">Type&#xA0;&apos;<span class="keyword">help</span>;&apos;&#xA0;or&#xA0;&apos;\h&apos;&#xA0;for&#xA0;help.&#xA0;<span class="keyword">Type</span>&#xA0;<span class="string">&apos;\c&apos;</span>&#xA0;<span class="keyword">to</span>&#xA0;<span class="keyword">clear</span>&#xA0;the&#xA0;<span class="keyword">current</span>&#xA0;<span class="keyword">input</span>&#xA0;statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;<span class="keyword">grant</span> <span class="keyword">replication</span> <span class="keyword">slave</span> <span class="keyword">on</span> *.* <span class="keyword">to</span> <span class="keyword">slave</span>@<span class="string">&quot;192.168.10.%&quot;</span> <span class="keyword">identified</span> <span class="keyword">by</span> <span class="string">&quot;Jaking@vip.163.com&quot;</span>;</span><br><span class="line">Query&#xA0;OK,&#xA0;0&#xA0;rows&#xA0;affected,&#xA0;1&#xA0;warning&#xA0;(0.01&#xA0;sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show master status;</span><br><span class="line">+<span class="comment">-------------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| File                    | Position | Binlog_Do_DB | Binlog_Ignore_DB | Executed_Gtid_Set |</span><br><span class="line">+<span class="comment">-------------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">| mysql-bin-master.000002 |      154 | TESTDB       | mysql            |                   |</span><br><span class="line">+<span class="comment">-------------------------+----------+--------------+------------------+-------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">binlog</span> <span class="keyword">events</span>\G</span><br><span class="line">*************************** <span class="number">1.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span>-<span class="keyword">master</span><span class="number">.000001</span></span><br><span class="line">        Pos: <span class="number">4</span></span><br><span class="line"> Event_type: Format_desc</span><br><span class="line">  Server_id: <span class="number">11</span></span><br><span class="line">End_log_pos: <span class="number">123</span></span><br><span class="line">       Info: <span class="keyword">Server</span> ver: <span class="number">5.7</span><span class="number">.24</span>-<span class="keyword">log</span>, <span class="keyword">Binlog</span> ver: <span class="number">4</span></span><br><span class="line">*************************** <span class="number">2.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span>-<span class="keyword">master</span><span class="number">.000001</span></span><br><span class="line">        Pos: <span class="number">123</span></span><br><span class="line"> Event_type: Previous_gtids</span><br><span class="line">  Server_id: <span class="number">11</span></span><br><span class="line">End_log_pos: <span class="number">154</span></span><br><span class="line">       Info: </span><br><span class="line">*************************** <span class="number">3.</span> <span class="keyword">row</span> ***************************</span><br><span class="line">   Log_name: mysql-<span class="keyword">bin</span>-<span class="keyword">master</span><span class="number">.000001</span></span><br><span class="line">        Pos: <span class="number">154</span></span><br><span class="line"> Event_type: <span class="keyword">Stop</span></span><br><span class="line">  Server_id: <span class="number">11</span></span><br><span class="line">End_log_pos: <span class="number">177</span></span><br><span class="line">       Info: </span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">flush</span> <span class="keyword">privileges</span>;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; exit</span><br><span class="line">Bye</span><br><span class="line">[root@MySQL1 ~]<span class="comment"># ls /var/lib/mysql</span></span><br><span class="line">auto.cnf         ib_logfile1              performance_schema</span><br><span class="line">ca-key.pem       ibtmp1                   private_key.pem</span><br><span class="line">ca.pem           mysql                    public_key.pem</span><br><span class="line">client-cert.pem  mysql-bin-master.000001  server-cert.pem</span><br><span class="line">client-key.pem   mysql-bin-master.000002  server-key.pem</span><br><span class="line">ib_buffer_pool   mysql-bin-master.index   sys</span><br><span class="line">ibdata1          mysql.sock               testdb</span><br><span class="line">ib_logfile0      mysql.sock.lock</span><br><span class="line">[root@MySQL1 ~]<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5BFC;&#x51FA;&#x6570;&#x636E;&#x5E93;&#x5E76;&#x4F20;&#x7ED9;&#x4ECE;&#x670D;&#x52A1;&#x5668;</p>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL1&#xA0;mysql&#x2010;5.7.19]#&#xA0;mysqldump -uroot -pJaking@vip.163.com -B TESTDB &gt; TESTDB.sql</span><br><span class="line">mysqldump:&#xA0;[Warning]&#xA0;Using&#xA0;a&#xA0;password&#xA0;on&#xA0;the&#xA0;command&#xA0;line&#xA0;interface&#xA0;can&#xA0;be&#xA0;insecure.</span><br><span class="line"></span><br><span class="line">[root@MySQL1&#xA0;mysql&#x2010;5.7.19]#&#xA0;ls</span><br><span class="line">BUILD&#xA0;CPackConfig.cmake&#xA0;install_manifest.txt&#xA0;mysys&#xA0;storage</span><br><span class="line">client&#xA0;CPackSourceConfig.cmake&#xA0;libbinlogevents&#xA0;mysys_ssl&#xA0;strings</span><br><span class="line">cmake&#xA0;CTestTestfile.cmake&#xA0;libbinlogstandalone&#xA0;packaging&#xA0;support&#x2010;files</span><br><span class="line">CMakeCache.txt&#xA0;dbug&#xA0;libevent&#xA0;plugin&#xA0;testclients</span><br><span class="line">CMakeFiles&#xA0;Docs&#xA0;libmysql&#xA0;rapid&#xA0;unittest</span><br><span class="line">cmake_install.cmake&#xA0;Doxyfile&#x2010;perfschema&#xA0;libmysqld&#xA0;README&#xA0;VERSION</span><br><span class="line">CMakeLists.txt&#xA0;extra&#xA0;libservices&#xA0;regex&#xA0;VERSION.dep</span><br><span class="line">cmd&#x2010;line&#x2010;utils&#xA0;TESTDB.sql&#xA0;make_dist.cmake&#xA0;scripts&#xA0;vio</span><br><span class="line">config.h.cmake&#xA0;include&#xA0;Makefile&#xA0;source_downloads&#xA0;win</span><br><span class="line">configure.cmake&#xA0;info_macros.cmake&#xA0;man&#xA0;sql&#xA0;zlib</span><br><span class="line">COPYING&#xA0;INSTALL&#xA0;mysql&#x2010;test&#xA0;sql&#x2010;common</span><br><span class="line"></span><br><span class="line">[root@MySQL1&#xA0;mysql&#x2010;5.7.19]#&#xA0;scp&#xA0;TESTDB.sql&#xA0;192.168.10.68:/root</span><br><span class="line">The&#xA0;authenticity&#xA0;of&#xA0;host&#xA0;&apos;192.168.10.68&#xA0;(192.168.10.68)&apos;&#xA0;can&apos;t&#xA0;be&#xA0;established.</span><br><span class="line">ECDSA&#xA0;key&#xA0;fingerprint&#xA0;is 57:3d:7f:91:5a:bc:6f:a1:88:4f:d2:fc:17:0e:51:8b.</span><br><span class="line">Are&#xA0;you&#xA0;sure&#xA0;you&#xA0;want&#xA0;to&#xA0;continue&#xA0;connecting&#xA0;(yes/no)?&#xA0;yes</span><br><span class="line">Warning:&#xA0;Permanently&#xA0;added&#xA0;&apos;192.168.10.68&apos;&#xA0;(ECDSA)&#xA0;to&#xA0;the&#xA0;list&#xA0;of&#xA0;knownhosts.</span><br><span class="line">root@192.168.10.68&apos;s&#xA0;password:</span><br><span class="line">TESTDB.sql&#xA0;100%&#xA0;1765&#xA0;1.7KB/s&#xA0;00:00</span><br></pre></td></tr></tbody></table></figure>
<h2 id="&#x914D;&#x7F6E;-Slave-192-168-10-68"><a href="#&#x914D;&#x7F6E;-Slave-192-168-10-68" class="headerlink" title="&#x914D;&#x7F6E; Slave 192.168.10.68"></a>&#x914D;&#x7F6E; Slave 192.168.10.68</h2><h3 id="&#x914D;&#x7F6E;-etc-my-cnf-1"><a href="#&#x914D;&#x7F6E;-etc-my-cnf-1" class="headerlink" title="&#x914D;&#x7F6E; /etc/my.cnf"></a>&#x914D;&#x7F6E; /etc/my.cnf</h3><figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL2&#xA0;~]#&#xA0;vim&#xA0;/etc/my.cnf</span><br><span class="line">[client]</span><br><span class="line">port=3306</span><br><span class="line">socket=/data/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line">[mysqld]</span><br><span class="line">cTESTDBracter&#x2010;set&#x2010;server=utf8</span><br><span class="line">collation&#x2010;server=utf8_general_ci</span><br><span class="line"></span><br><span class="line">skip&#x2010;name&#x2010;resolve</span><br><span class="line">user=mysql</span><br><span class="line">port=3306</span><br><span class="line">basedir=/usr/local/mysql57</span><br><span class="line">datadir=/data/mysql</span><br><span class="line">tmpdir=/tmp</span><br><span class="line">socket=/data/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line">log&#x2010;error=/data/mysql/mysqld.log</span><br><span class="line">pid&#x2010;file=/data/mysql/mysqld.pid</span><br><span class="line"></span><br><span class="line">server&#x2010;id=2</span><br><span class="line">#&#x4ECE;&#x670D;&#x52A1;&#x5668;ID&#x53F7;&#xFF0C;&#x4E0D;&#x8981;&#x548C;&#x4E3B;ID&#x76F8;&#x540C;&#xA0;&#xFF0C;&#x5982;&#x679C;&#x8BBE;&#x7F6E;&#x591A;&#x4E2A;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x6BCF;&#x4E2A;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x5FC5;&#x987B;&#x6709;&#x4E00;&#x4E2A;&#x552F;&#x4E00;&#x7684;server&#x2010;id&#x503C;&#xFF0C;&#x5FC5;&#x987B;&#x4E0E;&#x4E3B;&#x670D;&#x52A1;&#x5668;&#x7684;&#x4EE5;&#x53CA;&#x5176;&#x5B83;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x7684;&#x4E0D;&#x76F8;&#x540C;&#x3002;&#x53EF;&#x4EE5;&#x8BA4;&#x4E3A;server&#x2010;id&#x503C;&#x7C7B;&#x4F3C;&#x4E8E;IP&#x5730;&#x5740;&#xFF1A;&#x8FD9;&#x4E9B;ID&#x503C;&#x80FD;&#x552F;&#x4E00;&#x8BC6;&#x522B;&#x590D;&#x5236;&#x670D;&#x52A1;&#x5668;&#x7FA4;&#x96C6;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#x5B9E;&#x4F8B;&#x3002;</span><br><span class="line">lower_case_table_names=1</span><br><span class="line">#&#x6CE8;&#x610F;&#xFF1A;Linux&#x4E0B;&#x90E8;&#x7F72;&#x5B89;&#x88C5;MySQL&#xFF0C;&#x9ED8;&#x8BA4;&#x4E0D;&#x5FFD;&#x7565;&#x8868;&#x540D;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x9700;&#x8981;&#x624B;&#x52A8;&#x5230;/etc/my.cnf&#xA0;&#x4E0B;&#x914D;&#x7F6E;&#xA0;lower_case_table_names=1&#xA0;&#x4F7F;Linux&#x73AF;&#x5883;&#x4E0B;MySQL&#x5FFD;&#x7565;&#x8868;&#x540D;&#x5927;&#x5C0F;&#x5199;&#xFF0C;&#x5426;&#x5219;&#x4F7F;&#x7528;MyCAT&#x7684;&#x65F6;&#x5019;&#x4F1A;&#x63D0;&#x793A;&#x627E;&#x4E0D;&#x5230;&#x8868;&#x7684;&#x9519;&#x8BEF;&#xFF01;</span><br><span class="line">~</span><br><span class="line">~</span><br><span class="line">&quot;/etc/my.cnf&quot;&#xA0;20L,&#xA0;649C&#xA0;written</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight xml"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL2&#xA0;~]#&#xA0;service&#xA0;mysqld&#xA0;restart</span><br><span class="line">Shutting&#xA0;down&#xA0;MySQL..&#xA0;[&#xA0;OK&#xA0;]</span><br><span class="line">Starting&#xA0;MySQL.&#xA0;[&#xA0;OK&#xA0;]</span><br></pre></td></tr></tbody></table></figure>
<p><em>&#x4E24;&#x53F0;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x5668;mysql&#x7248;&#x672C;&#x8981;&#x4E00;&#x81F4;</em></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL1&#xA0;~]<span class="comment">#&#xA0;mysql&#xA0;&#x2010;uroot&#xA0;&#x2010;pJaking@vip.163.com</span></span><br><span class="line">mysql:&#xA0;[Warning]&#xA0;Using&#xA0;a&#xA0;password&#xA0;on&#xA0;the&#xA0;command&#xA0;line&#xA0;interface&#xA0;can&#xA0;be&#xA0;insecure.</span><br><span class="line">Welcome&#xA0;to&#xA0;the&#xA0;MySQL&#xA0;monitor.&#xA0;Commands&#xA0;<span class="keyword">end</span>&#xA0;<span class="keyword">with</span>&#xA0;;&#xA0;or&#xA0;\g.</span><br><span class="line">Your&#xA0;MySQL&#xA0;connection&#xA0;id&#xA0;is&#xA0;21</span><br><span class="line">Server&#xA0;version:&#xA0;5.7.19&#x2010;log&#xA0;Source&#xA0;distribution</span><br><span class="line"></span><br><span class="line">Copyright&#xA0;(c)&#xA0;2000,&#xA0;2017,&#xA0;Oracle&#xA0;and/or&#xA0;its&#xA0;affiliates.&#xA0;All&#xA0;rights&#xA0;reserved.</span><br><span class="line"></span><br><span class="line">Oracle&#xA0;is&#xA0;a&#xA0;registered&#xA0;trademark&#xA0;of&#xA0;Oracle&#xA0;Corporation&#xA0;and/or&#xA0;its</span><br><span class="line">affiliates.&#xA0;Other&#xA0;names&#xA0;may&#xA0;be&#xA0;trademarks&#xA0;of&#xA0;their&#xA0;respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type&#xA0;&apos;<span class="keyword">help</span>;&apos;&#xA0;or&#xA0;&apos;\h&apos;&#xA0;for&#xA0;help.&#xA0;<span class="keyword">Type</span>&#xA0;<span class="string">&apos;\c&apos;</span>&#xA0;<span class="keyword">to</span>&#xA0;<span class="keyword">clear</span>&#xA0;the&#xA0;<span class="keyword">current</span>&#xA0;<span class="keyword">input</span>&#xA0;statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;<span class="keyword">show</span>&#xA0;<span class="keyword">variables</span>&#xA0;<span class="keyword">like</span>&#xA0;<span class="string">&apos;%version%&apos;</span>;</span><br><span class="line"> +&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line"> |&#xA0;Variable_name&#xA0;|&#xA0;Value&#xA0;|</span><br><span class="line"> +&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line"> |&#xA0;innodb_version&#xA0;|&#xA0;5.7.19&#xA0;|</span><br><span class="line"> |&#xA0;protocol_version&#xA0;|&#xA0;10&#xA0;|</span><br><span class="line"> |&#xA0;slave_type_conversions&#xA0;|&#xA0;|</span><br><span class="line"> |&#xA0;tls_version&#xA0;|&#xA0;TLSv1,TLSv1.1&#xA0;|</span><br><span class="line"> |&#xA0;version&#xA0;|&#xA0;5.7.19&#x2010;log&#xA0;|</span><br><span class="line"> |&#xA0;version_comment&#xA0;|&#xA0;Source&#xA0;distribution&#xA0;|</span><br><span class="line"> |&#xA0;version_compile_machine&#xA0;|&#xA0;x86_64&#xA0;|</span><br><span class="line"> |&#xA0;version_compile_os&#xA0;|&#xA0;Linux&#xA0;|</span><br><span class="line"> +&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line"> 8&#xA0;rows&#xA0;in&#xA0;<span class="keyword">set</span>&#xA0;(<span class="number">0.01</span>&#xA0;sec)</span><br><span class="line"></span><br><span class="line"> mysql&gt;</span><br><span class="line"></span><br><span class="line">[root@MySQL2&#xA0;mysql]<span class="comment">#&#xA0;mysql&#xA0;&#x2010;uroot&#xA0;&#x2010;pJaking@vip.163.com</span></span><br><span class="line"> mysql:&#xA0;[<span class="keyword">Warning</span>]&#xA0;<span class="keyword">Using</span>&#xA0;a&#xA0;<span class="keyword">password</span>&#xA0;<span class="keyword">on</span>&#xA0;the&#xA0;command&#xA0;line&#xA0;<span class="keyword">interface</span>&#xA0;can&#xA0;be&#xA0;insecure.</span><br><span class="line"> Welcome&#xA0;<span class="keyword">to</span>&#xA0;the&#xA0;MySQL&#xA0;monitor.&#xA0;Commands&#xA0;<span class="keyword">end</span>&#xA0;<span class="keyword">with</span>&#xA0;;&#xA0;or&#xA0;\g.</span><br><span class="line"> Your&#xA0;MySQL&#xA0;connection&#xA0;id&#xA0;is&#xA0;6</span><br><span class="line"> Server&#xA0;version:&#xA0;5.7.19&#xA0;Source&#xA0;distribution</span><br><span class="line"></span><br><span class="line"> Copyright&#xA0;(c)&#xA0;2000,&#xA0;2017,&#xA0;Oracle&#xA0;and/or&#xA0;its&#xA0;affiliates.&#xA0;All&#xA0;rights&#xA0;reserved.</span><br><span class="line"></span><br><span class="line"> Oracle&#xA0;is&#xA0;a&#xA0;registered&#xA0;trademark&#xA0;of&#xA0;Oracle&#xA0;Corporation&#xA0;and/or&#xA0;its</span><br><span class="line"> affiliates.&#xA0;Other&#xA0;names&#xA0;may&#xA0;be&#xA0;trademarks&#xA0;of&#xA0;their&#xA0;respective</span><br><span class="line"> owners.</span><br><span class="line"></span><br><span class="line"> Type&#xA0;&apos;<span class="keyword">help</span>;&apos;&#xA0;or&#xA0;&apos;\h&apos;&#xA0;for&#xA0;help.&#xA0;<span class="keyword">Type</span>&#xA0;<span class="string">&apos;\c&apos;</span>&#xA0;<span class="keyword">to</span>&#xA0;<span class="keyword">clear</span>&#xA0;the&#xA0;<span class="keyword">current</span>&#xA0;<span class="keyword">input</span>&#xA0;statement.</span><br><span class="line"></span><br><span class="line"> mysql&gt;&#xA0;<span class="keyword">show</span>&#xA0;<span class="keyword">variables</span>&#xA0;<span class="keyword">like</span>&#xA0;<span class="string">&apos;%version%&apos;</span>;</span><br><span class="line"> +&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line"> |&#xA0;Variable_name&#xA0;|&#xA0;Value&#xA0;|</span><br><span class="line"> +&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line"> |&#xA0;innodb_version&#xA0;|&#xA0;5.7.19&#xA0;|</span><br><span class="line"> |&#xA0;protocol_version&#xA0;|&#xA0;10&#xA0;|</span><br><span class="line"> |&#xA0;slave_type_conversions&#xA0;|&#xA0;|</span><br><span class="line"> |&#xA0;tls_version&#xA0;|&#xA0;TLSv1,TLSv1.1&#xA0;|</span><br><span class="line"> |&#xA0;version&#xA0;|&#xA0;5.7.19&#xA0;|</span><br><span class="line"> |&#xA0;version_comment&#xA0;|&#xA0;Source&#xA0;distribution&#xA0;|</span><br><span class="line"> |&#xA0;version_compile_machine&#xA0;|&#xA0;x86_64&#xA0;|</span><br><span class="line"> |&#xA0;version_compile_os&#xA0;|&#xA0;Linux&#xA0;|</span><br><span class="line"> +&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line"> 8&#xA0;rows&#xA0;in&#xA0;<span class="keyword">set</span>&#xA0;(<span class="number">0.02</span>&#xA0;sec)</span><br><span class="line"></span><br><span class="line"> mysql&gt;&#xA0;<span class="keyword">exit</span></span><br><span class="line"> Bye</span><br></pre></td></tr></tbody></table></figure>
<p>&#x6D4B;&#x8BD5;&#x8FDE;&#x63A5;&#x5230;&#x4E3B;&#x6570;&#x636E;&#x5E93;&#x662F;&#x5426;&#x6210;&#x529F;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL2&#xA0;mysql]<span class="comment">#&#xA0;mysql -uslave -pJaking@vip.163.com -h 192.168.10.67</span></span><br><span class="line">mysql:&#xA0;[Warning]&#xA0;Using&#xA0;a&#xA0;password&#xA0;on&#xA0;the&#xA0;command&#xA0;line&#xA0;interface&#xA0;can&#xA0;be&#xA0;insecure.</span><br><span class="line">Welcome&#xA0;to&#xA0;the&#xA0;MySQL&#xA0;monitor.&#xA0;Commands&#xA0;<span class="keyword">end</span>&#xA0;<span class="keyword">with</span>&#xA0;;&#xA0;or&#xA0;\g.</span><br><span class="line">Your&#xA0;MySQL&#xA0;connection&#xA0;id&#xA0;is&#xA0;5</span><br><span class="line">Server&#xA0;version:&#xA0;5.7.19&#x2010;log&#xA0;Source&#xA0;distribution</span><br><span class="line"></span><br><span class="line">Copyright&#xA0;(c)&#xA0;2000,&#xA0;2017,&#xA0;Oracle&#xA0;and/or&#xA0;its&#xA0;affiliates.&#xA0;All&#xA0;rights&#xA0;reserved.</span><br><span class="line"></span><br><span class="line">Oracle&#xA0;is&#xA0;a&#xA0;registered&#xA0;trademark&#xA0;of&#xA0;Oracle&#xA0;Corporation&#xA0;and/or&#xA0;its</span><br><span class="line">affiliates.&#xA0;Other&#xA0;names&#xA0;may&#xA0;be&#xA0;trademarks&#xA0;of&#xA0;their&#xA0;respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type&#xA0;&apos;<span class="keyword">help</span>;&apos;&#xA0;or&#xA0;&apos;\h&apos;&#xA0;for&#xA0;help.&#xA0;<span class="keyword">Type</span>&#xA0;<span class="string">&apos;\c&apos;</span>&#xA0;<span class="keyword">to</span>&#xA0;<span class="keyword">clear</span>&#xA0;the&#xA0;<span class="keyword">current</span>&#xA0;<span class="keyword">input</span>&#xA0;statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;<span class="keyword">show</span>&#xA0;<span class="keyword">databases</span>;</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">|&#xA0;Database&#xA0;|</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">|&#xA0;information_schema&#xA0;|</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">1&#xA0;row&#xA0;in&#xA0;<span class="keyword">set</span>&#xA0;(<span class="number">0.00</span>&#xA0;sec)</span><br></pre></td></tr></tbody></table></figure>
<p> #&#x6B64;&#x65F6;&#x770B;&#x4E0D;&#x5230; TESTDB &#x6570;&#x636E;&#x5E93;&#x5C5E;&#x6B63;&#x5E38;&#x73B0;&#x8C61;</p>
<p>&#x5411;TESTDB&#x6570;&#x636E;&#x5E93;&#x5BFC;&#x5165;&#x6570;&#x636E;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL2&#xA0;~]<span class="comment">#&#xA0;mysql -uroot -pJaking@vip.163.com &lt; TESTDB.sql </span></span><br><span class="line">mysql:&#xA0;[Warning]&#xA0;Using&#xA0;a&#xA0;password&#xA0;on&#xA0;the&#xA0;command&#xA0;line&#xA0;interface&#xA0;can&#xA0;be&#xA0;insecure.</span><br><span class="line"></span><br><span class="line">[root@MySQL2&#xA0;~]<span class="comment">#&#xA0;mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql:&#xA0;[Warning]&#xA0;Using&#xA0;a&#xA0;password&#xA0;on&#xA0;the&#xA0;command&#xA0;line&#xA0;interface&#xA0;can&#xA0;be&#xA0;insecure.</span><br><span class="line">Welcome&#xA0;to&#xA0;the&#xA0;MySQL&#xA0;monitor.&#xA0;Commands&#xA0;<span class="keyword">end</span>&#xA0;<span class="keyword">with</span>&#xA0;;&#xA0;or&#xA0;\g.</span><br><span class="line">Your&#xA0;MySQL&#xA0;connection&#xA0;id&#xA0;is&#xA0;11</span><br><span class="line">Server&#xA0;version:&#xA0;5.7.19&#xA0;Source&#xA0;distribution</span><br><span class="line"></span><br><span class="line">Copyright&#xA0;(c)&#xA0;2000,&#xA0;2017,&#xA0;Oracle&#xA0;and/or&#xA0;its&#xA0;affiliates.&#xA0;All&#xA0;rights&#xA0;reserved.</span><br><span class="line"></span><br><span class="line">Oracle&#xA0;is&#xA0;a&#xA0;registered&#xA0;trademark&#xA0;of&#xA0;Oracle&#xA0;Corporation&#xA0;and/or&#xA0;its</span><br><span class="line">affiliates.&#xA0;Other&#xA0;names&#xA0;may&#xA0;be&#xA0;trademarks&#xA0;of&#xA0;their&#xA0;respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type&#xA0;&apos;<span class="keyword">help</span>;&apos;&#xA0;or&#xA0;&apos;\h&apos;&#xA0;for&#xA0;help.&#xA0;<span class="keyword">Type</span>&#xA0;<span class="string">&apos;\c&apos;</span>&#xA0;<span class="keyword">to</span>&#xA0;<span class="keyword">clear</span>&#xA0;the&#xA0;<span class="keyword">current</span>&#xA0;<span class="keyword">input</span>&#xA0;statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;<span class="keyword">show</span>&#xA0;<span class="keyword">databases</span>;</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">|&#xA0;Database&#xA0;|</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">|&#xA0;information_schema&#xA0;|</span><br><span class="line">|&#xA0;TESTDB&#xA0;|</span><br><span class="line">|&#xA0;mysql&#xA0;|</span><br><span class="line">|&#xA0;performance_schema&#xA0;|</span><br><span class="line">|&#xA0;sys&#xA0;|</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">5&#xA0;rows&#xA0;in&#xA0;<span class="keyword">set</span>&#xA0;(<span class="number">0.00</span>&#xA0;sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;<span class="keyword">use</span>&#xA0;TESTDB;</span><br><span class="line">Reading&#xA0;table&#xA0;information&#xA0;for&#xA0;completion&#xA0;of&#xA0;table&#xA0;and&#xA0;column&#xA0;names</span><br><span class="line">You&#xA0;can&#xA0;turn&#xA0;off&#xA0;this&#xA0;feature&#xA0;to&#xA0;get&#xA0;a&#xA0;quicker&#xA0;startup&#xA0;<span class="keyword">with</span>&#xA0;&#x2010;A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span>&#xA0;<span class="keyword">changed</span></span><br><span class="line">mysql&gt;&#xA0;<span class="keyword">show</span>&#xA0;<span class="keyword">tables</span>;</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">|&#xA0;Tables_in_TESTDB&#xA0;|</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">|&#xA0;table666&#xA0;|</span><br><span class="line">+&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;&#x2010;+</span><br><span class="line">1&#xA0;row&#xA0;in&#xA0;<span class="keyword">set</span>&#xA0;(<span class="number">0.00</span>&#xA0;sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;<span class="keyword">exit</span></span><br><span class="line">Bye</span><br></pre></td></tr></tbody></table></figure>
<p>&#x6307;&#x5B9A;&#x4E3B;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x91CD;&#x542F;slave<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL2&#xA0;~]<span class="comment">#&#xA0;mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql:&#xA0;[Warning]&#xA0;Using&#xA0;a&#xA0;password&#xA0;on&#xA0;the&#xA0;command&#xA0;line&#xA0;interface&#xA0;can&#xA0;be&#xA0;insecure.</span><br><span class="line">Welcome&#xA0;to&#xA0;the&#xA0;MySQL&#xA0;monitor.&#xA0;Commands&#xA0;<span class="keyword">end</span>&#xA0;<span class="keyword">with</span>&#xA0;;&#xA0;or&#xA0;\g.</span><br><span class="line">Your&#xA0;MySQL&#xA0;connection&#xA0;id&#xA0;is&#xA0;3</span><br><span class="line">Server&#xA0;version:&#xA0;5.7.19&#xA0;Source&#xA0;distribution</span><br><span class="line"></span><br><span class="line">Copyright&#xA0;(c)&#xA0;2000,&#xA0;2017,&#xA0;Oracle&#xA0;and/or&#xA0;its&#xA0;affiliates.&#xA0;All&#xA0;rights&#xA0;reserved.</span><br><span class="line"></span><br><span class="line">Oracle&#xA0;is&#xA0;a&#xA0;registered&#xA0;trademark&#xA0;of&#xA0;Oracle&#xA0;Corporation&#xA0;and/or&#xA0;its</span><br><span class="line">affiliates.&#xA0;Other&#xA0;names&#xA0;may&#xA0;be&#xA0;trademarks&#xA0;of&#xA0;their&#xA0;respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type&#xA0;&apos;<span class="keyword">help</span>;&apos;&#xA0;or&#xA0;&apos;\h&apos;&#xA0;for&#xA0;help.&#xA0;<span class="keyword">Type</span>&#xA0;<span class="string">&apos;\c&apos;</span>&#xA0;<span class="keyword">to</span>&#xA0;<span class="keyword">clear</span>&#xA0;the&#xA0;<span class="keyword">current</span>&#xA0;<span class="keyword">input</span>&#xA0;statement.</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;<span class="keyword">stop</span>&#xA0;<span class="keyword">slave</span>;</span><br><span class="line">Query&#xA0;OK,&#xA0;0&#xA0;rows&#xA0;affected,&#xA0;1&#xA0;warning&#xA0;(0.00&#xA0;sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;change&#xA0;master&#xA0;to master_host=&apos;192.168.10.67&apos;,master_user=&apos;slave&apos;,master_password=&apos;Jaking@vip.163.com&apos;;</span><br><span class="line">Query&#xA0;OK,&#xA0;0&#xA0;rows&#xA0;affected,&#xA0;2&#xA0;warnings&#xA0;(0.00&#xA0;sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;start&#xA0;slave;</span><br><span class="line">Query&#xA0;OK,&#xA0;0&#xA0;rows&#xA0;affected&#xA0;(0.00&#xA0;sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;&#xA0;show&#xA0;slave&#xA0;status\G</span><br><span class="line">***************************&#xA0;1.&#xA0;row&#xA0;***************************</span><br><span class="line">Slave_IO_State:&#xA0;Waiting&#xA0;for&#xA0;master&#xA0;to&#xA0;send&#xA0;event</span><br><span class="line">Master_Host:&#xA0;192.168.10.67</span><br><span class="line">Master_User:&#xA0;slave</span><br><span class="line">Master_Port:&#xA0;3306</span><br><span class="line">Connect_Retry:&#xA0;60</span><br><span class="line">Master_Log_File:&#xA0;mysql&#x2010;bin&#x2010;master.000002</span><br><span class="line">Read_Master_Log_Pos:&#xA0;601</span><br><span class="line">Relay_Log_File:&#xA0;MySQL2&#x2010;relay&#x2010;bin.000003</span><br><span class="line">Relay_Log_Pos:&#xA0;828</span><br><span class="line">Relay_Master_Log_File:&#xA0;mysql&#x2010;bin&#x2010;master.000002</span><br><span class="line">Slave_IO_Running:&#xA0;Yes</span><br><span class="line">Slave_SQL_Running:&#xA0;Yes</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Slave_IO_Running &#xFF1A;&#x4E00;&#x4E2A;&#x8D1F;&#x8D23;&#x4E0E;&#x4E3B;&#x673A;&#x7684;IO&#x901A;&#x4FE1;<br>Slave_SQL_Running&#xFF1A;&#x8D1F;&#x8D23;&#x81EA;&#x5DF1;&#x7684;slave mysql&#x8FDB;&#x7A0B;<br>&#x4E24;&#x4E2A;&#x4E3A; Yes &#x5C31;&#x6210;&#x529F;&#x4E86;&#xFF01;  </p>
<p>&#x518D;&#x5230;&#x4E3B;&#x6570;&#x636E;&#x5E93;&#x4E0A;&#x67E5;&#x770B;&#x72B6;&#x6001;  </p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">1 [root@MySQL1&#xA0;mysql&#x2010;5.7.19]<span class="comment">#&#xA0;mysql&#xA0;&#x2010;uroot&#xA0;&#x2010;pJaking@vip.163.com</span></span><br><span class="line">2 mysql:&#xA0;[Warning]&#xA0;Using&#xA0;a&#xA0;password&#xA0;on&#xA0;the&#xA0;command&#xA0;line&#xA0;interface&#xA0;can&#xA0;be&#xA0;in</span><br><span class="line">secure.</span><br><span class="line">3 Welcome&#xA0;to&#xA0;the&#xA0;MySQL&#xA0;monitor.&#xA0;Commands&#xA0;<span class="keyword">end</span>&#xA0;<span class="keyword">with</span>&#xA0;;&#xA0;or&#xA0;\g.</span><br><span class="line">4 Your&#xA0;MySQL&#xA0;connection&#xA0;id&#xA0;is&#xA0;7</span><br><span class="line">5 Server&#xA0;version:&#xA0;5.7.19&#x2010;log&#xA0;Source&#xA0;distribution</span><br><span class="line">6</span><br><span class="line">7 Copyright&#xA0;(c)&#xA0;2000,&#xA0;2017,&#xA0;Oracle&#xA0;and/or&#xA0;its&#xA0;affiliates.&#xA0;All&#xA0;rights&#xA0;reserv</span><br><span class="line">ed.</span><br><span class="line">8</span><br><span class="line">9 Oracle&#xA0;is&#xA0;a&#xA0;registered&#xA0;trademark&#xA0;of&#xA0;Oracle&#xA0;Corporation&#xA0;and/or&#xA0;its</span><br><span class="line">10 affiliates.&#xA0;Other&#xA0;names&#xA0;may&#xA0;be&#xA0;trademarks&#xA0;of&#xA0;their&#xA0;respective</span><br><span class="line">11 owners.</span><br><span class="line">12</span><br><span class="line">13 Type&#xA0;&apos;<span class="keyword">help</span>;&apos;&#xA0;or&#xA0;&apos;\h&apos;&#xA0;for&#xA0;help.&#xA0;<span class="keyword">Type</span>&#xA0;<span class="string">&apos;\c&apos;</span>&#xA0;<span class="keyword">to</span>&#xA0;<span class="keyword">clear</span>&#xA0;the&#xA0;<span class="keyword">current</span>&#xA0;<span class="keyword">input</span>&#xA0;stat</span><br><span class="line">ement.</span><br><span class="line"><span class="number">14</span></span><br><span class="line"><span class="number">15</span> mysql&gt;&#xA0;<span class="keyword">show</span>&#xA0;<span class="keyword">processlist</span>\G</span><br><span class="line"><span class="number">16</span> ***************************&#xA0;<span class="number">1.</span>&#xA0;<span class="keyword">row</span>&#xA0;***************************</span><br><span class="line"><span class="number">17</span> &#xA0;<span class="keyword">Id</span>:&#xA0;<span class="number">6</span></span><br><span class="line"><span class="number">18</span> &#xA0;<span class="keyword">User</span>:&#xA0;<span class="keyword">slave</span></span><br><span class="line"><span class="number">19</span> &#xA0;Host:&#xA0;<span class="number">192.168</span><span class="number">.10</span><span class="number">.68</span>:<span class="number">54656</span></span><br><span class="line"><span class="number">20</span> &#xA0;db:&#xA0;<span class="literal">NULL</span></span><br><span class="line"><span class="number">21</span> Command:&#xA0;<span class="keyword">Binlog</span>&#xA0;Dump</span><br><span class="line"><span class="number">22</span> &#xA0;<span class="built_in">Time</span>:&#xA0;<span class="number">165</span></span><br><span class="line"><span class="number">23</span> &#xA0;State:&#xA0;<span class="keyword">Master</span>&#xA0;TESTDBs&#xA0;sent&#xA0;all&#xA0;<span class="keyword">binlog</span>&#xA0;<span class="keyword">to</span>&#xA0;<span class="keyword">slave</span>;&#xA0;waiting&#xA0;for&#xA0;more&#xA0;updates</span><br><span class="line">24 &#xA0;Info:&#xA0;NULL</span><br><span class="line">25 ***************************&#xA0;2.&#xA0;row&#xA0;***************************</span><br><span class="line">26 &#xA0;Id:&#xA0;7</span><br><span class="line">27 &#xA0;User:&#xA0;root</span><br><span class="line">28 &#xA0;Host:&#xA0;localhost</span><br><span class="line">29 &#xA0;db:&#xA0;NULL</span><br><span class="line">30 Command:&#xA0;Query</span><br><span class="line">31 &#xA0;Time:&#xA0;0</span><br><span class="line">32 &#xA0;State:&#xA0;starting</span><br><span class="line">33 &#xA0;Info:&#xA0;<span class="keyword">show</span>&#xA0;<span class="keyword">processlist</span></span><br><span class="line"><span class="number">34</span> <span class="number">2</span>&#xA0;<span class="keyword">rows</span>&#xA0;<span class="keyword">in</span>&#xA0;<span class="keyword">set</span>&#xA0;(<span class="number">0.00</span>&#xA0;sec)</span><br><span class="line"><span class="number">35</span></span><br><span class="line"><span class="number">36</span> mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x6D4B;&#x8BD5;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL1 ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 11</span><br><span class="line">Server version: 5.7.19-log MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testdb             |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> testdb;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| Tables_in_testdb |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| table666         |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> table666;</span><br><span class="line">Empty <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table666(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;1&apos;</span>,<span class="string">&apos;Linux&apos;</span>,<span class="string">&apos;66&apos;</span>,<span class="string">&apos;DZ&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table666(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;2&apos;</span>,<span class="string">&apos;CLD&apos;</span>,<span class="string">&apos;68&apos;</span>,<span class="string">&apos;RM&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table666(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;3&apos;</span>,<span class="string">&apos;SYS&apos;</span>,<span class="string">&apos;90&apos;</span>,<span class="string">&apos;JX&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table666(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;4&apos;</span>,<span class="string">&apos;MySQL1&apos;</span>,<span class="string">&apos;71&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table666(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;5&apos;</span>,<span class="string">&apos;MySQL2&apos;</span>,<span class="string">&apos;72&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> table666(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;6&apos;</span>,<span class="string">&apos;MySQL3&apos;</span>,<span class="string">&apos;73&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from table666;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">|       6 | MySQL3 |    73 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@MySQL1 ~]<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@MySQL2 ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 9</span><br><span class="line">Server version: 5.7.19 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2018, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> testdb.table666;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">|       6 | MySQL3 |    73 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x4E3B;&#x5E93;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from table666;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">|       6 | MySQL3 |    73 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">delete</span> <span class="keyword">from</span> table666 <span class="keyword">where</span> bName=<span class="string">&quot;MySQL3&quot;</span>;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from table666;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x4ECE;&#x5E93;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from testdb.table666;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x4E3B;&#x5E93;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from table666;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">5 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">INSERT</span> <span class="keyword">INTO</span> table666(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;666&apos;</span>,<span class="string">&apos;Linux666&apos;</span>,<span class="string">&apos;666&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from table666;                                                 </span><br><span class="line">+<span class="comment">---------+----------+-------+------------+</span></span><br><span class="line">| bTypeId | bName    | price | publishing |</span><br><span class="line">+<span class="comment">---------+----------+-------+------------+</span></span><br><span class="line">|       1 | Linux    |    66 | DZ         |</span><br><span class="line">|       2 | CLD      |    68 | RM         |</span><br><span class="line">|       3 | SYS      |    90 | JX         |</span><br><span class="line">|       4 | MySQL1   |    71 | QH         |</span><br><span class="line">|       5 | MySQL2   |    72 | QH         |</span><br><span class="line">|     666 | Linux666 |   666 | QH         |</span><br><span class="line">+<span class="comment">---------+----------+-------+------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x4ECE;&#x5E93;</p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from testdb.table666;</span><br><span class="line">+<span class="comment">---------+----------+-------+------------+</span></span><br><span class="line">| bTypeId | bName    | price | publishing |</span><br><span class="line">+<span class="comment">---------+----------+-------+------------+</span></span><br><span class="line">|       1 | Linux    |    66 | DZ         |</span><br><span class="line">|       2 | CLD      |    68 | RM         |</span><br><span class="line">|       3 | SYS      |    90 | JX         |</span><br><span class="line">|       4 | MySQL1   |    71 | QH         |</span><br><span class="line">|       5 | MySQL2   |    72 | QH         |</span><br><span class="line">|     666 | Linux666 |   666 | QH         |</span><br><span class="line">+<span class="comment">---------+----------+-------+------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<h2 id="&#x81F3;&#x6B64;&#xFF0C;MySQL&#x4F20;&#x7EDF;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x642D;&#x5EFA;&#x6210;&#x529F;&#xFF01;"><a href="#&#x81F3;&#x6B64;&#xFF0C;MySQL&#x4F20;&#x7EDF;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x642D;&#x5EFA;&#x6210;&#x529F;&#xFF01;" class="headerlink" title="&#x81F3;&#x6B64;&#xFF0C;MySQL&#x4F20;&#x7EDF;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x642D;&#x5EFA;&#x6210;&#x529F;&#xFF01;"></a>&#x81F3;&#x6B64;&#xFF0C;MySQL&#x4F20;&#x7EDF;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x642D;&#x5EFA;&#x6210;&#x529F;&#xFF01;</h2><h2 id="&#x7EC3;&#x4E60;&#xFF1A;1-&#x914D;&#x7F6E;&#x4E92;&#x4E3A;&#x4E3B;&#x4ECE;-2-&#x5148;&#x914D;&#x7F6E;&#x5E38;&#x89C4;&#x4E3B;&#x4ECE;&#xFF0C;&#x7136;&#x540E;&#x589E;&#x52A0;&#x4E00;&#x53F0;&#x4ECE;&#x5E93;"><a href="#&#x7EC3;&#x4E60;&#xFF1A;1-&#x914D;&#x7F6E;&#x4E92;&#x4E3A;&#x4E3B;&#x4ECE;-2-&#x5148;&#x914D;&#x7F6E;&#x5E38;&#x89C4;&#x4E3B;&#x4ECE;&#xFF0C;&#x7136;&#x540E;&#x589E;&#x52A0;&#x4E00;&#x53F0;&#x4ECE;&#x5E93;" class="headerlink" title="&#x7EC3;&#x4E60;&#xFF1A;1. &#x914D;&#x7F6E;&#x4E92;&#x4E3A;&#x4E3B;&#x4ECE;  2. &#x5148;&#x914D;&#x7F6E;&#x5E38;&#x89C4;&#x4E3B;&#x4ECE;&#xFF0C;&#x7136;&#x540E;&#x589E;&#x52A0;&#x4E00;&#x53F0;&#x4ECE;&#x5E93;"></a>&#x7EC3;&#x4E60;&#xFF1A;1. &#x914D;&#x7F6E;&#x4E92;&#x4E3A;&#x4E3B;&#x4ECE;  2. &#x5148;&#x914D;&#x7F6E;&#x5E38;&#x89C4;&#x4E3B;&#x4ECE;&#xFF0C;&#x7136;&#x540E;&#x589E;&#x52A0;&#x4E00;&#x53F0;&#x4ECE;&#x5E93;</h2><p>&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;  </p>
<p>master_1:</p>
<pre><code>bind-address    = 0.0.0.0   # &#x542F;&#x7528;&#x8FDC;&#x7A0B;&#x8FDE;&#x63A5;

log-bin=mysql-bin   
# &#x6B65;&#x8FDB;&#x503C;&#xFF0C;&#x5982;&#x679C;&#x6709;n&#x53F0;master&#xFF0C;&#x5C31;&#x586B;n&#xFF1A;
auto_increment_increment=2
# &#x8D77;&#x59CB;&#x503C;&#xFF0C;&#x4E00;&#x822C;&#x586B;&#x7B2C;n&#x53F0;master&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x7B2C;1&#x53F0;&#x4E3B;MySQL
auto_increment_offset=1
server-id=1
lower_case_table_names=1
</code></pre><p>master_2:</p>
<pre><code>auto_increment_increment=2
auto_increment_offset=2
log-bin=mysql-bin
binlog_format=mixed
server-id=2
lower_case_table_names=1
</code></pre><p># &#x5BFC;&#x51FA;&#x6570;&#x636E;&#x5230;master_2<br>master_1:</p>
<pre><code>mysqldump -uroot -p -A &gt; all_db.sql
scp all_db.sql master_2_user@master_2_ipaddr:~/
</code></pre><p>master_2:</p>
<pre><code>mysql -uroot -p &lt; all.db.sql
</code></pre><p># &#x8BB0;&#x5F55;bin-log&#x6587;&#x4EF6;&#x8DDF;&#x4F4D;&#x7F6E;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x6388;&#x6743;&#x7ED9;&#x5BF9;&#x65B9;</p>
<p>#&#x4F8B;&#x5982;&#xFF1A;<br>master_1:</p>
<pre><code>show master status;
</code></pre><p>#&#x5C06;&#x81EA;&#x5DF1;&#x7684;bin-log&#x6587;&#x4EF6;&#x6388;&#x6743;&#x7ED9;&#x5176;&#x4ED6;master&#xFF1A;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">REPLICATION</span> <span class="keyword">SLAVE</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="keyword">slave</span>@<span class="string">&apos;master_2_ipaddr&apos;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> &#x2018;slave_password&#x2019;;</span><br><span class="line"><span class="keyword">STOP</span> <span class="keyword">SLAVE</span>;</span><br><span class="line"><span class="keyword">CHANGE</span> <span class="keyword">MASTER</span> <span class="keyword">TO</span> master_host=<span class="string">&apos;master_2_ipaddr&apos;</span>,master_user=<span class="string">&apos;slave&apos;</span>,master_password=<span class="string">&apos;slave_password&apos;</span>,master_log_file=<span class="string">&apos;mysql-bin.000005&apos;</span>,master_log_pos=<span class="number">13756331</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">SLAVE</span>;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">SLAVE</span> <span class="keyword">STATUS</span>\G</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>master_2:</p>
<h1 id="&#x5C06;&#x81EA;&#x5DF1;&#x7684;bin-log&#x6587;&#x4EF6;&#x6388;&#x6743;&#x7ED9;&#x5176;&#x4ED6;maser"><a href="#&#x5C06;&#x81EA;&#x5DF1;&#x7684;bin-log&#x6587;&#x4EF6;&#x6388;&#x6743;&#x7ED9;&#x5176;&#x4ED6;maser" class="headerlink" title="&#x5C06;&#x81EA;&#x5DF1;&#x7684;bin-log&#x6587;&#x4EF6;&#x6388;&#x6743;&#x7ED9;&#x5176;&#x4ED6;maser"></a>&#x5C06;&#x81EA;&#x5DF1;&#x7684;bin-log&#x6587;&#x4EF6;&#x6388;&#x6743;&#x7ED9;&#x5176;&#x4ED6;maser</h1><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GRANT</span> <span class="keyword">REPLICATION</span> <span class="keyword">SLAVE</span> <span class="keyword">ON</span> *.* <span class="keyword">TO</span> <span class="keyword">slave</span>@<span class="string">&apos;master_1_ipaddr&apos;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> &#x2018;slave_password&#x2019;;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br><span class="line"><span class="keyword">STOP</span> <span class="keyword">SLAVE</span>;</span><br><span class="line"><span class="keyword">CHANGE</span> <span class="keyword">MASTER</span> <span class="keyword">TO</span> master_host=<span class="string">&apos;master_1_ipaddr&apos;</span>,master_user=<span class="string">&apos;slave&apos;</span>,master_password=<span class="string">&apos;slave_password&apos;</span>,master_log_file=<span class="string">&apos;mysql-bin.000001&apos;</span>,mysql_log_pos=<span class="number">1022</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br><span class="line"><span class="keyword">START</span> <span class="keyword">SLAVE</span>;</span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">SLAVE</span> <span class="keyword">STATUS</span>\G</span><br></pre></td></tr></tbody></table></figure>
<p>&#x53C2;&#x8003;&#xFF1A;<a href="https://www.smister.com/post-41/mysql-master-master.html" target="_blank" rel="noopener">https://www.smister.com/post-41/mysql-master-master.html</a></p>
<p># &#x5728;&#x539F;&#x6709;&#x4E3B;&#x4ECE;&#x4E0A; &#x65B0;&#x589E;&#x4ECE;&#x5E93;</p>
<p>MySQL&#x4F20;&#x7EDF;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x4E4B;&#x4E0D;&#x505C;&#x673A;&#x91CD;&#x5EFA;&#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#xFF08;&#x5B9E;&#x6218;&#xFF09;<br><a href="https://note.youdao.com/s/bHvxKKyK" target="_blank" rel="noopener">https://note.youdao.com/s/bHvxKKyK</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/607e4760/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-MySQL调优" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/208cd020/">MySQL调优</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:44:39" datetime="2022-06-07T04:44:39.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h3 id="&#x5B66;&#x4E60;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x7684;&#x8FC7;&#x7A0B;&#xFF1A;"><a href="#&#x5B66;&#x4E60;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x7684;&#x8FC7;&#x7A0B;&#xFF1A;" class="headerlink" title="&#x5B66;&#x4E60;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x7684;&#x8FC7;&#x7A0B;&#xFF1A;"></a>&#x5B66;&#x4E60;&#x4E00;&#x4E2A;&#x670D;&#x52A1;&#x7684;&#x8FC7;&#x7A0B;&#xFF1A;</h3><p>1&#x3001; &#x6B64;&#x670D;&#x52A1;&#x5668;&#x7684;&#x6982;&#x8FF0;&#xFF1A;&#x540D;&#x79F0;&#xFF0C;&#x529F;&#x80FD;&#xFF0C;&#x7279;&#x70B9;&#xFF0C;&#x7AEF;&#x53E3;&#x53F7;<br>2&#x3001; &#x5B89;&#x88C5;<br>3&#x3001; &#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x7684;&#x4F4D;&#x7F6E;<br>4&#x3001; &#x670D;&#x52A1;&#x542F;&#x52A8;&#x5173;&#x95ED;&#x811A;&#x672C;&#xFF0C;&#x67E5;&#x770B;&#x7AEF;&#x53E3;<br>5&#x3001; &#x6B64;&#x670D;&#x52A1;&#x7684;&#x4F7F;&#x7528;&#x65B9;&#x6CD5;<br>6&#x3001; &#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5B9E;&#x6218;&#x4E3E;&#x4F8B;<br>7&#x3001; &#x6392;&#x9519;&#xFF08;&#x4ECE;&#x4E0B;&#x5230;&#x4E0A;&#xFF0C;&#x4ECE;&#x5185;&#x5230;&#x5916;&#xFF09;  </p>
<h3 id="&#x672C;&#x8282;&#x6240;&#x5B66;&#x5185;&#x5BB9;&#xFF1A;"><a href="#&#x672C;&#x8282;&#x6240;&#x5B66;&#x5185;&#x5BB9;&#xFF1A;" class="headerlink" title="&#x672C;&#x8282;&#x6240;&#x5B66;&#x5185;&#x5BB9;&#xFF1A;"></a>&#x672C;&#x8282;&#x6240;&#x5B66;&#x5185;&#x5BB9;&#xFF1A;</h3><p>&#x2022; &#x8C03;&#x4F18;&#x601D;&#x8DEF;&#xFF1A;<br>&#x2022; 0.&#x786C;&#x4EF6;&#x4F18;&#x5316;<br>&#x2022; 1.&#x6570;&#x636E;&#x5E93;&#x8BBE;&#x8BA1;&#x4E0E;&#x89C4;&#x5212;&#x2013;&#x4EE5;&#x540E;&#x518D;&#x4FEE;&#x6539;&#x5F88;&#x9EBB;&#x70E6;&#xFF0C;&#x4F30;&#x8BA1;&#x6570;&#x636E;&#x91CF;&#xFF0C;&#x4F7F;&#x7528;&#x4EC0;&#x4E48;&#x5B58;&#x50A8;&#x5F15;&#x64CE;<br>&#x2022; 2.&#x6570;&#x636E;&#x7684;&#x5E94;&#x7528;&#x2013;&#x600E;&#x6837;&#x53D6;&#x6570;&#x636E;&#xFF0C;sql &#x8BED;&#x53E5;&#x7684;&#x4F18;&#x5316;<br>&#x2022; 3.&#x78C1;&#x76D8; io &#x4F18;&#x5316;<br>&#x2022; 4.&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x4F18;&#x5316;&#x2013;&#x5185;&#x6838;&#x3001;tcp &#x8FDE;&#x63A5;&#x6570;&#x91CF;<br>&#x2022; 5.mysql &#x670D;&#x52A1;&#x4F18;&#x5316;&#x2013;&#x5185;&#x5B58;&#x7684;&#x4F7F;&#x7528;&#xFF0C;&#x78C1;&#x76D8;&#x7684;&#x4F7F;&#x7528;<br>&#x2022; 6.my.cnf &#x5185;&#x53C2;&#x6570;&#x7684;&#x4F18;&#x5316;<br>&#x2022; 7 &#x5206;&#x5E93;&#x5206;&#x8868;&#x601D;&#x8DEF;&#x548C;&#x4F18;&#x52A3;  </p>
<h3 id="0-&#x786C;&#x4EF6;&#x4F18;&#x5316;"><a href="#0-&#x786C;&#x4EF6;&#x4F18;&#x5316;" class="headerlink" title="0.&#x786C;&#x4EF6;&#x4F18;&#x5316;"></a>0.&#x786C;&#x4EF6;&#x4F18;&#x5316;</h3><p>CPU&#x2014;&#x2014; 64 &#x4F4D;&#x3001;&#x9AD8;&#x4E3B;&#x9891;&#x3001;&#x9AD8;&#x7F13;&#x5B58;&#xFF0C;&#x9AD8;&#x5E76;&#x884C;&#x5904;&#x7406;&#x80FD;&#x529B;<br>&#x5185;&#x5B58;&#x2014;&#x2014;&#x5927;&#x5185;&#x5B58;&#x3001;&#x4E3B;&#x9891;&#x9AD8;&#xFF0C;&#x5C3D;&#x91CF;&#x4E0D;&#x8981;&#x7528; SWAP<br>&#x786C;&#x76D8;&#x2014;&#x2014;15000&#x8F6C;&#x3001;RAID5&#x3001;RAID10 &#x3001; SSD<br>&#x7F51;&#x7EDC;&#x2014;&#x2014;&#x6807;&#x914D;&#x7684;&#x5343;&#x5146;&#x7F51;&#x5361;&#xFF0C;10G&#x7F51;&#x5361;&#xFF0C;bond0&#xFF0C;MySQL&#x670D;&#x52A1;&#x5668;&#x5C3D;&#x53EF;&#x80FD;&#x548C;&#x4F7F;&#x7528;&#x5B83;&#x7684;web&#x670D;&#x52A1;&#x5668;&#x5728;&#x540C;&#x4E00;&#x5C40;&#x57DF;&#x7F51;&#x5185;&#xFF0C;&#x5C3D;&#x91CF;&#x907F;&#x514D;&#x8BF8;&#x5982;&#x9632;&#x706B;&#x5899;&#x7B56;&#x7565;&#x7B49;&#x4E0D;&#x5FC5;&#x8981;&#x7684;&#x5F00;&#x9500;&#x3002;  </p>
<h3 id="1-&#x6570;&#x636E;&#x5E93;&#x8BBE;&#x8BA1;&#x4E0E;&#x89C4;&#x5212;&#xFF08;&#x67B6;&#x6784;&#x4E0A;&#x7684;&#x4F18;&#x5316;"><a href="#1-&#x6570;&#x636E;&#x5E93;&#x8BBE;&#x8BA1;&#x4E0E;&#x89C4;&#x5212;&#xFF08;&#x67B6;&#x6784;&#x4E0A;&#x7684;&#x4F18;&#x5316;" class="headerlink" title="1.&#x6570;&#x636E;&#x5E93;&#x8BBE;&#x8BA1;&#x4E0E;&#x89C4;&#x5212;&#xFF08;&#x67B6;&#x6784;&#x4E0A;&#x7684;&#x4F18;&#x5316;)"></a>1.&#x6570;&#x636E;&#x5E93;&#x8BBE;&#x8BA1;&#x4E0E;&#x89C4;&#x5212;&#xFF08;&#x67B6;&#x6784;&#x4E0A;&#x7684;&#x4F18;&#x5316;)</h3><p>&#x7EB5;&#x5411;&#x62C6;&#x89E3;: &#x4E13;&#x673A;&#x4E13;&#x7528;<br>&#x4F8B;&#xFF1A;&#x73B0;&#x5728;&#x516C;&#x53F8;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x540C;&#x65F6;&#x8D1F;&#x8D23; web&#x3001;ftp&#x3001;&#x6570;&#x636E;&#x5E93;&#x7B49;&#x591A;&#x4E2A;&#x89D2;&#x8272;&#x3002; R720 dell &#x5185;&#x5B58; &#xFF1A;768G<br>&#x7EB5;&#x5411;&#x62C6;&#x89E3;&#x540E;&#x5C31;&#x662F;&#xFF1A;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x5668;&#x4E13;&#x673A;&#x4E13;&#x7528;&#xFF0C;&#x907F;&#x514D;&#x989D;&#x5916;&#x7684;&#x670D;&#x52A1;&#x53EF;&#x80FD;&#x5BFC;&#x81F4;&#x7684;&#x6027;&#x80FD;&#x4E0B;&#x964D;&#x548C;&#x4E0D;&#x7A33;&#x5B9A;&#x6027;&#x3002; </p>
<p>&#x6A2A;&#x5411;&#x62C6;&#x89E3;: &#x4E3B;&#x4ECE;&#x540C;&#x6B65;&#x3001;&#x8D1F;&#x8F7D;&#x5747;&#x8861;&#x3001;&#x9AD8;&#x53EF;&#x7528;&#x6027;&#x96C6;&#x7FA4;&#xFF0C;&#x5F53;&#x5355;&#x4E2A; mysql &#x6570;&#x636E;&#x5E93;&#x65E0;&#x6CD5;&#x6EE1;&#x8DB3;&#x65E5;&#x76CA;&#x589E;&#x52A0;&#x7684;&#x9700;&#x6C42;&#x65F6;&#xFF0C;&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x5728;&#x6570;&#x636E;&#x5E93;&#x8FD9;&#x4E2A;&#x903B;&#x8F91;&#x5C42;&#x9762;&#x589E;&#x52A0;&#x591A;&#x53F0;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4EE5;&#x8FBE;&#x5230;&#x7A33;&#x5B9A;&#x3001;&#x9AD8;&#x6548;&#x7684;&#x6548;&#x679C;&#x3002;  </p>
<h3 id="2&#x3001;&#x67E5;&#x8BE2;&#x4F18;&#x5316;"><a href="#2&#x3001;&#x67E5;&#x8BE2;&#x4F18;&#x5316;" class="headerlink" title="2&#x3001;&#x67E5;&#x8BE2;&#x4F18;&#x5316;"></a>2&#x3001;&#x67E5;&#x8BE2;&#x4F18;&#x5316;</h3><p>a&gt;&#x5EFA;&#x8868;&#x65F6;&#x8868;&#x7ED3;&#x6784;&#x8981;&#x5408;&#x7406;&#xFF0C;&#x6BCF;&#x4E2A;&#x8868;&#x4E0D;&#x5B9C;&#x8FC7;&#x5927;&#xFF1B;&#x5728;&#x4EFB;&#x4F55;&#x60C5;&#x51B5;&#x4E0B;&#x5747;&#x5E94;&#x4F7F;&#x7528;&#x6700;&#x7CBE;&#x786E;&#x7684;&#x7C7B;&#x578B;&#x3002;&#x4F8B;&#x5982;&#xFF0C;&#x5982;&#x679C;ID&#x5217;&#x7528;int&#x662F;&#x4E00;&#x4E2A;&#x597D;&#x4E3B;&#x610F;&#xFF0C;&#x800C;&#x7528;text&#x7C7B;&#x578B;&#x5219;&#x662F;&#x4E2A;&#x8822;&#x529E;&#x6CD5;&#xFF1B;TIME&#x5217;&#x914C;&#x60C5;&#x4F7F;&#x7528;DATE&#x6216;&#x8005;DATETIME&#x3002;<br>b&gt;&#x7D22;&#x5F15;&#xFF0C;&#x5EFA;&#x7ACB;&#x5408;&#x9002;&#x7684;&#x7D22;&#x5F15;&#x3002;<br>c&gt;&#x67E5;&#x8BE2;&#x65F6;&#x5C3D;&#x91CF;&#x51CF;&#x5C11;&#x903B;&#x8F91;&#x8FD0;&#x7B97;&#xFF08;&#x4E0E;&#x8FD0;&#x7B97;&#x3001;&#x6216;&#x8FD0;&#x7B97;&#x3001;&#x5927;&#x4E8E;&#x5C0F;&#x4E8E;&#x67D0;&#x503C;&#x7684;&#x8FD0;&#x7B97;&#xFF09;&#xFF1B;<br>d&gt;&#x51CF;&#x5C11;&#x4E0D;&#x5F53;&#x7684;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#xFF0C;&#x4E0D;&#x8981;&#x67E5;&#x8BE2;&#x5E94;&#x7528;&#x4E2D;&#x4E0D;&#x9700;&#x8981;&#x7684;&#x5217;&#xFF0C;&#x6BD4;&#x5982;&#x8BF4;select * from &#x7B49;&#x64CD;&#x4F5C;&#x3002;<br>e&gt;&#x51CF;&#x5C0F;&#x4E8B;&#x52A1;&#x5305;&#x7684;&#x5927;&#x5C0F;&#xFF1B;<br>f&gt;&#x5C06;&#x591A;&#x4E2A;&#x5C0F;&#x7684;&#x67E5;&#x8BE2;&#x9002;&#x5F53;&#x5408;&#x5E76;&#x6210;&#x4E00;&#x4E2A;&#x5927;&#x7684;&#x67E5;&#x8BE2;&#xFF0C;&#x51CF;&#x5C11;&#x6BCF;&#x6B21;&#x5EFA;&#x7ACB;/&#x5173;&#x95ED;&#x67E5;&#x8BE2;&#x65F6;&#x7684;&#x5F00;&#x9500;&#xFF1B;<br>g&gt;&#x5C06;&#x67D0;&#x4E9B;&#x8FC7;&#x4E8E;&#x590D;&#x6742;&#x7684;&#x67E5;&#x8BE2;&#x62C6;&#x89E3;&#x6210;&#x591A;&#x4E2A;&#x5C0F;&#x67E5;&#x8BE2;&#xFF0C;&#x548C;&#x4E0A;&#x4E00;&#x6761;&#x6070;&#x597D;&#x76F8;&#x53CD;<br>h&gt;&#x5EFA;&#x7ACB;&#x548C;&#x4F18;&#x5316;&#x5B58;&#x50A8;&#x8FC7;&#x7A0B;&#x6765;&#x4EE3;&#x66FF;&#x5927;&#x91CF;&#x7684;&#x5916;&#x90E8;&#x7A0B;&#x5E8F;&#x4EA4;&#x4E92;&#x3002;  </p>
<h3 id="3&#xFF0C;&#x78C1;&#x76D8;-IO-&#x89C4;&#x5212;&#xFF0C;IO&#x76F8;&#x5173;&#x7684;&#x6280;&#x672F;"><a href="#3&#xFF0C;&#x78C1;&#x76D8;-IO-&#x89C4;&#x5212;&#xFF0C;IO&#x76F8;&#x5173;&#x7684;&#x6280;&#x672F;" class="headerlink" title="3&#xFF0C;&#x78C1;&#x76D8; IO &#x89C4;&#x5212;&#xFF0C;IO&#x76F8;&#x5173;&#x7684;&#x6280;&#x672F;"></a>3&#xFF0C;&#x78C1;&#x76D8; IO &#x89C4;&#x5212;&#xFF0C;IO&#x76F8;&#x5173;&#x7684;&#x6280;&#x672F;</h3><p>RAID &#x6280;&#x672F;&#xFF1A;RAID0&#x6216;RAID10<br>SSD<br>15000&#x8F6C;&#x3001;RAID5&#x3001;RAID10 &#x3001;SSD<br>swap &#x5206;&#x533A;&#xFF1A;&#x6700;&#x597D;&#x4F7F;&#x7528; RAID0 &#x6216; SSD<br>&#x78C1;&#x76D8;&#x5206;&#x533A;&#xFF1A;&#x5C06;&#x6570;&#x636E;&#x5E93;&#x76EE;&#x5F55;&#x653E;&#x5230;&#x4E00;&#x4E2A;&#x5206;&#x533A;&#x4E0A;&#x6216;&#x4E00;&#x4E2A;&#x78C1;&#x76D8;&#x4E0A;&#x7684;&#x7269;&#x7406;&#x5206;&#x533A;&#xFF0C;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x7684;&#x786C;&#x76D8;&#x6216;&#x5206;&#x533A;&#x548C;&#x7CFB;&#x7EDF;&#x6240;&#x5728;&#x7684;&#x786C;&#x76D8;&#x5206;&#x5F00;&#x3002;  </p>
<p>&#x8BBE;&#x7F6E;&#x4E3B;&#x4ECE;&#x65F6;&#xFF0C;&#x7531;&#x4E8E;binlog&#x65E5;&#x5FD7;&#x9891;&#x7E41;&#x8BB0;&#x5F55;&#x64CD;&#x4F5C;&#xFF0C;&#x5F00;&#x9500;&#x975E;&#x5E38;&#x5927;&#xFF0C;&#x9700;&#x8981;&#x628A;binlog&#x65E5;&#x5FD7;&#x653E;&#x5230;&#x5176;&#x5B83;&#x786C;&#x76D8;&#x5206;&#x533A;&#x4E0A;&#xFF1A;  </p>
<p>#vim /etc/my.cnf<br>[mysqld]<br>datadir=/data/  #&#x653E;&#x5728;&#x72EC;&#x7ACB;&#x7684;&#x786C;&#x76D8;&#x4E0A;SSD<br>socket=/var/lib/mysql/mysql.sock<br>user=mysql<br># Disabling symbolic-links is recommended to prevent assorted security risks<br>symbolic-links=0  </p>
<p>#&#x5728;&#x539F;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x6DFB;&#x52A0;&#x4EE5;&#x4E0B;&#x5185;&#x5BB9;&#xFF1A;<br>log-bin=mysql-bin-master #&#x542F;&#x7528;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;<br>server-id=1 #&#x672C;&#x673A;&#x6570;&#x636E;&#x5E93;ID &#x6807;&#x793A;<br>binlog-do-db=db #&#x53EF;&#x4EE5;&#x88AB;&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x590D;&#x5236;&#x7684;&#x5E93;&#xFF0C;&#x4E8C;&#x8FDB;&#x5236;&#x9700;&#x8981;&#x540C;&#x6B65;&#x7684;&#x6570;&#x636E;&#x5E93;&#x540D;  </p>
<h3 id="4-&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x4F18;&#x5316;"><a href="#4-&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x4F18;&#x5316;" class="headerlink" title="4.&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x4F18;&#x5316;"></a>4.&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x7684;&#x4F18;&#x5316;</h3><p>&#x7F51;&#x5361; bonding &#x6280;&#x672F;<br>&#x8BBE;&#x7F6E;tcp &#x8FDE;&#x63A5;&#x6570;&#x91CF;&#x9650;&#x5236;&#xFF0C;&#x4F18;&#x5316;&#x7CFB;&#x7EDF;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x7684;&#x6700;&#x5927;&#x9650;&#x5236;&#x3002;<br>&#x4F7F;&#x7528;64&#x4F4D;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#xFF0C;64&#x4F4D;&#x7CFB;&#x7EDF;&#x53EF;&#x4EE5;&#x5206;&#x7ED9;&#x5355;&#x4E2A;&#x8FDB;&#x7A0B;&#x66F4;&#x591A;&#x7684;&#x5185;&#x5B58;&#xFF0C;&#x8BA1;&#x7B97;&#x66F4;&#x5FEB; &#x3002;<br>&#x7981;&#x7528;&#x4E0D;&#x5FC5;&#x8981;&#x542F;&#x52A8;&#x7684;&#x670D;&#x52A1;&#x3002;<br>&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x8C03;&#x4F18;&#xFF0C;&#x7ED9;&#x6570;&#x636E;&#x4ED3;&#x5E93;&#x4E00;&#x4E2A;&#x5355;&#x72EC;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x63A8;&#x8350;&#x4F7F;&#x7528;XFS&#xFF0C;&#x4E00;&#x822C;&#x6548;&#x7387;&#x66F4;&#x9AD8;&#x3001;&#x66F4;&#x53EF;&#x9760;&#x3002;<br>ext3 &#x4E0D;&#x9519;&#xFF0C;ext4 &#x53EA;&#x662F;&#x4E00;&#x4E2A;&#x8FC7;&#x6E21;&#x7684;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#x3002;<br>&#x53EF;&#x4EE5;&#x8003;&#x8651;&#x5728;&#x6302;&#x8F7D;&#x5206;&#x533A;&#x65F6;&#x542F;&#x7528; noatime &#x9009;&#x9879;&#x3002; #&#x4E0D;&#x8BB0;&#x5F55;&#x8BBF;&#x95EE;&#x65F6;&#x95F4;<br>&#x6700;&#x5C0F;&#x5316;&#x539F;&#x5219;:<br>                         1&#xFF09;   &#x5B89;&#x88C5;&#x7CFB;&#x7EDF;&#x6700;&#x5C0F;&#x5316;<br>                         2&#xFF09;   &#x5F00;&#x542F;&#x7A0B;&#x5E8F;&#x670D;&#x52A1;&#x6700;&#x5C0F;&#x5316;&#x539F;&#x5219;<br>                         3&#xFF09;   &#x64CD;&#x4F5C;&#x6700;&#x5C0F;&#x5316;&#x539F;&#x5219;<br>                         4&#xFF09;   &#x767B;&#x5F55;&#x6700;&#x5C0F;&#x5316;&#x539F;&#x5219;<br>                         5&#xFF09;   &#x6743;&#x9650;&#x6700;&#x5C0F;&#x5316;  </p>
<p>&#x4F8B;&#xFF1A;&#x5173;&#x6389;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;atime&#x9009;&#x9879;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# vim /etc/fstab #&#x5728;&#x6302;&#x8F7D;&#x9879;&#x4E2D;&#x6DFB;&#x52A0;noatime&#x9009;&#x9879;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002; </span><br><span class="line">UUID=46cb104c-e4dc-4f84-8afc-552f21279c65 /boot t4 defaults,noatime 1 2</span><br><span class="line">[root@jaking ~]# mount #&#x67E5;&#x770B;&#x6DFB;&#x52A0;&#x524D;mount&#x6302;&#x8F7D;&#x9009;&#x9879;</span><br><span class="line">/dev/sda1 on /boot type ext4 (rw) </span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> &#x4F7F;&#x8BBE;&#x7F6E;&#x7ACB;&#x5373;&#x751F;&#x6548;&#xFF0C;&#x53EF;&#x8FD0;&#x884C;&#xFF1A; </span></span><br><span class="line">[root@jaking ~]# mount -o remount /boot/ </span><br><span class="line">[root@jaking ~]# mount </span><br><span class="line">/dev/sda1 on /boot type ext4 (rw,noatime)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8FD9;&#x6837;&#x4EE5;&#x540E;&#x7CFB;&#x7EDF;&#x5728;&#x8BFB;&#x6B64;&#x5206;&#x533A;&#x4E0B;&#x7684;&#x6587;&#x4EF6;&#x65F6;&#xFF0C;&#x5C06;&#x4E0D;&#x4F1A;&#x518D;&#x4FEE;&#x6539;atime&#x5C5E;&#x6027;&#x3002;<br>&#x8BF4;&#x660E;&#xFF1A;&#x6D4B;&#x8BD5;&#x6548;&#x679C;&#xFF0C;&#x7ED3;&#x679C;&#x6CA1;&#x6709;&#x592A;&#x5927;&#x7684;&#x610F;&#x4E49;&#x3002;</p>
<h3 id="5-MySQL-&#x670D;&#x52A1;&#x4F18;&#x5316;&#xFF08;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x7684;&#x4F18;&#x5316;"><a href="#5-MySQL-&#x670D;&#x52A1;&#x4F18;&#x5316;&#xFF08;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x7684;&#x4F18;&#x5316;" class="headerlink" title="5. MySQL &#x670D;&#x52A1;&#x4F18;&#x5316;&#xFF08;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x7684;&#x4F18;&#x5316;)"></a>5. MySQL &#x670D;&#x52A1;&#x4F18;&#x5316;&#xFF08;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x7684;&#x4F18;&#x5316;)</h3><p>&#x4FDD;&#x6301;&#x6BCF;&#x4E2A;&#x8868;&#x90FD;&#x4E0D;&#x8981;&#x592A;&#x5927;&#xFF0C;&#x53EF;&#x4EE5;&#x5BF9;&#x5927;&#x8868;&#x505A;&#x6A2A;&#x5207;&#x548C;&#x7EB5;&#x5207;&#xFF1A;&#x6BD4;&#x5982;&#x8BF4;&#x6211;&#x8981;&#x53D6;&#x5F97;&#x67D0; ID &#x7684; lastlog&#xFF0C; &#x5B8C;&#x5168;&#x53EF;&#x4EE5;&#x505A;&#x4E00;&#x5F20;&#x53EA;&#x6709;&#x201C;ID&#x548C; &#x201C;lastlog&#x201D;&#x7684;&#x5C0F;&#x8868;&#xFF0C;&#x800C;&#x975E;&#x51E0;&#x5341;&#x3001;&#x51E0;&#x767E;&#x5217;&#x6570;&#x636E;&#x7684;&#x5E76;&#x6392;&#x5927;;&#x53E6;&#x5916;&#x5BF9;&#x4E00;&#x4E2A;&#x6709; 1000 &#x4E07;&#x6761;&#x8BB0;&#x5F55;&#x7684;&#x8868;&#x505A;&#x66F4;&#x65B0;&#x6BD4;&#x5BF9; 10 &#x4E2A; 100 &#x4E07;&#x8BB0;&#x5F55;&#x7684;&#x8868;&#x505A;&#x66F4;&#x65B0;&#x4E00;&#x822C;&#x6765;&#x5F97;&#x8981;&#x6162;&#x3002;  </p>
<p><strong>&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#xFF1A;</strong> </p>
<p>MyISAM &#x5F15;&#x64CE;&#xFF0C;&#x8868;&#x7EA7;&#x9501;&#xFF0C;&#x8868;&#x7EA7;&#x9501;&#x5F00;&#x9500;&#x5C0F;&#xFF0C;&#x5F71;&#x54CD;&#x8303;&#x56F4;&#x5927;&#xFF0C;&#x9002;&#x5408;&#x8BFB;&#x591A;&#x5199;&#x5C11;&#x7684;&#x8868;&#xFF0C;&#x4E0D;&#x652F;&#x6301;&#x4E8B;&#x52A1;&#xFF0C;&#x8868;&#x9501;&#x5B9A;&#x4E0D;&#x5B58;&#x5728;&#x6B7B;&#x9501; &#xFF08;&#x4E5F;&#x6709;&#x4F8B;&#x5916;&#xFF09;  </p>
<p>Innodb &#x5F15;&#x64CE;&#xFF0C;&#x884C;&#x7EA7;&#x9501;&#xFF0C;&#x9501;&#x5B9A;&#x884C;&#x7684;&#x5F00;&#x9500;&#x8981;&#x6BD4;&#x9501;&#x5B9A;&#x5168;&#x8868;&#x8981;&#x5927;&#x3002;&#x5F71;&#x54CD;&#x8303;&#x56F4;&#x5C0F;&#xFF0C;&#x9002;&#x5408;&#x5199;&#x64CD;&#x4F5C;&#x6BD4;&#x8F83;&#x9891;&#x7E41;&#x7684;&#x6570;&#x636E;&#x8868;&#x3002;&#x884C;&#x7EA7;&#x9501;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x6B7B;&#x9501;  </p>
<p>MySQL&#x7684;&#x9501;&#x673A;&#x5236;&#x6BD4;&#x8F83;&#x7B80;&#x5355;&#xFF0C;&#x5176;&#x6700;&#x663E;&#x8457;&#x7684;&#x7279;&#x70B9;&#x662F;&#x4E0D;&#x540C;&#x7684;&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x652F;&#x6301;&#x4E0D;&#x540C;&#x7684;&#x9501;&#x673A;&#x5236;  </p>
<p>&#x6240;&#x8C13;&#x6B7B;&#x9501;&#xFF1A;&#x662F;&#x6307;&#x4E24;&#x4E2A;&#x6216;&#x4E24;&#x4E2A;&#x4EE5;&#x4E0A;&#x7684;&#x8FDB;&#x7A0B;&#x5728;&#x6267;&#x884C;&#x8FC7;&#x7A0B;&#x4E2D;,&#x56E0;&#x4E89;&#x593A;&#x8D44;&#x6E90;&#x800C;&#x9020;&#x6210;&#x7684;&#x4E00;&#x79CD;&#x4E92;&#x76F8;&#x7B49;&#x5F85;&#x7684;&#x73B0;&#x8C61;,&#x82E5;&#x65E0;&#x5916;&#x529B;&#x4F5C;&#x7528;&#xFF0C;&#x5B83;&#x4EEC;&#x90FD;&#x5C06;&#x65E0;&#x6CD5;&#x63A8;&#x8FDB;&#x4E0B;&#x53BB;&#xFF0C;&#x6B64;&#x65F6;&#x79F0;&#x7CFB;&#x7EDF;&#x5904;&#x4E8E;&#x6B7B;&#x9501;&#x72B6;&#x6001;&#x6216;&#x7CFB;&#x7EDF;&#x4EA7;&#x751F;&#x4E86;&#x6B7B;&#x9501;&#xFF0C;&#x8FD9;&#x4E9B;&#x6C38;&#x8FDC;&#x5728;&#x4E92;&#x76F8;&#x7B49;&#x5F85;&#x7684;&#x8FDB;&#x7A0B;&#x79F0;&#x4E3A;&#x6B7B;&#x9501;&#x8FDB;&#x7A0B;&#x3002;&#x8868;&#x7EA7;&#x9501;&#x4E0D;&#x4F1A;&#x4EA7;&#x751F;&#x6B7B;&#x9501;&#xFF0C;&#x6240;&#x4EE5;&#x89E3;&#x51B3;&#x6B7B;&#x9501;&#x4E3B;&#x8981;&#x8FD8;&#x662F;&#x9488;&#x5BF9;&#x4E8E;&#x6700;&#x5E38;&#x7528;&#x7684;InnoDB  </p>
<p>&#x4E4B;&#x6240;&#x4EE5;&#x51FA;&#x73B0;&#x6B7B;&#x9501;&#xFF0C;&#x662F;&#x56E0;&#x4E3A;&#x591A;&#x7EBF;&#x7A0B;&#x5BF9;&#x8D44;&#x6E90;&#x7684;&#x5F3A;&#x5360;&#xFF0C;&#x4F60;&#x8981;&#x6211;&#x7684;&#xFF0C;&#x6211;&#x4E5F;&#x8981;&#x4F60;&#x7684;&#xFF0C;&#x4E24;&#x4EBA;&#x5835;&#x5728;&#x8DEF;&#x4E0A;&#x8C01;&#x90FD;&#x4E0D;&#x8BA9;&#xFF0C;&#x6240;&#x4EE5;&#x6B7B;&#x9501;&#x4E86;  </p>
<p>#&#x5F00;&#x542F;&#x9519;&#x8BEF;&#x65E5;&#x5FD7;&#x540E;&#x4F1A;&#x5C06;&#x6240;&#x6709;&#x7684;&#x6B7B;&#x9501;&#x8BB0;&#x5F55;&#x5230;mysqld.log&#x4E2D; &#x9519;&#x8BEF;&#x65E5;&#x5FD7;&#x5728;my.cnf&#x914D;&#x7F6E;&#x4E3A; </p>
<pre><code>log-error=/data/mysql/mysqld.log
innodb_print_all_deadlocks = 1
innodb_sort_buffer_size = 16M
</code></pre><p>&#x67E5;&#x770B;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;&#x7684;&#x72B6;&#x6001;&#xFF0C;&#x767B;&#x5F55;mysql<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show status; #&#x770B;&#x7CFB;&#x7EDF;&#x7684;&#x72B6;&#x6001;</span><br><span class="line">mysql&gt; show engine innodb status \G #&#x663E;&#x793A; InnoDB &#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x7684;&#x72B6;&#x6001;</span><br><span class="line">mysql&gt; show variables; #&#x770B;&#x53D8;&#x91CF;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x67E5;&#x770B;&#x8B66;&#x544A;&#x4FE1;&#x606F;&#xFF1A;<br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show warnings; #&#x67E5;&#x770B;&#x6700;&#x8FD1;&#x4E00;&#x4E2A; sql &#x8BED;&#x53E5;&#x4EA7;&#x751F;&#x7684;&#x9519;&#x8BEF;&#x8B66;&#x544A;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x4F8B;&#xFF1A;&#x67E5;&#x770B;&#x8B66;&#x544A;&#x4FE1;&#x606F;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; adadfs; -- &#x968F;&#x4FBF;&#x8F93;&#x5165;&#x4E00;&#x4E9B;&#x5185;&#x5BB9;&#xFF0C;&#x56DE;&#x8F66;&#xFF0C;&#x5C06;&#x770B;&#x5230;&#x4EE5;&#x4E0B;&#x4E00;&#x4E9B;&#x9519;&#x8BEF;&#x4FE1;&#x606F; </span><br><span class="line">ERROR 1064 (42000): You have an error in your SQL syntax; <span class="keyword">check</span> the <span class="keyword">manual</span> that corresponds <span class="keyword">to</span> your MySQL <span class="keyword">server</span> <span class="keyword">version</span> <span class="keyword">for</span> the <span class="keyword">right</span> syntax <span class="keyword">to</span> <span class="keyword">use</span> near <span class="string">&apos;adadfs&apos;</span> <span class="keyword">at</span> line <span class="number">1</span> </span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">warnings</span>; </span><br><span class="line">mysql&gt; show processlist ; -- &#x663E;&#x793A;mysql&#x7CFB;&#x7EDF;&#x4E2D;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x6240;&#x6709;&#x7EBF;&#x7A0B;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6BCF;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x6B63;&#x5728;&#x6267;&#x884C;&#x7684;&#x547D;&#x4EE4; </span><br><span class="line"><span class="comment">-- &#x672C;&#x8BED;&#x53E5;TCP/IP&#x8FDE;&#x63A5;&#x7684;&#x4E3B;&#x673A;&#x540D;&#x79F0;&#xFF08;&#x91C7;&#x7528;host_name:client_port&#x683C;&#x5F0F;&#xFF09;&#xFF0C;&#x4EE5;&#x65B9;&#x4FBF;&#x5730;&#x5224;&#x5B9A;&#x54EA;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x6B63;&#x5728;&#x505A;&#x4EC0;&#x4E48;</span></span><br><span class="line">mysql&gt; show processlist ;</span><br><span class="line">+<span class="comment">----+------+-----------+------+---------+------+----------+------------------+</span></span><br><span class="line">| Id | User | Host&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | db&#xA0;&#xA0; | Command | Time | State&#xA0;&#xA0;&#xA0; | Info&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">----+------+-----------+------+---------+------+----------+------------------+</span></span><br><span class="line">|&#xA0; 4 | root | localhost | NULL | Query&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0; 0 | starting | <span class="keyword">show</span> <span class="keyword">processlist</span> |</span><br><span class="line">+<span class="comment">----+------+-----------+------+---------+------+----------+------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x542F;&#x7528; MySQL &#x6162;&#x67E5;&#x8BE2;&#xFF1A;&#x2014;&#x5206;&#x6790; sql &#x8BED;&#x53E5;&#xFF0C;&#x627E;&#x5230;&#x5F71;&#x54CD;&#x6548;&#x7387;&#x7684; SQL<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# vim /etc/my.cnf </span><br><span class="line">[mysqld] </span><br><span class="line">slow_query_log=1&#xA0; #&#x5F00;&#x542F;&#x6162;&#x67E5;&#x8BE2;&#x65E5;&#x5FD7;</span><br><span class="line">slow-query-log-file=/data/mysql/slow.log &#xA0;#mysql &#x7528;&#x6237;&#x5BF9;&#x8FD9;&#x4E2A;&#x76EE;&#x5F55;&#x5177;&#x6709;&#x53EF;&#x5199;&#x6743;&#x9650; </span><br><span class="line">long_query_time=5 &#xA0;#&#x67E5;&#x8BE2;&#x8D85;&#x8FC7; 5 &#x79D2;&#x949F;&#x7684;&#x8BED;&#x53E5;&#x8BB0;&#x5F55;&#x4E0B;&#x6765;</span><br><span class="line">log-queries-not-using-indexes=1&#xA0; #&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x7D22;&#x5F15;&#x7684;&#x67E5;&#x8BE2;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8FD9;&#x4E09;&#x4E2A;&#x8BBE;&#x7F6E;&#x4E00;&#x8D77;&#x4F7F;&#x7528;&#xFF0C;&#x53EF;&#x4EE5;&#x8BB0;&#x5F55;&#x6267;&#x884C;&#x65F6;&#x95F4;&#x8D85;&#x8FC7;5 &#x79D2;&#x548C;&#x6CA1;&#x6709;&#x4F7F;&#x7528;&#x7D22;&#x5F15;&#x7684;&#x67E5;&#x8BE2;&#xFF1B;&#x8BF7;&#x6CE8;&#x610F;&#x6709;&#x5173;log-queries-not-using-indexes&#x7684;&#x8B66;&#x544A;&#xFF1B;&#x6162;&#x901F;&#x67E5;&#x8BE2;&#x65E5;&#x5FD7;&#x90FD;&#x4FDD;&#x5B58;&#x5728;/data/mysql/slow.log<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# systemctl restart mysqld</span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.&#xA0; Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.7.19-log Source distribution</span><br><span class="line"> </span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"> </span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"> </span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; drop database testdb;</span><br><span class="line">Query OK, 12 rows affected (0.01 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; create database testdb;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; use testdb;</span><br><span class="line">Database changed</span><br><span class="line">mysql&gt; create table test (id int,name varchar(20));</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; insert into test values (1,&apos;man&apos;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line">mysql&gt; select * from test;</span><br><span class="line">+<span class="comment">------+------+</span></span><br><span class="line">| id&#xA0;&#xA0; | name |</span><br><span class="line">+<span class="comment">------+------+</span></span><br><span class="line">|&#xA0;&#xA0;&#xA0; 1 | man&#xA0; |</span><br><span class="line">+<span class="comment">------+------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x67E5;&#x770B;slow.log</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# tail -f /data/mysql/slow.log </span><br><span class="line">/usr/local/mysql57/bin/mysqld, Version: 5.7.19-log (Source distribution). started with:</span><br><span class="line">Tcp port: 3306&#xA0; Unix socket: /data/mysql/mysql.sock</span><br><span class="line">Time&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Id Command&#xA0;&#xA0;&#xA0; Argument</span><br><span class="line"><span class="meta">#</span><span class="bash"> Time: 2021-05-15T11:36:01.644259Z</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> User@Host: root[root] @ localhost []&#xA0; Id:&#xA0;&#xA0;&#xA0;&#xA0; 3</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> Query_time: 0.000150&#xA0; Lock_time: 0.000062 Rows_sent: 1&#xA0; Rows_examined: 1</span></span><br><span class="line">use testdb;</span><br><span class="line">SET timestamp=1621078561;</span><br><span class="line">select * from test;</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="6-my-cnf-&#x5185;&#x53C2;&#x6570;&#x7684;&#x4F18;&#x5316;"><a href="#6-my-cnf-&#x5185;&#x53C2;&#x6570;&#x7684;&#x4F18;&#x5316;" class="headerlink" title="6. my.cnf &#x5185;&#x53C2;&#x6570;&#x7684;&#x4F18;&#x5316;"></a>6. my.cnf &#x5185;&#x53C2;&#x6570;&#x7684;&#x4F18;&#x5316;</h3><p><strong>&#x4F18;&#x5316;&#x603B;&#x539F;&#x5219;&#xFF1A;</strong><br>&#x7ED9; mysql &#x7684;&#x8D44;&#x6E90;&#x592A;&#x5C11;&#xFF0C;&#x5219; mysql &#x65BD;&#x5C55;&#x4E0D;&#x5F00;&#xFF1A;&#x7ED9; mysql &#x7684;&#x8D44;&#x6E90;&#x592A;&#x591A;&#xFF0C;&#x53EF;&#x80FD;&#x4F1A;&#x62D6;&#x7D2F;&#x6574;&#x4E2A; OS 40%&#x8D44;&#x6E90;&#x7ED9;OS&#xFF0C; 60%-70% &#x7ED9;mysql &#xFF08;&#x5185;&#x5B58;&#x548C;CPU&#xFF09;  </p>
<p><strong>&#x5BF9;&#x67E5;&#x8BE2;&#x8FDB;&#x884C;&#x7F13;&#x5B58;</strong><br>&#x5927;&#x591A;&#x6570;LAMP&#x5E94;&#x7528;&#x90FD;&#x4E25;&#x91CD;&#x4F9D;&#x8D56;&#x4E8E;&#x6570;&#x636E;&#x5E93;&#x67E5;&#x8BE2;&#xFF0C;&#x67E5;&#x8BE2;&#x7684;&#x5927;&#x81F4;&#x8FC7;&#x7A0B;&#x5982;&#x4E0B;:<br>PHP&#x53D1;&#x51FA;&#x67E5;&#x8BE2;&#x8BF7;&#x6C42;-&gt;&#x6570;&#x636E;&#x5E93;&#x6536;&#x5230;&#x6307;&#x4EE4;&#x5BF9;&#x67E5;&#x8BE2;&#x8BED;&#x53E5;&#x8FDB;&#x884C;&#x5206;&#x6790;-&gt;&#x786E;&#x5B9A;&#x5982;&#x4F55;&#x67E5;&#x8BE2;-&gt;&#x4ECE;&#x78C1;&#x76D8;&#x4E2D;&#x52A0;&#x8F7D;&#x4FE1;&#x606F;-&gt;&#x8FD4;&#x56DE;&#x7ED3;&#x679C;<br>&#x5982;&#x679C;&#x53CD;&#x590D;&#x67E5;&#x8BE2;&#xFF0C;&#x5C31;&#x53CD;&#x590D;&#x6267;&#x884C;&#x8FD9;&#x4E9B;&#x6307;&#x4EE4;&#xFF1B;MySQL &#x6709;&#x4E00;&#x4E2A;&#x7279;&#x6027;&#x79F0;&#x4E3A;&#x67E5;&#x8BE2;&#x7F13;&#x5B58;&#xFF0C;&#x53EF;&#x4EE5;&#x5C06;&#x67E5;&#x8BE2;&#x7684;&#x7ED3;&#x679C;&#x4FDD;&#x5B58;&#x5728;&#x5185;&#x5B58;&#x4E2D;&#xFF0C;&#x5728;&#x5F88;&#x591A;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x8FD9;&#x4F1A;&#x6781;&#x5927;&#x5730;&#x63D0;&#x9AD8;&#x6027;&#x80FD;&#xFF1B;&#x4E0D;&#x8FC7;&#xFF0C;&#x95EE;&#x9898;&#x662F;&#x67E5;&#x8BE2;&#x7F13;&#x5B58;&#x5728;&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#x662F;&#x7981;&#x7528;&#x7684;&#x3002;  </p>
<p><strong>&#x542F;&#x52A8;&#x67E5;&#x8BE2;&#x7F13;&#x5B58;&#xFF1A;</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/my.cnf &#x6DFB;&#x52A0;&#xFF1A; </span><br><span class="line">[mysqld] #&#x5728;&#x6B64;&#x5B57;&#x6BB5;&#x4E2D;&#x6DFB;&#x52A0; </span><br><span class="line">query_cache_size = 32M</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x67E5;&#x770B;&#xFF1A;&#x67E5;&#x8BE2;&#x7F13;&#x5B58;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# systemctl restart mysqld</span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.&#xA0; Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.7.19-log Source distribution</span><br><span class="line"> </span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"> </span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"> </span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show status like &apos;qcache%&apos;;</span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Value&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">| Qcache_free_blocks&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_free_memory&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 33537320 |</span><br><span class="line">| Qcache_hits&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 0&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_inserts&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 0&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_lowmem_prunes&#xA0;&#xA0;&#xA0; | 0&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_not_cached&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_queries_in_cache | 0&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_total_blocks&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x89E3;&#x91CA;&#x5982;&#x4E0B;&#xFF1A; </p>
<table>
<thead>
<tr>
<th>&#x53D8;&#x91CF;&#x540D;</th>
<th>&#x8BF4;&#x660E;</th>
<th>&#x5907;&#x6CE8;</th>
</tr>
</thead>
<tbody>
<tr>
<td>Qcache_free_blocks</td>
<td>&#x7F13;&#x5B58;&#x4E2D;&#x76F8;&#x90BB;&#x5185;&#x5B58;&#x5757;&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x6570;&#x76EE;&#x5927;&#x8BF4;&#x660E;&#x53EF;&#x80FD;&#x6709;&#x788E;&#x7247;</td>
<td>&#x5982;&#x679C;&#x6570;&#x76EE;&#x6BD4;&#x8F83;&#x5927;&#xFF0C;&#x53EF;&#x4EE5;&#x6267;&#x884C;<code>flush query cache;</code>&#x5BF9;&#x7F13;&#x5B58;&#x4E2D;&#x7684;&#x788E;&#x7247;&#x8FDB;&#x884C;&#x6574;&#x7406;&#xFF0C;&#x4ECE;&#x800C;&#x5F97;&#x5230;&#x4E00;&#x4E2A;&#x7A7A;&#x95F2;&#x5757;</td>
</tr>
<tr>
<td>Qcache_free_memory</td>
<td>&#x7F13;&#x5B58;&#x4E2D;&#x7684;&#x7A7A;&#x95F2;&#x5185;&#x5B58;&#x5927;&#x5C0F;</td>
</tr>
<tr>
<td>Qcache_hits</td>
<td>&#x6BCF;&#x6B21;&#x67E5;&#x8BE2;&#x5728;&#x7F13;&#x5B58;&#x4E2D;&#x547D;&#x4E2D;&#x65F6;&#x5C31;&#x589E;&#x5927;</td>
</tr>
<tr>
<td>Qcache_inserts</td>
<td>&#x6BCF;&#x6B21;&#x63D2;&#x5165;&#x4E00;&#x4E2A;&#x67E5;&#x8BE2;&#x65F6;&#x5C31;&#x589E;&#x5927;&#xFF0C;&#x5373;&#x6CA1;&#x6709;&#x4ECE;&#x7F13;&#x5B58;&#x4E2D;&#x627E;&#x5230;&#x6570;&#x636E;</td>
</tr>
<tr>
<td>Qcache_lowmem_prunes</td>
<td>&#x56E0;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#x5220;&#x9664;&#x7F13;&#x5B58;&#x6B21;&#x6570;&#xFF0C;&#x7F13;&#x5B58;&#x51FA;&#x73B0;&#x5185;&#x5B58;&#x4E0D;&#x8DB3;&#x5E76;&#x4E14;&#x5FC5;&#x987B;&#x8981;&#x8FDB;&#x884C;&#x6E05;&#x7406;,&#x4EE5;&#x4FBF;&#x4E3A;&#x66F4;&#x591A;&#x67E5;&#x8BE2;&#x63D0;&#x4F9B;&#x7A7A;&#x95F4;&#x7684;&#x6B21;&#x6570;&#x3002;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x6700;&#x597D;&#x957F;&#x65F6;&#x95F4;&#x6765;&#x770B;&#xFF0C;&#x5982;&#x679C;&#x8FD9;&#x4E2A;&#x6570;&#x5B57;&#x5728;&#x4E0D;&#x65AD;&#x589E;&#x957F;&#xFF0C;&#x5C31;&#x8868;&#x793A;&#x53EF;&#x80FD;&#x788E;&#x7247;&#x975E;&#x5E38;&#x4E25;&#x91CD;&#xFF0C;&#x6216;&#x8005;&#x7F13;&#x5B58;&#x5185;&#x5B58;&#x5F88;&#x5C11;  &#x5982;&#x679C;Qcache_free_blocks&#x6BD4;&#x8F83;&#x5927;&#xFF0C;&#x8BF4;&#x660E;&#x788E;&#x7247;&#x4E25;&#x91CD;&#xFF1B;&#x5982;&#x679C; free_memory &#x5F88;&#x5C0F;&#xFF0C;&#x8BF4;&#x660E;&#x7F13;&#x5B58;&#x4E0D;&#x591F;&#x7528;&#x4E86;</td>
</tr>
<tr>
<td>Qcache_not_cached</td>
<td>&#x6CA1;&#x6709;&#x8FDB;&#x884C;&#x7F13;&#x5B58;&#x7684;&#x67E5;&#x8BE2;&#x7684;&#x6570;&#x91CF;&#xFF0C;&#x901A;&#x5E38;&#x662F;&#x8FD9;&#x4E9B;&#x67E5;&#x8BE2;&#x672A;&#x88AB;&#x7F13;&#x5B58;&#x6216;&#x5176;&#x7C7B;&#x578B;&#x4E0D;&#x5141;&#x8BB8;&#x88AB;&#x7F13;&#x5B58;</td>
</tr>
<tr>
<td>Qcache_queries_in_cache</td>
<td>&#x5728;&#x5F53;&#x524D;&#x7F13;&#x5B58;&#x7684;&#x67E5;&#x8BE2;&#xFF08;&#x548C;&#x54CD;&#x5E94;&#xFF09;&#x7684;&#x6570;&#x91CF;</td>
</tr>
<tr>
<td>Qcache_total_blocks</td>
<td>&#x7F13;&#x5B58;&#x4E2D;&#x5757;&#x7684;&#x6570;&#x91CF;</td>
</tr>
</tbody>
</table>
<p>&#x4F8B;&#xFF1A;&#x4F7F;&#x7528;mysql&#x67E5;&#x8BE2;&#x7F13;&#x5B58;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# cat /etc/my.cnf </span><br><span class="line">[mysqld]</span><br><span class="line">datadir=/data/mysql</span><br><span class="line">socket=/data/mysql/mysql.sock</span><br><span class="line">user=mysql</span><br><span class="line"><span class="meta">#</span><span class="bash"> Disabling symbolic-links is recommended to prevent assorted security risks</span></span><br><span class="line">symbolic-links=0</span><br><span class="line">query_cache_size=32M #&#x81F3;&#x5C11;4M&#x4EE5;&#x5B58;&#x50A8;&#x6570;&#x636E;&#x7ED3;&#x6784;&#xFF0C;&#x53EF;&#x6269;&#x5C55;&#xFF1B;&#x6574;&#x4F53;100G&#xFF0C;&#x82E5;&#x6B64;&#x670D;&#x52A1;&#x5668;&#x53EA;&#x8FD0;&#x884C;mysql&#x670D;&#x52A1;&#x5668;&#xFF0C;70-80G&#x7ED9;mysql</span><br><span class="line">[root@jaking ~]# systemctl restart mysqld</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql&gt; create database aa;</span><br><span class="line">mysql&gt; use aa;</span><br><span class="line">mysql&gt; create table test (id int, name varchar(255)) ;</span><br><span class="line">mysql&gt; insert into test values (1,&apos;aaaa&apos;), (2,&apos;aaaa&apos;);</span><br><span class="line">mysql&gt; select * from test;</span><br><span class="line">mysql&gt; show status like &quot;qcache%&quot;;</span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Value&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">| Qcache_free_blocks&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_free_memory&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 33535112 |</span><br><span class="line">| Qcache_hits&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 0&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0; <span class="comment">-- &#x6CA1;&#x6709;&#x547D;&#x4E2D;</span></span><br><span class="line">| Qcache_inserts&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;|&#xA0; <span class="comment">-- &#x7B2C;&#x4E00;&#x6B21;&#x63D2;&#x5165;&#x4E00;&#x6761;&#x8BED;&#x53E5;</span></span><br><span class="line">| Qcache_lowmem_prunes &#xA0;  | 0&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_not_cached&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 3&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_queries_in_cache | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_total_blocks&#xA0;&#xA0;&#xA0;&#xA0; | 4&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line"></span><br><span class="line"><span class="comment">-- &#x518D;&#x67E5;&#x8BE2;&#xFF1A;</span></span><br><span class="line">mysql&gt; select * from test;</span><br><span class="line">mysql&gt; show status like &quot;qcache%&quot;;</span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Value&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">| Qcache_free_blocks&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_free_memory&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 33535112 |</span><br><span class="line">| Qcache_hits&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1        | <span class="comment">-- &#x7B2C;&#x4E8C;&#x6B21;&#x67E5;&#x8BE2;&#x65F6;&#xFF0C;&#x5C31;&#x547D;&#x4E2D;&#x4E86;</span></span><br><span class="line">| Qcache_inserts&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line"> </span><br><span class="line">Qcache_hits/&#xFF08;Qcache_inserts+ Qcache_hits&#xFF09; &#x547D;&#x4E2D;&#x7387;</span><br><span class="line"> </span><br><span class="line"><span class="comment">-- &#x7ECF;&#x8FC7;&#x591A;&#x6B21;select&#xFF0C;&#x547D;&#x4E2D;&#x7684;&#x6B21;&#x6570;&#x4E5F;&#x4F1A;&#x589E;&#x52A0;&#xFF1A;</span></span><br><span class="line">mysql&gt; show status like &apos;qcache%&apos;;&#xA0; </span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Value&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">-------------------------+----------+</span></span><br><span class="line">| Qcache_free_blocks&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Qcache_free_memory&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 33535344 |</span><br><span class="line">| Qcache_hits&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 3&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | <span class="comment">-- &#x7B2C;&#x56DB;&#x6B21;&#x67E5;&#x8BE2;&#x65F6;&#xFF0C;&#x5C31;&#x547D;&#x4E2D;3&#x6B21;</span></span><br><span class="line">| Qcache_inserts&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5F3A;&#x5236;&#x9650;&#x5236;MySQL &#x8D44;&#x6E90;&#x8BBE;&#x7F6E;<br>&#x53EF;&#x4EE5;&#x5728;mysqld&#x4E2D;&#x5F3A;&#x5236;&#x4E00;&#x4E9B;&#x9650;&#x5236;&#x6765;&#x786E;&#x4FDD;&#x7CFB;&#x7EDF;&#x8D1F;&#x8F7D;&#x4E0D;&#x4F1A;&#x5BFC;&#x81F4;&#x8D44;&#x6E90;&#x8017;&#x5C3D;&#x7684;&#x60C5;&#x51B5;&#x51FA;&#x73B0;&#x3002;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# vim /etc/my.cnf </span><br><span class="line">[mysqld]</span><br><span class="line">datadir=/data/mysql</span><br><span class="line">socket=/data/mysql/mysql.sock</span><br><span class="line">user=mysql</span><br><span class="line"><span class="meta">#</span><span class="bash"> Disabling symbolic-links is recommended to prevent assorted security risks</span></span><br><span class="line">symbolic-links=0</span><br><span class="line">query_cache_size = 32M </span><br><span class="line">max_connections=500&#xA0; #&#x4E0A;&#x9650;&#x662F;&#x770B;&#x786C;&#x4EF6;&#x914D;&#x7F6E;</span><br><span class="line">wait_timeout=10 </span><br><span class="line">max_connect_errors=100</span><br><span class="line">[root@jaking ~]# systemctl restart mysqld</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x53C2;&#x6570;&#xFF1A;</strong><br>&#x7B2C;&#x4E00;&#x884C;&#xFF1A;&#x6700;&#x5927;&#x8FDE;&#x63A5;&#x6570;&#xFF0C;&#x5728;&#x670D;&#x52A1;&#x5668;&#x6CA1;&#x6709;&#x5D29;&#x6E83;&#x4E4B;&#x524D;&#x786E;&#x4FDD;&#x53EA;&#x5EFA;&#x7ACB;&#x670D;&#x52A1;&#x5141;&#x8BB8;&#x6570;&#x76EE;&#x7684;&#x8FDE;&#x63A5;<br>&#x8BE5;&#x53C2;&#x6570;&#x8BBE;&#x7F6E;&#x8FC7;&#x5C0F;&#x7684;&#x6700;&#x660E;&#x663E;&#x7279;&#x5F81;&#x662F;&#x51FA;&#x73B0;&#x201C;Too many connections&#x201D;&#x9519;&#x8BEF;  </p>
<p>&#x7B2C;&#x4E8C;&#x884C;&#xFF1A;mysqld&#x5C06;&#x7EC8;&#x6B62;&#x7B49;&#x5F85;&#x65F6;&#x95F4;&#xFF08;&#x7A7A;&#x95F2;&#x65F6;&#x95F4;&#xFF09;&#x8D85;&#x8FC7;10&#x79D2;&#x7684;&#x8FDE;&#x63A5;&#xFF1B;&#x5728;LAMP&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x4E2D;&#xFF0C;&#x8FDE;&#x63A5;&#x6570;&#x636E;&#x5E93;&#x7684;&#x65F6;&#x95F4;&#x901A;&#x5E38;&#x5C31;&#x662F;Web &#x670D;&#x52A1;&#x5668;&#x5904;&#x7406;&#x8BF7;&#x6C42;&#x6240;&#x82B1;&#x8D39;&#x7684;&#x65F6;&#x95F4;&#xFF1B;&#x6709;&#x65F6;&#x5019;&#x5982;&#x679C;&#x8D1F;&#x8F7D;&#x8FC7;&#x91CD;&#xFF0C;&#x8FDE;&#x63A5;&#x4F1A;&#x6302;&#x8D77;&#xFF0C;&#x5E76;&#x4E14;&#x4F1A;&#x5360;&#x7528;&#x8FDE;&#x63A5;&#x8868;&#x7A7A;&#x95F4;&#xFF1B;&#x5982;&#x679C;&#x6709;&#x591A;&#x4E2A;&#x4EA4;&#x4E92;&#x7528;&#x6237;&#x4F7F;&#x7528;&#x4E86;&#x5230;&#x6570;&#x636E;&#x5E93;&#x7684;&#x6301;&#x4E45;&#x8FDE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48;&#x5E94;&#x8BE5;&#x5C06;&#x8FD9;&#x4E2A;&#x503C;&#x8BBE;&#x4F4E;&#x4E00;&#x70B9;&#x3002;  </p>
<p>&#x7B2C;&#x4E09;&#x884C;&#xFF1A;&#x5982;&#x679C;&#x4E00;&#x4E2A;&#x4E3B;&#x673A;&#x5728;&#x8FDE;&#x63A5;&#x5230;&#x670D;&#x52A1;&#x5668;&#x65F6;&#x6709;&#x95EE;&#x9898;&#xFF0C;&#x5E76;&#x91CD;&#x8BD5;&#x5F88;&#x591A;&#x6B21;&#x540E;&#x653E;&#x5F03;&#xFF0C;&#x90A3;&#x4E48;&#x8FD9;&#x4E2A;&#x4E3B;&#x673A;&#x5C31;&#x4F1A;&#x88AB;&#x9501;&#x5B9A;&#xFF0C;&#x76F4;&#x5230;&#x6267;&#x884C;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; FLUSH HOSTS;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x4E4B;&#x540E;&#x624D;&#x80FD;&#x8FD0;&#x884C;&#x3002;  </p>
<p>&#x9ED8;&#x8BA4;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;10 &#x6B21;&#x5931;&#x8D25;&#x5C31;&#x8DB3;&#x4EE5;&#x5BFC;&#x81F4;&#x9501;&#x5B9A;&#x4E86;&#xFF1B;&#x5C06;&#x8FD9;&#x4E2A;&#x503C;&#x4FEE;&#x6539;&#x4E3A;100 &#x4F1A;&#x7ED9;&#x670D;&#x52A1;&#x5668;&#x8DB3;&#x591F;&#x7684;&#x65F6;&#x95F4;&#x6765;&#x4ECE;&#x95EE;&#x9898;&#x4E2D;&#x6062;&#x590D;&#xFF1B;&#x5982;&#x679C;&#x91CD;&#x8BD5;100 &#x6B21;&#x90FD;&#x65E0;&#x6CD5;&#x5EFA;&#x7ACB;&#x8FDE;&#x63A5;&#xFF0C;&#x90A3;&#x4E48;&#x4F7F;&#x7528;&#x518D;&#x9AD8;&#x7684;&#x503C;&#x4E5F;&#x4E0D;&#x4F1A;&#x6709;&#x592A;&#x591A;&#x5E2E;&#x52A9;&#xFF0C;&#x53EF;&#x80FD;&#x5B83;&#x6839;&#x672C;&#x5C31;&#x65E0;&#x6CD5;&#x8FDE;&#x63A5;&#x3002;  </p>
<p>&#x9A8C;&#x8BC1;&#xFF1A;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql&gt; show status like &apos;max_used_connections&apos;;</span><br><span class="line">+<span class="comment">----------------------+-------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Value |</span><br><span class="line">+<span class="comment">----------------------+-------+</span></span><br><span class="line">| Max_used_connections | 1&#xA0; |<span class="comment">#&#x5F53;&#x524D;&#x6709;&#x4E00;&#x4E2A;mysql&#x8FDE;&#x63A5;</span></span><br><span class="line">+<span class="comment">----------------------+-------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">&#x518D;&#x53E6;&#x4E00;&#x4E2A;&#x5BA2;&#x6237;&#x7AEF;&#x6253;&#x5F00;&#x4E00;&#x4E2A;mysql&#x8FDE;&#x63A5;&#xFF0C;&#x6267;&#x884C;&#x4E00;&#x4E0B;&#x67E5;&#x8BE2;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x6709;&#x4E24;&#x4E2A;</span><br><span class="line">[root@jaking ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">&apos;max_used_connections&apos;</span>;</span><br><span class="line">+<span class="comment">----------------------+-------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Value |</span><br><span class="line">+<span class="comment">----------------------+-------+</span></span><br><span class="line">| Max_used_connections | 2&#xA0; |</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x603B;&#x7ED3;&#xFF1A;</strong><br>mysql&#x6709;&#x8D85;&#x8FC7;100&#x4E2A;&#x53EF;&#x4EE5;&#x8C03;&#x8282;&#x7684;&#x8BBE;&#x7F6E;&#xFF0C;&#x8981;&#x8BB0;&#x4F4F;&#x90A3;&#x4E48;&#x591A;&#x57FA;&#x672C;&#x662F;&#x4E0D;&#x53EF;&#x80FD;&#x7684;&#xFF0C;&#x4F46;&#x662F;&#x5E78;&#x8FD0;&#x7684;&#x662F;&#x4F60;&#x53EA;&#x9700;&#x8981;&#x8BB0;&#x4F4F;&#x5F88;&#x5C11;&#x4E00;&#x90E8;&#x5206;&#x4F60;&#x5C31;&#x53EF;&#x4EE5;&#x57FA;&#x672C;&#x6EE1;&#x8DB3;&#x4F60;&#x7684;&#x9700;&#x6C42;&#x4E86;&#xFF0C;&#x6211;&#x4EEC;&#x8FD8;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x201C;SHOW STATUS&#x201D;&#x547D;&#x4EE4;&#x6765;&#x67E5;&#x770B;mysql&#x662F;&#x5426;&#x6309;&#x7167;&#x6211;&#x4EEC;&#x7684;&#x671F;&#x671B;&#x5728;&#x8FD0;&#x884C;  </p>
<p><strong>&#x8868;&#x9AD8;&#x901F;&#x7F13;&#x5B58;&#xFF1A;</strong><br>&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x6BCF;&#x4E2A;&#x8868;&#x5B58;&#x50A8;&#x5728;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x8981;&#x8BFB;&#x53D6;&#x6587;&#x4EF6;&#x7684;&#x5185;&#x5BB9;&#xFF0C;&#x4F60;&#x5FC5;&#x987B;&#x5148;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x8BFB;&#x53D6;&#xFF1B;&#x4E3A;&#x4E86;&#x52A0;&#x5FEB;&#x4ECE;&#x6587;&#x4EF6;&#x4E2D;&#x8BFB;&#x53D6;&#x6570;&#x636E;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;mysqld &#x5BF9;&#x8FD9;&#x4E9B;&#x6253;&#x5F00;&#x6587;&#x4EF6;&#x8FDB;&#x884C;&#x4E86;&#x7F13;&#x5B58;&#xFF0C;&#x5176;&#x6700;&#x5927;&#x6570;&#x76EE;&#x7531; /etc/my.cnf&#x4E2D;&#x7684; table_open_cache &#x6307;&#x5B9A;  </p>
<p>&#x4F8B;&#x5982;&#xFF1A;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# vim /etc/my.cnf </span><br><span class="line">[mysqld] </span><br><span class="line">datadir=/var/lib/mysql </span><br><span class="line">&#x2026;&#x2026; </span><br><span class="line">table_open_cache=24 &#xA0;#&#x7F13;&#x5B58;24&#x4E2A;&#x8868; </span><br><span class="line"> </span><br><span class="line">[root@jaking ~]# systemctl restart mysqld</span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash">&#xA0; show global status like <span class="string">&apos;open%_tables&apos;</span>;</span></span><br><span class="line">+---------------+-------+</span><br><span class="line">| Variable_name | Value |</span><br><span class="line">+---------------+-------+</span><br><span class="line">| Open_tables&#xA0;&#xA0; | 1&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Opened_tables | 114&#xA0;&#xA0; |</span><br><span class="line">+---------------+-------+</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>Open_tables &#x8868;&#x793A;&#x6253;&#x5F00;&#x8868;&#x7684;&#x6570;&#x91CF;&#xFF0C;Opened_tables&#x8868;&#x793A;&#x6253;&#x5F00;&#x8FC7;&#x7684;&#x8868;&#x6570;&#x91CF;&#xFF0C;&#x5982;&#x679C;Opened_tables&#x6570;&#x91CF;&#x8FC7;&#x5927;&#xFF0C;&#x8BF4;&#x660E;&#x914D;&#x7F6E;&#x4E2D; table_cache(5.1.3&#x4E4B;&#x540E;&#x8FD9;&#x4E2A;&#x503C;&#x53EB;&#x505A;table_open_cache)&#x503C;&#x53EF;&#x80FD;&#x592A;&#x5C0F;<br>table_cache &#x7684;&#x503C;&#x5728; 2G &#x5185;&#x5B58;&#x4EE5;&#x4E0B;&#x7684;&#x673A;&#x5668;&#x4E2D;&#x7684;&#x503C;&#x9ED8;&#x8BA4;&#x4ECE; 256 &#x5230; 512&#x4E2A;<br>&#x5BF9;&#x4E8E;&#x6709; 1G &#x5185;&#x5B58;&#x7684;&#x673A;&#x5668;&#xFF0C;&#x63A8;&#x8350;&#x503C;&#x662F; 128-256  </p>
<p>&#x5173;&#x952E;&#x5B57;&#x7F13;&#x51B2;&#x533A;<br>key_buffer_size&#x6307;&#x5B9A;&#x7D22;&#x5F15;&#x7F13;&#x51B2;&#x533A;&#x7684;&#x5927;&#x5C0F;&#xFF0C;&#x5B83;&#x51B3;&#x5B9A;&#x7D22;&#x5F15;&#x5904;&#x7406;&#x7684;&#x901F;&#x5EA6;&#xFF0C;&#x5C24;&#x5176;&#x662F;&#x7D22;&#x5F15;&#x8BFB;&#x7684;&#x901F;&#x5EA6;  </p>
<p>&#x4F8B;&#xFF1A;&#x5173;&#x952E;&#x5B57;&#x7F13;&#x5B58; , &#x7F13;&#x5B58;&#x6765;&#x7F13;&#x5B58;&#x7D22;&#x5F15;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# vim /etc/my.cnf </span><br><span class="line">[mysqld]</span><br><span class="line">datadir=/var/lib/mysql</span><br><span class="line">&#x2026;&#x2026;</span><br><span class="line">key_buffer_size=512M</span><br><span class="line"><span class="meta">#</span><span class="bash">&#x53EA;&#x8DD1;&#x4E00;&#x4E2A;mysql&#x670D;&#x52A1;&#xFF0C;&#x7ED3;&#x5408;&#x6240;&#x6709;&#x7F13;&#x5B58;&#xFF0C;mysql&#x6574;&#x4F53;&#x4F7F;&#x7528;&#x7684;&#x7F13;&#x5B58;&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x7269;&#x7406;&#x5185;&#x5B58;&#x7684;80%</span></span><br><span class="line">[root@jaking ~]# systemctl restart mysqld</span><br><span class="line"></span><br><span class="line">&#x67E5;&#x770B;&#xFF1A;</span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line"><span class="meta">mysql&gt;</span><span class="bash"> show status like <span class="string">&apos;%key_read%&apos;</span>;</span></span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0; | Value |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">| Key_read_requests | 6&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Key_reads&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 3&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+-------------------+-------+</span><br><span class="line">2 rows in set (0.00 sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5173;&#x952E;&#x5B57;&#xFF0C;&#x7406;&#x60F3;&#x60C5;&#x51B5;&#x4E0B;&#x5BF9;&#x4E8E;&#x4ED6;&#x7684;&#x8BF7;&#x6C42;&#x5E94;&#x8BE5;&#x6765;&#x81EA;&#x4E8E;&#x5185;&#x5B58;&#x800C;&#x4E0D;&#x662F;&#x78C1;&#x76D8;&#xFF0C;&#x4ECE;&#x8FD9;&#x4E2A;&#x8868;&#x4E2D;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x770B;&#x51FA;&#x6709;&#x591A;&#x5C11;&#x662F;Key_reads &#x4EE3;&#x8868;&#x547D;&#x4E2D;&#x78C1;&#x76D8;&#x7684;&#x8BF7;&#x6C42;&#x4E2A;&#x6570;&#xFF0C;Key_read_requests &#x662F;&#x603B;&#x6570;&#xFF0C; &#x547D;&#x4E2D;&#x78C1;&#x76D8;&#x7684;&#x8BFB;&#x8BF7;&#x6C42;&#x6570;&#x9664;&#x4EE5;&#x8BFB;&#x8BF7;&#x6C42;&#x603B;&#x6570;&#x5C31;&#x662F;&#x4E0D;&#x4E2D;&#x6BD4;&#x7387;&#xFF1B;&#x5982;&#x679C;&#x6BCF; 1000 &#x4E2A;&#x8BF7;&#x6C42;&#x4E2D;&#x547D;&#x4E2D;&#x78C1;&#x76D8;&#x7684;&#x6570;&#x76EE;&#x8D85;&#x8FC7; 1 &#x4E2A;&#xFF0C;&#x5C31;&#x5E94;&#x8BE5;&#x8003;&#x8651;&#x589E;&#x5927;&#x5173;&#x952E;&#x5B57;&#x7F13;&#x51B2;&#x533A;&#x4E86;<br>&#x547D;&#x4E2D;&#x7387;&#xFF1A;(1-(Key_reads / Key_read_requests ) )*100  </p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql&gt; create database jaking;</span><br><span class="line"> <span class="keyword">use</span> jaking;</span><br><span class="line"> <span class="keyword">create</span> <span class="keyword">table</span> test2 (<span class="keyword">id</span> <span class="built_in">int</span>,<span class="keyword">name</span> <span class="built_in">varchar</span>(<span class="number">24</span>));</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> test2 <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&apos;aaaaa&apos;</span>),(<span class="number">2</span>,<span class="string">&apos;aaaaa&apos;</span>),(<span class="number">3</span>,<span class="string">&apos;aaaaa&apos;</span>);</span><br><span class="line"> <span class="keyword">create</span> <span class="keyword">index</span> idx_name <span class="keyword">on</span> test2(<span class="keyword">name</span>);</span><br><span class="line">mysql&gt; show status like &apos;%key_read%&apos;;</span><br><span class="line">+<span class="comment">-------------------+-------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0; | Value |</span><br><span class="line">+<span class="comment">-------------------+-------+</span></span><br><span class="line">| Key_read_requests | 6&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Key_reads&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 3&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">-------------------+-------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">mysql&gt; <span class="keyword">select</span> <span class="keyword">name</span> <span class="keyword">from</span> test2;</span><br><span class="line">+<span class="comment">-------+</span></span><br><span class="line">| name&#xA0; |</span><br><span class="line">+<span class="comment">-------+</span></span><br><span class="line">| aaaaa |</span><br><span class="line">| aaaaa |</span><br><span class="line">| aaaaa |</span><br><span class="line">+<span class="comment">-------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">status</span> <span class="keyword">like</span> <span class="string">&apos;%key_read%&apos;</span>;</span><br><span class="line">+<span class="comment">-------------------+-------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0; | Value |</span><br><span class="line">+<span class="comment">-------------------+-------+</span></span><br><span class="line">| Key_read_requests | 6&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| Key_reads&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | 3&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">-------------------+-------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p>&#x603B;&#x7ED3;&#xFF1A;<br>1&#x3001;&#x770B;&#x673A;&#x5668;&#x914D;&#x7F6E;&#xFF0C;&#x6307;&#x4E09;&#x5927;&#x4EF6;&#xFF1A;cpu&#x3001;&#x5185;&#x5B58;&#x3001;&#x786C;&#x76D8;<br>2&#x3001;&#x770B;mysql&#x914D;&#x7F6E;&#x53C2;&#x6570;<br>3&#x3001;&#x67E5;&#x770B;mysql&#x884C;&#x72B6;&#x6001;<br>4&#x3001;&#x67E5;&#x770B;mysql&#x7684;&#x6162;&#x67E5;&#x8BE2;<br>&#x4F9D;&#x6B21;&#x89E3;&#x51B3;&#x4E86;&#x4EE5;&#x4E0A;&#x95EE;&#x9898;&#x4E4B;&#x540E;&#xFF0C;&#x518D;&#x6765;&#x67E5;&#x627E;&#x7A0B;&#x5E8F;&#x65B9;&#x9762;&#x7684;&#x95EE;&#x9898;  </p>
<p>#&#x4E0D;&#x8FDB;&#x884C;&#x57DF;&#x540D;&#x53CD;&#x89E3;&#x6790;,&#x6CE8;&#x610F;&#x7531;&#x6B64;&#x5E26;&#x6765;&#x7684;&#x6743;&#x9650;/&#x6388;&#x6743;&#x95EE;&#x9898;&#xFF1B;&#x5173;&#x95ED; MySQL &#x7684; DNS &#x53CD;&#x67E5;&#x529F;&#x80FD;&#xFF1B;&#x8FD9;&#x6837;&#x901F;&#x5EA6;&#x5C31;&#x5FEB;&#x4E86;!<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# echo skip-name-resolve &gt;&gt; /etc/my.cnf</span><br><span class="line">[root@jaking ~]# systemctl restart mysqld</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x8BE5;&#x9009;&#x9879;&#x5C31;&#x80FD;&#x7981;&#x7528;DNS &#x89E3;&#x6790;&#xFF0C;&#x8FDE;&#x63A5;&#x901F;&#x5EA6;&#x4F1A;&#x5FEB;&#x5F88;&#x591A;&#xFF1B;&#x4E0D;&#x8FC7;&#xFF0C;&#x8FD9;&#x6837;&#x7684;&#x8BDD;&#x5C31;&#x4E0D;&#x80FD;&#x5728;MySQL &#x7684;&#x6388;&#x6743;&#x8868;&#x4E2D;&#x4F7F;&#x7528;&#x4E3B;&#x673A;&#x540D;&#x4E86;&#x800C;&#x53EA;&#x80FD;&#x7528;IP&#x683C;&#x5F0F;  </p>
<p>#&#x7D22;&#x5F15;&#x7F13;&#x5B58;,&#x6839;&#x636E;&#x5185;&#x5B58;&#x5927;&#x5C0F;&#x800C;&#x5B9A;,&#x5982;&#x679C;&#x662F;&#x72EC;&#x7ACB;&#x7684; DB &#x670D;&#x52A1;&#x5668;,&#x53EF;&#x4EE5;&#x8BBE;&#x7F6E;&#x9AD8;&#x8FBE;80%&#x7684;&#x5185;&#x5B58;&#x603B;&#x91CF;  </p>
<pre><code>key_buffer_size=512M
</code></pre><p>#&#x6253;&#x5F00;&#x8868;&#x7F13;&#x5B58;&#x603B;&#x4E2A;&#x6570;,&#x53EF;&#x4EE5;&#x907F;&#x514D;&#x9891;&#x7E41;&#x7684;&#x6253;&#x5F00;&#x6570;&#x636E;&#x8868;&#x4EA7;&#x751F;&#x7684;&#x5F00;&#x9500;  </p>
<pre><code>table_open_cache=24
query_cache_size=128M 
max_connections=10000 #&#x6700;&#x5927;&#x8FDE;&#x63A5;&#x6570;
</code></pre><p>#&#x8BBE;&#x7F6E;&#x8D85;&#x65F6;&#x65F6;&#x95F4;,&#x80FD;&#x907F;&#x514D;&#x957F;&#x8FDE;&#x63A5;  </p>
<pre><code>wait_timeout=60
</code></pre><p>#&#x8BB0;&#x5F55;&#x6162;&#x67E5;&#x8BE2;,&#x7136;&#x540E;&#x5BF9;&#x6162;&#x67E5;&#x8BE2;&#x4E00;&#x4E00;&#x4F18;&#x5316;&#x5355;&#x4F4D;&#xFF1A;&#x79D2;  </p>
<pre><code>slow-queries- log-file=/var/lib/mysql/slow.log
long_query_time=5
</code></pre><h3 id="&#x6269;&#x5C55;-MySQL&#x4F18;&#x5316;&#x4E4B;&#x2014;&#x2014;-&#x5206;&#x5E93;&#x5206;&#x8868;"><a href="#&#x6269;&#x5C55;-MySQL&#x4F18;&#x5316;&#x4E4B;&#x2014;&#x2014;-&#x5206;&#x5E93;&#x5206;&#x8868;" class="headerlink" title="&#x6269;&#x5C55; MySQL&#x4F18;&#x5316;&#x4E4B;&#x2014;&#x2014;-&#x5206;&#x5E93;&#x5206;&#x8868;"></a>&#x6269;&#x5C55; MySQL&#x4F18;&#x5316;&#x4E4B;&#x2014;&#x2014;-&#x5206;&#x5E93;&#x5206;&#x8868;</h3><p>1 &#x57FA;&#x672C;&#x601D;&#x60F3;&#x4E4B;&#x4EC0;&#x4E48;&#x662F;&#x5206;&#x5E93;&#x5206;&#x8868;&#xFF1F;<br>&#x4ECE;&#x5B57;&#x9762;&#x4E0A;&#x7B80;&#x5355;&#x7406;&#x89E3;&#xFF0C;&#x5C31;&#x662F;&#x628A;&#x539F;&#x672C;&#x5B58;&#x50A8;&#x4E8E;&#x4E00;&#x4E2A;&#x5E93;&#x7684;&#x6570;&#x636E;&#x5206;&#x5757;&#x5B58;&#x50A8;&#x5230;&#x591A;&#x4E2A;&#x5E93;&#x4E0A;&#xFF0C;&#x628A;&#x539F;&#x672C;&#x5B58;&#x50A8;&#x4E8E;&#x4E00;&#x4E2A;&#x8868;&#x7684;&#x6570;&#x636E;&#x5206;&#x5757;&#x5B58;&#x50A8;&#x5230;&#x591A;&#x4E2A;&#x8868;&#x4E0A;&#x3002;  </p>
<p>2 &#x57FA;&#x672C;&#x601D;&#x60F3;&#x4E4B;&#x4E3A;&#x4EC0;&#x4E48;&#x8981;&#x5206;&#x5E93;&#x5206;&#x8868;&#xFF1F;<br>     &#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x91CF;&#x4E0D;&#x4E00;&#x5B9A;&#x662F;&#x53EF;&#x63A7;&#x7684;&#xFF0C;&#x5728;&#x672A;&#x8FDB;&#x884C;&#x5206;&#x5E93;&#x5206;&#x8868;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#xFF0C;&#x968F;&#x7740;&#x65F6;&#x95F4;&#x548C;&#x4E1A;&#x52A1;&#x7684;&#x53D1;&#x5C55;&#xFF0C;&#x5E93;&#x4E2D;&#x7684;&#x8868;&#x4F1A;&#x8D8A;&#x6765;&#x8D8A;&#x591A;&#xFF0C;&#x8868;&#x4E2D;&#x7684;&#x6570;&#x636E;&#x91CF;&#x4E5F;&#x4F1A;&#x8D8A;&#x6765;&#x8D8A;&#x5927;&#xFF0C;&#x76F8;&#x5E94;&#x5730;&#xFF0C;&#x6570;&#x636E;&#x64CD;&#x4F5C;&#xFF0C;&#x589E;&#x5220;&#x6539;&#x67E5;&#x7684;&#x5F00;&#x9500;&#x4E5F;&#x4F1A;&#x8D8A;&#x6765;&#x8D8A;&#x5927;&#xFF1B;&#x53E6;&#x5916;&#xFF0C;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x7684;&#x8D44;&#x6E90;&#xFF08;CPU&#x3001;&#x78C1;&#x76D8;&#x3001;&#x5185;&#x5B58;&#x3001;IO&#x7B49;&#xFF09;&#x662F;&#x6709;&#x9650;&#x7684;&#xFF0C;&#x6700;&#x7EC8;&#x6570;&#x636E;&#x5E93;&#x6240;&#x80FD;&#x627F;&#x8F7D;&#x7684;&#x6570;&#x636E;&#x91CF;&#x3001;&#x6570;&#x636E;&#x5904;&#x7406;&#x80FD;&#x529B;&#x90FD;&#x5C06;&#x906D;&#x9047;&#x74F6;&#x9888;  </p>
<p>3 &#x5206;&#x5E93;&#x5206;&#x8868;&#x7684;&#x5B9E;&#x65BD;&#x7B56;&#x7565;&#x3002;<br>     &#x5982;&#x679C;&#x4F60;&#x7684;&#x5355;&#x673A;&#x6027;&#x80FD;&#x5F88;&#x4F4E;&#x4E86;&#xFF0C;&#x90A3;&#x53EF;&#x4EE5;&#x5C1D;&#x8BD5;&#x5206;&#x5E93;&#x3002;&#x5206;&#x5E93;&#xFF0C;&#x4E1A;&#x52A1;&#x900F;&#x660E;&#xFF0C;&#x5728;&#x7269;&#x7406;&#x5B9E;&#x73B0;&#x4E0A;&#x5206;&#x6210;&#x591A;&#x4E2A;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x4E0D;&#x540C;&#x7684;&#x5206;&#x5E93;&#x5728;&#x4E0D;&#x540C;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x3002;&#x5206;&#x533A;&#x53EF;&#x4EE5;&#x628A;&#x8868;&#x5206;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x786C;&#x76D8;&#x4E0A;&#xFF0C;&#x4F46;&#x4E0D;&#x80FD;&#x5206;&#x914D;&#x5230;&#x4E0D;&#x540C;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#x3002;&#x4E00;&#x53F0;&#x673A;&#x5668;&#x7684;&#x6027;&#x80FD;&#x662F;&#x6709;&#x9650;&#x5236;&#x7684;&#xFF0C;&#x7528;&#x5206;&#x5E93;&#x53EF;&#x4EE5;&#x89E3;&#x51B3;&#x5355;&#x53F0;&#x670D;&#x52A1;&#x5668;&#x6027;&#x80FD;&#x4E0D;&#x591F;&#xFF0C;&#x6216;&#x8005;&#x6210;&#x672C;&#x8FC7;&#x9AD8;&#x95EE;&#x9898;&#x3002;  </p>
<p>&#x5F53;&#x5206;&#x533A;&#x4E4B;&#x540E;&#xFF0C;&#x8868;&#x8FD8;&#x662F;&#x5F88;&#x5927;&#xFF0C;&#x5904;&#x7406;&#x4E0D;&#x8FC7;&#x6765;&#xFF0C;&#x8FD9;&#x65F6;&#x5019;&#x53EF;&#x4EE5;&#x7528;&#x5206;&#x5E93;&#x3002;<br>orderid,userid,ordertime,&#x2026;..<br>userid%4=0&#xFF0C;&#x7528;&#x5206;&#x5E93;1<br>userid%4=1&#xFF0C;&#x7528;&#x5206;&#x5E93;2<br>userid%4=2, &#x7528;&#x5206;&#x5E93;3<br>userid%4=3&#xFF0C;&#x7528;&#x5206;&#x5E93;4  </p>
<p>&#x4E0A;&#x9762;&#x8FD9;&#x4E2A;&#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x7B80;&#x5355;&#x7684;&#x5206;&#x5E93;&#x8DEF;&#x7531;&#xFF0C;&#x6839;&#x636E;userid&#x9009;&#x62E9;&#x5206;&#x5E93;&#xFF0C;&#x5373;&#x4E0D;&#x540C;&#x7684;&#x670D;&#x52A1;&#x5668;  </p>
<p>4 &#x5206;&#x5E93;&#x5206;&#x8868;&#x5B58;&#x5728;&#x7684;&#x95EE;&#x9898;&#x3002;  </p>
<p>4.1 &#x4E8B;&#x52A1;&#x95EE;&#x9898;&#x3002;<br>     &#x5728;&#x6267;&#x884C;&#x5206;&#x5E93;&#x5206;&#x8868;&#x4E4B;&#x540E;&#xFF0C;&#x7531;&#x4E8E;&#x6570;&#x636E;&#x5B58;&#x50A8;&#x5230;&#x4E86;&#x4E0D;&#x540C;&#x7684;&#x5E93;&#x4E0A;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x51FA;&#x73B0;&#x4E86;&#x56F0;&#x96BE;&#x3002;&#x5982;&#x679C;&#x4F9D;&#x8D56;&#x6570;&#x636E;&#x5E93;&#x672C;&#x8EAB;&#x7684;&#x5206;&#x5E03;&#x5F0F;&#x4E8B;&#x52A1;&#x7BA1;&#x7406;&#x529F;&#x80FD;&#x53BB;&#x6267;&#x884C;&#x4E8B;&#x52A1;&#xFF0C;&#x5C06;&#x4ED8;&#x51FA;&#x9AD8;&#x6602;&#x7684;&#x6027;&#x80FD;&#x4EE3;&#x4EF7;&#xFF1B;&#x5982;&#x679C;&#x7531;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x53BB;&#x534F;&#x52A9;&#x63A7;&#x5236;&#xFF0C;&#x5F62;&#x6210;&#x7A0B;&#x5E8F;&#x903B;&#x8F91;&#x4E0A;&#x7684;&#x4E8B;&#x52A1;&#xFF0C;&#x53C8;&#x4F1A;&#x9020;&#x6210;&#x7F16;&#x7A0B;&#x65B9;&#x9762;&#x7684;&#x8D1F;&#x62C5;&#x3002;  </p>
<p>4.2 &#x8DE8;&#x5E93;&#x8DE8;&#x8868;&#x7684;join&#x95EE;&#x9898;&#x3002;<br>    &#x5728;&#x6267;&#x884C;&#x4E86;&#x5206;&#x5E93;&#x5206;&#x8868;&#x4E4B;&#x540E;&#xFF0C;&#x96BE;&#x4EE5;&#x907F;&#x514D;&#x4F1A;&#x5C06;&#x539F;&#x672C;&#x903B;&#x8F91;&#x5173;&#x8054;&#x6027;&#x5F88;&#x5F3A;&#x7684;&#x6570;&#x636E;&#x5212;&#x5206;&#x5230;&#x4E0D;&#x540C;&#x7684;&#x8868;&#x3001;&#x4E0D;&#x540C;&#x7684;&#x5E93;&#x4E0A;&#xFF0C;&#x8FD9;&#x65F6;&#xFF0C;&#x8868;&#x7684;&#x5173;&#x8054;&#x64CD;&#x4F5C;&#x5C06;&#x53D7;&#x5230;&#x9650;&#x5236;&#xFF0C;&#x6211;&#x4EEC;&#x65E0;&#x6CD5;join&#x4F4D;&#x4E8E;&#x4E0D;&#x540C;&#x5206;&#x5E93;&#x7684;&#x8868;&#xFF0C;&#x4E5F;&#x65E0;&#x6CD5;join&#x5206;&#x8868;&#x7C92;&#x5EA6;&#x4E0D;&#x540C;&#x7684;&#x8868;&#xFF0C;&#x7ED3;&#x679C;&#x539F;&#x672C;&#x4E00;&#x6B21;&#x67E5;&#x8BE2;&#x80FD;&#x591F;&#x5B8C;&#x6210;&#x7684;&#x4E1A;&#x52A1;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x591A;&#x6B21;&#x67E5;&#x8BE2;&#x624D;&#x80FD;&#x5B8C;&#x6210;&#x3002;  </p>
<p>4.3 &#x989D;&#x5916;&#x7684;&#x6570;&#x636E;&#x7BA1;&#x7406;&#x8D1F;&#x62C5;&#x548C;&#x6570;&#x636E;&#x8FD0;&#x7B97;&#x538B;&#x529B;&#x3002;<br>     &#x989D;&#x5916;&#x7684;&#x6570;&#x636E;&#x7BA1;&#x7406;&#x8D1F;&#x62C5;&#xFF0C;&#x6700;&#x663E;&#x800C;&#x6613;&#x89C1;&#x7684;&#x5C31;&#x662F;&#x6570;&#x636E;&#x7684;&#x5B9A;&#x4F4D;&#x95EE;&#x9898;&#x548C;&#x6570;&#x636E;&#x7684;&#x589E;&#x5220;&#x6539;&#x67E5;&#x7684;&#x91CD;&#x590D;&#x6267;&#x884C;&#x95EE;&#x9898;&#xFF0C;&#x8FD9;&#x4E9B;&#x90FD;&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x5E94;&#x7528;&#x7A0B;&#x5E8F;&#x89E3;&#x51B3;&#xFF0C;&#x4F46;&#x5FC5;&#x7136;&#x5F15;&#x8D77;&#x989D;&#x5916;&#x7684;&#x903B;&#x8F91;&#x8FD0;&#x7B97;&#xFF0C;&#x4F8B;&#x5982;&#xFF0C;&#x5BF9;&#x4E8E;&#x4E00;&#x4E2A;&#x8BB0;&#x5F55;&#x7528;&#x6237;&#x6210;&#x7EE9;&#x7684;&#x7528;&#x6237;&#x6570;&#x636E;&#x8868;userTable&#xFF0C;&#x4E1A;&#x52A1;&#x8981;&#x6C42;&#x67E5;&#x51FA;&#x6210;&#x7EE9;&#x6700;&#x597D;&#x7684;100&#x4F4D;&#xFF0C;&#x5728;&#x8FDB;&#x884C;&#x5206;&#x8868;&#x4E4B;&#x524D;&#xFF0C;&#x53EA;&#x9700;&#x4E00;&#x4E2A;order by&#x8BED;&#x53E5;&#x5C31;&#x53EF;&#x4EE5;&#x641E;&#x5B9A;&#xFF0C;&#x4F46;&#x662F;&#x5728;&#x8FDB;&#x884C;&#x5206;&#x8868;&#x4E4B;&#x540E;&#xFF0C;&#x5C06;&#x9700;&#x8981;n&#x4E2A;order by&#x8BED;&#x53E5;&#xFF0C;&#x5206;&#x522B;&#x67E5;&#x51FA;&#x6BCF;&#x4E00;&#x4E2A;&#x5206;&#x8868;&#x7684;&#x524D;100&#x540D;&#x7528;&#x6237;&#x6570;&#x636E;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x5BF9;&#x8FD9;&#x4E9B;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#x8BA1;&#x7B97;&#xFF0C;&#x624D;&#x80FD;&#x5F97;&#x51FA;&#x7ED3;&#x679C;&#x3002;  </p>
<p>MySQL5.7 &#x5B98;&#x65B9;&#x6587;&#x6863;<br><a href="https://dev.mysql.com/doc/refman/5.7/en/" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.7/en/</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/208cd020/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-MySQL备份与恢复（删库不跑路）" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/269a56e8/">MySQL备份与恢复（删库不跑路）</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:44:29" datetime="2022-06-07T04:44:29.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h3 id="&#x4E00;&#xFF1A;MySQL&#x5B57;&#x7B26;&#x96C6;"><a href="#&#x4E00;&#xFF1A;MySQL&#x5B57;&#x7B26;&#x96C6;" class="headerlink" title="&#x4E00;&#xFF1A;MySQL&#x5B57;&#x7B26;&#x96C6;"></a>&#x4E00;&#xFF1A;MySQL&#x5B57;&#x7B26;&#x96C6;</h3><p><strong>1&#xFF1A;&#x5B57;&#x7B26;&#x96C6;&#x4ECB;&#x7ECD;</strong><br>&#x5B57;&#x7B26;&#x96C6;&#x5C31;&#x662F;&#x4E00;&#x5957;&#x6587;&#x5B57;&#x7B26;&#x53F7;&#x53CA;&#x5176;&#x7F16;&#x7801;&#x3001;&#x6BD4;&#x8F83;&#x89C4;&#x5219;&#x7684;&#x96C6;&#x5408;&#xFF0C;&#x7B2C;&#x4E00;&#x4E2A;&#x8BA1;&#x7B97;&#x673A;&#x5B57;&#x7B26;&#x96C6;ASC2&#xFF1B;MySQL&#x6570;&#x636E;&#x5E93;&#x5B57;&#x7B26;&#x96C6;&#x5305;&#x62EC;&#x5B57;&#x7B26;&#x96C6;&#xFF08;CHARACTER&#xFF09;&#x548C;&#x6821;&#x5BF9;&#x89C4;&#x5219;&#xFF08;COLLATION&#xFF09;&#x4E24;&#x4E2A;&#x6982;&#x5FF5;&#xFF0C;&#x5176;&#x4E2D;&#x5B57;&#x7B26;&#x96C6;&#x7528;&#x6765;&#x5B9A;&#x4E49;MySQL&#x6570;&#x636E;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x5B58;&#x50A8;&#x65B9;&#x5F0F;&#xFF0C;&#x800C;&#x6821;&#x5BF9;&#x89C4;&#x5219;&#x5B9A;&#x4E49;&#x6BD4;&#x8F83;&#x5B57;&#x7B26;&#x4E32;&#x7684;&#x65B9;&#x5F0F;</p>
<p><strong>2&#xFF1A;MySQL&#x6570;&#x636E;&#x5E93;&#x5E38;&#x89C1;&#x5B57;&#x7B26;&#x96C6;&#x4ECB;&#x7ECD;</strong></p>
<p>&#x9009;&#x62E9;&#x5B57;&#x7B26;&#x96C6;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#x56FD;&#x9645;&#x6807;&#x51C6;&#x7684;utf8</p>
<p><strong>3&#xFF1A;MySQL&#x600E;&#x6837;&#x9009;&#x62E9;&#x5408;&#x9002;&#x7684;&#x5B57;&#x7B26;&#x96C6;</strong><br>1&#x3001;&#x5982;&#x679C;&#x5904;&#x7406;&#x5404;&#x79CD;&#x5404;&#x6837;&#x7684;&#x6587;&#x5B57;&#xFF0C;&#x53D1;&#x5E03;&#x5230;&#x4E0D;&#x540C;&#x8BED;&#x8A00;&#x56FD;&#x5BB6;&#x5730;&#x533A;&#xFF0C;&#x5E94;&#x9009;Unicode&#x5B57;&#x7B26;&#x96C6;&#xFF0C;&#x5BF9;MySQL&#x6765;&#x8BF4;&#x5C31;&#x662F;utf8(&#x6BCF;&#x4E2A;&#x6C49;&#x5B57;&#x4E09;&#x4E2A;&#x5B57;&#x8282;)<br>2&#x3001;&#x5982;&#x679C;&#x53EA;&#x662F;&#x9700;&#x8981;&#x652F;&#x6301;&#x4E2D;&#x6587;&#xFF0C;&#x5E76;&#x4E14;&#x6570;&#x636E;&#x91CF;&#x5F88;&#x5927;&#xFF0C;&#x6027;&#x80FD;&#x8981;&#x6C42;&#x4E5F;&#x9AD8;&#xFF0C;&#x53EF;&#x9009;GBK(&#x5B9A;&#x957F;&#xFF0C;&#x6BCF;&#x4E2A;&#x6C49;&#x5B57;&#x5360;&#x53CC;&#x5B57;&#x8282;&#xFF0C;&#x82F1;&#x6587;&#x4E5F;&#x5360;&#x53CC;&#x5B57;&#x8282;)&#xFF0C;&#x5982;&#x679C;&#x662F;&#x5927;&#x91CF;&#x8FD0;&#x7B97;&#xFF0C;&#x6BD4;&#x8F83;&#x6392;&#x5E8F;&#x7B49;&#xFF0C;&#x5B9A;&#x957F;&#x5B57;&#x7B26;&#x96C6;&#x66F4;&#x5FEB;&#xFF0C;&#x6027;&#x80FD;&#x4E5F;&#x9AD8;<br>3&#x3001;&#x5904;&#x7406;&#x79FB;&#x52A8;&#x4E92;&#x8054;&#x7F51;&#x4E1A;&#x52A1;&#xFF0C;&#x53EF;&#x80FD;&#x9700;&#x8981;&#x4F7F;&#x7528;utf8mb4&#x5B57;&#x7B26;&#x96C6;</p>
<p><strong>4&#xFF1A;&#x67E5;&#x770B;&#x5F53;&#x524D;MySQL&#x652F;&#x6301;&#x7684;&#x5B57;&#x7B26;&#x96C6;</strong></p>
<p>MySQL&#x53EF;&#x4EE5;&#x652F;&#x6301;&#x591A;&#x79CD;&#x5B57;&#x7B26;&#x96C6;&#xFF0C;&#x540C;&#x4E00;&#x53F0;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5E93;&#x6216;&#x8868;&#x7684;&#x4E0D;&#x540C;&#x5B57;&#x6BB5;&#x90FD;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x4E0D;&#x540C;&#x7684;&#x5B57;&#x7B26;&#x96C6;</p>
<pre><code>mysql -uroot -pJaking@vip.163.com -e &quot;show character set \G;&quot;  #&#x67E5;&#x770B;&#x6240;&#x6709;&#x7684;&#x5B57;&#x7B26;&#x96C6;
</code></pre><p>&#x67E5;&#x770B;&#x5E38;&#x7528;&#x7684;&#x5B57;&#x7B26;&#x96C6;&#xFF1A;</p>
<pre><code>mysql -uroot -pJaking@vip.163.com -e &quot;show character set\G;&quot; |egrep &quot;gbk|utf8|latin1&quot;|awk &apos;{print $0}&apos;
</code></pre><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com -e &quot;show character set\G;&quot; | egrep &quot;gbk|utf8|latin1&quot;|awk &apos;{print $0}&apos;</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Charset: latin1</span><br><span class="line">Default collation: latin1_swedish_ci</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Charset: gbk</span><br><span class="line">Default collation: gbk_chinese_ci</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Charset: utf8</span><br><span class="line">Default collation: utf8_general_ci</span><br><span class="line">&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; Charset: utf8mb4</span><br><span class="line">Default collation: utf8mb4_general_ci</span><br></pre></td></tr></tbody></table></figure>
<p><strong>5&#xFF1A;&#x67E5;&#x770B;MySQL&#x5F53;&#x524D;&#x7684;&#x5B57;&#x7B26;&#x96C6;&#x8BBE;&#x7F6E;&#x60C5;&#x51B5;</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;character_set%&apos;;</span><br><span class="line">+<span class="comment">--------------------------+------------------------------------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Value&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">--------------------------+------------------------------------+</span></span><br><span class="line">| character_set_client&#xA0;&#xA0;&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">| character_set_connection | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_database&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_filesystem | binary&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_results&#xA0;&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">| character_set_server&#xA0;&#xA0;&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_system&#xA0;&#xA0;&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_sets_dir&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | /usr/local/mysql57/share/charsets/ |</span><br><span class="line">+<span class="comment">--------------------------+------------------------------------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="built_in">character</span> <span class="keyword">set</span>;</span><br><span class="line">+<span class="comment">----------+---------------------------------+---------------------+--------+</span></span><br><span class="line">| Charset&#xA0; | Description&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Default collation&#xA0;&#xA0; | Maxlen |</span><br><span class="line">+<span class="comment">----------+---------------------------------+---------------------+--------+</span></span><br><span class="line">| big5&#xA0;&#xA0;&#xA0;&#xA0; | Big5 Traditional Chinese&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | big5_chinese_ci&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 2 |</span><br><span class="line">| dec8&#xA0;&#xA0;&#xA0;&#xA0; | DEC West European&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | dec8_swedish_ci&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| cp850&#xA0;&#xA0;&#xA0; | DOS West European&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | cp850_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| hp8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | HP West European&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | hp8_english_ci&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| koi8r&#xA0;&#xA0;&#xA0; | KOI8-R Relcom Russian&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | koi8r_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| latin1&#xA0;&#xA0; | cp1252 West European&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | latin1_swedish_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| latin2&#xA0;&#xA0; | ISO 8859-2 Central European&#xA0;&#xA0;&#xA0;&#xA0; | latin2_general_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| swe7&#xA0;&#xA0;&#xA0;&#xA0; | 7bit Swedish&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | swe7_swedish_ci&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| ascii&#xA0;&#xA0;&#xA0; | US ASCII&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | ascii_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| ujis&#xA0;&#xA0;&#xA0;&#xA0; | EUC-JP Japanese&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | ujis_japanese_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 3 |</span><br><span class="line">| sjis&#xA0;&#xA0;&#xA0;&#xA0; | Shift-JIS Japanese&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | sjis_japanese_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 2 |</span><br><span class="line">| hebrew&#xA0;&#xA0; | ISO 8859-8 Hebrew&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | hebrew_general_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| tis620&#xA0;&#xA0; | TIS620 Thai&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;| tis620_thai_ci&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| euckr&#xA0;&#xA0;&#xA0; | EUC-KR Korean&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | euckr_korean_ci&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 2 |</span><br><span class="line">| koi8u&#xA0;&#xA0;&#xA0; | KOI8-U Ukrainian&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | koi8u_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| gb2312&#xA0;&#xA0; | GB2312 Simplified Chinese&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | gb2312_chinese_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 2 |</span><br><span class="line">| greek&#xA0;&#xA0;&#xA0; | ISO 8859-7 Greek&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | greek_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| cp1250&#xA0;&#xA0; | Windows Central European&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | cp1250_general_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| gbk&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | GBK Simplified Chinese&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | gbk_chinese_ci&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 2 |</span><br><span class="line">| latin5&#xA0;&#xA0; | ISO 8859-9 Turkish&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | latin5_turkish_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| armscii8 | ARMSCII-8 Armenian&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | armscii8_general_ci |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| utf8&#xA0;&#xA0;&#xA0;&#xA0; | UTF-8 Unicode&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | utf8_general_ci&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 3 |</span><br><span class="line">| ucs2&#xA0;&#xA0;&#xA0;&#xA0; | UCS-2 Unicode&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | ucs2_general_ci&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 2 |</span><br><span class="line">| cp866&#xA0;&#xA0;&#xA0; | DOS Russian&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | cp866_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| keybcs2&#xA0; | DOS Kamenicky Czech-Slovak&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | keybcs2_general_ci&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| macce&#xA0;&#xA0;&#xA0; | Mac Central European&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;| macce_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| macroman | Mac West European&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | macroman_general_ci |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| cp852&#xA0;&#xA0;&#xA0; | DOS Central European&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | cp852_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| latin7&#xA0;&#xA0; | ISO 8859-13 Baltic&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | latin7_general_ci&#xA0; &#xA0;|&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| utf8mb4&#xA0; | UTF-8 Unicode&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | utf8mb4_general_ci&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 4 |</span><br><span class="line">| cp1251&#xA0;&#xA0; | Windows Cyrillic&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | cp1251_general_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| utf16&#xA0;&#xA0;&#xA0; | UTF-16 Unicode&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | utf16_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 4 |</span><br><span class="line">| utf16le &#xA0;| UTF-16LE Unicode&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | utf16le_general_ci&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 4 |</span><br><span class="line">| cp1256&#xA0;&#xA0; | Windows Arabic&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | cp1256_general_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| cp1257&#xA0;&#xA0; | Windows Baltic&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | cp1257_general_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| utf32&#xA0;&#xA0;&#xA0; | UTF-32 Unicode&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;| utf32_general_ci&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 4 |</span><br><span class="line">| binary&#xA0;&#xA0; | Binary pseudo charset&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | binary&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| geostd8&#xA0; | GEOSTD8 Georgian&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | geostd8_general_ci&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 |</span><br><span class="line">| cp932&#xA0;&#xA0;&#xA0; | SJIS for Windows Japanese&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | cp932_japanese_ci&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 2 |</span><br><span class="line">| eucjpms&#xA0; | UJIS for Windows Japanese&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | eucjpms_japanese_ci |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 3 |</span><br><span class="line">| gb18030&#xA0; | China National Standard GB18030 | gb18030_chinese_ci&#xA0; |&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 4 |</span><br><span class="line">+<span class="comment">----------+---------------------------------+---------------------+--------+</span></span><br><span class="line">41 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"><span class="string">``</span><span class="string">` </span></span><br><span class="line"><span class="string"> </span></span><br><span class="line"><span class="string">**&#x6539;&#x5B57;&#x7B26;&#x7F16;&#x7801;**</span></span><br><span class="line"><span class="string">`</span><span class="string">``</span>shell </span><br><span class="line">[root@jaking ~]<span class="comment"># echo character_set_server=utf8 &gt;&gt; /etc/my.cnf</span></span><br><span class="line">[root@jaking ~]<span class="comment"># cat /etc/my.cnf</span></span><br><span class="line">[<span class="keyword">client</span>]</span><br><span class="line">port=<span class="number">3306</span></span><br><span class="line">socket=/<span class="keyword">data</span>/mysql/mysql.sock</span><br><span class="line"> </span><br><span class="line">[mysqld]</span><br><span class="line"><span class="built_in">character</span>-<span class="keyword">set</span>-<span class="keyword">server</span>=utf8</span><br><span class="line"><span class="keyword">collation</span>-<span class="keyword">server</span>=utf8_general_ci</span><br><span class="line"> </span><br><span class="line"><span class="keyword">skip</span>-<span class="keyword">name</span>-resolve</span><br><span class="line"><span class="keyword">user</span>=mysql</span><br><span class="line">port=<span class="number">3306</span></span><br><span class="line">basedir=/usr/<span class="keyword">local</span>/mysql57</span><br><span class="line">datadir=/<span class="keyword">data</span>/mysql</span><br><span class="line">tmpdir=/tmp</span><br><span class="line">socket=/<span class="keyword">data</span>/mysql/mysql.sock</span><br><span class="line"> </span><br><span class="line"><span class="keyword">log</span>-<span class="keyword">error</span>=/<span class="keyword">data</span>/mysql/mysqld.log</span><br><span class="line">pid-<span class="keyword">file</span>=/<span class="keyword">data</span>/mysql/mysqld.pid </span><br><span class="line"><span class="keyword">default</span>-<span class="keyword">storage</span>-<span class="keyword">engine</span>=<span class="keyword">InnoDB</span></span><br><span class="line">character_set_server=utf8</span><br><span class="line">[root@jaking ~]<span class="comment"># systemctl restart mysqld</span></span><br><span class="line">[root@jaking ~]<span class="comment"># mysql -uroot -pJaking@vip.163.com</span></span><br><span class="line">mysql: [<span class="keyword">Warning</span>] <span class="keyword">Using</span> a <span class="keyword">password</span> <span class="keyword">on</span> the command line <span class="keyword">interface</span> can be insecure.</span><br><span class="line">Welcome <span class="keyword">to</span> the MySQL monitor.&#xA0; Commands <span class="keyword">end</span> <span class="keyword">with</span> ; or \g.</span><br><span class="line">Your MySQL connection id is 4</span><br><span class="line">Server version: 5.7.19 Source distribution</span><br><span class="line"> </span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"> </span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"> </span><br><span class="line">Type &apos;<span class="keyword">help</span>;&apos; or &apos;\h&apos; for help. <span class="keyword">Type</span> <span class="string">&apos;\c&apos;</span> <span class="keyword">to</span> <span class="keyword">clear</span> the <span class="keyword">current</span> <span class="keyword">input</span> statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show variables like &apos;character_set%&apos;;</span><br><span class="line">+<span class="comment">--------------------------+------------------------------------+</span></span><br><span class="line">| Variable_name&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | Value&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">--------------------------+------------------------------------+</span></span><br><span class="line">| character_set_client&#xA0;&#xA0;&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_connection | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_database&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">| character_set_filesystem | binary&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_results&#xA0;&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_server&#xA0;&#xA0;&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">| character_set_system&#xA0;&#xA0;&#xA0;&#xA0; | utf8&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">| character_sets_dir&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | /usr/local/mysql57/share/charsets/ |</span><br><span class="line">+<span class="comment">--------------------------+------------------------------------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">create</span> <span class="keyword">database</span> testdb;     </span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show create database testdb;</span><br><span class="line">+<span class="comment">----------+-----------------------------------------------------------------+</span></span><br><span class="line">| Database | <span class="keyword">Create</span> <span class="keyword">Database</span>                                                 |</span><br><span class="line">+<span class="comment">----------+-----------------------------------------------------------------+</span></span><br><span class="line">| testdb   | <span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="string">`testdb`</span> <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8 */</span> |</span><br><span class="line">+<span class="comment">----------+-----------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<p><strong>6&#xFF1A;&#x5B9E;&#x6218;&#xFF1A;&#x8FC1;&#x79FB;&#x6570;&#x636E;</strong></p>
<p> &#x80CC;&#x666F;&#xFF1A;&#x516C;&#x53F8;&#x4E1A;&#x52A1;&#x6570;&#x636E;book,&#x7531;&#x4E8E;&#x4E4B;&#x524D;&#x5EFA;&#x8868;&#x6CA1;&#x6CE8;&#x610F;&#x5B57;&#x7B26;&#x96C6;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x5BFC;&#x81F4;&#x4E4B;&#x524D;&#x5199;&#x5165;&#x7684;&#x6570;&#x636E;&#x51FA;&#x73B0;&#x4E71;&#x7801;&#xFF1B;&#x73B0;&#x5728;&#x8981;&#x5C06;&#x4E4B;&#x524D;&#x7684;&#x6570;&#x636E;&#x548C;&#x73B0;&#x5728;&#x6570;&#x636E;&#x7684;&#x5B57;&#x7B26;&#x96C6;&#x4E00;&#x81F4;&#xFF0C;&#x4E0D;&#x51FA;&#x73B0;&#x4E71;&#x7801;&#x60C5;&#x51B5;&#xFF1B;&#x5C06;&#x5B57;&#x7B26;&#x96C6;&#x4E3A;latin1&#x5DF2;&#x6709;&#x8BB0;&#x5F55;&#x7684;&#x6570;&#x636E;&#x8F6C;&#x6210;utf8&#xFF0C;&#x5E76;&#x4E14;&#x5DF2;&#x7ECF;&#x5B58;&#x5728;&#x7684;&#x8BB0;&#x5F55;&#x4E0D;&#x4E71;&#x7801;</p>
<p>&#x6B65;&#x9AA4;<br>                 1&#xFF1A;&#x5EFA;&#x5E93;&#x53CA;&#x5EFA;&#x8868;&#x7684;&#x8BED;&#x53E5;&#x5BFC;&#x51FA;&#xFF0C;sed&#x6279;&#x91CF;&#x4FEE;&#x6539;&#x4E3A;utf8<br>                 2&#xFF1A;&#x5BFC;&#x51FA;&#x4E4B;&#x524D;&#x6240;&#x6709;&#x7684;&#x6570;&#x636E;<br>                 3&#xFF1A;&#x4FEE;&#x6539;mysql&#x670D;&#x52A1;&#x7AEF;&#x548C;&#x5BA2;&#x6237;&#x7AEF;&#x7F16;&#x7801;&#x4E3A;utf8<br>                 4&#xFF1A;&#x5220;&#x9664;&#x539F;&#x6709;&#x7684;&#x5E93;&#x8868;&#x53CA;&#x6570;&#x636E;<br>                 5&#xFF1A;&#x5BFC;&#x5165;&#x65B0;&#x7684;&#x5EFA;&#x5E93;&#x53CA;&#x5EFA;&#x8868;&#x8BED;&#x53E5;<br>                 6&#xFF1A;&#x5BFC;&#x5165;&#x4E4B;&#x524D;&#x7684;&#x6570;&#x636E;</p>
<p> &#x51C6;&#x5907;&#x521B;&#x5EFA;&#x6D4B;&#x8BD5;&#x5E93;&#x548C;&#x8868;&#x7684;SQL&#x8BED;&#x53E5;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> testbookdb;</span><br><span class="line"><span class="comment">#CREATE DATABASE `testbookdb` DEFAULT CHARACTER SET utf8 COLLATE utf8_general_ci;</span></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="keyword">use</span> testbookdb;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> book1 (bTypeId <span class="built_in">int</span>,bName <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,publishing <span class="built_in">char</span>(<span class="number">16</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;1&apos;</span>,<span class="string">&apos;&#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;&apos;</span>,<span class="string">&apos;66&apos;</span>,<span class="string">&apos;&#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;2&apos;</span>,<span class="string">&apos;&#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;&apos;</span>,<span class="string">&apos;68&apos;</span>,<span class="string">&apos;&#x4EBA;&#x6C11;&#x90AE;&#x7535;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;3&apos;</span>,<span class="string">&apos;&#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;&apos;</span>,<span class="string">&apos;90&apos;</span>,<span class="string">&apos;&#x673A;&#x68B0;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;4&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;&apos;</span>,<span class="string">&apos;71&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;5&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL2&#x300B;&apos;</span>,<span class="string">&apos;72&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;6&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL3&#x300B;&apos;</span>,<span class="string">&apos;73&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;7&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL4&#x300B;&apos;</span>,<span class="string">&apos;74&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;8&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL5&#x300B;&apos;</span>,<span class="string">&apos;75&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;9&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL6&#x300B;&apos;</span>,<span class="string">&apos;76&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;10&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL7&#x300B;&apos;</span>,<span class="string">&apos;77&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;11&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL8&#x300B;&apos;</span>,<span class="string">&apos;78&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;12&apos;</span>,<span class="string">&apos;&#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL9&#x300B;&apos;</span>,<span class="string">&apos;79&apos;</span>,<span class="string">&apos;&#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> book1 (bTypeId <span class="built_in">int</span>,bName <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,publishing <span class="built_in">char</span>(<span class="number">16</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;1&apos;</span>,<span class="string">&apos;Linux&apos;</span>,<span class="string">&apos;66&apos;</span>,<span class="string">&apos;DZ&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;2&apos;</span>,<span class="string">&apos;CLD&apos;</span>,<span class="string">&apos;68&apos;</span>,<span class="string">&apos;RM&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;3&apos;</span>,<span class="string">&apos;OS&apos;</span>,<span class="string">&apos;90&apos;</span>,<span class="string">&apos;JX&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;4&apos;</span>,<span class="string">&apos;MySQL1&apos;</span>,<span class="string">&apos;71&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;5&apos;</span>,<span class="string">&apos;MySQL2&apos;</span>,<span class="string">&apos;72&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;6&apos;</span>,<span class="string">&apos;MySQL3&apos;</span>,<span class="string">&apos;73&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;7&apos;</span>,<span class="string">&apos;MySQL4&apos;</span>,<span class="string">&apos;74&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;8&apos;</span>,<span class="string">&apos;MySQL5&apos;</span>,<span class="string">&apos;75&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;9&apos;</span>,<span class="string">&apos;MySQL6&apos;</span>,<span class="string">&apos;76&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;10&apos;</span>,<span class="string">&apos;MySQL7&apos;</span>,<span class="string">&apos;77&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;11&apos;</span>,<span class="string">&apos;MySQL8&apos;</span>,<span class="string">&apos;78&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> book1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;12&apos;</span>,<span class="string">&apos;MySQL9&apos;</span>,<span class="string">&apos;79&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"></span><br><span class="line">mysql&gt; create database book;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show create database book;</span><br><span class="line">+<span class="comment">----------+---------------------------------------------------------------+</span></span><br><span class="line">| Database | <span class="keyword">Create</span> <span class="keyword">Database</span>                                               |</span><br><span class="line">+<span class="comment">----------+---------------------------------------------------------------+</span></span><br><span class="line">| book     | <span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="string">`book`</span> <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8 */</span> |</span><br><span class="line">+<span class="comment">----------+---------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> book;</span><br><span class="line">Database changed</span><br><span class="line"></span><br><span class="line">mysql&gt; CREATE TABLE book1 (bTypeId int,bName char(16),price int,publishing char(16)) character set latin1;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; show CREATE TABLE book1;</span><br><span class="line">+<span class="comment">-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table | <span class="keyword">Create</span> <span class="keyword">Table</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">+<span class="comment">-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| book1 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book1`</span> (</span><br><span class="line">&#xA0; <span class="string">`bTypeId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`bName`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`price`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`publishing`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=latin1 |</span><br><span class="line">+<span class="comment">-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.02</span> sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x4FEE;&#x6539;&#x6570;&#x636E;&#x5E93;&#x5B57;&#x7B26;&#x96C6;</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show create database book;</span><br><span class="line">+<span class="comment">----------+---------------------------------------------------------------+</span></span><br><span class="line">| Database | <span class="keyword">Create</span> <span class="keyword">Database</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">----------+---------------------------------------------------------------+</span></span><br><span class="line">| book&#xA0;&#xA0;&#xA0;&#xA0; | <span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="string">`book`</span> <span class="comment">/*!40100 DEFAULT CHARACTER SET utf8 */</span> |</span><br><span class="line">+<span class="comment">----------+---------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; <span class="keyword">alter</span> <span class="keyword">database</span> book <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> latin1;</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; show create database book;</span><br><span class="line">+<span class="comment">----------+-----------------------------------------------------------------+</span></span><br><span class="line">| Database | <span class="keyword">Create</span> <span class="keyword">Database</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">----------+-----------------------------------------------------------------+</span></span><br><span class="line">| book&#xA0;&#xA0;&#xA0;&#xA0; | <span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> <span class="string">`book`</span> <span class="comment">/*!40100 DEFAULT CHARACTER SET latin1 */</span> |</span><br><span class="line">+<span class="comment">----------+-----------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x4FEE;&#x6539;&#x8868;&#x7684;&#x5B57;&#x7B26;&#x96C6;</strong><br> </p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show create table book1;</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table | <span class="keyword">Create</span> <span class="keyword">Table</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| book1 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book1`</span> (</span><br><span class="line">&#xA0; <span class="string">`bTypeId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`bName`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`price`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`publishing`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 |</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; <span class="keyword">alter</span> <span class="keyword">table</span> book1 <span class="keyword">default</span> <span class="built_in">character</span> <span class="keyword">set</span> latin1;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">Records: 0&#xA0; Duplicates: 0&#xA0; Warnings: 0</span><br><span class="line"> </span><br><span class="line">mysql&gt; show create table book1;</span><br><span class="line">+<span class="comment">-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table | <span class="keyword">Create</span> <span class="keyword">Table</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">+<span class="comment">-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| book1 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book1`</span> (</span><br><span class="line">&#xA0; <span class="string">`bTypeId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`bName`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`price`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`publishing`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> utf8 <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=latin1 |</span><br><span class="line">+<span class="comment">-------+---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x6DF1;&#x5165;&#x7814;&#x7A76;&#x5B57;&#x7B26;&#x96C6;&#xFF1A;</strong><br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; drop table book1;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">mysql&gt;&#xA0;CREATE TABLE book1 (bTypeId int,bName char(16),price int,publishing char(16)) character set latin1;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; INSERT INTO book1(bTypeId,bName,price,publishing) VALUES(&apos;1&apos;,&apos;&#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;&apos;,&apos;66&apos;,&apos;&#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&apos;);</span><br><span class="line">ERROR 1366 (HY000): Incorrect string value: &apos;\xE3\x80\x8ALin...&apos; for column &apos;bName&apos; at row 1</span><br><span class="line">mysql&gt; drop table book1;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt;&#xA0; CREATE TABLE book1 (bTypeId int,bName char(16),price int,publishing char(16));</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; INSERT INTO book1(bTypeId,bName,price,publishing) VALUES(&apos;1&apos;,&apos;&#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;&apos;,&apos;66&apos;,&apos;&#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&apos;);</span><br><span class="line">ERROR 1366 (HY000): Incorrect string value: &apos;\xE3\x80\x8ALin...&apos; for column &apos;bName&apos; at row 1</span><br><span class="line">mysql&gt; show create table book1;</span><br><span class="line">+<span class="comment">-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table | <span class="keyword">Create</span> <span class="keyword">Table</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">+<span class="comment">-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| book1 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book1`</span> (</span><br><span class="line">&#xA0; <span class="string">`bTypeId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`bName`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`price`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`publishing`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=latin1 |</span><br><span class="line">+<span class="comment">-------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; <span class="keyword">drop</span> <span class="keyword">table</span> book1;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; </span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt;&#xA0; CREATE TABLE book1 (bTypeId int,bName char(16),price int,publishing char(16)) character set utf8;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; INSERT INTO book1(bTypeId,bName,price,publishing) VALUES(&apos;1&apos;,&apos;&#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;&apos;,&apos;66&apos;,&apos;&#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&apos;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; select * from book1;</span><br><span class="line">+<span class="comment">---------+-------------------------------+-------+-----------------------+</span></span><br><span class="line">| bTypeId | bName&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; | price | publishing&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">---------+-------------------------------+-------+-----------------------+</span></span><br><span class="line">|&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 1 | &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |&#xA0;&#xA0;&#xA0; 66 | &#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">---------+-------------------------------+-------+-----------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">-----------------------+</span></span><br><span class="line">| Tables_in_testbookdb2 |</span><br><span class="line">+<span class="comment">-----------------------+</span></span><br><span class="line">| book1                 |</span><br><span class="line">+<span class="comment">-----------------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> book2 (bTypeId <span class="built_in">int</span>,bName <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,publishing <span class="built_in">char</span>(<span class="number">16</span>)) <span class="built_in">character</span> <span class="keyword">set</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci;</span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; INSERT INTO book2(bTypeId,bName,price,publishing) VALUES(&apos;1&apos;,&apos;&#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;&apos;,&apos;66&apos;,&apos;&#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;&apos;);</span><br><span class="line">Query OK, 1 row affected (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show create table book2;</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table | <span class="keyword">Create</span> <span class="keyword">Table</span>                                                                                                                                                                                        |</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| book2 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book2`</span> (</span><br><span class="line">  <span class="string">`bTypeId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`bName`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`price`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`publishing`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 |</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> book1;</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table | <span class="keyword">Create</span> <span class="keyword">Table</span>                                                                                                                                                                                                                                  |</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| book1 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book1`</span> (</span><br><span class="line">  <span class="string">`bTypeId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`bName`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> latin1 <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`price`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">  <span class="string">`publishing`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="built_in">CHARACTER</span> <span class="keyword">SET</span> latin1 <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 |</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>1&#xFF09;&#xFF1A;&#x5BFC;&#x51FA;&#x8868;&#x7ED3;&#x6784;</strong></p>
<pre><code>mysqldump -uroot -pJaking@vip.163.com --default-character-set=latin1 -d  testbookdb &gt; booktable.sql 
</code></pre><p><strong>2&#xFF09;: &#x7F16;&#x8F91;booktable.sql &#x5C06;latin1&#x4FEE;&#x6539;&#x6210;utf8</strong></p>
<pre><code>vim booktable.sql &#x4FEE;&#x6539;&#x6240;&#x6709;latin1&#x4E3A;utf8
</code></pre><p><strong>3&#xFF09;: &#x786E;&#x4FDD;&#x6570;&#x636E;&#x5E93;&#x4E0D;&#x518D;&#x66F4;&#x65B0;&#xFF0C;&#x5BFC;&#x51FA;&#x6307;&#x5B9A;&#x5E93;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -pJaking@vip.163.com --quick --no-create-info --extended-insert --default-character-set=latin1 --databases  testbookdb &gt; bookdata.sql</span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --databases  testbookdb &gt; bookdata.sql         </span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --quick --no-create-info --extended-insert --default-character-set=latin1 -B  testbookdb &gt; bookdata.sql</span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --quick --no-create-info --extended-insert --default-character-set=latin1 -t testbookdb &gt; bookdata.sql</span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --databases  testbookdb &gt; bookdata.sql</span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com -t testbookdb &gt; bookdata.sql</span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --quick --no-create-info --extended-insert --default-character-set=latin1  -A  &gt; ALL.sql</span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --quick --no-create-info --extended-insert  -A  &gt; ALL.sql</span><br><span class="line"> </span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --quick --no-create-info --extended-insert --default-character-set=utf8  --all-databases  &gt; ALL.sql</span><br><span class="line"></span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --all-databases  &gt; ALL.sql</span><br><span class="line"></span><br><span class="line">mysql -uroot -pJaking@vip.163.com &lt; ALL.sql</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x53C2;&#x6570;&#x8BF4;&#x660E;&#xFF1A;</strong><br><code>--quick</code>:&#x7528;&#x4E8E;&#x8F6C;&#x50A8;&#x5927;&#x7684;&#x8868;&#xFF0C;&#x5F3A;&#x5236;mysqldump&#x4ECE;&#x670D;&#x52A1;&#x5668;&#x4E00;&#x6B21;&#x4E00;&#x884C;&#x7684;&#x68C0;&#x7D22;&#x6570;&#x636E;&#x800C;&#x4E0D;&#x662F;&#x68C0;&#x7D22;&#x6240;&#x6709;&#x884C;&#xFF0C;&#x5E76;&#x8F93;&#x51FA;&#x5F53;&#x524D;cache&#x5230;&#x5185;&#x5B58;&#x4E2D;<br><code>--no-create-info</code>:&#x4E0D;&#x8981;&#x521B;&#x5EFA;create table&#x8BED;&#x53E5;<br><code>--extended-insert</code>:&#x4F7F;&#x7528;&#x5305;&#x62EC;&#x51E0;&#x4E2A;values&#x5217;&#x8868;&#x7684;&#x591A;&#x884C;insert&#x8BED;&#x6CD5;&#xFF0C;&#x8FD9;&#x6837;&#x6587;&#x4EF6;&#x66F4;&#x5C0F;&#xFF0C;IO&#x4E5F;&#x5C0F;&#xFF0C;&#x5BFC;&#x5165;&#x6570;&#x636E;&#x65F6;&#x4F1A;&#x975E;&#x5E38;&#x5FEB;<br><code>--default-character-set=latin1</code>:&#x6309;&#x7167;&#x539F;&#x6709;&#x5B57;&#x7B26;&#x96C6;&#x5BFC;&#x51FA;&#x6570;&#x636E;&#xFF0C;&#x8FD9;&#x6837;&#x5BFC;&#x51FA;&#x7684;&#x6587;&#x4EF6;&#x4E2D;&#xFF0C;&#x6240;&#x6709;&#x4E2D;&#x6587;&#x90FD;&#x662F;&#x53EF;&#x89C1;&#x7684;&#xFF0C;&#x4E0D;&#x4F1A;&#x4FDD;&#x5B58;&#x6210;&#x4E71;&#x7801;<br><strong>4&#xFF09;&#xFF1A;&#x6253;&#x5F00;bookdata.sql &#x5C06;SET NAME latin1 &#x4FEE;&#x6539;&#x6210;SET NAME utf8</strong></p>
<pre><code>vim bookdata.sql 
/*!40101 SET NAMES utf8 */;
</code></pre><p><strong>5&#xFF09;: &#x91CD;&#x65B0;&#x5EFA;&#x5E93;</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; create database  testdb default charset utf8;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>6&#xFF09;&#xFF1A;&#x5EFA;&#x7ACB;&#x8868;&#xFF0C;&#x5BFC;&#x5165;&#x6211;&#x4EEC;&#x4E4B;&#x524D;&#x5BFC;&#x51FA;&#x7684;&#x8868;&#x7684;&#x8868;&#x7ED3;&#x6784;</strong><br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -pJaking@vip.163.com testdb &lt; booktable.sql</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>7&#xFF09;: &#x5BFC;&#x5165;&#x6570;&#x636E;</strong></p>
<pre><code>mysql -uroot -pJaking@vip.163.com testdb &lt; bookdata.sql
&#x6CE8;&#x610F;&#xFF1A;&#x9009;&#x62E9;&#x76EE;&#x6807;&#x5B57;&#x7B26;&#x96C6;&#x65F6;&#xFF0C;&#x8981;&#x6CE8;&#x610F;&#x6700;&#x597D;&#x5927;&#x4E8E;&#x7B49;&#x4E8E;&#x539F;&#x5B57;&#x7B26;&#x96C6;&#xFF08;&#x5B57;&#x5E93;&#x66F4;&#x5927;&#xFF09;&#xFF0C;&#x5426;&#x5219;&#x53EF;&#x80FD;&#x4F1A;&#x4E22;&#x5931;&#x4E0D;&#x88AB;&#x652F;&#x6301;&#x7684;&#x6570;&#x636E;
</code></pre><p><strong>&#x4E8C;&#xFF1A;MySQL&#x65E5;&#x5E38;&#x7EF4;&#x62A4;</strong></p>
<p><strong>1&#xFF1A;mysqlcheck mysql&#x4FEE;&#x590D;&#x5DE5;&#x5177;</strong></p>
<p>mysqlcheck&#x5BA2;&#x6237;&#x7AEF;&#x5DE5;&#x5177;&#x53EF;&#x4EE5;&#x68C0;&#x67E5;&#x548C;&#x4FEE;&#x590D;MyISAM&#x8868;&#xFF0C;&#x8FD8;&#x53EF;&#x4EE5;&#x4F18;&#x5316;&#x548C;&#x5206;&#x6790;&#x8868;&#x3002;<br>&#x5B9E;&#x9645;&#x4E0A;&#xFF0C;&#x5B83;&#x96C6;&#x6210;&#x4E86;mysql&#x5DE5;&#x5177;&#x4E2D;check&#x3001;repair&#x3001;analyze&#x3001;tmpimize&#x7684;&#x529F;&#x80FD;&#x3002;<br>/usr/local/mysql/bin/mysqlcheck   #&#x6E90;&#x7801;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;&#x4F4D;&#x7F6E;</p>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">rpm -qf `which mysqlcheck` &#xA0;yum&#x5B89;&#x88C5;&#x67E5;&#x770B;</span><br><span class="line">[root@jaking ~]# rpm -qf `which mysqlcheck`</span><br><span class="line">file /usr/local/mysql57/bin/mysqlcheck is not owned by any package</span><br><span class="line">[root@jaking ~]# yum provides mysqlcheck</span><br><span class="line">Loaded plugins: product-id, search-disabled-repos, subscription-manager</span><br><span class="line">This system is not registered to Red Hat Subscription Management. You can use subscription-manager to register.</span><br><span class="line">1:mariadb-5.5.52-1.el7.x86_64 : A community developed branch of MySQL</span><br><span class="line">Repo&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; : rhel7</span><br><span class="line">Matched from:</span><br><span class="line">Filename&#xA0;&#xA0;&#xA0; : /usr/bin/mysqlcheck</span><br><span class="line">[root@jaking ~]# yum install -y mariadb-5.5.52-1.el7.x86_64</span><br><span class="line">[root@jaking ~]# rpm -qf `which mysqlcheck`</span><br><span class="line">mariadb-5.5.52-1.el7.x86_64</span><br><span class="line">[root@jaking ~]# which mysqlcheck</span><br><span class="line">/usr/bin/mysqlcheck</span><br></pre></td></tr></tbody></table></figure>
<p>&#x53C2;&#x6570;&#x9009;&#x9879;&#xFF1A;<br>mysqlcheck &#x2013;help &#x67E5;&#x770B;&#x5E2E;&#x52A9;<br><code>-c</code>, &#x2013;check (&#x68C0;&#x67E5;&#x8868;)&#xFF1B;<br><code>-r</code>, &#x2013;repair&#xFF08;&#x4FEE;&#x590D;&#x8868;)&#xFF1B;<br><code>-a</code>, &#x2013;analyze (&#x5206;&#x6790;&#x8868;)&#xFF1B;<br><code>-o</code>, &#x2013;tmpimize(&#x4F18;&#x5316;&#x8868;)&#xFF1B; //&#x5176;&#x4E2D;&#xFF0C;&#x9ED8;&#x8BA4;&#x9009;&#x9879;&#x662F;-c(&#x68C0;&#x67E5;&#x8868;)<br><code>-u</code>&#xFF0C; &#x4F7F;&#x7528;mysql&#x4E2D;&#x54EA;&#x4E2A;&#x7528;&#x6237;&#x8FDB;&#x884C;&#x64CD;&#x4F5C;</p>
<p>mysqlcheck&#x4F7F;&#x7528;&#x8BED;&#x6CD5;&#xFF1A;<br>&#x4F7F;&#x7528;&#x4EE5;&#x4E0B;3&#x79CD;&#x65B9;&#x5F0F;&#x6765;&#x8C03;&#x7528;mysqlcheck&#xFF1A;<br>mysqlcheck[tmpions] db_name [tables]<br>mysqlcheck[tmpions] &#x2014;database DB1 [DB2 DB3&#x2026;]<br>mysqlcheck[tmpions] &#x2013;all&#x2013;databases<br>&#x5982;&#x679C;&#x6CA1;&#x6709;&#x6307;&#x5B9A;&#x4EFB;&#x4F55;&#x8868;&#x6216;&#x4F7F;&#x7528;&#x2014;databases(-B)&#x6216;&#x2013;all&#x2013;databases(-A)&#x9009;&#x9879;&#xFF0C;&#x5219;&#x68C0;&#x67E5;&#x6574;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x3002;</p>
<p>&#x4E3E;&#x4F8B;&#x8BF4;&#x660E;&#xFF1A;</p>
<p>1&#xFF1A;&#x68C0;&#x67E5;&#x8868;(check)<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# mysqlcheck -uroot -pJaking@vip.163.com -c testdb book1</span><br><span class="line">mysqlcheck: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">testdb.book1                                       OK</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>2:  &#x4FEE;&#x590D;&#x8868;&#xFF08;repair&#xFF09;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# mysqlcheck -uroot -pJaking@vip.163.com -r testdb book1</span><br><span class="line">mysqlcheck: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">testdb.book1</span><br><span class="line">note     : The storage engine for the table doesn&apos;t support repair</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.&#xA0; Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 12</span><br><span class="line">Server version: 5.7.19 Source distribution</span><br><span class="line"> </span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"> </span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"> </span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show create table testdb.book1;</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table | <span class="keyword">Create</span> <span class="keyword">Table</span>&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; |</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| book1 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book1`</span> (</span><br><span class="line">&#xA0; <span class="string">`bTypeId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0;&#xA0;<span class="string">`bName`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`price`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`publishing`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 |</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"> </span><br><span class="line">mysql&gt; <span class="keyword">alter</span> <span class="keyword">table</span> testdb.book1 <span class="keyword">engine</span> = MyISAM;</span><br><span class="line">Query OK, 0 rows affected (0.00 sec)</span><br><span class="line">Records: 0&#xA0; Duplicates: 0&#xA0; Warnings: 0</span><br><span class="line"> </span><br><span class="line">mysql&gt; show create table testdb.book1;</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| Table | <span class="keyword">Create</span> <span class="keyword">Table</span> &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;|</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line">| book1 | <span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="string">`book1`</span> (</span><br><span class="line">&#xA0; <span class="string">`bTypeId`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`bName`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`price`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span>,</span><br><span class="line">&#xA0; <span class="string">`publishing`</span> <span class="built_in">char</span>(<span class="number">16</span>) <span class="keyword">DEFAULT</span> <span class="literal">NULL</span></span><br><span class="line">) <span class="keyword">ENGINE</span>=MyISAM <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8 |</span><br><span class="line">+<span class="comment">-------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="keyword">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line">mysql&gt; <span class="keyword">exit</span></span><br><span class="line">Bye</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# mysqlcheck -uroot -pJaking@vip.163.com -r testdb book1</span><br><span class="line">mysqlcheck: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">testdb.book1                                       OK</span><br><span class="line"> </span><br><span class="line">3:&#x4FEE;&#x590D;&#x6307;&#x5B9A;&#x7684;&#x6570;&#x636E;&#x5E93;</span><br><span class="line">[root@jaking ~]# mysqlcheck -uroot -pJaking@vip.163.com -r testdb book1</span><br><span class="line">mysqlcheck: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">testdb.book1                                       OK&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; &#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# mysqlcheck -uroot -p  -r --databases testdb</span><br><span class="line">Enter password: </span><br><span class="line">testdb.book1                                       OK</span><br><span class="line">testdb.book2</span><br><span class="line">note     : The storage engine for the table doesn&apos;t support repair</span><br></pre></td></tr></tbody></table></figure>
<p>&#x6269;&#x5C55;&#xFF1A; &#x4FEE;&#x590D;&#x6587;&#x4EF6;&#x7CFB;&#x7EDF;&#xFF0C;&#x5BB9;&#x6613;&#x6389;&#x5931;&#x6570;&#x636E;</p>
<pre><code>fsck -y -f /dev/sdbx
</code></pre><p>4:  &#x68C0;&#x67E5;&#x4FEE;&#x590D;&#x6240;&#x6709;&#x6570;&#x636E;&#x5E93;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# mysqlcheck -uroot -pJaking@vip.163.com -A -r</span><br><span class="line">book.book1&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">book2.book1</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">market.order</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">market.order1</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">market.user</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.columns_priv&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">mysql.db&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">mysql.engine_cost</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.event&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">mysql.func&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">mysql.gtid_executed</span><br><span class="line">Warning&#xA0; : Please do not modify the gtid_executed table. This is a mysql internal system table to store GTIDs for committed transactions. Modifying it can lead to an inconsistent GTID state.</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.help_category</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.help_keyword</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.help_relation</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.help_topic</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.innodb_index_stats</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.innodb_table_stats</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.ndb_binlog_index&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">mysql.plugin</span><br><span class="line">note&#xA0;&#xA0;&#xA0;&#xA0; : The storage engine for the table doesn&apos;t support repair</span><br><span class="line">mysql.proc&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">mysql.procs_priv&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">mysql.proxies_priv&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; OK</span><br><span class="line">mysql.server_cost</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x53C2;&#x6570;-A &#x7B49;&#x4E8E;  &#x2013;all-databases  </p>
<p>5&#xFF1A;&#x6BCF;&#x5929;&#x5B9A;&#x65F6;&#x5BF9;mysql&#x6570;&#x636E;&#x5E93;&#x8FDB;&#x884C;&#x4F18;&#x5316;</p>
<p>&#x4F7F;&#x7528;&#x8BA1;&#x5212;&#x4EFB;&#x52A1;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br><span class="line"><span class="meta">#</span><span class="bash">0 1 * * * /usr/bin/mysqlcheck -A -o -r&#xA0; -u&#x4F60;&#x7684;&#x7528;&#x6237;&#x540D; -p&#x4F60;&#x7684;&#x5BC6;&#x7801; &gt; /dev/null 2&gt;&amp;1</span></span><br><span class="line"></span><br><span class="line">0 3 * * *&#xA0; /usr/bin/mysqlcheck -uroot -pJaking@vip.163.com -r -o -A &gt; /dev/null 2&gt;&amp;1 #&#x6BCF;&#x5929;3&#x70B9;&#x4F18;&#x5316;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>2&#xFF1A;MySQL&#x5907;&#x4EFD;&#x4E0E;&#x6062;&#x590D;</p>
<p>1)MySQL&#x5907;&#x4EFD;&#x7684;&#x7C7B;&#x578B;<br>&#x6309;&#x7167;&#x5907;&#x4EFD;&#x65F6;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5F71;&#x54CD;&#x8303;&#x56F4;&#x5206;&#x4E3A;&#xFF1A;<br>Hot backup(&#x70ED;&#x5907;)  Cold Backup&#xFF08;&#x51B7;&#x5907;&#xFF09;Warm Backup&#xFF08;&#x6E29;&#x5907;&#xFF09;<br>Hot backup&#xFF1A;&#x70ED;&#x5907;&#x6307;&#x5728;&#x6570;&#x636E;&#x5E93;&#x8FD0;&#x884C;&#x4E2D;&#x76F4;&#x63A5;&#x5907;&#x4EFD;&#xFF0C;&#x5BF9;&#x6B63;&#x5728;&#x8FD0;&#x884C;&#x7684;&#x6570;&#x636E;&#x5E93;&#x6CA1;&#x6709;&#x4EFB;&#x4F55;&#x5F71;&#x54CD;&#xFF0C;&#xFF08;Online Backup&#xFF09;&#x5B98;&#x65B9;&#x624B;&#x518C;&#x4E3A;&#x5728;&#x7EBF;&#x5907;&#x4EFD;<br>Cold Backup&#xFF1A;&#x51B7;&#x5907;&#x6307;&#x5728;&#x6570;&#x636E;&#x5E93;&#x505C;&#x6B62;&#x7684;&#x60C5;&#x51B5;&#x4E0B;&#x8FDB;&#x884C;&#x5907;&#x4EFD;&#xFF0C;(OfflineBackup) &#x5B98;&#x65B9;&#x624B;&#x518C;&#x79F0;&#x4E3A;&#x79BB;&#x7EBF;&#x5907;&#x4EFD;<br>Warm Backup&#xFF1A;&#x6E29;&#x5907;&#x6307;&#x5907;&#x4EFD;&#x540C;&#x6837;&#x5728;&#x6570;&#x636E;&#x5E93;&#x8FD0;&#x884C;&#x65F6;&#x8FDB;&#x884C;&#xFF0C;&#x4F46;&#x662F;&#x4F1A;&#x5BF9;&#x5F53;&#x524D;&#x6570;&#x636E;&#x5E93;&#x7684;&#x64CD;&#x4F5C;&#x6709;&#x6240;&#x5F71;&#x54CD;&#xFF0C;&#x4F8B;&#x5982;&#x52A0;&#x4E00;&#x4E2A;&#x5168;&#x5C40;&#x8BFB;&#x9501;&#x4EE5;&#x4FDD;&#x8BC1;&#x5907;&#x4EFD;&#x6570;&#x636E;&#x7684;&#x4E00;&#x81F4;&#x6027;</p>
<p>&#x6309;&#x7167;&#x5907;&#x4EFD;&#x540E;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#xFF1A;</p>
<p>&#x903B;&#x8F91;&#x5907;&#x4EFD; &#x2013;&gt;<br>&#x6307;&#x5907;&#x4EFD;&#x540E;&#x7684;&#x6587;&#x4EF6;&#x5185;&#x5BB9;&#x662F;&#x53EF;&#x8BFB;&#x7684;&#xFF0C;&#x901A;&#x5E38;&#x4E3A;&#x6587;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x5185;&#x5BB9;&#x4E00;&#x822C;&#x662F;SQL&#x8BED;&#x53E5;&#xFF0C;&#x6216;&#x8005;&#x662F;&#x8868;&#x5185;&#x7684;&#x5B9E;&#x9645;&#x6570;&#x636E;&#xFF0C;&#x5982;mysqldump&#x548C;SELECT * INTO OUTFILE&#x7684;&#x65B9;&#x6CD5;&#xFF0C;&#x4E00;&#x822C;&#x9002;&#x7528;&#x4E8E;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5347;&#x7EA7;&#x548C;&#x8FC1;&#x79FB;&#xFF0C;&#x6062;&#x590D;&#x65F6;&#x95F4;&#x8F83;&#x957F;</p>
<p>&#x88F8;&#x6587;&#x4EF6;&#x5907;&#x4EFD;&#x2013;&gt;<br>&#x62F7;&#x8D1D;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7269;&#x7406;&#x6587;&#x4EF6;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x65E2;&#x53EF;&#x4EE5;&#x5904;&#x4E8E;&#x8FD0;&#x884C;&#x72B6;&#x6001;&#xFF08;mysqlhotcopy &#x3001;ibbackup&#x3001;xtrabackup&#x8FD9;&#x7C7B;&#x5DE5;&#x5177;&#xFF09;&#xFF0C;&#x4E5F;&#x53EF;&#x4EE5;&#x5904;&#x4E8E;&#x505C;&#x6B62;&#x72B6;&#x6001;&#xFF0C;&#x6062;&#x590D;&#x65F6;&#x95F4;&#x8F83;&#x77ED;&#x3002;</p>
<p>&#x6309;&#x7167;&#x5907;&#x4EFD;&#x6570;&#x636E;&#x5E93;&#x7684;&#x5185;&#x5BB9;&#x6765;&#x5206;&#xFF0C;&#x53C8;&#x53EF;&#x4EE5;&#x5206;&#x4E3A;&#xFF1A;<br>&#x5B8C;&#x5168;&#x5907;&#x4EFD;&#xFF1A;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x5B8C;&#x6574;&#x7684;&#x5907;&#x4EFD;<br>&#x589E;&#x91CF;&#x5907;&#x4EFD;&#xFF1A;&#x5728;&#x4E0A;&#x4E00;&#x6B21;&#x5B8C;&#x5168;&#x5907;&#x4EFD;&#x57FA;&#x7840;&#x4E0A;&#xFF0C;&#x5BF9;&#x66F4;&#x65B0;&#x7684;&#x6570;&#x636E;&#x8FDB;&#x884C;&#x5907;&#x4EFD;&#xFF08;xtrabackup&#xFF09;<br>&#x65E5;&#x5FD7;&#x5907;&#x4EFD;&#xFF1A;&#x4E8C;&#x8FDB;&#x5236;&#x65E5;&#x5FD7;&#x5907;&#x4EFD;&#xFF0C;&#x4E3B;&#x4ECE;&#x590D;&#x5236;</p>
<p>2)&#x903B;&#x8F91;&#x5907;&#x4EFD;&#x5DE5;&#x5177;mysqldump<br>&#x4F7F;&#x7528;&#x7684;&#x65F6;&#x5019;MySQL&#x5F53;&#x8981;&#x5BFC;&#x5165;&#x6216;&#x8005;&#x5BFC;&#x51FA;&#x6570;&#x636E;&#x91CF;&#x5927;&#x7684;&#x5E93;&#x7684;&#x65F6;&#x5019;,&#x7528;PHPMYADMIN&#x751A;&#x81F3;MySQL Administrator&#x8FD9;&#x4E9B;&#x5DE5;&#x5177;&#x90FD;&#x4F1A;&#x529B;&#x4E0D;&#x4ECE;&#x5FC3;,&#x8FD9;&#x65F6;&#x53EA;&#x80FD;&#x4F7F;&#x7528;MySQL&#x6240;&#x63D0;&#x4F9B;&#x7684;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;mysqldump&#x8FDB;&#x884C;&#x5907;&#x4EFD;&#x6062;&#x590D;&#xFF1B;&#x6570;&#x636E;&#x91CF;&#x5927;&#x7684;&#x65F6;&#x5019;&#x4E0D;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#xFF0C;&#x53EF;&#x652F;&#x6301;MyISAM,InnoDB</p>
<p>MySQL&#x6570;&#x636E;&#x7684;&#x5BFC;&#x51FA;&#x548C;&#x5BFC;&#x5165;&#x5DE5;&#x5177;: mysqldump</p>
<p>&#x5BFC;&#x51FA;&#x6570;&#x636E;&#xFF1A;<br>&#x8BED;&#x6CD5;&#xFF1A; mysqldump [TMPIONS] database [tables] &gt;&#x5BFC;&#x51FA;&#x7684;&#x6587;&#x4EF6;&#x540D;.sql</p>
<p>A:&#x5BFC;&#x51FA;&#x6240;&#x6709;&#x6570;&#x636E;&#x5E93;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -pJaking@vip.163.com -A &gt;all.sql</span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com --all-databases &gt;all2.sql</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x53C2;&#x6570;-A&#x4EE3;&#x8868;&#x6240;&#x6709;&#xFF0C;&#x7B49;&#x540C;&#x4E8E; &#x2013;all-databases</p>
<p>B:&#x5BFC;&#x51FA;&#x67D0;&#x4E2A;&#x6570;&#x636E;&#x5E93;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -u &#x7528;&#x6237;&#x540D; -p&#x5BC6;&#x7801; &#x6570;&#x636E;&#x5E93;&#x540D; &gt; &#x5BFC;&#x51FA;&#x7684;&#x6587;&#x4EF6;&#x540D;.sql&#xA0; </span><br><span class="line">mysqldump -uroot -pJaking@vip.163.com testdb &gt; testdb.sql</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>C:&#x5BFC;&#x51FA;&#x5355;&#x5F20;&#x8868;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -pJaking@vip.163.com testdb book1 &gt; testdb.book1.sql&#xA0; #&#x5BFC;&#x51FA;testdb&#x5E93;book1&#x8868;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>D:&#x5BFC;&#x51FA;&#x5E93;&#x7684;&#x8868;&#x7ED3;&#x6784;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -pJaking@vip.163.com -d testdb &gt; testdbtable.sql&#xA0; #&#x53EA;&#x5BFC;&#x51FA;testdb&#x5E93;&#x7684;&#x8868;&#x7ED3;&#x6784;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>E:&#x53EA;&#x5BFC;&#x51FA;&#x6570;&#x636E;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -pJaking@vip.163.com -t testdb &gt; testdbdata.sql&#xA0; #&#x53EA;&#x5BFC;&#x51FA;testdb&#x5E93;&#x4E2D;&#x7684;&#x6570;&#x636E;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>F:&#x5BFC;&#x51FA;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5E76;&#x81EA;&#x52A8;&#x751F;&#x6210;&#x5E93;&#x7684;&#x521B;&#x5EFA;&#x8BED;&#x53E5;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysqldump -uroot -pJaking@vip.163.com -B testdb &gt; testdb.sql  #&#x751F;&#x6210;&#x5EFA;&#x5E93;&#x8BED;&#x53E5;</span><br><span class="line">mysql -uroot -pJaking@vip.163.com &lt; testdb.sql  #&#x5BFC;&#x5165;&#x4E0D;&#x7528;&#x6307;&#x5B9A;&#x6570;&#x636E;&#x540D;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x5BFC;&#x5165;&#x6570;&#x636E;&#xFF1A;<br>A&#xFF1A;&#x5BFC;&#x5165;&#x6240;&#x6709;&#x6570;&#x636E;&#x5E93;</p>
<pre><code>mysql -uroot -pJaking@vip.163.com &lt; all.sql
</code></pre><p>B&#xFF1A;&#x5BFC;&#x5165;&#x6570;&#x636E;&#x5E93;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -pJaking@vip.163.com testdb &lt; testdb.sql&#xA0; #&#x5982;&#x679C;&#x5BFC;&#x5165;&#x65F6;&#xFF0C;&#x6CA1;&#x6709;&#x5BF9;&#x5E94;&#x7684;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x9700;&#x8981;&#x4F60;&#x624B;&#x52A8;&#x521B;&#x5EFA;&#x4E00;&#x4E0B;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>mysql&gt; create database testdb;</p>
<p>&#x4F7F;&#x7528;source&#x5BFC;&#x5165;<br>mysql&gt; drop database testdb;<br>mysql&gt; create database testdb;<br>mysql&gt; use testdb;<br>mysql&gt; source /tmp/testdb.sql</p>
<p>C:&#x5BFC;&#x5165;&#x8868;<br>mysql&gt; drop table testdb.book1;<br>mysql&gt; source /tmp/testdb.book1.sql;   #&#x5BFC;&#x5165;&#x8868;&#x65F6;&#xFF0C;&#x4E0D;&#x9700;&#x8981;&#x91CD;&#x65B0;&#x521B;&#x5EFA;&#x8868;&#xFF0C;&#x8981;&#x5148;&#x8FDB;&#x5230;&#x76F8;&#x5E94;&#x7684;&#x6570;&#x636E;&#x5E93;&#x4E2D;<br>mysql&gt; select * from testdb.book1;</p>
<p>D&#xFF1A;&#x5BFC;&#x5165;&#x8868;&#x7ED3;&#x6784;&#x548C;&#x6570;&#x636E;<br>mysql&gt; create database testdb;<br>mysql -uroot <a href="mailto:-pJaking@vip.163.com" target="_blank" rel="noopener">-pJaking@vip.163.com</a> testdb &lt; testdbtable.sql<br>mysql -uroot <a href="mailto:-pJaking@vip.163.com" target="_blank" rel="noopener">-pJaking@vip.163.com</a> testdb &lt; testdbdata.sql</p>
<p>mysqldump&#x8FDC;&#x7A0B;&#x5907;&#x4EFD;&#x4E0E;&#x6062;&#x590D;&#x6570;&#x636E;</p>
<p>&#x6587;&#x6863;&#xFF1A;10 mysqldump&#x8FDC;&#x7A0B;&#x5907;&#x4EFD;&#x4E0E;&#x6062;&#x590D;&#x6570;&#x636E;.md<br>&#x94FE;&#x63A5;&#xFF1A;<a href="http://note.youdao.com/noteshare?id=7af3e7cda297defe01228ed798e72c02&amp;sub=E2F44DF8E1BC4B9287EA434DEA3B670C" target="_blank" rel="noopener">http://note.youdao.com/noteshare?id=7af3e7cda297defe01228ed798e72c02&amp;sub=E2F44DF8E1BC4B9287EA434DEA3B670C</a></p>
<p>&#x8FDC;&#x7A0B;&#x5907;&#x4EFD;<br>mysqldump -h ip_addr -u db_user -p db_name &gt; file_name.sql<br>&#x8FDC;&#x7A0B;&#x6062;&#x590D;<br>mysql -h ip_addr -u db_user -p &lt; db_file.sql</p>
<p>3) mysqlhotcopy &#x88F8;&#x6587;&#x4EF6;&#x5907;&#x4EFD;    </p>
<p>&#x6CE8;&#x610F;&#xFF1A;5.7&#x7248;&#x672C;&#x5DF2;&#x7ECF;&#x53BB;&#x6389;&#x6B64;&#x547D;&#x4EE4;&#xFF0C;&#x8BF7;&#x5728;5.5&#x53CA;&#x4EE5;&#x4E0B;&#x7248;&#x672C;&#x6D4B;&#x8BD5;&#xFF01;<br>mysqlhotcopy&#x4F7F;&#x7528;lock tables&#x3001;flush tables&#x548C;cp&#x6216;scp&#x6765;&#x5FEB;&#x901F;&#x5907;&#x4EFD;&#x6570;&#x636E;&#x5E93;&#xFF0C;&#x5B83;&#x662F;&#x5907;&#x4EFD;&#x6570;&#x636E;&#x5E93;&#x6216;&#x5355;&#x4E2A;&#x8868;&#x6700;&#x5FEB;&#x7684;&#x9014;&#x5F84;,&#x5B8C;&#x5168;&#x5C5E;&#x4E8E;&#x7269;&#x7406;&#x5907;&#x4EFD;,&#x4F46;&#x53EA;&#x80FD;&#x7528;&#x4E8E;&#x5907;&#x4EFD;MyISAM&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#x548C;&#x8FD0;&#x884C;&#x5728;&#x6570;&#x636E;&#x5E93;&#x76EE;&#x5F55;&#x6240;&#x5728;&#x7684;&#x673A;&#x5668;&#x4E0A;&#xFF0C;&#x4E0E;mysqldump&#x5907;&#x4EFD;&#x4E0D;&#x540C;,mysqldump&#x5C5E;&#x4E8E;&#x903B;&#x8F91;&#x5907;&#x4EFD;,&#x6062;&#x590D;&#x65F6;&#x662F;&#x6267;&#x884C;&#x7684;sql&#x8BED;&#x53E5;&#x3002;</p>
<p>mysqlhotcopy&#x672C;&#x8D28;&#x662F;&#x4F7F;&#x7528;&#x9501;&#x8868;&#x8BED;&#x53E5;&#x540E;&#x518D;&#x4F7F;&#x7528;cp&#x6216;scp&#x62F7;&#x8D1D;&#x6570;&#x636E;&#x5E93;</p>
<p>1.&#x5B89;&#x88C5;mysqlhotcopy</p>
<p>yum provides mysqlhotcopy<br>yum install -y mariadb-server</p>
<p>2.&#x67E5;&#x770B;mysqlhotcopy&#x5E2E;&#x52A9;&#x4FE1;&#x606F;</p>
<p>mysqlhotcopy &#x2013;help<br>  &#x2013;allowold   don&#x2019;t abort if target dir already exists (rename it _old) &#x2013;&#x4E0D;&#x8986;&#x76D6;&#x4EE5;&#x524D;&#x5907;&#x4EFD;&#x7684;&#x6587;&#x4EF6;<br>  &#x2013;addtodest  don&#x2019;t rename target dir if it exists, just add files to it      &#x2013;&#x5C5E;&#x4E8E;&#x589E;&#x91CF;&#x5907;&#x4EFD;<br>  &#x2013;noindices   don&#x2019;t include full index files in copy          &#x2013;&#x4E0D;&#x5907;&#x4EFD;&#x7D22;&#x5F15;&#x6587;&#x4EF6;<br>  &#x2013;debug     enable debug                                 &#x2013;&#x542F;&#x7528;&#x8C03;&#x8BD5;&#x8F93;&#x51FA;<br>  &#x2013;regexp=#   copy all databases with names matching regexp  &#x2013;&#x4F7F;&#x7528;&#x6B63;&#x5219;&#x8868;&#x8FBE;&#x5F0F;<br>  &#x2013;checkpoint=#  insert checkpoint entry into specified db.table    &#x2013;&#x63D2;&#x5165;&#x68C0;&#x67E5;&#x70B9;&#x6761;&#x76EE;<br>  &#x2013;flushlog      flush logs once all tables are locked          &#x2013;&#x6240;&#x6709;&#x8868;&#x9501;&#x5B9A;&#x540E;&#x5237;&#x65B0;&#x65E5;&#x5FD7;<br>  &#x2013;resetmaster    reset the binlog once all tables are locked     &#x2013;&#x4E00;&#x65E6;&#x9501;&#x8868;&#x91CD;&#x7F6E;binlog&#x6587;&#x4EF6;<br>  &#x2013;resetslave  reset the master.info once all tables are locked  &#x2013;&#x4E00;&#x65E6;&#x9501;&#x8868;&#x91CD;&#x7F6E;master.info&#x6587;&#x4EF6; </p>
<p>&#x4E3E;&#x4F8B;&#x8BF4;&#x660E;&#xFF1A;<br>A&#xFF1A;&#x5907;&#x4EFD;&#x4E00;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x5230;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x4E2D;<br>mysqlhotcopy -u root -p <a href="mailto:Jaking@vip.163.com" target="_blank" rel="noopener">Jaking@vip.163.com</a> BOOK /tmp  #-u -p &#x540E;&#x9762;&#x90FD;&#x6709;&#x7A7A;&#x683C;</p>
<p>[root@jaking ~]# mysqlhotcopy -u root -p <a href="mailto:Jaking@vip.163.com" target="_blank" rel="noopener">Jaking@vip.163.com</a> BOOK /tmp<br>Flushed 1 tables with read lock (<code>BOOK</code>.<code>book</code>) in 0 seconds.<br>Locked 0 views () in 0 seconds.<br>Copying 2 files&#x2026;<br>Copying indices for 0 files&#x2026;<br>Unlocked tables.<br>mysqlhotcopy copied 1 tables (2 files) in 0 seconds (0 seconds overall).<br>[root@jaking ~]# ls /tmp<br>BOOK<br>[root@jaking ~]# ls /tmp/BOOK/<br>book.frm  db.opt</p>
<p>&#x5BF9;&#x6BD4;&#x4E0B;&#x5927;&#x5C0F;</p>
<p>[root@jaking ~]# du -sh /var/lib/mysql/BOOK/ /tmp/BOOK/<br>16K     /var/lib/mysql/BOOK/<br>16K     /tmp/BOOK/</p>
<p>B&#xFF1A;&#x5907;&#x4EFD;&#x591A;&#x4E2A;&#x6570;&#x636E;&#x5E93;&#x5230;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# rm -rf /tmp/*</span><br><span class="line">[root@jaking ~]# mysqlhotcopy -u root -p Jaking@vip.163.com BOOK mysql /tmp/</span><br><span class="line">mysqlhotcopy -u root -p Jaking@vip.163.com BOOK mysql /tmp/</span><br><span class="line">Flushed 23 tables with read lock (`BOOK`.`book`, `mysql`.`columns_priv`, `mysql`.`db`, `mysql`.`event`, `mysql`.`func`, `mysql`.`help_category`, `mysql`.`help_keyword`, `mysql`.`help_relation`, `mysql`.`help_topic`, `mysql`.`host`, `mysql`.`ndb_binlog_index`, `mysql`.`plugin`, `mysql`.`proc`, `mysql`.`procs_priv`, `mysql`.`proxies_priv`, `mysql`.`servers`, `mysql`.`tables_priv`, `mysql`.`time_zone`, `mysql`.`time_zone_leap_second`, `mysql`.`time_zone_name`, `mysql`.`time_zone_transition`, `mysql`.`time_zone_transition_type`, `mysql`.`user`) in 0 seconds.</span><br><span class="line">Locked 0 views () in 0 seconds.</span><br><span class="line">Copying 2 files...</span><br><span class="line">Copying indices for 0 files...</span><br><span class="line">Copying 72 files...</span><br><span class="line">Copying indices for 0 files...</span><br><span class="line">Unlocked tables.</span><br><span class="line">mysqlhotcopy copied 24 tables (74 files) in 0 seconds (0 seconds overall).</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# ls /tmp</span><br><span class="line">BOOK  mysql</span><br><span class="line">[root@jaking ~]# du -h /tmp </span><br><span class="line">0       /tmp/.X11-unix</span><br><span class="line">0       /tmp/.font-unix</span><br><span class="line">0       /tmp/.ICE-unix</span><br><span class="line">0       /tmp/.XIM-unix</span><br><span class="line">0       /tmp/.Test-unix</span><br><span class="line">16K     /tmp/BOOK</span><br><span class="line">1004K   /tmp/mysql</span><br><span class="line">1020K   /tmp</span><br><span class="line">[root@jaking ~]# du -h /var/lib/mysql/</span><br><span class="line">1004K   /var/lib/mysql/mysql</span><br><span class="line">212K    /var/lib/mysql/performance_schema</span><br><span class="line">16K     /var/lib/mysql/BOOK</span><br><span class="line">30M     /var/lib/mysql/</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>C&#xFF1A;&#x5907;&#x4EFD;&#x6570;&#x636E;&#x5E93;&#x4E2D;&#x7684;&#x67D0;&#x4E2A;&#x8868;<br>&#x8BED;&#x6CD5;&#xFF1A;mysqlhotcopy -u &#x7528;&#x6237; -p &#x5BC6;&#x7801; &#x6570;&#x636E;&#x5E93;&#x540D;./&#x8981;&#x5907;&#x4EFD;&#x7684;&#x8868;&#x540D;/  &#x8981;&#x5907;&#x4EFD;&#x7684;&#x8DEF;&#x5F84;</p>
<p>mysqlhotcopy -u root -p <a href="mailto:Jaking@vip.163.com" target="_blank" rel="noopener">Jaking@vip.163.com</a> BOOK./book/ /tmp/   #&#x6CE8;&#x610F;&#x6700;&#x540E;&#x7684; / &#x4E00;&#x5B9A;&#x8981;&#x6709;&#xFF01;<br>&#x5B9E;&#x9645;&#x4E0A;&#x662F;&#x628A;&#x5BF9;&#x5E94;&#x7684;&#x8868;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x5230;/tmp&#x76EE;&#x5F55;&#x4E0B;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# rm -rf *</span><br><span class="line">[root@jaking ~]# mysqlhotcopy -u root -p Jaking@vip.163.com BOOK./book/ /tmp/   Flushed 1 tables with read lock (`BOOK`.`book`) in 0 seconds.</span><br><span class="line">Locked 0 views () in 0 seconds.</span><br><span class="line">Copying 1 files...</span><br><span class="line">Copying indices for 0 files...</span><br><span class="line">Unlocked tables.</span><br><span class="line">mysqlhotcopy copied 1 tables (1 files) in 0 seconds (0 seconds overall).</span><br><span class="line">[root@jaking ~]# ls BOOK/</span><br><span class="line">book.frm</span><br><span class="line">[root@jaking ~]# ll /tmp/BOOK/</span><br><span class="line">total 12</span><br><span class="line">-rw-rw---- 1 mysql mysql 8624 Apr 22 14:31 book.frm</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>D:&#x6062;&#x590D;&#x6570;&#x636E;</p>
<p>&#x7834;&#x574F;&#x6570;&#x636E;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking tmp]# cd /var/lib/mysql/</span><br><span class="line">[root@jaking mysql]# ls</span><br><span class="line">aria_log.00000001  BOOK     ib_logfile0  mysql       performance_schema</span><br><span class="line">aria_log_control   ibdata1  ib_logfile1  mysql.sock</span><br><span class="line">[root@jaking mysql]# rm -rf BOOK/</span><br><span class="line">[root@jaking mysql]# ls</span><br><span class="line">aria_log.00000001  ibdata1      ib_logfile1  mysql.sock</span><br><span class="line">aria_log_control   ib_logfile0  mysql        performance_schema</span><br><span class="line">[root@jaking mysql]#</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 39</span><br><span class="line">Server version: 5.5.52-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">3 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(<span class="keyword">none</span>)]&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x5F00;&#x59CB;&#x6062;&#x590D;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking mysql]# cp -ra /tmp/BOOK/ /var/lib/mysql/</span><br><span class="line">[root@jaking mysql]# ll /var/lib/mysql/</span><br><span class="line">total 28700</span><br><span class="line">-rw-rw---- 1 mysql mysql    16384 Apr 22 14:29 aria_log.00000001</span><br><span class="line">-rw-rw---- 1 mysql mysql       52 Apr 22 14:29 aria_log_control</span><br><span class="line">drwxr-x--- 2 mysql mysql       22 Apr 22 14:53 BOOK</span><br><span class="line">-rw-rw---- 1 mysql mysql 18874368 Apr 22 14:53 ibdata1</span><br><span class="line">-rw-rw---- 1 mysql mysql  5242880 Apr 22 14:53 ib_logfile0</span><br><span class="line">-rw-rw---- 1 mysql mysql  5242880 Apr 22 14:29 ib_logfile1</span><br><span class="line">drwx------ 2 mysql mysql     4096 Apr 22 14:29 mysql</span><br><span class="line">srwxrwxrwx 1 mysql mysql        0 Apr 22 14:29 mysql.sock</span><br><span class="line">drwx------ 2 mysql mysql     4096 Apr 22 14:29 performance_schema</span><br><span class="line">[root@jaking mysql]# chown -Rf mysql:mysql /var/lib/mysql/BOOK/</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">Welcome to the MariaDB monitor.  Commands end with ; or \g.</span><br><span class="line">Your MariaDB connection id is 40</span><br><span class="line">Server version: 5.5.52-MariaDB MariaDB Server</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2016, Oracle, MariaDB Corporation Ab and others.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">MariaDB [(none)]&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [(<span class="keyword">none</span>)]&gt; <span class="keyword">use</span> BOOK;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">MariaDB [BOOK]&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| Tables_in_BOOK |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| book           |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [BOOK]&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">MariaDB [BOOK]&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x603B;&#x7ED3;&#xFF1A;<br>mysqldump&#x548C;mysqlhotcopy&#x7684;&#x6BD4;&#x8F83;&#xFF1A;<br>1&#x3001;mysqldump &#x662F;&#x91C7;&#x7528;SQL&#x7EA7;&#x522B;&#x7684;&#x5907;&#x4EFD;&#x673A;&#x5236;&#xFF0C;&#x5B83;&#x5C06;&#x6570;&#x636E;&#x8868;&#x5BFC;&#x6210; SQL &#x811A;&#x672C;&#x6587;&#x4EF6;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x5927;&#x65F6;&#xFF0C;&#x5360;&#x7528;&#x7CFB;&#x7EDF;&#x8D44;&#x6E90;&#x8F83;&#x591A;&#xFF0C;&#x652F;&#x6301;&#x5E38;&#x7528;&#x7684;MyISAM&#xFF0C;Innodb<br>2&#x3001;mysqlhotcopy&#x53EA;&#x662F;&#x7B80;&#x5355;&#x7684;&#x7F13;&#x5B58;&#x5199;&#x5165;&#x548C;&#x6587;&#x4EF6;&#x590D;&#x5236;&#x7684;&#x8FC7;&#x7A0B;&#xFF0C;&#x5360;&#x7528;&#x8D44;&#x6E90;&#x548C;&#x5907;&#x4EFD;&#x901F;&#x5EA6;&#x6BD4;mysqldump&#x5FEB;&#x5F88;&#x591A;&#xFF1B;&#x7279;&#x522B;&#x9002;&#x5408;&#x5927;&#x7684;&#x6570;&#x636E;&#x5E93;<br>3&#x3001;mysqlhotcopy&#x53EA;&#x80FD;&#x8FD0;&#x884C;&#x5728;&#x6570;&#x636E;&#x5E93;&#x6570;&#x636E;&#x76EE;&#x5F55;&#x6240;&#x5728;&#x7684;&#x673A;&#x5668;&#x4E0A;&#xFF0C;mysqldump&#x53EF;&#x4EE5;&#x7528;&#x5728;&#x8FDC;&#x7A0B;&#x5BA2;&#x6237;&#x7AEF;<br>4&#x3001;&#x76F8;&#x540C;&#x7684;&#x5730;&#x65B9;&#x90FD;&#x662F;&#x5728;&#x7EBF;&#x6267;&#x884C;LOCK TABLES &#x4EE5;&#x53CA; UNLOCK TABLES<br>5&#x3001;mysqlhotcopy&#x6062;&#x590D;&#x53EA;&#x9700;&#x8981;COPY&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x5230;&#x6E90;&#x76EE;&#x5F55;&#x8986;&#x76D6;&#x5373;&#x53EF;&#xFF0C;mysqldump&#x9700;&#x8981;&#x5BFC;&#x5165;SQL&#x6587;&#x4EF6;&#x5230;&#x539F;&#x6765;&#x5E93;&#x4E2D;</p>
<p>&#x5B9E;&#x6218;&#xFF1A;&#x5199;&#x4E2A;&#x81EA;&#x52A8;&#x5907;&#x4EFD;MySQL&#x6570;&#x636E;&#x5E93;shell&#x811A;&#x672C;<br>vim  mysql-autoback.sh </p>
<p>#!/bin/bash<br>export LANG=en_US.UTF-8<br>mkdir /database_back &amp;&gt;/dev/null<br>savedir=/database_back<br>cd &#x201C;$savedir&#x201D;<br>time=&#x201D;$(date +&#x201D;%Y-%m-%d&#x201D;)&#x201D;<br>mysqldump -u root <a href="mailto:-pJaking@vip.163.com" target="_blank" rel="noopener">-pJaking@vip.163.com</a> book &gt; book-&#x201C;$time&#x201D;.sql  </p>
<p>&#x518D;&#x6DFB;&#x52A0;&#x8BA1;&#x5212;&#x4EFB;&#x52A1; crontab &#x5C31;&#x884C;</p>
<p>xtrabackup&#x5907;&#x4EFD;&#x5DE5;&#x5177;&#x4F7F;&#x7528;</p>
<p>1&#x3001;xtrabackup&#x7B80;&#x4ECB;</p>
<p>Xtrabackup&#x5305;&#x62EC;&#x4E24;&#x4E2A;&#x4E3B;&#x8981;&#x5DE5;&#x5177;&#xFF1A;Xtrabackup&#x548C;innobackupex&#xFF1A;<br>Xtrabackup&#x53EA;&#x80FD;&#x5907;&#x4EFD;InnoDB&#x548C;XtraDB&#x4E24;&#x79CD;&#x5F15;&#x64CE;&#x8868;&#xFF0C;&#x800C;&#x4E0D;&#x80FD;&#x5907;&#x4EFD;MyISAM&#x6570;&#x636E;&#x8868;</p>
<p>&#x6211;&#x4EEC;&#x77E5;&#x9053;&#xFF0C;&#x9488;&#x5BF9;InnoDB&#x5B58;&#x50A8;&#x5F15;&#x64CE;&#xFF0C;MySQL&#x672C;&#x8EAB;&#x6CA1;&#x6709;&#x63D0;&#x4F9B;&#x5408;&#x9002;&#x7684;&#x70ED;&#x5907;&#x5DE5;&#x5177;&#xFF0C;ibbackup&#x867D;&#x662F;&#x4E00;&#x6B3E;&#x9AD8;&#x6548;&#x7684;&#x9996;&#x9009;&#x70ED;&#x5907;&#x65B9;&#x5F0F;&#xFF0C;&#x4F46;&#x5B83;&#x662F;&#x662F;&#x6536;&#x8D39;&#x7684;&#x3002;&#x597D;&#x5728;Percona&#x516C;&#x53F8;&#x7ED9;&#x5927;&#x5BB6;&#x63D0;&#x4F9B;&#x4E86;&#x4E00;&#x4E2A;&#x5F00;&#x6E90;&#x3001;&#x514D;&#x8D39;&#x7684;Xtrabackup&#x70ED;&#x5907;&#x5DE5;&#x5177;&#xFF0C;&#x5B83;&#x53EF;&#x5B9E;&#x73B0;ibbackup&#x7684;&#x6240;&#x6709;&#x529F;&#x80FD;&#xFF0C;&#x5E76;&#x4E14;&#x8FD8;&#x6269;&#x5C55;&#x652F;&#x6301;&#x771F;&#x6B63;&#x7684;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x529F;&#x80FD;&#xFF0C;&#x662F;&#x5546;&#x4E1A;&#x5907;&#x4EFD;&#x5DE5;&#x5177;InnoDB Hotbackup&#x7684;&#x4E00;&#x4E2A;&#x5F88;&#x597D;&#x7684;&#x66FF;&#x4EE3;&#x54C1;&#x3002;</p>
<p>2&#x3001;Percona-XtraBackup &#x5B89;&#x88C5; &#xFF08;mysql5.7.20&#x9700;&#x5B89;&#x88C5;XtraBackup2.4.9&#xFF09;</p>
<p>&#x4E0B;&#x8F7D;&#x5B89;&#x88C5;&#x5305;<br> [root@jaking ~]# wget <a href="https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.9/binary/redhat/7/x86_64/Percona-XtraBackup-2.4.9-ra467167cdd4-el7-x86_64-bundle.tar" target="_blank" rel="noopener">https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.9/binary/redhat/7/x86_64/Percona-XtraBackup-2.4.9-ra467167cdd4-el7-x86_64-bundle.tar</a> </p>
<p>&#x89E3;&#x538B;&#x5305;<br>[root@jaking ~]# tar -xvf Percona-XtraBackup-2.4.9-ra467167cdd4-el7-x86_64-bundle.tar </p>
<p>yum&#x5B89;&#x88C5;&#x5E76;&#x89E3;&#x51B3;&#x4F9D;&#x8D56;&#xFF1A;<br>yum -y localinstall percona-xtrabackup-24-2.4.9-1.el7.x86_64.rpm </p>
<p>&#x6216;&#x8005;<br>yum install -y <a href="https://repo.percona.com/yum/percona-release-latest.noarch.rpm" target="_blank" rel="noopener">https://repo.percona.com/yum/percona-release-latest.noarch.rpm</a></p>
<p>&#x6216;&#x8005;<br>rpm -ivh percona-release-latest.noarch.rpm</p>
<p>yum install -y percona-xtrabackup-24.x86_64</p>
<p>&#x5982;&#x679C;&#x51FA;&#x73B0;&#x4EE5;&#x4E0B;&#x62A5;&#x9519;&#xFF1A;<br>Error: Package: percona-xtrabackup-24-2.4.22-1.el7.x86_64 (percona-release-x86_64)<br>           Requires: libev.so.4()(64bit)</p>
<p>&#x89E3;&#x51B3;&#x65B9;&#x6CD5;&#xFF1A;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# wget ftp://rpmfind.net/linux/atrpms/el6-x86_64/atrpms/stable/libev-4.04-2.el6.x86_64.rpm</span><br><span class="line">[root@jaking ~]# rpm -ivh libev-4.04-2.el6.x86_64.rpm </span><br><span class="line">[root@jaking ~]# rz</span><br><span class="line">rz waiting to receive.</span><br><span class="line">&#xA0;zmodem trl+C &#x221;</span><br><span class="line"></span><br><span class="line"><span class="meta">&#xA0; 100%</span><span class="bash">&#xA0;&#xA0;&#xA0; 7805 KB 7805 KB/s 00:00:01&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; 0 Errors2.4.22-1.el7.x86_64.rpm...</span></span><br><span class="line"> </span><br><span class="line">[root@jaking ~]# ls -hl</span><br><span class="line">total 7.7M</span><br><span class="line">-rw-r--r--&#xA0; 1 root root&#xA0; 38K May 13 09:36 libev-4.04-2.el6.x86_64.rpm</span><br><span class="line">-rwxr-xr-x. 1 root root&#xA0; 937 Apr 23 03:57 named.sh</span><br><span class="line">-rw-r--r--&#xA0; 1 root root 7.7M Mar 10 04:56 percona-xtrabackup-24-2.4.22-1.el7.x86_64.rpm</span><br><span class="line"></span><br><span class="line">&#x6216;&#x8005;</span><br><span class="line">[root@jaking ~]# yum install -y percona-xtrabackup #&#x5907;&#x9009;&#x65B9;&#x6848;</span><br><span class="line"></span><br><span class="line">&#x6216;&#x8005;</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# rpm -ivh mysql-community-libs-compat-5.7.20-1.el7.x86_64.rpm</span><br><span class="line">[root@jaking ~]# yum install -y cmake gcc gcc-c++ libaio libaio-devel automake autoconf bzr rsync</span><br><span class="line">[root@jaking ~]# yum  install -y perl perl-devel libaio libaio-devel perl-Time-HiRes perl-DBD-MySQL  perl-Digest-MD5</span><br><span class="line">[root@jaking ~]# rpm -ivh percona-xtrabackup-24-2.4.22-1.el7.x86_64.rpm</span><br><span class="line">Preparing...&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0;&#xA0; ################################# [100%]</span><br><span class="line">Updating / installing...</span><br><span class="line">&#xA0;&#xA0; 1:percona-xtrabackup-24-2.4.22-1.el################################# [100%]</span><br><span class="line">[root@jaking ~]# which xtrabackup</span><br><span class="line">/usr/bin/xtrabackup</span><br><span class="line">[root@jaking ~]# xtrabackup --version</span><br><span class="line">xtrabackup: recognized server arguments: --datadir=/var/lib/mysql </span><br><span class="line">xtrabackup version 2.4.22 based on MySQL server 5.7.32 Linux (x86_64) (revision id: c99a781)</span><br><span class="line"></span><br><span class="line">&#x6CE8;&#x610F;&#xFF1A;my.cnf&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#x91CC;datadir&#x6307;&#x5B9A;&#x7684;MySQL&#x6570;&#x636E;&#x8DEF;&#x5F84;</span><br><span class="line"></span><br><span class="line">[root@jaking ~]#cat /etc/my.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">datadir=/var/lib/mysql</span><br><span class="line">socket=/var/lib/mysql/mysql.sock</span><br><span class="line">symbolic-links=0</span><br><span class="line"></span><br><span class="line">log-error=/var/log/mysqld.log</span><br><span class="line">pid-file=/var/run/mysqld/mysqld.pid</span><br><span class="line">skip-name-resolve</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# systemctl restart mysqld</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><span style="color:orange">fnaichu:</span><br>&#x5148;&#x5B89;&#x88C5;epel&#x6E90;<br>yum install -y epel-release</p>
<p>&#x5B89;&#x88C5;MySQL&#xFF0C;&#x786E;&#x4FDD;&#x81F3;&#x5C11;&#x5B89;&#x88C5;&#x6709;&#x4EE5;&#x4E0B;5&#x4E2A;&#x5305;&#xFF1A;</p>
<p>&#x5B89;&#x88C5;xtrabackup:<br>&#x53C2;&#x8003;&#x5B98;&#x65B9;&#x6587;&#x6863;&#xFF1A;<a href="https://docs.percona.com/percona-xtrabackup/2.4/installation/yum_repo.html" target="_blank" rel="noopener">https://docs.percona.com/percona-xtrabackup/2.4/installation/yum_repo.html</a></p>
<p>&#x5B89;&#x88C5;xtrabackup&#x4F9D;&#x8D56;&#x5305;<br>yum install <a href="https://repo.percona.com/yum/percona-release-latest.noarch.rpm" target="_blank" rel="noopener">https://repo.percona.com/yum/percona-release-latest.noarch.rpm</a></p>
<p>&#x4E0B;&#x8F7D;xtrabackup&#x5B89;&#x88C5;&#x5305;<br>wget <a href="https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.4/\" target="_blank" rel="noopener">https://www.percona.com/downloads/XtraBackup/Percona-XtraBackup-2.4.4/\</a><br>binary/redhat/7/x86_64/percona-xtrabackup-24-2.4.4-1.el7.x86_64.rpm</p>
<p>&#x5B89;&#x88C5;xtrabackup<br>yum localinstall percona-xtrabackup-24-2.4.4-1.el7.x86_64.rpm</p>
<p>3&#x3001;xtrbackup&#x4F7F;&#x7528;<br>&#x4E00;&#x822C;&#x4F7F;&#x7528;innobackupex&#x811A;&#x672C;<br>innobackupex&#x662F;perl&#x811A;&#x672C;&#x5BF9;xtrabackup&#x7684;&#x5C01;&#x88C5;&#x548C;&#x529F;&#x80FD;&#x6269;&#x5C55;</p>
<p>&#x5907;&#x4EFD;&#x51C6;&#x5907;&#x5DE5;&#x4F5C;&#xFF1A;<br>&#x6743;&#x9650;&#x548C;&#x8FDE;&#x63A5;<br>xtrabackup&#x9700;&#x8981;&#x8FDE;&#x63A5;&#x5230;&#x6570;&#x636E;&#x5E93;&#x548C;datadir&#x64CD;&#x4F5C;&#x6743;&#x9650;<br>xtrabackup&#x6216;&#x8005;innobackupex&#x5728;&#x4F7F;&#x7528;&#x8FC7;&#x7A0B;&#x4E2D;&#x6D89;&#x53CA;&#x5230;&#x4E24;&#x7C7B;&#x7528;&#x6237;&#x6743;&#x9650;</p>
<p>1.&#x7CFB;&#x7EDF;&#x7528;&#x6237;&#xFF0C;&#x7528;&#x6765;&#x8C03;&#x7528;innobackupex&#x6216;&#x8005;xtrabackup</p>
<p>2.&#x6570;&#x636E;&#x5E93;&#x7528;&#x6237;&#xFF0C;&#x6570;&#x636E;&#x5E93;&#x5185;&#x4F7F;&#x7528;&#x7684;&#x7528;&#x6237;</p>
<pre><code>&#x5176;&#x4ED6;&#x8FDE;&#x63A5;&#x9009;&#x9879;&#xFF1A;
</code></pre><p>| &#x70B9;&#x51FB;&#x8FD9;&#x91CC; | &#x70B9;&#x51FB;&#x8FD9;&#x91CC; |<br>|    Tmpion<br>    |    Description<br>    |<br>|   &#x2013;port<br>   |   The port to use when connecting to the database   server with TCP/IP.<br>   |<br>|   &#x2013;socket<br>   |   The socket to use when   connecting to the local database.<br>   |<br>|   &#x2013;host<br>   |   The host to use when connecting   to the database server with TCP/IP.<br>   |</p>
<p>&#x53EF;&#x4EE5;&#x5355;&#x72EC;&#x521B;&#x5EFA;&#x7528;&#x6765;&#x5907;&#x4EFD;&#x6570;&#x636E;&#x5E93;&#x7684;&#x7528;&#x6237;&#xFF0C;&#x5B89;&#x5168;&#xFF0C;&#x5E76;&#x8D4B;&#x4E88;&#x5BF9;&#x5E94;&#x7684;&#x6743;&#x9650;</p>
<p>4&#x3001;&#x5168;&#x5907;&#x548C;&#x5168;&#x5907;&#x8FD8;&#x539F;</p>
<p>&#x4F7F;&#x7528;innobackupex&#x521B;&#x5EFA;&#x5168;&#x5907;</p>
<p>&#x521B;&#x5EFA;&#x5168;&#x5907;&#xFF1A;<br>innobackupex &#x2013;user=root <a href="mailto:--password=Jaking@vip.163.com" target="_blank" rel="noopener">--password=Jaking@vip.163.com</a> /tmp/db_backup/<br>innobackupex &#x2013;user=root <a href="mailto:--password=Jaking@vip.163.com" target="_blank" rel="noopener">--password=Jaking@vip.163.com</a> /tmp/db_backup/ &amp;&gt;&gt;/tmp/db_backup.log<br>&amp;&gt;&gt;/tmp/db_backup.log   #&#x4E0D;&#x663E;&#x793A;&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#xFF0C;&#x8F93;&#x51FA;&#x4FE1;&#x606F;&#x91CD;&#x5B9A;&#x5411;&#x5230;db_backup.log</p>
<p>[root@jaking ~]# ls /tmp<br>db_backup  db_backup.log  percona-version-check<br>[root@jaking ~]# ls /tmp/db_backup<br>2021-05-14_08-08-38<br>[root@jaking ~]# ls /tmp/db_backup/2021-05-14_08-08-38/<br>backup-my.cnf   ibdata1             sys                     xtrabackup_info<br>book1           market              testbookdb              xtrabackup_logfile<br>book2           mysql               testdb<br>ib_buffer_pool  performance_schema  xtrabackup_checkpoints </p>
<p>&#x5185;&#x90E8;&#x673A;&#x5236;&#xFF1A;&#x5728;&#x5907;&#x4EFD;&#x7684;&#x65F6;&#x5019;innobackupex&#x4F1A;&#x8C03;&#x7528;xtrabackup&#x6765;&#x5907;&#x4EFD;innodb&#x8868;&#xFF0C;&#x5E76;&#x590D;&#x5236;&#x6240;&#x6709;&#x7684;&#x8868;&#x5B9A;&#x4E49;&#xFF0C;&#x5176;&#x4ED6;&#x5F15;&#x64CE;&#x7684;&#x8868;(MyISAM,MERGE,CSV,ARCHIVE)<br>innobackupex&#x662F;&#x4E00;&#x4E2A;&#x5C01;&#x88C5;&#x4E86;xtrabackup&#x7684;&#x811A;&#x672C;&#xFF0C;&#x80FD;&#x540C;&#x65F6;&#x5904;&#x7406;innodb&#x548C;myisam&#xFF0C;&#x4F46;&#x5728;&#x5904;&#x7406;myisam&#x65F6;&#x9700;&#x8981;&#x52A0;&#x4E00;&#x4E2A;&#x8BFB;&#x9501;</p>
<p>&#x5176;&#x4ED6;&#x9009;&#x9879;:<br>&#x2013;no-timestamp&#xFF0C;&#x6307;&#x5B9A;&#x4E86;&#x8FD9;&#x4E2A;&#x9009;&#x9879;&#x5907;&#x4EFD;&#x4F1A;&#x76F4;&#x63A5;&#x5907;&#x4EFD;&#x5728;BACKUP-DIR&#xFF0C;&#x4E0D;&#x518D;&#x521B;&#x5EFA;&#x65F6;&#x95F4;&#x6233;&#x6587;&#x4EF6;&#x5939;<br>&#x2013;default-file&#xFF0C;&#x6307;&#x5B9A;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x7528;&#x6765;&#x914D;&#x7F6E;innobackupex&#x7684;&#x9009;&#x9879;&#xFF0C;&#x8BE5;&#x9009;&#x9879;&#x6307;&#x5B9A;&#x4E86;&#x4ECE;&#x54EA;&#x4E2A;&#x6587;&#x4EF6;&#x8BFB;&#x53D6;MySQL&#x914D;&#x7F6E;</p>
<p>innobackupex &#x2013;user=root <a href="mailto:--password=Jaking@vip.163.com" target="_blank" rel="noopener">--password=Jaking@vip.163.com</a> &#x2013;no-timestamp /tmp/db_backup/full (&#x4F7F;&#x7528;&#x2013;no-timestamp&#x65F6;&#xFF0C;&#x540E;&#x9762;&#x7684;&#x8FD9;&#x4E2A;full&#x76EE;&#x5F55;&#x5FC5;&#x987B;&#x8DDF;&#x4E0A;&#x4E14;&#x4E0D;&#x80FD;&#x63D0;&#x524D;&#x81EA;&#x5DF1;&#x5EFA;&#x7ACB;&#xFF0C;&#x5B83;&#x7531;innobackupex&#x81EA;&#x52A8;&#x5EFA;&#x7ACB;&#xFF0C;&#x5426;&#x5219;&#x53EF;&#x80FD;&#x4F1A;&#x62A5;&#x9519;innobackupex: Error: Failed to create backup directory) (Errcode: 17 - File exists)</p>
<p>[root@jaking ~]# innobackupex &#x2013;default-file=/etc/my.cnf &#x2013;user=root <a href="mailto:--password=Jaking@vip.163.com" target="_blank" rel="noopener">--password=Jaking@vip.163.com</a> &#x2013;no-timestamp /tmp/db_backup/full<br>[root@jaking ~]# ls /tmp/db_backup/<br>full</p>
<p>&#x4F7F;&#x7528;innobackupex&#x8FD8;&#x539F;&#x5907;&#x4EFD;</p>
<p>&#x4F7F;&#x7528;innobackupex &#x2013;copy-back &#x6765;&#x8FD8;&#x539F;&#x5907;&#x4EFD;</p>
<p>&#x505C;&#x6B62;MySQL&#x670D;&#x52A1;</p>
<p>systemctl stop mysqld</p>
<p>&#x5220;&#x9664;&#x6570;&#x636E;&#xFF1A;&#xFF08;&#x5371;&#x9669;&#x52A8;&#x4F5C;&#xFF09;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# systemctl stop mysqld</span><br><span class="line">[root@jaking ~]# ls /var/lib/mysql</span><br><span class="line">auto.cnf    client-cert.pem  ib_logfile0         private_key.pem  sys</span><br><span class="line">BOOK        client-key.pem   ib_logfile1         public_key.pem   testbookdb</span><br><span class="line">ca-key.pem  ib_buffer_pool   mysql               server-cert.pem</span><br><span class="line">ca.pem      ibdata1          performance_schema  server-key.pem</span><br><span class="line">[root@jaking ~]# rm -rf /var/lib/mysql/*</span><br><span class="line">[root@jaking ~]# ls /var/lib/mysql</span><br><span class="line"></span><br><span class="line">&#x8FD8;&#x539F;:</span><br><span class="line">[root@jaking ~]# innobackupex --copy-back /tmp/db_backup/full/&#xA0;</span><br><span class="line">[root@jaking ~]# ls /var/lib/mysql</span><br><span class="line">BOOK            ibdata1  performance_schema  testbookdb</span><br><span class="line">ib_buffer_pool  mysql    sys                 xtrabackup_info</span><br><span class="line"> </span><br><span class="line">&#x67E5;&#x770B;&#x6743;&#x9650;</span><br><span class="line">[root@jaking ~]# ll /var/lib/mysql</span><br><span class="line">total 12324</span><br><span class="line">drwxr-x--- 2 root root       52 Apr 23 04:53 BOOK</span><br><span class="line">-rw-r----- 1 root root      310 Apr 23 04:53 ib_buffer_pool</span><br><span class="line">-rw-r----- 1 root root 12582912 Apr 23 04:53 ibdata1</span><br><span class="line">drwxr-x--- 2 root root     4096 Apr 23 04:53 mysql</span><br><span class="line">drwxr-x--- 2 root root     8192 Apr 23 04:53 performance_schema</span><br><span class="line">drwxr-x--- 2 root root     8192 Apr 23 04:53 sys</span><br><span class="line">drwxr-x--- 2 root root       88 Apr 23 04:53 testbookdb</span><br><span class="line">-rw-r----- 1 root root      472 Apr 23 04:53 xtrabackup_info</span><br><span class="line"></span><br><span class="line">&#x91CD;&#x65B0;&#x6388;&#x6743;</span><br><span class="line">[root@jaking ~]# chown -Rf mysql:mysql /var/lib/mysql&#xA0;&#xA0; #&#x8981;&#x4E0D;&#x7136;MySQL&#x670D;&#x52A1;&#x4E0D;&#x80FD;&#x542F;&#x52A8;</span><br><span class="line">[root@jaking ~]# ll /var/lib/mysql                   </span><br><span class="line">total 12324</span><br><span class="line">drwxr-x--- 2 mysql mysql       52 Apr 23 04:53 BOOK</span><br><span class="line">-rw-r----- 1 mysql mysql      310 Apr 23 04:53 ib_buffer_pool</span><br><span class="line">-rw-r----- 1 mysql mysql 12582912 Apr 23 04:53 ibdata1</span><br><span class="line">drwxr-x--- 2 mysql mysql     4096 Apr 23 04:53 mysql</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 23 04:53 performance_schema</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 23 04:53 sys</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 23 04:53 testbookdb</span><br><span class="line">-rw-r----- 1 mysql mysql      472 Apr 23 04:53 xtrabackup_info</span><br><span class="line">[root@jaking ~]# systemctl start mysqld</span><br><span class="line"></span><br><span class="line">&#x6CE8;&#xFF1A;datadir&#x5FC5;&#x987B;&#x662F;&#x4E3A;&#x7A7A;&#x7684;&#xFF0C;innobackupex &#x2013;copy-back&#x4E0D;&#x4F1A;&#x8986;&#x76D6;&#x5DF2;&#x5B58;&#x5728;&#x7684;&#x6587;&#x4EF6;&#xFF0C;&#x8FD8;&#x8981;&#x6CE8;&#x610F;&#xFF0C;&#x8FD8;&#x539F;&#x65F6;&#x9700;&#x8981;&#x5148;&#x5173;&#x95ED;&#x670D;&#x52A1;&#xFF0C;&#x5982;&#x679C;&#x670D;&#x52A1;&#x662F;&#x542F;&#x52A8;&#x7684;&#xFF0C;&#x90A3;&#x4E48;&#x5C31;&#x4E0D;&#x80FD;&#x8FD8;&#x539F;&#x5230;datadir</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# ls /var/lib/mysql</span><br><span class="line">auto.cnf  mysql  performance_schema  sys</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# innobackupex --copy-back /tmp/db_backup/full/</span><br><span class="line">xtrabackup: recognized server arguments: --datadir=/var/lib/mysql </span><br><span class="line">xtrabackup: recognized client arguments: </span><br><span class="line">220423 05:01:30 innobackupex: Starting the copy-back operation</span><br><span class="line"></span><br><span class="line">IMPORTANT: Please check that the copy-back run completes successfully.</span><br><span class="line">           At the end of a successful copy-back run innobackupex</span><br><span class="line">           prints &quot;completed OK!&quot;.</span><br><span class="line"></span><br><span class="line">innobackupex version 2.4.22 based on MySQL server 5.7.32 Linux (x86_64) (revision id: c99a781)</span><br><span class="line">Original data directory /var/lib/mysql is not empty!</span><br><span class="line"></span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.7.20 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testbookdb         |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> BOOK;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| Tables_in_BOOK |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| book           |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">1 row in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> testbookdb;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">| Tables_in_testbookdb |</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">| book1                |</span><br><span class="line">| book2                |</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book1;</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">| bTypeId | bName                             | price | publishing            |</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">|       1 | &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;             |    66 | &#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       2 | &#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;                    |    68 | &#x4EBA;&#x6C11;&#x90AE;&#x7535;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       3 | &#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;            |    90 | &#x673A;&#x68B0;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       4 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;                   |    71 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       5 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL2&#x300B;                  |    72 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       6 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL3&#x300B;                  |    73 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       7 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL4&#x300B;                  |    74 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       8 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL5&#x300B;                  |    75 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       9 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL6&#x300B;                  |    76 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      10 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL7&#x300B;                  |    77 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      11 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL8&#x300B;                  |    78 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      12 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL9&#x300B;                  |    79 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book2;</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">| name                              | price | pages |</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">| &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;             |    30 |   666 |</span><br><span class="line">| &#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;                    |    60 |   666 |</span><br><span class="line">| &#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;            |    80 |   666 |</span><br><span class="line">| &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;                   |   166 |   666 |</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>5&#xFF1A;&#x521B;&#x5EFA;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x4E0E;&#x8FD8;&#x539F;<br>&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x4F5C;&#x7528;&#xFF1A;&#x51CF;&#x5C11;&#x5907;&#x4EFD;&#x6570;&#x636E;&#x91CD;&#x590D;&#xFF0C;&#x8282;&#x7701;&#x78C1;&#x76D8;&#x7A7A;&#x95F4;&#xFF0C;&#x7F29;&#x77ED;&#x5907;&#x4EFD;&#x65F6;&#x95F4;<br>&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x7684;&#x5B9E;&#x73B0;&#xFF0C;&#x4F9D;&#x8D56;&#x4E8E;innodb&#x9875;&#x4E0A;&#x9762;&#x7684;LSN&#xFF08;log sequence number&#xFF09;&#xFF0C;&#x6BCF;&#x6B21;&#x5BF9;&#x6570;&#x636E;&#x5E93;&#x7684;&#x4FEE;&#x6539;&#x90FD;&#x4F1A;&#x5BFC;&#x81F4;LSN&#x81EA;&#x589E;&#xFF0C;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x4F1A;&#x590D;&#x5236;&#x6307;&#x5B9A;LSN&lt;&#x65E5;&#x5FD7;&#x5E8F;&#x5217;&#x53F7;&gt;&#x4E4B;&#x540E;&#x7684;&#x6240;&#x6709;&#x6570;&#x636E;&#x9875;</p>
<p>&#x521B;&#x5EFA;&#x589E;&#x91CF;&#x5907;&#x4EFD;</p>
<ol>
<li>&#x9996;&#x5148;&#x521B;&#x5EFA;&#x5168;&#x5907;<br>&#x5728;&#x521B;&#x5EFA;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x4E4B;&#x524D;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x5168;&#x5907;&#xFF0C;&#x4E0D;&#x7136;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x662F;&#x6CA1;&#x6709;&#x610F;&#x4E49;&#x7684;<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">innobackupex --user=root --password=Jaking@vip.163.com /tmp/db_backup/</span><br><span class="line">[root@jaking ~]# ls /tmp</span><br><span class="line">db_backup&#xA0; percona-version-check</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/</span><br><span class="line">2022-04-24_21-23-58</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>&#x63D2;&#x5165;&#x4E00;&#x4E9B;&#x6570;&#x636E;&#x5230;&#x8868;&#x91CC;&#x9762;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 7</span><br><span class="line">Server version: 5.7.20 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testbookdb         |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">6 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> TESTDB;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="keyword">use</span> TESTDB;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TABLE1 (bTypeId <span class="built_in">int</span>,bName <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,publishing <span class="built_in">char</span>(<span class="number">16</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;1&apos;</span>,<span class="string">&apos;Linux&apos;</span>,<span class="string">&apos;66&apos;</span>,<span class="string">&apos;DZ&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;2&apos;</span>,<span class="string">&apos;CLD&apos;</span>,<span class="string">&apos;68&apos;</span>,<span class="string">&apos;RM&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;3&apos;</span>,<span class="string">&apos;SYS&apos;</span>,<span class="string">&apos;90&apos;</span>,<span class="string">&apos;JX&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;4&apos;</span>,<span class="string">&apos;MySQL1&apos;</span>,<span class="string">&apos;71&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;5&apos;</span>,<span class="string">&apos;MySQL2&apos;</span>,<span class="string">&apos;72&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;6&apos;</span>,<span class="string">&apos;MySQL3&apos;</span>,<span class="string">&apos;73&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;7&apos;</span>,<span class="string">&apos;MySQL4&apos;</span>,<span class="string">&apos;74&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;8&apos;</span>,<span class="string">&apos;MySQL5&apos;</span>,<span class="string">&apos;75&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;9&apos;</span>,<span class="string">&apos;MySQL6&apos;</span>,<span class="string">&apos;76&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;10&apos;</span>,<span class="string">&apos;MySQL7&apos;</span>,<span class="string">&apos;77&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;11&apos;</span>,<span class="string">&apos;MySQL8&apos;</span>,<span class="string">&apos;78&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;12&apos;</span>,<span class="string">&apos;MySQL9&apos;</span>,<span class="string">&apos;79&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TABLE2 (<span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,pages <span class="built_in">int</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;Linux&apos;</span>,<span class="string">&apos;30&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;CLD&apos;</span>,<span class="string">&apos;60&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;SYS&apos;</span>,<span class="string">&apos;80&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;MySQL1&apos;</span>,<span class="string">&apos;166&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> TABLE1;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> TABLE2;</span><br><span class="line"></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| Tables_in_TESTDB |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| TABLE1           |</span><br><span class="line">| TABLE2           |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE1;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">|       6 | MySQL3 |    73 | QH         |</span><br><span class="line">|       7 | MySQL4 |    74 | QH         |</span><br><span class="line">|       8 | MySQL5 |    75 | QH         |</span><br><span class="line">|       9 | MySQL6 |    76 | QH         |</span><br><span class="line">|      10 | MySQL7 |    77 | QH         |</span><br><span class="line">|      11 | MySQL8 |    78 | QH         |</span><br><span class="line">|      12 | MySQL9 |    79 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE2;</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| name   | price | pages |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| Linux  |    30 |   666 |</span><br><span class="line">| CLD    |    60 |   666 |</span><br><span class="line">| SYS    |    80 |   666 |</span><br><span class="line">| MySQL1 |   166 |   666 |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| TESTDB             |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testbookdb         |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></tbody></table></figure>
<ol start="2">
<li>&#x4F7F;&#x7528; &#x2013;incremental&#x521B;&#x5EFA;&#x589E;&#x91CF;&#x5907;&#x4EFD;<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">innobackupex --user=root --password=Jaking@vip.163.com --incremental /&#x589E;&#x91CF;1&#x8DEF;&#x5F84; --incremental-basedir=&#x5168;&#x5907;&#x8DEF;&#x5F84;&#xFF0C;&#x6307;&#x5B9A;&#x5728;&#x54EA;&#x4E2A;&#x5168;&#x5907;&#x4E0A;&#x8FDB;&#x884C;&#x589E;&#x91CF;&#x5907;&#x4EFD;</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/</span><br><span class="line">2021-05-14_08-33-57</span><br><span class="line">[root@jaking ~]#&#xA0;innobackupex --user=root --password=Jaking@vip.163.com --incremental /tmp/db_backup/ --incremental-basedir=/tmp/db_backup/2022-04-24_21-23-58/</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/</span><br><span class="line">2022-04-24_21-23-58  2022-04-24_21-31-38</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/2022-04-24_21-23-58/</span><br><span class="line">backup-my.cnf   mysql               xtrabackup_checkpoints</span><br><span class="line">BOOK            performance_schema  xtrabackup_info</span><br><span class="line">ib_buffer_pool  sys                 xtrabackup_logfile</span><br><span class="line">ibdata1         testbookdb</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/2022-04-24_21-31-38/</span><br><span class="line">backup-my.cnf   mysql               xtrabackup_checkpoints</span><br><span class="line">BOOK            performance_schema  xtrabackup_info</span><br><span class="line">ib_buffer_pool  sys                 xtrabackup_logfile</span><br><span class="line">ibdata1.delta   testbookdb</span><br><span class="line">ibdata1.meta    TESTDB</span><br><span class="line">[root@jaking ~]# du -sh /tmp/db_backup/2022-04-24_21-23-58/</span><br><span class="line">26M     /tmp/db_backup/2022-04-24_21-23-58/</span><br><span class="line">[root@jaking ~]# du -sh /tmp/db_backup/2022-04-24_21-31-38/ </span><br><span class="line">5.1M    /tmp/db_backup/2022-04-24_21-31-38/</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>&#x518D;&#x67E5;&#x770B;LSN&lt;&#x65E5;&#x5FD7;&#x5E8F;&#x5217;&#x53F7;&gt;<br>[root@jaking ~]# cat /tmp/db_backup/2022-04-24_21-23-58/xtrabackup_checkpoints<br>backup_type = full-backuped<br>from_lsn = 0<br>to_lsn = 2566100<br>last_lsn = 2566109<br>compact = 0<br>recover_binlog_info = 0<br>flushed_lsn = 2566109</p>
<p>[root@jaking ~]# cat /tmp/db_backup/2022-04-24_21-31-38/xtrabackup_checkpoints<br>backup_type = incremental<br>from_lsn = 2566100<br>to_lsn = 2588592<br>last_lsn = 2588601<br>compact = 0<br>recover_binlog_info = 0<br>flushed_lsn = 2588601</p>
<ol start="3">
<li>&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x521B;&#x5EFA;&#x7684;&#x66FF;&#x4EE3;&#x65B9;&#x6CD5;<br>&#x53EF;&#x4EE5;&#x4F7F;&#x7528;&#x6307;&#x5B9A; &#x2013;incremental-lsn&#x6765;&#x4EE3; &#x2013;incremental-basedir&#x7684;&#x65B9;&#x6CD5;&#x521B;&#x5EFA;&#x589E;&#x91CF;&#x5907;&#x4EFD;<br>innobackupex &#x2013;user=root <a href="mailto:--password=Jaking@vip.163.com" target="_blank" rel="noopener">--password=Jaking@vip.163.com</a> &#x2013;incremental /tmp/db_backup/ &#x2013;incremental-lsn=&lt;&#x65E5;&#x5FD7;&#x5E8F;&#x5217;&#x53F7;&gt;  #&#x4ECE;&#x8FD9;&#x4E2A;&#x7F16;&#x53F7;&#x70B9;&#x5F00;&#x59CB;&#x5907;&#x4EFD;<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# ls /tmp/db_backup/</span><br><span class="line">2022-04-24_21-23-58  2022-04-24_21-31-38</span><br><span class="line">[root@jaking ~]# innobackupex --user=root --password=Jaking@vip.163.com --incremental /tmp/db_backup/ --incremental-lsn=2566109</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/</span><br><span class="line">2022-04-24_21-23-58  2022-04-24_21-31-38  2022-04-24_21-41-49</span><br><span class="line">[root@jaking ~]# du -sh /tmp/db_backup/2022-04-24_21-23-58</span><br><span class="line">26M     /tmp/db_backup/2022-04-24_21-23-58</span><br><span class="line">[root@jaking ~]# du -sh /tmp/db_backup/2022-04-24_21-31-38</span><br><span class="line">5.1M    /tmp/db_backup/2022-04-24_21-31-38</span><br><span class="line">[root@jaking ~]# du -sh /tmp/db_backup/2022-04-24_21-41-49</span><br><span class="line">5.1M    /tmp/db_backup/2022-04-24_21-41-49</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>&#x6CE8;&#x610F;&#xFF1A;xtrabackup&#x53EA;&#x4F1A;&#x5F71;&#x54CD;xtradb&#x6216;&#x8005;innodb&#x7684;&#x8868;&#xFF0C;&#x5176;&#x4ED6;&#x5F15;&#x64CE;&#x7684;&#x8868;&#x5728;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x7684;&#x65F6;&#x5019;&#x53EA;&#x4F1A;&#x590D;&#x5236;&#x6574;&#x4E2A;&#x6587;&#x4EF6;</p>
<p>&#x8FD8;&#x539F;</p>
<p>&#x505C;&#x6B62;MySQL&#x670D;&#x52A1;,&#x5220;&#x9664;&#x6570;&#x636E; rm -rf /var/lib/mysql/* </p>
<p>&#x8FD8;&#x539F;&#x589E;&#x91CF;&#x5907;&#x4EFD;<br>&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x7684;&#x6062;&#x590D;&#x6BD4;&#x5168;&#x5907;&#x8981;&#x590D;&#x6742;&#x4E00;&#x70B9;&#xFF0C;&#x7B2C;&#x4E00;&#x6B65;&#x662F;&#x5728;&#x6240;&#x6709;&#x5907;&#x4EFD;&#x76EE;&#x5F55;&#x4E0B;&#x91CD;&#x505A;&#x5DF2;&#x63D0;&#x4EA4;&#x7684;&#x65E5;&#x5FD7;&#xFF0C;&#x5982;&#xFF1A;<br>innobackupex &#x2013;apply-log &#x2013;redo-only BASE-DIR  </p>
<p>innobackupex &#x2013;apply-log &#x2013;redo-only BASE-DIR &#x2013;incremental-dir=INCREMENTAL-DIR-1<br>innobackupex &#x2013;apply-log &#x2013;redo-only BASE-DIR &#x2013;incremental-dir=INCREMENTAL-DIR-2<br>&#x2026;<br>&#x2026;<br>&#x2026;<br>innobackupex &#x2013;apply-log BASE-DIR &#x2013;incremental-dir=INCREMENTAL-DIR-last-num</p>
<p>&#x6CE8;&#x610F;&#xFF1A;&#x5982;&#x679C;&#x4EC5;&#x6709;&#x4E00;&#x4EFD;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#xFF0C;&#x7B2C;3&#x6761;&#x8BED;&#x53E5;&#x5FFD;&#x7565;<br>&#x5176;&#x4E2D;BASE-DIR&#x662F;&#x6307;&#x5168;&#x5907;&#x76EE;&#x5F55;&#xFF0C;INCREMENTAL-DIR-1&#x662F;&#x6307;&#x7B2C;&#x4E00;&#x6B21;&#x7684;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#xFF0C;INCREMENTAL-DIR-2&#x662F;&#x6307;&#x7B2C;&#x4E8C;&#x6B21;&#x7684;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#xFF0C;&#x4EE5;&#x6B64;&#x7C7B;&#x63A8;&#x3002;</p>
<p>&#x8FD9;&#x91CC;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#xFF1A;&#x6700;&#x540E;&#x4E00;&#x6B65;&#x7684;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x5E76;&#x6CA1;&#x6709;&#x2013;redo-only&#x9009;&#x9879;&#xFF01;</p>
<p>&#x4EE5;&#x4E0A;&#x8BED;&#x53E5;&#x6267;&#x884C;&#x6210;&#x529F;&#x4E4B;&#x540E;&#xFF0C;&#x6700;&#x7EC8;&#x6570;&#x636E;&#x5728;BASE-DIR&#xFF08;&#x5373;&#x5168;&#x5907;&#x76EE;&#x5F55;&#xFF09;&#x4E0B;</p>
<p>&#x7B2C;&#x4E00;&#x6B65;&#x5B8C;&#x6210;&#x4E4B;&#x540E;&#xFF0C;&#x6211;&#x4EEC;&#x5F00;&#x59CB;&#x7B2C;&#x4E8C;&#x6B65;&#xFF1A;&#x56DE;&#x6EDA;&#x672A;&#x5B8C;&#x6210;&#x7684;&#x65E5;&#x5FD7;&#xFF1A;<br>innobackupex &#x2013;apply-log BASE-DIR</p>
<p>&#x4E0A;&#x9762;&#x6267;&#x884C;&#x5B8C;&#x4E4B;&#x540E;&#xFF0C;BASE-DIR&#x91CC;&#x7684;&#x5907;&#x4EFD;&#x6587;&#x4EF6;&#x5DF2;&#x5B8C;&#x5168;&#x51C6;&#x5907;&#x5C31;&#x7EEA;&#xFF0C;&#x6700;&#x540E;&#x4E00;&#x6B65;&#x662F;&#x62F7;&#x8D1D;&#xFF1A;<br>innobackupex &#x2013;copy-back BASE-DIR</p>
<p>&#x6062;&#x590D;mysql&#x6743;&#x9650; chown -Rf mysql:mysql /var/lib/mysql/</p>
<p>&#x6700;&#x540E;&#x542F;&#x52A8; systemctl start mysqld </p>
<p>&#x68C0;&#x9A8C;&#x6570;&#x636E;&#x662F;&#x5426;&#x6062;&#x590D;&#x6B63;&#x5E38;<br>&#x6CE8;&#x610F;&#xFF1A;innobackupex&#x8FD8;&#x539F;&#x589E;&#x91CF;&#x5907;&#x4EFD;&#x5BB9;&#x6613;&#x51FA;&#x9519;&#xFF0C;&#x4E0D;&#x5EFA;&#x8BAE;&#x4F7F;&#x7528;&#xFF01;</p>
<p>&#x5B9E;&#x6218;&#xFF1A;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line">[root@jaking ~]# ls /var/lib/mysql</span><br><span class="line">auto.cnf        ibdata1      mysql               testbookdb</span><br><span class="line">BOOK            ib_logfile0  performance_schema  TESTDB</span><br><span class="line">ib_buffer_pool  ib_logfile1  sys                 xtrabackup_info</span><br><span class="line">[root@jaking ~]# mkdir /mysql-all-data</span><br><span class="line">[root@jaking ~]# mv /var/lib/mysql/* /mysql-all-data/</span><br><span class="line">[root@jaking ~]# ls /var/lib/mysql                   </span><br><span class="line">[root@jaking ~]# ls /mysql-all-data/</span><br><span class="line">auto.cnf        ibdata1      mysql               testbookdb</span><br><span class="line">BOOK            ib_logfile0  performance_schema  TESTDB</span><br><span class="line">ib_buffer_pool  ib_logfile1  sys                 xtrabackup_info</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/</span><br><span class="line">2022-04-24_21-23-58  2022-04-24_21-31-38  2022-04-24_21-41-49</span><br><span class="line">[root@jaking ~]# rm -rf /tmp/db_backup/2022-04-24_21-41-49</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/                       </span><br><span class="line">2022-04-24_21-23-58  2022-04-24_21-31-38</span><br><span class="line">[root@jaking ~]# innobackupex --apply-log --redo-only /tmp/db_backup/2022-04-24_21-23-58</span><br><span class="line">[root@jaking ~]# innobackupex --apply-log /tmp/db_backup/2022-04-24_21-23-58 --incremental-dir=/tmp/db_backup/2022-04-24_21-31-38</span><br><span class="line">fnaich:&#xFF01;&#x589E;&#x91CF;&#x5408;&#x5E76;&#x5FC5;&#x987B;&#x4F7F;&#x7528;&#x7EDD;&#x5BF9;&#x8DEF;&#x5F84;&#xFF0C;&#x5426;&#x5219;&#x62A5;&#x9519;</span><br><span class="line">[root@jaking ~]# ls /tmp/db_backup/2022-04-24_21-23-58/</span><br><span class="line">backup-my.cnf   ib_logfile0  performance_schema  xtrabackup_checkpoints</span><br><span class="line">BOOK            ib_logfile1  sys                 xtrabackup_info</span><br><span class="line">ib_buffer_pool  ibtmp1       testbookdb          xtrabackup_logfile</span><br><span class="line">ibdata1         mysql        TESTDB              xtrabackup_master_key_id</span><br><span class="line">[root@jaking ~]# innobackupex --apply-log /tmp/db_backup/2022-04-24_21-23-58/</span><br><span class="line">[root@jaking ~]# innobackupex --copy-back /tmp/db_backup/2022-04-24_21-23-58/</span><br><span class="line">[root@jaking ~]# chown -Rf mysql:mysql /var/lib/mysql/</span><br><span class="line">[root@jaking ~]# ll /var/lib/mysql/</span><br><span class="line">total 122920</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 24 21:59 BOOK</span><br><span class="line">-rw-r----- 1 mysql mysql      315 Apr 24 21:59 ib_buffer_pool</span><br><span class="line">-rw-r----- 1 mysql mysql 12582912 Apr 24 21:59 ibdata1</span><br><span class="line">-rw-r----- 1 mysql mysql 50331648 Apr 24 21:59 ib_logfile0</span><br><span class="line">-rw-r----- 1 mysql mysql 50331648 Apr 24 21:59 ib_logfile1</span><br><span class="line">-rw-r----- 1 mysql mysql 12582912 Apr 24 21:59 ibtmp1</span><br><span class="line">drwxr-x--- 2 mysql mysql     4096 Apr 24 21:59 mysql</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 24 21:59 performance_schema</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 24 21:59 sys</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 24 21:59 testbookdb</span><br><span class="line">drwxr-x--- 2 mysql mysql       92 Apr 24 21:59 TESTDB</span><br><span class="line">-rw-r----- 1 mysql mysql      504 Apr 24 21:59 xtrabackup_info</span><br><span class="line">-rw-r----- 1 mysql mysql        1 Apr 24 21:59 xtrabackup_master_key_id</span><br><span class="line">[root@jaking ~]# systemctl start mysqld</span><br><span class="line">[root@jaking ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.7.20 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| TESTDB             |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testbookdb         |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> BOOK;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| Tables_in_BOOK |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| book           |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> testbookdb;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">| Tables_in_testbookdb |</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">| book1                |</span><br><span class="line">| book2                |</span><br><span class="line">+<span class="comment">----------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book1;</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">| bTypeId | bName                             | price | publishing            |</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">|       1 | &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;             |    66 | &#x7535;&#x5B50;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       2 | &#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;                    |    68 | &#x4EBA;&#x6C11;&#x90AE;&#x7535;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       3 | &#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;            |    90 | &#x673A;&#x68B0;&#x5DE5;&#x4E1A;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       4 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;                   |    71 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       5 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL2&#x300B;                  |    72 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       6 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL3&#x300B;                  |    73 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       7 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL4&#x300B;                  |    74 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       8 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL5&#x300B;                  |    75 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|       9 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL6&#x300B;                  |    76 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      10 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL7&#x300B;                  |    77 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      11 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL8&#x300B;                  |    78 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">|      12 | &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL9&#x300B;                  |    79 | &#x6E05;&#x534E;&#x5927;&#x5B66;&#x51FA;&#x7248;&#x793E;        |</span><br><span class="line">+<span class="comment">---------+-----------------------------------+-------+-----------------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book2;</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">| name                              | price | pages |</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">| &#x300A;Linux&#x4ECE;&#x5165;&#x95E8;&#x5230;&#x7CBE;&#x901A;&#x300B;             |    30 |   666 |</span><br><span class="line">| &#x300A;&#x4E91;&#x8BA1;&#x7B97;&#x8D8B;&#x52BF;&#x300B;                    |    60 |   666 |</span><br><span class="line">| &#x300A;&#x64CD;&#x4F5C;&#x7CFB;&#x7EDF;&#x8BBE;&#x8BA1;&#x4E0E;&#x5B9E;&#x73B0;&#x300B;            |    80 |   666 |</span><br><span class="line">| &#x300A;&#x9AD8;&#x6027;&#x80FD;MySQL&#x300B;                   |   166 |   666 |</span><br><span class="line">+<span class="comment">-----------------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> TESTDB;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| Tables_in_TESTDB |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| TABLE1           |</span><br><span class="line">| TABLE2           |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE1;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">|       6 | MySQL3 |    73 | QH         |</span><br><span class="line">|       7 | MySQL4 |    74 | QH         |</span><br><span class="line">|       8 | MySQL5 |    75 | QH         |</span><br><span class="line">|       9 | MySQL6 |    76 | QH         |</span><br><span class="line">|      10 | MySQL7 |    77 | QH         |</span><br><span class="line">|      11 | MySQL8 |    78 | QH         |</span><br><span class="line">|      12 | MySQL9 |    79 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE2;</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| name   | price | pages |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| Linux  |    30 |   666 |</span><br><span class="line">| CLD    |    60 |   666 |</span><br><span class="line">| SYS    |    80 |   666 |</span><br><span class="line">| MySQL1 |   166 |   666 |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></tbody></table></figure>
<p>&#x62D3;&#x5C55;&#xFF1A;&#x8FD8;&#x539F;&#x6570;&#x636E;<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[root@server12 ~]# rm -rf /tmp/db_backup/*</span><br><span class="line">[root@server12 ~]# innobackupex --default-file=/etc/my.cnf --user=root --password=Jaking@vip.163.com --no-timestamp /tmp/db_backup/all-mysql-data</span><br><span class="line">[root@server12 ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 5</span><br><span class="line">Server version: 5.7.20 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure><p></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| TESTDB             |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testbookdb         |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">DATABASE</span> TESTDB666;</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">databases</span>;</span><br><span class="line"><span class="keyword">use</span> TESTDB666;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TABLE1 (bTypeId <span class="built_in">int</span>,bName <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,publishing <span class="built_in">char</span>(<span class="number">16</span>));</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;1&apos;</span>,<span class="string">&apos;Linux&apos;</span>,<span class="string">&apos;66&apos;</span>,<span class="string">&apos;DZ&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;2&apos;</span>,<span class="string">&apos;CLD&apos;</span>,<span class="string">&apos;68&apos;</span>,<span class="string">&apos;RM&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;3&apos;</span>,<span class="string">&apos;SYS&apos;</span>,<span class="string">&apos;90&apos;</span>,<span class="string">&apos;JX&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;4&apos;</span>,<span class="string">&apos;MySQL1&apos;</span>,<span class="string">&apos;71&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;5&apos;</span>,<span class="string">&apos;MySQL2&apos;</span>,<span class="string">&apos;72&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;6&apos;</span>,<span class="string">&apos;MySQL3&apos;</span>,<span class="string">&apos;73&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;7&apos;</span>,<span class="string">&apos;MySQL4&apos;</span>,<span class="string">&apos;74&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;8&apos;</span>,<span class="string">&apos;MySQL5&apos;</span>,<span class="string">&apos;75&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;9&apos;</span>,<span class="string">&apos;MySQL6&apos;</span>,<span class="string">&apos;76&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;10&apos;</span>,<span class="string">&apos;MySQL7&apos;</span>,<span class="string">&apos;77&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;11&apos;</span>,<span class="string">&apos;MySQL8&apos;</span>,<span class="string">&apos;78&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE1(bTypeId,bName,price,publishing) <span class="keyword">VALUES</span>(<span class="string">&apos;12&apos;</span>,<span class="string">&apos;MySQL9&apos;</span>,<span class="string">&apos;79&apos;</span>,<span class="string">&apos;QH&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> TABLE2 (<span class="keyword">name</span> <span class="built_in">char</span>(<span class="number">16</span>),price <span class="built_in">int</span>,pages <span class="built_in">int</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;Linux&apos;</span>,<span class="string">&apos;30&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;CLD&apos;</span>,<span class="string">&apos;60&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;SYS&apos;</span>,<span class="string">&apos;80&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"><span class="keyword">INSERT</span> <span class="keyword">INTO</span> TABLE2(<span class="keyword">name</span>,price,pages) <span class="keyword">VALUES</span>(<span class="string">&apos;MySQL1&apos;</span>,<span class="string">&apos;166&apos;</span>,<span class="string">&apos;666&apos;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> TABLE1;</span><br><span class="line"><span class="keyword">select</span> * <span class="keyword">from</span> TABLE2;</span><br><span class="line"></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+<span class="comment">---------------------+</span></span><br><span class="line">| Tables_in_TESTDB666 |</span><br><span class="line">+<span class="comment">---------------------+</span></span><br><span class="line">| TABLE1              |</span><br><span class="line">| TABLE2              |</span><br><span class="line">+<span class="comment">---------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE1;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">|       6 | MySQL3 |    73 | QH         |</span><br><span class="line">|       7 | MySQL4 |    74 | QH         |</span><br><span class="line">|       8 | MySQL5 |    75 | QH         |</span><br><span class="line">|       9 | MySQL6 |    76 | QH         |</span><br><span class="line">|      10 | MySQL7 |    77 | QH         |</span><br><span class="line">|      11 | MySQL8 |    78 | QH         |</span><br><span class="line">|      12 | MySQL9 |    79 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE2;</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| name   | price | pages |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| Linux  |    30 |   666 |</span><br><span class="line">| CLD    |    60 |   666 |</span><br><span class="line">| SYS    |    80 |   666 |</span><br><span class="line">| MySQL1 |   166 |   666 |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; </span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">[root@server12 ~]# innobackupex --user=root --password=Jaking@vip.163.com --no-timestamp --incremental /tmp/db_backup/incremental-mysql-data --incremental-basedir=/tmp/db_backup/all-mysql-data/</span><br><span class="line">[root@server12 ~]# ls /tmp/db_backup/</span><br><span class="line">all-mysql-data  incremental-mysql-data</span><br><span class="line">[root@server12 ~]# du -sh /tmp/db_backup/all-mysql-data/</span><br><span class="line">27M     /tmp/db_backup/all-mysql-data/</span><br><span class="line">[root@server12 ~]# du -sh /tmp/db_backup/incremental-mysql-data/</span><br><span class="line">4.8M    /tmp/db_backup/incremental-mysql-data/</span><br><span class="line"></span><br><span class="line">[root@server12 ~]# systemctl stop mysqld</span><br><span class="line">[root@server12 ~]# rm -rf /var/lib/mysql/*</span><br><span class="line">[root@server12 ~]# ls /tmp/db_backup/all-mysql-data/</span><br><span class="line">backup-my.cnf   ibdata1             sys         xtrabackup_checkpoints</span><br><span class="line">BOOK            mysql               testbookdb  xtrabackup_info</span><br><span class="line">ib_buffer_pool  performance_schema  TESTDB      xtrabackup_logfile</span><br><span class="line">[root@server12 ~]# ls /tmp/db_backup/incremental-mysql-data/</span><br><span class="line">backup-my.cnf   mysql               TESTDB666</span><br><span class="line">BOOK            performance_schema  xtrabackup_checkpoints</span><br><span class="line">ib_buffer_pool  sys                 xtrabackup_info</span><br><span class="line">ibdata1.delta   testbookdb          xtrabackup_logfile</span><br><span class="line">ibdata1.meta    TESTDB</span><br><span class="line">[root@server12 ~]# cp -ra /tmp/db_backup/incremental-mysql-data/TESTDB666 /tmp/db_backup/all-mysql-data/</span><br><span class="line">[root@server12 ~]# cp -ra /tmp/db_backup/incremental-mysql-data/ibdata1* /tmp/db_backup/all-mysql-data/</span><br><span class="line">[root@server12 ~]# ls /tmp/db_backup/all-mysql-data/</span><br><span class="line">backup-my.cnf   ibdata1.delta       sys         xtrabackup_checkpoints</span><br><span class="line">BOOK            ibdata1.meta        testbookdb  xtrabackup_info</span><br><span class="line">ib_buffer_pool  mysql               TESTDB      xtrabackup_logfile</span><br><span class="line">ibdata1         performance_schema  TESTDB666</span><br><span class="line">[root@server12 ~]# ls /tmp/db_backup/incremental-mysql-data/</span><br><span class="line">backup-my.cnf   mysql               TESTDB666</span><br><span class="line">BOOK            performance_schema  xtrabackup_checkpoints</span><br><span class="line">ib_buffer_pool  sys                 xtrabackup_info</span><br><span class="line">ibdata1.delta   testbookdb          xtrabackup_logfile</span><br><span class="line">ibdata1.meta    TESTDB</span><br><span class="line">[root@server12 ~]# innobackupex --copy-back /tmp/db_backup/all-mysql-data/</span><br><span class="line">[root@server12 ~]# ll /var/lib/mysql</span><br><span class="line">total 13912</span><br><span class="line">drwxr-x--- 2 root root       88 Apr 24 22:26 BOOK</span><br><span class="line">-rw-r----- 1 root root      315 Apr 24 22:26 ib_buffer_pool</span><br><span class="line">-rw-r----- 1 root root 12582912 Apr 24 22:26 ibdata1</span><br><span class="line">-rw-r----- 1 root root  1622016 Apr 24 22:26 ibdata1.delta</span><br><span class="line">-rw-r----- 1 root root       60 Apr 24 22:26 ibdata1.meta</span><br><span class="line">drwxr-x--- 2 root root     4096 Apr 24 22:26 mysql</span><br><span class="line">drwxr-x--- 2 root root     8192 Apr 24 22:26 performance_schema</span><br><span class="line">drwxr-x--- 2 root root     8192 Apr 24 22:26 sys</span><br><span class="line">drwxr-x--- 2 root root       88 Apr 24 22:26 testbookdb</span><br><span class="line">drwxr-x--- 2 root root       92 Apr 24 22:26 TESTDB</span><br><span class="line">drwxr-x--- 2 root root      150 Apr 24 22:26 TESTDB666</span><br><span class="line">-rw-r----- 1 root root      482 Apr 24 22:26 xtrabackup_info</span><br><span class="line">[root@server12 ~]# chown -Rf mysql:mysql /var/lib/mysql</span><br><span class="line">[root@server12 ~]# ll /var/lib/mysql                   </span><br><span class="line">total 13912</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 24 22:26 BOOK</span><br><span class="line">-rw-r----- 1 mysql mysql      315 Apr 24 22:26 ib_buffer_pool</span><br><span class="line">-rw-r----- 1 mysql mysql 12582912 Apr 24 22:26 ibdata1</span><br><span class="line">-rw-r----- 1 mysql mysql  1622016 Apr 24 22:26 ibdata1.delta</span><br><span class="line">-rw-r----- 1 mysql mysql       60 Apr 24 22:26 ibdata1.meta</span><br><span class="line">drwxr-x--- 2 mysql mysql     4096 Apr 24 22:26 mysql</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 24 22:26 performance_schema</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 24 22:26 sys</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 24 22:26 testbookdb</span><br><span class="line">drwxr-x--- 2 mysql mysql       92 Apr 24 22:26 TESTDB</span><br><span class="line">drwxr-x--- 2 mysql mysql      150 Apr 24 22:26 TESTDB666</span><br><span class="line">-rw-r----- 1 mysql mysql      482 Apr 24 22:26 xtrabackup_info</span><br><span class="line">[root@server12 ~]# systemctl start mysqld</span><br><span class="line">[root@server12 ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.7.20 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| TESTDB             |</span><br><span class="line">| TESTDB666          |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testbookdb         |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">8 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> BOOK;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| Tables_in_BOOK |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| book           |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> TESTDB666;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">---------------------+</span></span><br><span class="line">| Tables_in_TESTDB666 |</span><br><span class="line">+<span class="comment">---------------------+</span></span><br><span class="line">| TABLE1              |</span><br><span class="line">| TABLE2              |</span><br><span class="line">+<span class="comment">---------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE1;</span><br><span class="line">ERROR 1146 (42S02): Table &apos;TESTDB666.TABLE1&apos; doesn&apos;t exist</span><br><span class="line">mysql&gt; select * from TABLE2;</span><br><span class="line">ERROR 1146 (42S02): Table &apos;TESTDB666.TABLE2&apos; doesn&apos;t exist</span><br><span class="line">mysql&gt; use TESTDB;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| Tables_in_TESTDB |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| TABLE1           |</span><br><span class="line">| TABLE2           |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE1;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">|       6 | MySQL3 |    73 | QH         |</span><br><span class="line">|       7 | MySQL4 |    74 | QH         |</span><br><span class="line">|       8 | MySQL5 |    75 | QH         |</span><br><span class="line">|       9 | MySQL6 |    76 | QH         |</span><br><span class="line">|      10 | MySQL7 |    77 | QH         |</span><br><span class="line">|      11 | MySQL8 |    78 | QH         |</span><br><span class="line">|      12 | MySQL9 |    79 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE2;</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| name   | price | pages |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| Linux  |    30 |   666 |</span><br><span class="line">| CLD    |    60 |   666 |</span><br><span class="line">| SYS    |    80 |   666 |</span><br><span class="line">| MySQL1 |   166 |   666 |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">[root@server12 ~]#</span><br><span class="line"></span><br><span class="line">[root@server12 ~]# ll /mysql-all-data/</span><br><span class="line">total 110632</span><br><span class="line">-rw-r----- 1 mysql mysql       56 Apr 23 05:15 auto.cnf</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 24 21:26 BOOK</span><br><span class="line">-rw-r----- 1 mysql mysql      343 Apr 24 21:51 ib_buffer_pool</span><br><span class="line">-rw-r----- 1 mysql mysql 12582912 Apr 24 21:51 ibdata1</span><br><span class="line">-rw-r----- 1 mysql mysql 50331648 Apr 24 21:51 ib_logfile0</span><br><span class="line">-rw-r----- 1 mysql mysql 50331648 Apr 23 05:15 ib_logfile1</span><br><span class="line">drwxr-x--- 2 mysql mysql     4096 Apr 23 05:14 mysql</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 23 05:14 performance_schema</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 23 05:14 sys</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 23 05:14 testbookdb</span><br><span class="line">drwxr-x--- 2 mysql mysql       92 Apr 24 21:28 TESTDB</span><br><span class="line">-rw-r----- 1 mysql mysql      472 Apr 23 05:14 xtrabackup_info</span><br><span class="line">[root@server12 ~]# systemctl stop mysqld</span><br><span class="line">[root@server12 ~]# rm -rf /var/lib/mysql/*</span><br><span class="line">[root@server12 ~]# mv /mysql-all-data/* /var/lib/mysql</span><br><span class="line">[root@server12 ~]# ll /var/lib/mysql</span><br><span class="line">total 110632</span><br><span class="line">-rw-r----- 1 mysql mysql       56 Apr 23 05:15 auto.cnf</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 24 21:26 BOOK</span><br><span class="line">-rw-r----- 1 mysql mysql      343 Apr 24 21:51 ib_buffer_pool</span><br><span class="line">-rw-r----- 1 mysql mysql 12582912 Apr 24 21:51 ibdata1</span><br><span class="line">-rw-r----- 1 mysql mysql 50331648 Apr 24 21:51 ib_logfile0</span><br><span class="line">-rw-r----- 1 mysql mysql 50331648 Apr 23 05:15 ib_logfile1</span><br><span class="line">drwxr-x--- 2 mysql mysql     4096 Apr 23 05:14 mysql</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 23 05:14 performance_schema</span><br><span class="line">drwxr-x--- 2 mysql mysql     8192 Apr 23 05:14 sys</span><br><span class="line">drwxr-x--- 2 mysql mysql       88 Apr 23 05:14 testbookdb</span><br><span class="line">drwxr-x--- 2 mysql mysql       92 Apr 24 21:28 TESTDB</span><br><span class="line">-rw-r----- 1 mysql mysql      472 Apr 23 05:14 xtrabackup_info</span><br><span class="line">[root@server12 ~]# systemctl start mysqld</span><br><span class="line">[root@server12 ~]# mysql -uroot -pJaking@vip.163.com</span><br><span class="line">mysql: [Warning] Using a password on the command line interface can be insecure.</span><br><span class="line">Welcome to the MySQL monitor.  Commands end with ; or \g.</span><br><span class="line">Your MySQL connection id is 3</span><br><span class="line">Server version: 5.7.20 MySQL Community Server (GPL)</span><br><span class="line"></span><br><span class="line">Copyright (c) 2000, 2017, Oracle and/or its affiliates. All rights reserved.</span><br><span class="line"></span><br><span class="line">Oracle is a registered trademark of Oracle Corporation and/or its</span><br><span class="line">affiliates. Other names may be trademarks of their respective</span><br><span class="line">owners.</span><br><span class="line"></span><br><span class="line">Type &apos;help;&apos; or &apos;\h&apos; for help. Type &apos;\c&apos; to clear the current input statement.</span><br></pre></td></tr></tbody></table></figure>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show databases;</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| Database           |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">| information_schema |</span><br><span class="line">| BOOK               |</span><br><span class="line">| TESTDB             |</span><br><span class="line">| mysql              |</span><br><span class="line">| performance_schema |</span><br><span class="line">| sys                |</span><br><span class="line">| testbookdb         |</span><br><span class="line">+<span class="comment">--------------------+</span></span><br><span class="line">7 rows in <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> BOOK;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| Tables_in_BOOK |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">| book           |</span><br><span class="line">+<span class="comment">----------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> book;</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| name                    | price | pages |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">| Linux                   |    30 |   666 |</span><br><span class="line">| Cloud Computing         |    60 |   666 |</span><br><span class="line">| Operation System        |    80 |   666 |</span><br><span class="line">| Artificial Intelligence |   166 |   666 |</span><br><span class="line">+<span class="comment">-------------------------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">use</span> TESTDB;</span><br><span class="line">Reading table information for completion of table and column names</span><br><span class="line">You can turn off this feature to get a quicker startup <span class="keyword">with</span> -A</span><br><span class="line"></span><br><span class="line"><span class="keyword">Database</span> <span class="keyword">changed</span></span><br><span class="line">mysql&gt; <span class="keyword">show</span> <span class="keyword">tables</span>;</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| Tables_in_TESTDB |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">| TABLE1           |</span><br><span class="line">| TABLE2           |</span><br><span class="line">+<span class="comment">------------------+</span></span><br><span class="line">2 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE1;</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">| bTypeId | bName  | price | publishing |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">|       1 | Linux  |    66 | DZ         |</span><br><span class="line">|       2 | CLD    |    68 | RM         |</span><br><span class="line">|       3 | SYS    |    90 | JX         |</span><br><span class="line">|       4 | MySQL1 |    71 | QH         |</span><br><span class="line">|       5 | MySQL2 |    72 | QH         |</span><br><span class="line">|       6 | MySQL3 |    73 | QH         |</span><br><span class="line">|       7 | MySQL4 |    74 | QH         |</span><br><span class="line">|       8 | MySQL5 |    75 | QH         |</span><br><span class="line">|       9 | MySQL6 |    76 | QH         |</span><br><span class="line">|      10 | MySQL7 |    77 | QH         |</span><br><span class="line">|      11 | MySQL8 |    78 | QH         |</span><br><span class="line">|      12 | MySQL9 |    79 | QH         |</span><br><span class="line">+<span class="comment">---------+--------+-------+------------+</span></span><br><span class="line">12 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; <span class="keyword">select</span> * <span class="keyword">from</span> TABLE2;</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| name   | price | pages |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">| Linux  |    30 |   666 |</span><br><span class="line">| CLD    |    60 |   666 |</span><br><span class="line">| SYS    |    80 |   666 |</span><br><span class="line">| MySQL1 |   166 |   666 |</span><br><span class="line">+<span class="comment">--------+-------+-------+</span></span><br><span class="line">4 rows in <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; ^DBye</span><br><span class="line">[root@server12 ~]<span class="comment">#</span></span><br></pre></td></tr></tbody></table></figure>
<p>&#x7531;&#x4EE5;&#x4E0A;&#x64CD;&#x4F5C;&#x53EF;&#x77E5;innobackupex&#x8FD8;&#x539F;&#x589E;&#x91CF;&#x6570;&#x636E;&#x4E0D;&#x7A33;&#x5B9A;&#xFF01;</p>
<p>6&#xFF1A;&#x5B98;&#x65B9;&#x6587;&#x6863;<br><a href="https://www.percona.com/doc/percona-xtrabackup/2.4/index.html" target="_blank" rel="noopener">https://www.percona.com/doc/percona-xtrabackup/2.4/index.html</a></p>
<p>&#x6587;&#x6863;&#xFF1A;10 mysqldump&#x8FDC;&#x7A0B;&#x5907;&#x4EFD;&#x4E0E;&#x6062;&#x590D;&#x6570;&#x636E;.md<br>&#x94FE;&#x63A5;&#xFF1A;<a href="http://note.youdao.com/noteshare?id=7af3e7cda297defe01228ed798e72c02&amp;sub=E2F44DF8E1BC4B9287EA434DEA3B670C" target="_blank" rel="noopener">http://note.youdao.com/noteshare?id=7af3e7cda297defe01228ed798e72c02&amp;sub=E2F44DF8E1BC4B9287EA434DEA3B670C</a></p>
<p>&#x6587;&#x6863;&#xFF1A;16 innobackupex&#x5907;&#x4EFD;MySQL&#x6570;&#x636E;&#x9047;&#x5230;Can&#x2019;&#x2026;<br>&#x94FE;&#x63A5;&#xFF1A;<a href="http://note.youdao.com/noteshare?id=75c497bba7496b9ec1c61c766e03cca8&amp;sub=F4A9B0EB5E554DB5BB6EF40A12A25512" target="_blank" rel="noopener">http://note.youdao.com/noteshare?id=75c497bba7496b9ec1c61c766e03cca8&amp;sub=F4A9B0EB5E554DB5BB6EF40A12A25512</a></p>
<p>&#x7EC3;&#x4E60;&#xFF1A;1. &#x628A;&#x6570;&#x636E;&#x5B57;&#x5178;&#x5BFC;&#x5165;MySQL&#x6570;&#x636E;&#x5E93; 2. MySQL5.7.20&#x5728;&#x7EBF;&#x5347;&#x7EA7;&#x5230;MySQL5.7.24</p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/269a56e8/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-使用RPM包安装MySQL5-7数据库" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/f6e2d114/">使用RPM包安装MySQL5.7数据库</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:44:03" datetime="2022-06-07T04:44:03.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <p>&#x4F7F;&#x7528;rpm&#x5305;&#x5B89;&#x88C5;MySQL5.7&#x6570;&#x636E;&#x5E93;</p>
<ol>
<li>&#x4F18;&#x5316;Linux&#x7CFB;&#x7EDF;  </li>
</ol>
<figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">sed -i &apos;s/SELINUX=enforcing/SELINUX=disabled/&apos; /etc/selinux/config &amp;&gt; /dev/null</span><br><span class="line">setenforce 0</span><br><span class="line">systemctl stop firewalld</span><br><span class="line">systemctl disable firewalld</span><br><span class="line">iptables -F</span><br><span class="line">systemctl stop NetworkManager &amp;&gt; /dev/null</span><br><span class="line">systemctl disable NetworkManager &amp;&gt; /dev/null</span><br></pre></td></tr></tbody></table></figure>
<ol start="2">
<li><p>&#x4E0A;&#x4F20;mysql&#x5B89;&#x88C5;&#x5305;</p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">tar -xvf mysql5.7.tar.gz</span><br><span class="line">cd mysql/</span><br></pre></td></tr></tbody></table></figure>
</li>
<li><p>&#x5B89;&#x88C5;  </p>
<p>rpm -e &#x2013;nodeps mariadb-libs &#x2014;&#x2013;&#x5378;&#x8F7D;&#x673A;&#x5668;&#x4E2D;&#x9ED8;&#x8BA4;&#x5B89;&#x88C5;&#x7684;mariadb-libs&#x6570;&#x636E;&#x5E93;&#x5305;</p>
<p>rpm -ivh mysql-community-common-5.7.24-1.el7.x86_64.rpm<br>rpm -ivh mysql-community-libs-5.7.24-1.el7.x86_64.rpm<br>rpm -ivh mysql-community-client-5.7.24-1.el7.x86_64.rpm<br>rpm -ivh mysql-community-devel-5.7.24-1.el7.x86_64.rpm<br>rpm -ivh mysql-community-server-5.7.24-1.el7.x86_64.rpm  </p>
</li>
<li><p>&#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x5E93;<br>vim /etc/my.cnf &#x2014;&#x2013;&#x7F16;&#x8F91;myslq&#x670D;&#x52A1;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5728;&#x672B;&#x5C3E;&#x589E;&#x52A0;&#x4E00;&#x4E0B;&#x8BED;&#x53E5;&#x4F18;&#x5316;&#x8FDE;&#x63A5;<br>&#x8DF3;&#x8FC7;&#x4E3B;&#x673A;&#x540D;&#x89E3;&#x6790;&#xFF0C;&#x63D0;&#x9AD8;&#x8FDE;&#x63A5;&#x901F;&#x5EA6;  </p>
<figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">skip-name-resolve</span><br><span class="line">echo skip-name-resolve &gt;&gt; /etc/my.cnf</span><br></pre></td></tr></tbody></table></figure>
</li>
</ol>
<p>&#x542F;&#x52A8;&#x6570;&#x636E;&#x5E93;&#x670D;&#x52A1;</p>
<pre><code>systemctl start mysqld
systemctl status mysqld
systemctl enable mysqld
</code></pre><p>&#x83B7;&#x53D6;&#x968F;&#x673A;&#x7684;&#x521D;&#x59CB;&#x5BC6;&#x7801; (mysql5.7&#x5F00;&#x59CB;&#x7B2C;&#x4E00;&#x6B21;&#x4EA7;&#x751F;&#x968F;&#x673A;&#x5BC6;&#x7801;&#xFF0C;&#x4E14;&#x767B;&#x5F55;&#x540E;&#x5FC5;&#x987B;&#x4FEE;&#x6539;&#xFF0C;&#x5426;&#x5219;&#x65E0;&#x6CD5;&#x64CD;&#x4F5C;&#x6570;&#x636E;&#x5E93;)<br></p><figure class="highlight shell"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat /var/log/mysqld.log | grep &quot;password&quot;</span><br><span class="line">2021-01-09T07:10:18.431779Z 1 [Note] A temporary password is generated for root@localhost: -dhfHuf%p9hq</span><br><span class="line"></span><br><span class="line">netstat -nlpt | grep mysqld -----mysqld &#x9ED8;&#x8BA4;&#x7AEF;&#x53E3;3306</span><br><span class="line">tcp6 0 0 :::3306 :::* LISTEN 4434/mysqld</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x901A;&#x8FC7;mysql&#x547D;&lt;&#x5BA2;&#x6237;&#x7AEF;&gt;&#x767B;&#x5F55; mysqld&#x670D;&#x52A1;&#x5668;<br>mysql -u &lt;&#x7528;&#x6237;&#x540D;&gt; -p &lt;&#x5BC6;&#x7801;&gt; -h &lt;&#x6307;&#x5B9A;&#x670D;&#x52A1;&#x5668;IP,&#x8FDC;&#x7A0B;&#x767B;&#x5F55;&gt; -P &lt;&#x7AEF;&#x53E3;,&#x9ED8;&#x8BA4;3306&gt;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br><span class="line">Enter password:</span><br><span class="line">mysql&gt;  &#x8F93;&#x5165;sql&#x8BED;&#x53E5;&#x4E0E;mysqld&#x4EA4;&#x4E92;</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>&#x4FEE;&#x6539;&#x521D;&#x59CB;&#x5BC6;&#x7801;&#xFF0C;&lt;&#x5BC6;&#x7801;&#x9700;&#x8981;&#x590D;&#x6742;&#x7684;&#x5BC6;&#x7801;&gt;<br></p><figure class="highlight plain"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; ALTER USER &apos;root&apos;@&apos;localhost&apos; identified by &quot;Uplooking_123&quot;;</span><br><span class="line">mysql&gt; flush privileges; ----&#x5237;&#x65B0;&#x6743;&#x9650;&#xFF0C;&#x7ACB;&#x5373;&#x751F;&#x6548;</span><br><span class="line">mysql&gt; quit</span><br></pre></td></tr></tbody></table></figure><p></p>
<p>rpm&#x5B89;&#x88C5;MySQL5.7&#x914D;&#x7F6E;&#x591A;&#x5B9E;&#x4F8B;<br>&#x94FE;&#x63A5;&#xFF1A;<a href="https://note.youdao.com/s/LGwmlumI" target="_blank" rel="noopener">https://note.youdao.com/s/LGwmlumI</a></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/f6e2d114/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
        <li class="post-list-item fade">
            <article id="post-MySQL5-7" class="article-card article-type-post" itemprop="blogPost">

    


  
    <h3 class="post-title" itemprop="name">
      <a href="/posts/61fb6d52/">MySQL5.7</a>
    </h3>
  




     <div class="post-meta">
        <time class="post-time" title="2022-06-07 12:43:47" datetime="2022-06-07T04:43:47.000Z" itemprop="datePublished">2022-06-07</time>

    </div>

    <div class="post-content" id="post-content" itemprop="postContent">

    
        <h2 id="&#x6E90;&#x7801;&#x5B89;&#x88C5;MySQL-5-7"><a href="#&#x6E90;&#x7801;&#x5B89;&#x88C5;MySQL-5-7" class="headerlink" title="&#x6E90;&#x7801;&#x5B89;&#x88C5;MySQL 5.7"></a>&#x6E90;&#x7801;&#x5B89;&#x88C5;MySQL 5.7</h2><h3 id="1-&#x5B89;&#x88C5;&#x4F9D;&#x8D56;-Boost-C-&#x5E93;"><a href="#1-&#x5B89;&#x88C5;&#x4F9D;&#x8D56;-Boost-C-&#x5E93;" class="headerlink" title="1. &#x5B89;&#x88C5;&#x4F9D;&#x8D56; Boost C++ &#x5E93;"></a>1. &#x5B89;&#x88C5;&#x4F9D;&#x8D56; Boost C++ &#x5E93;</h3><p>&#x4ECE;MySQL5.7&#x7248;&#x672C;&#x5F00;&#x59CB;&#xFF0C;&#x5B89;&#x88C5;MySQL&#x9700;&#x8981;&#x4F9D;&#x8D56; Boost &#x7684;C++&#x6269;&#x5C55;&#xFF0C;&#x800C;&#x4E14;&#x53EA;&#x80FD;&#x662F; 1.59.0 &#x7248;&#x672C;&#x3002;<br>Boost &#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF08;&#x4EFB;&#x4E00;&#x5730;&#x5740;&#x90FD;&#x53EF;&#x4E0B;&#x8F7D;&#xFF09;&#xFF1A;<br><a href="http://www.boost.org/users/history" target="_blank" rel="noopener">http://www.boost.org/users/history</a> &#xFF1B;<br><a href="https://www.boost.org/users/history/version_1_59_0.html" target="_blank" rel="noopener">https://www.boost.org/users/history/version_1_59_0.html</a><br><a href="https://sourceforge.net/projects/boost/files/boost/1.59.0/" target="_blank" rel="noopener">https://sourceforge.net/projects/boost/files/boost/1.59.0/</a><br><a href="https://downloads.mysql.com/archives/get/p/23/file/mysql-boost-5.7.19.tar.gz" target="_blank" rel="noopener">https://downloads.mysql.com/archives/get/p/23/file/mysql-boost-5.7.19.tar.gz</a><br>&#x9009;&#x62E9;1.59.0&#x7248;&#x672C;&#x4E0B;&#x8F7D;&#xFF0C;&#x5728;&#x7F16;&#x8BD1;&#x662F;&#x586B;&#x5199;&#x76F8;&#x5E94;&#x53C2;&#x6570;&#xFF0C;&#x6307;&#x5B9A;Boost&#x6E90;&#x7801;&#x4F4D;&#x7F6E;&#x5373;&#x53EF;&#x3002;<br>Boost&#x5E93;&#x662F;&#x4E00;&#x4E2A;&#x53EF;&#x79FB;&#x690D;&#x3001;&#x63D0;&#x4F9B;&#x6E90;&#x4EE3;&#x7801;&#x7684;C++&#x5E93;&#xFF0C;&#x4F5C;&#x4E3A;&#x6807;&#x51C6;&#x5E93;&#x7684;&#x540E;&#x5907;&#xFF0C;&#x662F;C++&#x6807;&#x51C6;&#x5316;&#x8FDB;&#x7A0B;&#x7684;&#x5F00;&#x53D1;&#x5F15;&#x64CE;&#x4E4B;&#x4E00;&#x3002;<br>Boost&#x5E93;&#x7531;C++&#x6807;&#x51C6;&#x59D4;&#x5458;&#x4F1A;&#x5E93;&#x5DE5;&#x4F5C;&#x7EC4;&#x6210;&#x5458;&#x53D1;&#x8D77;&#xFF0C;&#x5176;&#x4E2D;&#x6709;&#x4E9B;&#x5185;&#x5BB9;&#x6709;&#x671B;&#x6210;&#x4E3A;&#x4E0B;&#x4E00;&#x4EE3;C++&#x6807;&#x51C6;&#x5E93;&#x5185;&#x5BB9;&#x3002;<br>&#x5728;C++&#x793E;&#x533A;&#x4E2D;&#x5F71;&#x54CD;&#x751A;&#x5927;&#xFF0C;&#x662F;&#x4E0D;&#x6298;&#x4E0D;&#x6263;&#x7684;&#x201C;&#x51C6;&#x201D;&#x6807;&#x51C6;&#x5E93;&#x3002;Boost&#x7531;&#x4E8E;&#x5176;&#x5BF9;&#x8DE8;&#x5E73;&#x53F0;&#x7684;&#x5F3A;&#x8C03;&#xFF0C;&#x5BF9;&#x6807;&#x51C6;C++&#x7684;&#x5F3A;&#x8C03;&#xFF0C;&#x4E0E;&#x7F16;&#x5199;&#x5E73;&#x53F0;&#x65E0;&#x5173;&#x3002;  </p>
<p><strong>&#x4E0B;&#x8F7D;&#x89E3;&#x538B;Boost C++&#x5E93;</strong>  </p>
<pre><code>wget http://sourceforge.net/projects/boost/files/boost/1.59.0/boost_1_59_0.tar.gz
# &#x89E3;&#x538B;&#x5230;/usr/local/boost
tar -zxvf boost_1_59_0.tar.gz 
mv boost_1_59_0 /usr/local/boost
</code></pre><h3 id="2-&#x5B89;&#x88C5;&#x76F8;&#x5173;&#x7F16;&#x8BD1;&#x5DE5;&#x5177;&#x548C;&#x4F9D;&#x8D56;&#x5305;"><a href="#2-&#x5B89;&#x88C5;&#x76F8;&#x5173;&#x7F16;&#x8BD1;&#x5DE5;&#x5177;&#x548C;&#x4F9D;&#x8D56;&#x5305;" class="headerlink" title="2. &#x5B89;&#x88C5;&#x76F8;&#x5173;&#x7F16;&#x8BD1;&#x5DE5;&#x5177;&#x548C;&#x4F9D;&#x8D56;&#x5305;"></a>2. &#x5B89;&#x88C5;&#x76F8;&#x5173;&#x7F16;&#x8BD1;&#x5DE5;&#x5177;&#x548C;&#x4F9D;&#x8D56;&#x5305;</h3><pre><code>yum install -y gcc-c++ cmake ncurses-devel
</code></pre><h3 id="3-&#x521B;&#x5EFA;MySQL&#x7528;&#x6237;&#x6765;&#x8FD0;&#x884C;MySQL&#x6570;&#x636E;&#x5E93;"><a href="#3-&#x521B;&#x5EFA;MySQL&#x7528;&#x6237;&#x6765;&#x8FD0;&#x884C;MySQL&#x6570;&#x636E;&#x5E93;" class="headerlink" title="3. &#x521B;&#x5EFA;MySQL&#x7528;&#x6237;&#x6765;&#x8FD0;&#x884C;MySQL&#x6570;&#x636E;&#x5E93;"></a>3. &#x521B;&#x5EFA;MySQL&#x7528;&#x6237;&#x6765;&#x8FD0;&#x884C;MySQL&#x6570;&#x636E;&#x5E93;</h3><pre><code>groupadd -g 27 mysql
useradd mysql -u 27 -g mysql -M -s /sbin/nologin
</code></pre><h3 id="4-&#x521B;&#x5EFA;&#x5B58;&#x653E;&#x6570;&#x636E;&#x7684;&#x76EE;&#x5F55;"><a href="#4-&#x521B;&#x5EFA;&#x5B58;&#x653E;&#x6570;&#x636E;&#x7684;&#x76EE;&#x5F55;" class="headerlink" title="4. &#x521B;&#x5EFA;&#x5B58;&#x653E;&#x6570;&#x636E;&#x7684;&#x76EE;&#x5F55;"></a>4. &#x521B;&#x5EFA;&#x5B58;&#x653E;&#x6570;&#x636E;&#x7684;&#x76EE;&#x5F55;</h3><pre><code>mkdir -p /data/mysql
chown -Rf mysql:mysql /data/mysql
</code></pre><h3 id="5-&#x6E90;&#x7801;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;MySQL-5-7"><a href="#5-&#x6E90;&#x7801;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;MySQL-5-7" class="headerlink" title="5. &#x6E90;&#x7801;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;MySQL 5.7"></a>5. &#x6E90;&#x7801;&#x7F16;&#x8BD1;&#x5B89;&#x88C5;MySQL 5.7</h3><p>MySQL&#x5B98;&#x65B9;&#x4E0B;&#x8F7D;&#x5730;&#x5740;&#xFF1A;<br><a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener">https://downloads.mysql.com/archives/community/</a></p>
<p><strong>&#x4E0B;&#x8F7D;</strong></p>
<pre><code>wget https://downloads.mysql.com/archives/get/p/23/file/mysql-5.7.19.tar.gz
tar -zxvf mysql-5.7.19.tar.gz -C /usr/local/src
</code></pre><p><strong>&#x7F16;&#x8BD1;&#x5B89;&#x88C5;</strong></p>
<pre><code>cd /usr/local/src/mysql-5.7.19

# &#x9884;&#x7F16;&#x8BD1;
cmake -DCMAKE_INSTALL_PREFIX=/usr/local/mysql57 -DMYSQL_DATADIR=/data/mysql -DDEFAULT_CHARSET=utf8 -DDEFAULT_COLLATION=utf8_general_ci -DMYSQL_TCP_PORT=3306 -DMYSQL_UNIX_ADDR=/tmp/mysql.sock -DMYSQL_USER=mysql -DWITH_MYISAM_STORAGE_ENGINE=1 -DWITH_INNOBASE_STORAGE_ENGINE=1 -DDOWNLOAD_BOOST=1 -DWITH_BOOST=/usr/local/boost -DWITH_INNODB_MEMCACHED=ON

## &#x7F16;&#x8BD1;&#x5B89;&#x88C5;
# &#x9ED8;&#x8BA4;&#x7F16;&#x8BD1;&#x901F;&#x5EA6;&#x975E;&#x5E38;&#x6162;&#xFF0C;&#x4E0D;&#x63A8;&#x8350;
# &#x52A0;&#x901F;&#x7F16;&#x8BD1;&#x65B9;&#x6CD5;&#x770B;&#x6587;&#x672B;&#x64CD;&#x4F5C;
make &amp;&amp; make install
</code></pre><h3 id="6-&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;"><a href="#6-&#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;" class="headerlink" title="6. &#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;"></a>6. &#x521B;&#x5EFA;&#x914D;&#x7F6E;&#x6587;&#x4EF6;</h3><pre><code>mv /etc/my.cnf /etc/my.cnf.bak
</code></pre><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /etc/my.cnf &lt;&lt;EOF</span><br><span class="line">[client]</span><br><span class="line">port=3306</span><br><span class="line">socket=/data/mysql/mysql.sock</span><br><span class="line">[mysqld]</span><br><span class="line">character-set-server=utf8</span><br><span class="line">collation-server=utf8_general_ci</span><br><span class="line">skip-name-resolve</span><br><span class="line">user=mysql</span><br><span class="line">port=3306</span><br><span class="line">basedir=/usr/<span class="built_in">local</span>/mysql57</span><br><span class="line">datadir=/data/mysql</span><br><span class="line">tmpdir=/tmp</span><br><span class="line">socket=/data/mysql/mysql.sock</span><br><span class="line"><span class="built_in">log</span>-error=/data/mysql/mysqld.log</span><br><span class="line">pid-file=/data/mysql/mysqld.pid</span><br><span class="line">EOF</span><br></pre></td></tr></tbody></table></figure>
<h3 id="7-&#x914D;&#x7F6E;MySQL&#x73AF;&#x5883;&#x53D8;&#x91CF;"><a href="#7-&#x914D;&#x7F6E;MySQL&#x73AF;&#x5883;&#x53D8;&#x91CF;" class="headerlink" title="7. &#x914D;&#x7F6E;MySQL&#x73AF;&#x5883;&#x53D8;&#x91CF;"></a>7. &#x914D;&#x7F6E;MySQL&#x73AF;&#x5883;&#x53D8;&#x91CF;</h3><figure class="highlight bash"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">echo</span> <span class="string">&quot;export PATH=\$PATH:/usr/local/mysql57/bin&quot;</span> &gt;&gt; /etc/profile</span><br><span class="line"><span class="built_in">source</span> /etc/profile</span><br></pre></td></tr></tbody></table></figure>
<h3 id="8-&#x521D;&#x59CB;&#x5316;MySQL-5-7"><a href="#8-&#x521D;&#x59CB;&#x5316;MySQL-5-7" class="headerlink" title="8. &#x521D;&#x59CB;&#x5316;MySQL 5.7"></a>8. &#x521D;&#x59CB;&#x5316;MySQL 5.7</h3><pre><code>/usr/local/mysql57/bin/mysqld --defaults-file=/etc/my.cnf --initialize --user=mysql
</code></pre><h3 id="9-&#x8FD0;&#x884C;MySQL"><a href="#9-&#x8FD0;&#x884C;MySQL" class="headerlink" title="9. &#x8FD0;&#x884C;MySQL"></a>9. &#x8FD0;&#x884C;MySQL</h3><pre><code>/usr/local/mysql57/support-files/mysql.server start

/usr/local/mysql57/support-files/mysql.server status
</code></pre><h3 id="10-&#x67E5;&#x627E;MySQL-root&#x7528;&#x6237;&#x521D;&#x59CB;&#x5BC6;&#x7801;"><a href="#10-&#x67E5;&#x627E;MySQL-root&#x7528;&#x6237;&#x521D;&#x59CB;&#x5BC6;&#x7801;" class="headerlink" title="10. &#x67E5;&#x627E;MySQL root&#x7528;&#x6237;&#x521D;&#x59CB;&#x5BC6;&#x7801;"></a>10. &#x67E5;&#x627E;MySQL root&#x7528;&#x6237;&#x521D;&#x59CB;&#x5BC6;&#x7801;</h3><pre><code>cd /data/mysql

cat mysqld.log | grep root
</code></pre><h3 id="11-&#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;"><a href="#11-&#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;" class="headerlink" title="11. &#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;"></a>11. &#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;</h3><p><strong>&#x4F7F;&#x7528;root&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;&#x767B;&#x5F55;MySQL</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&apos;root&apos;</span>@<span class="string">&apos;localhost&apos;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&apos;New_password&apos;</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></tbody></table></figure>
<h3 id="12-&#x521B;&#x5EFA;MySQL-5-7-systemd&#x542F;&#x52A8;&#x6587;&#x4EF6;"><a href="#12-&#x521B;&#x5EFA;MySQL-5-7-systemd&#x542F;&#x52A8;&#x6587;&#x4EF6;" class="headerlink" title="12. &#x521B;&#x5EFA;MySQL 5.7 systemd&#x542F;&#x52A8;&#x6587;&#x4EF6;"></a>12. &#x521B;&#x5EFA;MySQL 5.7 systemd&#x542F;&#x52A8;&#x6587;&#x4EF6;</h3><p>&#x53C2;&#x8003;&#xFF1A;<a href="https://dev.mysql.com/doc/refman/5.7/en/using-systemd.html" target="_blank" rel="noopener">https://dev.mysql.com/doc/refman/5.7/en/using-systemd.html</a></p>
<h3 id="13-&#x7F16;&#x8BD1;&#x4F18;&#x5316;"><a href="#13-&#x7F16;&#x8BD1;&#x4F18;&#x5316;" class="headerlink" title="13. &#x7F16;&#x8BD1;&#x4F18;&#x5316;"></a>13. &#x7F16;&#x8BD1;&#x4F18;&#x5316;</h3><p><strong>&#x5B89;&#x88C5;ccache&#x52A0;&#x5FEB;&#x7F16;&#x8BD1;&#x901F;&#x5EA6;</strong></p>
<pre><code>yum install -y epel-release
yum install -y ccache

# &#x4F7F;&#x7528;ccache&#x63A5;&#x7BA1;gcc/g++
cp ccache /usr/local/bin/
ln -s ccache /usr/local/bin/gcc
ln -s ccache /usr/local/bin/g++
ln -s ccache /usr/local/bin/cc
ln -s ccache /usr/local/bin/c++
</code></pre><p><strong>make -j&#x5E76;&#x884C;&#x7F16;&#x8BD1;</strong><br>CPU&#x662F;&#x5F71;&#x54CD;&#x7F16;&#x8BD1;&#x901F;&#x5EA6;&#x7684;&#x4E00;&#x4E2A;&#x91CD;&#x8981;&#x56E0;&#x7D20;<br><code>make -j4</code> &#x8BA9;make&#x6700;&#x591A;&#x5141;&#x8BB8;4&#x4E2A;&#x7F16;&#x8BD1;&#x547D;&#x4EE4;&#x540C;&#x65F6;&#x6267;&#x884C;</p>
<p>&#x5728;&#x591A;&#x6838;CPU&#x4E0A;&#xFF0C;&#x9002;&#x5F53;&#x7684;&#x8FDB;&#x884C;&#x5E76;&#x884C;&#x7F16;&#x8BD1;&#x8FD8;&#x662F;&#x53EF;&#x4EE5;&#x660E;&#x663E;&#x63D0;&#x9AD8;&#x7F16;&#x8BD1;&#x901F;&#x5EA6;&#x7684;&#x3002;&#x4F46;&#x5E76;&#x884C;&#x7684;&#x4EFB;&#x52A1;&#x4E0D;&#x5B9C;&#x592A;&#x591A;&#xFF0C;<strong>make -j &#x4E00;&#x822C;&#x662F;&#x4EE5;CPU&#x7684;&#x6838;&#x5FC3;&#x6570;&#x76EE;&#x7684;&#x4E24;&#x500D;</strong>&#x4E3A;&#x5B9C;&#x3002;</p>
<p><strong>&#x6CE8;&#x610F;&#xFF01;</strong> &#x5728;&#x4F7F;&#x7528;&#x5E76;&#x884C;&#x7F16;&#x8BD1;&#x65F6;&#xFF0C;&#x7CFB;&#x7EDF;&#x5185;&#x5B58;&#x548C;&#x4EA4;&#x6362;&#x5206;&#x533A;&#x7ED9;&#x5927;&#x4E00;&#x4E9B;&#xFF0C;&#x5185;&#x5B58;&#x8FC7;&#x5C0F;&#x65F6;&#xFF0C;&#x7F16;&#x8BD1;&#x4F1A;&#x51FA;&#x9519;</p>
<p>ccache&#x5B98;&#x65B9;&#x6587;&#x6863;<br><a href="https://ccache.dev/manual/4.3.html" target="_blank" rel="noopener">https://ccache.dev/manual/4.3.html</a></p>
<hr>
<hr>
<h2 id="&#x4F7F;&#x7528;rpm&#x5B89;&#x88C5;MySQL-5-7"><a href="#&#x4F7F;&#x7528;rpm&#x5B89;&#x88C5;MySQL-5-7" class="headerlink" title="&#x4F7F;&#x7528;rpm&#x5B89;&#x88C5;MySQL 5.7"></a>&#x4F7F;&#x7528;rpm&#x5B89;&#x88C5;MySQL 5.7</h2><h3 id="1-&#x4F18;&#x5316;Linux&#x7CFB;&#x7EDF;"><a href="#1-&#x4F18;&#x5316;Linux&#x7CFB;&#x7EDF;" class="headerlink" title="1. &#x4F18;&#x5316;Linux&#x7CFB;&#x7EDF;"></a>1. &#x4F18;&#x5316;Linux&#x7CFB;&#x7EDF;</h3><pre><code>sed -i &apos;s/SELINUX=enforcing/SELINUX=disabled/&apos; /etc/selinux/config &amp;&gt; /dev/null
setenforce 0
systemctl stop firewalld
systemctl disable firewalld
iptables -F
systemctl stop NetworkManager &amp;&gt; /dev/null
systemctl disable NetworkManager &amp;&gt; /dev/null
</code></pre><h3 id="2-&#x83B7;&#x53D6;MySQL-5-7&#x7684;rpm&#x5305;"><a href="#2-&#x83B7;&#x53D6;MySQL-5-7&#x7684;rpm&#x5305;" class="headerlink" title="2. &#x83B7;&#x53D6;MySQL 5.7&#x7684;rpm&#x5305;"></a>2. &#x83B7;&#x53D6;MySQL 5.7&#x7684;rpm&#x5305;</h3><p>&#x83B7;&#x53D6;&#x65B9;&#x5F0F;&#x4E00;&#xFF1A;<br>MySQL&#x5B98;&#x7F51;&#x4E0B;&#x8F7D;<br><a href="https://downloads.mysql.com/archives/community/" target="_blank" rel="noopener">https://downloads.mysql.com/archives/community/</a><br>&#x83B7;&#x53D6;&#x65B9;&#x5F0F;&#x4E8C;&#xFF1A;copy&#x955C;&#x50CF;&#x5B89;&#x88C5;&#x5305;   </p>
<p><strong>&#x5206;&#x522B;&#x4E0B;&#x8F7D;&#x8FD9;5&#x4E2A;rpm&#x5305;&#xFF1A;</strong><br>MySQL&#x670D;&#x52A1;&#x7AEF;&#x7A0B;&#x5E8F;RPM Package, MySQL Server&#xFF1A;<br><a href="https://downloads.mysql.com/archives/get/p/23/file/mysql-community-server-5.7.24-1.el7.x86_64.rpm" target="_blank" rel="noopener">mysql-community-server-5.7.24-1.el7.x86_64.rpm</a><br>MySQL&#x5BA2;&#x6237;&#x7AEF;&#x5DE5;&#x5177;RPM Package, Client Utilities&#xFF1A;<br><a href="https://downloads.mysql.com/archives/get/p/23/file/mysql-community-client-5.7.24-1.el7.x86_64.rpm" target="_blank" rel="noopener">mysql-community-client-5.7.24-1.el7.x86_64.rpm</a><br>MySQL&#x5F00;&#x53D1;&#x5E93;RPM Package, Development Libraries&#xFF1A;<br><a href="https://downloads.mysql.com/archives/get/p/23/file/mysql-community-devel-5.7.24-1.el7.x86_64.rpm" target="_blank" rel="noopener">mysql-community-devel-5.7.24-1.el7.x86_64.rpm</a><br>MySQL&#x914D;&#x7F6E;&#x7A0B;&#x5E8F;RPM Package, MySQL Configuration&#xFF1A;<br><a href="https://downloads.mysql.com/archives/get/p/23/file/mysql-community-common-5.7.24-1.el7.x86_64.rpm" target="_blank" rel="noopener">mysql-community-common-5.7.24-1.el7.x86_64.rpm</a><br>MySQL&#x5171;&#x4EAB;&#x5E93;RPM Package, Shared Libraries&#xFF1A;<br><a href="https://downloads.mysql.com/archives/get/p/23/file/mysql-community-libs-5.7.24-1.el7.x86_64.rpm" target="_blank" rel="noopener">mysql-community-libs-5.7.24-1.el7.x86_64.rpm</a>  </p>
<h3 id="3-&#x5B89;&#x88C5;MySQL"><a href="#3-&#x5B89;&#x88C5;MySQL" class="headerlink" title="3. &#x5B89;&#x88C5;MySQL"></a>3. &#x5B89;&#x88C5;MySQL</h3><p><strong>&#x5378;&#x8F7D;&#x7CFB;&#x7EDF;&#x4E2D;&#x9ED8;&#x8BA4;&#x5B89;&#x88C5;&#x7684;mariadb-libs&#x6570;&#x636E;&#x5E93;&#x5305;</strong></p>
<pre><code>rpm -e --nodeps mariadb-libs
</code></pre><p><strong>&#x5B89;&#x88C5;rpm&#x5305;</strong><br>&#x5B89;&#x88C5;&#x987A;&#x5E8F;&#xFF1A;</p>
<pre><code>rpm -ivh mysql-community-common-5.7.24-1.el7.x86_64.rpm
rpm -ivh mysql-community-libs-5.7.24-1.el7.x86_64.rpm
rpm -ivh mysql-community-client-5.7.24-1.el7.x86_64.rpm
rpm -ivh mysql-community-devel-5.7.24-1.el7.x86_64.rpm
rpm -ivh mysql-community-server-5.7.24-1.el7.x86_64.rpm
</code></pre><h3 id="4-&#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x5E93;"><a href="#4-&#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x5E93;" class="headerlink" title="4. &#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x5E93;"></a>4. &#x521D;&#x59CB;&#x5316;&#x6570;&#x636E;&#x5E93;</h3><pre><code>vim /etc/my.cnf

# &#x672B;&#x884C;&#x6DFB;&#x52A0;skip-name-resolv&#xFF0C;&#x8DF3;&#x8FC7;&#x4E3B;&#x673A;&#x540D;&#x89E3;&#x6790;&#xFF0C;&#x63D0;&#x9AD8;&#x8FDE;&#x63A5;&#x901F;&#x5EA6;
skip-name-resolv
</code></pre><p><strong>&#x542F;&#x52A8;&#x6570;&#x636E;&#x5E93;</strong></p>
<pre><code>systemctl start mysqld
systemctl status mysqld
systemctl enable mysqld
</code></pre><h3 id="5-&#x67E5;&#x770B;MySQL&#x521D;&#x59CB;&#x5BC6;&#x7801;"><a href="#5-&#x67E5;&#x770B;MySQL&#x521D;&#x59CB;&#x5BC6;&#x7801;" class="headerlink" title="5. &#x67E5;&#x770B;MySQL&#x521D;&#x59CB;&#x5BC6;&#x7801;"></a>5. &#x67E5;&#x770B;MySQL&#x521D;&#x59CB;&#x5BC6;&#x7801;</h3><pre><code>cat /var/log/mysqld.log | grep &quot;password&quot;
</code></pre><h3 id="6-&#x4FEE;&#x6539;MySQL&#x521D;&#x59CB;&#x5BC6;&#x7801;"><a href="#6-&#x4FEE;&#x6539;MySQL&#x521D;&#x59CB;&#x5BC6;&#x7801;" class="headerlink" title="6. &#x4FEE;&#x6539;MySQL&#x521D;&#x59CB;&#x5BC6;&#x7801;"></a>6. &#x4FEE;&#x6539;MySQL&#x521D;&#x59CB;&#x5BC6;&#x7801;</h3><p><strong>&#x4F7F;&#x7528;MySQL root&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#x6570;&#x636E;&#x5E93;</strong></p>
<figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&apos;root&apos;</span>@<span class="string">&apos;localhost&apos;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&apos;new_PASSWORD&apos;</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br><span class="line"><span class="comment"># &#x6216;&#x8005;</span></span><br><span class="line"><span class="keyword">update</span> mysql.user <span class="keyword">set</span> authentication_string=<span class="keyword">password</span>(<span class="string">&apos;123456&apos;</span>) <span class="keyword">where</span> <span class="keyword">user</span>=<span class="string">&apos;root&apos;</span> <span class="keyword">and</span> Host = <span class="string">&apos;localhost&apos;</span>;</span><br><span class="line"><span class="comment"># &#x6216;&#x8005;</span></span><br><span class="line"><span class="keyword">set</span> <span class="keyword">password</span> <span class="keyword">for</span> <span class="string">&apos;root&apos;</span>@<span class="string">&apos;localhost&apos;</span>=<span class="keyword">password</span>(<span class="string">&apos;123456&apos;</span>);</span><br></pre></td></tr></tbody></table></figure>
<h4 id="&#x6269;&#x5C55;&#xFF1A;&#x4FEE;&#x6539;MySQL&#x5BC6;&#x7801;&#x7B56;&#x7565;"><a href="#&#x6269;&#x5C55;&#xFF1A;&#x4FEE;&#x6539;MySQL&#x5BC6;&#x7801;&#x7B56;&#x7565;" class="headerlink" title="&#x6269;&#x5C55;&#xFF1A;&#x4FEE;&#x6539;MySQL&#x5BC6;&#x7801;&#x7B56;&#x7565;"></a>&#x6269;&#x5C55;&#xFF1A;&#x4FEE;&#x6539;MySQL&#x5BC6;&#x7801;&#x7B56;&#x7565;</h4><p>&#x5728;&#x4F7F;&#x7528;rpm&#x5B89;&#x88C5;MySQL 5.7&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;&#x5F3A;&#x5EA6;&#x7B56;&#x7565;&#x662F;MEDIUM&#xFF0C;&#x4F7F;&#x7528;&#x521D;&#x59CB;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#x540E;&#xFF0C;&#x5FC5;&#x987B;&#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;&#xFF0C;&#x4E0D;&#x7136;&#x5F88;&#x591A;&#x529F;&#x80FD;&#x90FD;&#x4E0D;&#x80FD;&#x7528;&#xFF0C;&#x4FEE;&#x6539;&#x5BC6;&#x7801;&#x540E;&#x624D;&#x80FD;&#x6B63;&#x5E38;&#x64CD;&#x4F5C;&#x3002;<br><strong>&#x65B9;&#x6CD5;&#x4E00;&#xFF1A;&#x5173;&#x95ED;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;&#x63D2;&#x4EF6;</strong><br>&#x4FEE;&#x6539;MySQL&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x6DFB;&#x52A0;&#x5982;&#x4E0B;&#x53C2;&#x6570;</p>
<pre><code>validate_password=off
</code></pre><p><strong>&#x65B9;&#x6CD5;&#x4E8C;&#xFF1A;&#x4FEE;&#x6539;&#x5BC6;&#x7801;&#x5F3A;&#x5EA6;&#x7B56;&#x7565;</strong>&#xFF08;&#x63A8;&#x8350;&#xFF09;<br></p><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- &#x67E5;&#x770B;&#x5BC6;&#x7801;&#x7B56;&#x7565;</span></span><br><span class="line"><span class="keyword">SHOW</span> <span class="keyword">VARIABLES</span> <span class="keyword">like</span> <span class="string">&quot;%password%&quot;</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">global</span> validate_password_length=<span class="number">6</span>;</span><br><span class="line"><span class="keyword">SET</span> <span class="keyword">global</span> validate_password_policy=<span class="number">0</span>;</span><br><span class="line"><span class="comment"># 0 &#x6216; LOW</span></span><br><span class="line"><span class="comment"># 1 &#x6216; MEDIUM</span></span><br><span class="line"><span class="comment"># 2 &#x6216; STRONG</span></span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></tbody></table></figure><p></p>
<h3 id="MySQL-5-7&#x591A;&#x5B9E;&#x4F8B;&#x914D;&#x7F6E;"><a href="#MySQL-5-7&#x591A;&#x5B9E;&#x4F8B;&#x914D;&#x7F6E;" class="headerlink" title="MySQL 5.7&#x591A;&#x5B9E;&#x4F8B;&#x914D;&#x7F6E;"></a>MySQL 5.7&#x591A;&#x5B9E;&#x4F8B;&#x914D;&#x7F6E;</h3><p><strong>&#x5B89;&#x88C5;MySQL 5.7 rpm&#x5305;</strong></p>
<pre><code>rpm -e --nodeps mariadb-libs

rpm -ivh mysql-community-common-5.7.24-1.el7.x86_64.rpm
rpm -ivh mysql-community-libs-5.7.24-1.el7.x86_64.rpm
rpm -ivh mysql-community-client-5.7.24-1.el7.x86_64.rpm
rpm -ivh mysql-community-devel-5.7.24-1.el7.x86_64.rpm
rpm -ivh mysql-community-server-5.7.24-1.el7.x86_64.rpm
</code></pre><p><strong>&#x521B;&#x5EFA;&#x6570;&#x636E;&#x5B58;&#x653E;&#x76EE;&#x5F55;</strong></p>
<pre><code>mkdir -p /data/mysql/{3306, 3307}
mkdir -p /data/mysql/3306/{data, binlog, logs}
mkdir -p /data/mysql/3307/{data, binlog, logs}
</code></pre><p><strong>&#x521B;&#x5EFA;&#x7528;&#x6237;&#xFF0C;&#x8BBE;&#x7F6E;&#x5C5E;&#x4E3B;&#x5C5E;&#x7EC4;</strong></p>
<pre><code>chown -Rf mysql:mysql /data/mysql
mv /etc/my.cnf /etc/my.cnf.bak
</code></pre><p><strong>&#x65B0;&#x589E;&#x914D;&#x7F6E;&#x6587;&#x4EF6;my3306.cnf</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cat&gt;&gt;/etc/my3306.cnf&lt;&lt;EOF</span><br><span class="line">[mysqld]</span><br><span class="line">user = mysql</span><br><span class="line">port = 3306</span><br><span class="line">server_id = 3306</span><br><span class="line">datadir = /data/mysql/3306/data</span><br><span class="line">socket = /data/mysql/3306/mysql3306.sock</span><br><span class="line">symbolic-links = 0</span><br><span class="line">log-error = /data/mysql/3306/logs/mysqld3306.log</span><br><span class="line">pid-file = /data/mysql/3306/mysqld3306.pid</span><br><span class="line">EOF</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x65B0;&#x589E;&#x914D;&#x7F6E;&#x6587;&#x4EF6;my3307.cnf</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">cp /etc/my3306.cnf /etc/my3307.cnf</span><br><span class="line">sed -i &apos;s/3306/3307/g&apos; /etc/my3307.cnf</span><br><span class="line"></span><br><span class="line">[root@jaking mysql5.7]# cat /etc/my3307.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">user = mysql</span><br><span class="line">port = 3307</span><br><span class="line">server_id = 3307</span><br><span class="line">datadir = /data/mysql/3307/data</span><br><span class="line">socket = /data/mysql/3307/mysql3307.sock</span><br><span class="line">symbolic-links = 0</span><br><span class="line">log-error = /data/mysql/3307/logs/mysqld3307.log</span><br><span class="line">pid-file = /data/mysql/3307/mysqld3307.pid</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x5907;&#x4EFD;mysql&#x542F;&#x52A8;&#x670D;&#x52A1;&#x6587;&#x4EF6;</strong></p>
<pre><code>mv /usr/lib/systemd/system/mysqld.service /usr/lib/systemd/system/mysqld.service.bak
</code></pre><p><strong>&#x65B0;&#x589E;mysqld3306.service&#x542F;&#x52A8;&#x6587;&#x4EF6;</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">cat&gt;&gt;/usr/lib/systemd/system/mysqld3306.service&lt;&lt;EOF</span><br><span class="line">[Unit]</span><br><span class="line">Description=MySQL Server</span><br><span class="line">Documentation=man:mysqld(8)</span><br><span class="line">Documentation=http://dev.mysql.com/doc/refman/en/using-systemd.html</span><br><span class="line">After=network.target</span><br><span class="line">After=syslog.target</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=mysql</span><br><span class="line">Group=mysql</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/data/mysql/3306/mysqld3306.pid</span><br><span class="line">TimeoutSec=0</span><br><span class="line">PermissionsStartOnly=true</span><br><span class="line">ExecStart=/usr/sbin/mysqld --defaults-file=/etc/my3306.cnf --daemonize --pid-file=/data/mysql/3306/mysqld3306.pid $MYSQLD_OPTS</span><br><span class="line">EnvironmentFile=-/etc/sysconfig/mysql</span><br><span class="line">LimitNOFILE = 5000</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartPreventExitStatus=1</span><br><span class="line">PrivateTmp=false</span><br><span class="line">EOF</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x65B0;&#x589E;mysqld3307.service&#x542F;&#x52A8;&#x6587;&#x4EF6;</strong><br></p><figure class="highlight"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">cp /usr/lib/systemd/system/mysqld3306.service /usr/lib/systemd/system/mysqld3307.service</span><br><span class="line">sed -i &apos;s/3306/3307/g&apos; /usr/lib/systemd/system/mysqld3307.service</span><br><span class="line"></span><br><span class="line">[root@jaking mysql5.7]# cat /usr/lib/systemd/system/mysqld3307.service</span><br><span class="line">[Unit]</span><br><span class="line">Description=MySQL Server</span><br><span class="line">Documentation=man:mysqld(8)</span><br><span class="line">Documentation=http://dev.mysql.com/doc/refman/en/using-systemd.html</span><br><span class="line">After=network.target</span><br><span class="line">After=syslog.target</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=mysql</span><br><span class="line">Group=mysql</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/data/mysql/3307/mysqld3307.pid</span><br><span class="line">TimeoutSec=0</span><br><span class="line">PermissionsStartOnly=true</span><br><span class="line">ExecStart=/usr/sbin/mysqld --defaults-file=/etc/my3307.cnf --daemonize --pid-file=/data/mysql/3307/mysqld3307.pid </span><br><span class="line">EnvironmentFile=-/etc/sysconfig/mysql</span><br><span class="line">LimitNOFILE = 5000</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartPreventExitStatus=1</span><br><span class="line">PrivateTmp=false</span><br></pre></td></tr></tbody></table></figure><p></p>
<p><strong>&#x521D;&#x59CB;&#x5316;&#x591A;&#x5B9E;&#x4F8B;3306&#x3001;3307</strong></p>
<pre><code>mysqld --defaults-file=/etc/my3306.cnf --initialize --user=mysql --datadir=/data/mysql/3306/data
mysqld --defaults-file=/etc/mysql3307.cnf --initialize --user=mysql --datadir=/data/mysql/3307/data
</code></pre><p><strong>&#x542F;&#x52A8;&#x591A;&#x5B9E;&#x4F8B;3306&#x3001;3307</strong></p>
<pre><code>systemctl daemon-reload
systemctl start mysqld3306
systemctl start mysqld3307

netstat -pantul | grep mysql

ps aux | grep mysql
</code></pre><p><strong>&#x67E5;&#x770B;MySQL root&#x521D;&#x59CB;&#x5BC6;&#x7801;</strong></p>
<pre><code>cat /data/mysql/3306/logs/mysqld3306.log | grep root
cat /data/mysql/3307/logs/mysqld3307.log | grep root
</code></pre><p><strong>&#x767B;&#x5F55;&#x591A;&#x5B9E;&#x4F8B;&#x5E76;&#x4FEE;&#x6539;root&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;</strong></p>
<pre><code># mysql3306&#x5B9E;&#x4F8B;
mysql -S /data/mysql/3306/mysql3306.sock -uroot -p 
</code></pre><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&apos;root&apos;</span>@<span class="string">&apos;localhost&apos;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&apos;newPassword&apos;</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></tbody></table></figure>
<pre><code># mysql3307&#x5B9E;&#x4F8B;
mysql -S /data/mysql/3307/mysql3307.sock -uroot -p
</code></pre><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;</span></span><br><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&apos;root&apos;</span>@<span class="string">&apos;localhost&apos;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&apos;New_password&apos;</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></tbody></table></figure>
<h4 id="&#x589E;&#x52A0;&#x5B9E;&#x4F8B;"><a href="#&#x589E;&#x52A0;&#x5B9E;&#x4F8B;" class="headerlink" title="&#x589E;&#x52A0;&#x5B9E;&#x4F8B;"></a>&#x589E;&#x52A0;&#x5B9E;&#x4F8B;</h4><p><strong>&#x521B;&#x5EFA;&#x76EE;&#x5F55;&#xFF0C;&#x8BBE;&#x7F6E;&#x5C5E;&#x4E3B;&#x5C5E;&#x7EC4;</strong></p>
<pre><code>mkdir -p /data/mysql/3308/{data, binlog, logs}
chown -Rf mysql:mysql /data/mysql/3308
</code></pre><p><strong>&#x65B0;&#x589E;&#x914D;&#x7F6E;&#x6587;&#x4EF6;my3308.cnf</strong></p>
<pre><code>cp /etc/my3306.cnf /etc/my3308.cnf
sed -i &apos;s/3306/3308/g&apos; /etc/my3308.cnf
</code></pre><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/my3308.cnf</span><br><span class="line">[mysqld]</span><br><span class="line">user = mysql</span><br><span class="line">port = 3308</span><br><span class="line">server_id = 3308</span><br><span class="line">datadir = /data/mysql/3308/data</span><br><span class="line">socket = /data/mysql/3308/mysql3308.sock</span><br><span class="line">symbolic-links = 0</span><br><span class="line"><span class="built_in">log</span>-error = /data/mysql/3308/logs/mysqld3308.log</span><br><span class="line">pid-file = /data/mysql/3308/mysqld3308.pid</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x6DFB;&#x52A0;mysqld3308.service&#x542F;&#x52A8;&#x6587;&#x4EF6;</strong></p>
<pre><code>cp /usr/lib/systemd/system/mysqld3306.service /usr/lib/systemd/system/mysqld3308.service
sed -i &apos;s/3306/3308/g&apos; /usr/lib/systemd/system/mysqld3308.service
</code></pre><figure class="highlight sh"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">cat /usr/lib/systemd/system/mysqld3308.service</span><br><span class="line">[Unit]</span><br><span class="line">Description=MySQL Server</span><br><span class="line">Documentation=man:mysqld(8)</span><br><span class="line">Documentation=http://dev.mysql.com/doc/refman/en/using-systemd.html</span><br><span class="line">After=network.target</span><br><span class="line">After=syslog.target</span><br><span class="line"></span><br><span class="line">[Install]</span><br><span class="line">WantedBy=multi-user.target</span><br><span class="line"></span><br><span class="line">[Service]</span><br><span class="line">User=mysql</span><br><span class="line">Group=mysql</span><br><span class="line">Type=forking</span><br><span class="line">PIDFile=/data/mysql/3308/mysqld3308.pid</span><br><span class="line">TimeoutSec=0</span><br><span class="line">PermissionsStartOnly=<span class="literal">true</span></span><br><span class="line">ExecStart=/usr/sbin/mysqld --defaults-file=/etc/my3308.cnf --daemonize --pid-file=/data/mysql/3308/mysqld3308.pid </span><br><span class="line">EnvironmentFile=-/etc/sysconfig/mysql</span><br><span class="line">LimitNOFILE = 5000</span><br><span class="line">Restart=on-failure</span><br><span class="line">RestartPreventExitStatus=1</span><br><span class="line">PrivateTmp=<span class="literal">false</span></span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x521D;&#x59CB;&#x5316;&#x65B0;&#x589E;&#x5B9E;&#x4F8B;3308</strong></p>
<pre><code>mysqld --defaults-file=/etc/my3308.cnf --initialize --user=mysql --datadir=/data/mysql/3308/data
</code></pre><p><strong>&#x542F;&#x52A8;&#x65B0;&#x589E;&#x5B9E;&#x4F8B;3308</strong></p>
<pre><code>systemctl start mysqld3308

netstat -nutpl | grep mysql
</code></pre><p><strong>&#x83B7;&#x53D6;mysql3308 root&#x521D;&#x59CB;&#x5316;&#x5BC6;&#x7801;</strong></p>
<pre><code>cat /data/mysql/3308/logs/mysqld3308.log | grep root
</code></pre><p><strong>&#x767B;&#x5F55;mysql3308&#x4FEE;&#x6539;&#x9ED8;&#x8BA4;&#x5BC6;&#x7801;</strong></p>
<pre><code>mysql -S /data/mysql/3308/mysql3308.sock -uroot -p
</code></pre><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&apos;root&apos;</span>@<span class="string">&apos;localhost&apos;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&quot;NewPassword&quot;</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></tbody></table></figure>
<hr>
<hr>
<h2 id="&#x4FEE;&#x6539;MySQL&#x7AEF;&#x53E3;"><a href="#&#x4FEE;&#x6539;MySQL&#x7AEF;&#x53E3;" class="headerlink" title="&#x4FEE;&#x6539;MySQL&#x7AEF;&#x53E3;"></a>&#x4FEE;&#x6539;MySQL&#x7AEF;&#x53E3;</h2><pre><code>vim /etc/my.cnf

[mysqld]
datadir=/var/lib/mysql
socket=/var/lib/mysql/mysql.sock
symbolic-links=0
port=3307
log-error=/var/log/mysqld.log
pid-file=/var/run/mysqld/mysqld.pid

netstat -pantul | grep 3307
</code></pre><hr>
<hr>
<h2 id="MySQL-5-7-&#x5FD8;&#x8BB0;root&#x5BC6;&#x7801;"><a href="#MySQL-5-7-&#x5FD8;&#x8BB0;root&#x5BC6;&#x7801;" class="headerlink" title="MySQL 5.7 &#x5FD8;&#x8BB0;root&#x5BC6;&#x7801;"></a>MySQL 5.7 &#x5FD8;&#x8BB0;root&#x5BC6;&#x7801;</h2><p><strong>&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x7ED5;&#x8FC7;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;</strong></p>
<pre><code>echo skip-grant-tables &gt;&gt; /etc/my.cnf
/etc/init.d/mysqld restart
</code></pre><p><strong>&#x4FEE;&#x6539;&#x6570;&#x636E;&#x5E93;root&#x5BC6;&#x7801;</strong></p>
<pre><code>mysql
</code></pre><figure class="highlight sql"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">USER</span> <span class="string">&apos;root&apos;</span>@<span class="string">&apos;localhost&apos;</span> <span class="keyword">IDENTIFIED</span> <span class="keyword">BY</span> <span class="string">&apos;new_Password&apos;</span>;</span><br><span class="line"><span class="keyword">FLUSH</span> <span class="keyword">PRIVILEGES</span>;</span><br></pre></td></tr></tbody></table></figure>
<p><strong>&#x4FEE;&#x6539;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5220;&#x9664;skil-grant-tables&#xFF0C;&#x6062;&#x590D;&#x5BC6;&#x7801;&#x9A8C;&#x8BC1;</strong></p>
<p><strong>&#x91CD;&#x542F;MySQL</strong></p>
<script>
        document.querySelectorAll('.github-emoji')
          .forEach(el => {
            if (!el.dataset.src) { return; }
            const img = document.createElement('img');
            img.style = 'display:none !important;';
            img.src = el.dataset.src;
            img.addEventListener('error', () => {
              img.remove();
              el.style.color = 'inherit';
              el.style.backgroundImage = 'none';
              el.style.background = 'none';
            });
            img.addEventListener('load', () => {
              img.remove();
            });
            document.body.appendChild(img);
          });
      </script>
    
        <div>
            <a href="/posts/61fb6d52/" class="post-more waves-button">
                阅读全文 »
            </a>
        </div>
    </div>
    
</article>

        </li>
    
    </ul>

    
<nav id="page-nav">
    <div class="inner">
    <a class="extend prev" rel="prev" href="/page/8/">上一页</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/">7</a><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><a class="page-number" href="/page/11/">11</a><span class="space">&hellip;</span><a class="page-number" href="/page/16/">16</a><a class="extend next" rel="next" href="/page/10/">下一页</a>
    </div>
</nav>


</div>

        <footer class="footer">
    <div class="footer-content">
        <span class="power">
            <i class="icon icon-lg icon-copyright"></i>
            2022
            <i class="icon icon-lg icon-heart"></i>
            <a href="https://marnm.github.io">marnm.github.io</a>
            <br>
            Power by
            <a href="https://hexo.io/" target="_blank" rel="external nofollow">Hexo</a>&nbsp;·&nbsp;
            Theme
            <a class="tomotoeslink" href="https://github.com/tomotoes/hexo-theme-tomotoes/" target="_blank" rel="external nofollow">tomotoes</a>
        </span>

        <br>

        <span id="RunTime" style="color:#a7a7a2;"></span>
        <br>

        <span>
            

        </span>
        <br>

        <span class="license"><a target="_blank" rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">博客内容遵循 知识共享 署名 - 非商业性 - 相同方式共享 4.0 国际协议</a></span>
    </div>
</footer>

    </main>
    
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <!-- waves按钮特效 -->
<script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>

<!-- 主题配置脚本 -->
<script>
var BLOG = { ROOT: '/', SHARE: true, REWARD: false };
</script>

<!-- jquery -->
<script src="/js/jquery.min.js?v=3.0"></script>

<!-- 搜索 -->

<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item waves-block waves-effect" onclick="location.href='{path}'">
    <div class="title ellipsis" title="{title}">{title}</div>
</li>
</template>


<!-- main博客脚本 -->
<script src="/js/main.min.js?v=3.0"></script>

<!-- 动画&配置 -->
<script src="/js/script.min.js?v=3.0"></script>

<!-- 脚本管理 -->
<script>

if(window.innerWidth > 800){
	/* 3D标题 */
	$(".content-header").on("mousemove", threedee);

	/* 底部追随鼠标 */
	$(".footer").hover(2);

	/* gotop键的涟漪 */
	$("#gotop").hover(1);

	/* 赞赏的粒子雨 */
	$("#reward").hover(3);

	/* 微信公众号的底部渲染 */
	$("#wechat").hover(4);

    /* 标题跳动 */
    $(".archivestitle").bumpyText();

	/* 图片点击放大 */
	const postimg = jQuery(".post-content img:not(.github-emoji)");
	postimg.on("click",function(){

		mask.classList.add("in");
		main.classList.add("Mask");
		menu.classList.add("Mask");
		var myimg = this.cloneNode(true);
		myimg.classList.add("imgShow");

		setTimeout(function(){
			jQuery(myimg).animate({
				opacity:"1"
			},1000);
		},0);

		document.body.appendChild(myimg);

		myimg.onclick=function(){
			document.body.removeChild(myimg);
			mask.classList.remove("in");
			main.classList.remove("Mask");
			menu.classList.remove("Mask");
		};

	});

}

/* 名字跳动 */
$("#name").bumpyText();


/* 网站运行时间 */
setInterval(function () {
	setTime("2019/01/01");
}, 1000);

/* 文章块的淡出 */
postshow();

/* 座右铭 */

   getHitokoto();



/* 粘贴提示 */
G($(".post-content"), location.href, "Echo");


/* 控制台 */
if (window.console && window.console.log) {
	setTimeout(function () {
		console.log("\n %c 一个坏掉的番茄 %c  © Simon Ma  http://tomotoes.com \n\n", "color:#FFFFFB;background:#1abc9c;padding:5px 0;border-radius:.5rem 0 0 .5rem;", "color:#FFFFFB;background:#080808;padding:5px 0;border-radius:0 .5rem .5rem 0;");
	}, 0);
}

</script>




<!-- 公式渲染 -->



<!-- 不蒜子 -->


</body>
</html>
